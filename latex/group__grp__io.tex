\hypertarget{group__grp__io}{}\section{Reading and Writing Midi Messages}
\label{group__grp__io}\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{porttime_8h_ad478fb637833fb6b1a4bdb25a03f4662}{P\+M\+E\+X\+P\+O\+RT} \hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{group__grp__io_ga3d59225bc890ede974f245ada3de6456}{Pm\+\_\+\+Read} (\hyperlink{portmidi_8h_af4949219ee1bb0afc857cb242d123914}{Port\+Midi\+Stream} $\ast$stream, \hyperlink{struct_pm_event}{Pm\+Event} $\ast$\hyperlink{structbuffer}{buffer}, \hyperlink{lib-src_2ffmpeg_2win32_2stdint_8h_a37994e3b11c72957c6f454c6ec96d43d}{int32\+\_\+t} \hyperlink{test__lib_f_l_a_c_2format_8c_ac94dc16b22556ba5fa815655f27442da}{length})
\item 
\hyperlink{porttime_8h_ad478fb637833fb6b1a4bdb25a03f4662}{P\+M\+E\+X\+P\+O\+RT} \hyperlink{portmidi_8h_a5fd46ccd2e320e17a840886731e8c6b9}{Pm\+Error} \hyperlink{group__grp__io_ga54198ca9dc1af9d82ec5f44f661faeea}{Pm\+\_\+\+Poll} (\hyperlink{portmidi_8h_af4949219ee1bb0afc857cb242d123914}{Port\+Midi\+Stream} $\ast$stream)
\item 
\hyperlink{porttime_8h_ad478fb637833fb6b1a4bdb25a03f4662}{P\+M\+E\+X\+P\+O\+RT} \hyperlink{portmidi_8h_a5fd46ccd2e320e17a840886731e8c6b9}{Pm\+Error} \hyperlink{group__grp__io_ga82950117f003d28f9ca6536c00af985a}{Pm\+\_\+\+Write} (\hyperlink{portmidi_8h_af4949219ee1bb0afc857cb242d123914}{Port\+Midi\+Stream} $\ast$stream, \hyperlink{struct_pm_event}{Pm\+Event} $\ast$\hyperlink{structbuffer}{buffer}, \hyperlink{lib-src_2ffmpeg_2win32_2stdint_8h_a37994e3b11c72957c6f454c6ec96d43d}{int32\+\_\+t} \hyperlink{test__lib_f_l_a_c_2format_8c_ac94dc16b22556ba5fa815655f27442da}{length})
\item 
\hyperlink{porttime_8h_ad478fb637833fb6b1a4bdb25a03f4662}{P\+M\+E\+X\+P\+O\+RT} \hyperlink{portmidi_8h_a5fd46ccd2e320e17a840886731e8c6b9}{Pm\+Error} \hyperlink{group__grp__io_ga4a8cdd77e5b2ad4c16338eed475dfc6b}{Pm\+\_\+\+Write\+Short} (\hyperlink{portmidi_8h_af4949219ee1bb0afc857cb242d123914}{Port\+Midi\+Stream} $\ast$stream, \hyperlink{portmidi_8h_acf4245beeef251c4a46d66e99d77ffdf}{Pm\+Timestamp} when, \hyperlink{lib-src_2ffmpeg_2win32_2stdint_8h_a37994e3b11c72957c6f454c6ec96d43d}{int32\+\_\+t} msg)
\item 
\hyperlink{porttime_8h_ad478fb637833fb6b1a4bdb25a03f4662}{P\+M\+E\+X\+P\+O\+RT} \hyperlink{portmidi_8h_a5fd46ccd2e320e17a840886731e8c6b9}{Pm\+Error} \hyperlink{group__grp__io_ga4bd5753bdfb53a1611bcdf5ba159fc87}{Pm\+\_\+\+Write\+Sys\+Ex} (\hyperlink{portmidi_8h_af4949219ee1bb0afc857cb242d123914}{Port\+Midi\+Stream} $\ast$stream, \hyperlink{portmidi_8h_acf4245beeef251c4a46d66e99d77ffdf}{Pm\+Timestamp} when, unsigned char $\ast$msg)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}!Pm\+\_\+\+Poll@{Pm\+\_\+\+Poll}}
\index{Pm\+\_\+\+Poll@{Pm\+\_\+\+Poll}!Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsubsection[{\texorpdfstring{Pm\+\_\+\+Poll(\+Port\+Midi\+Stream $\ast$stream)}{Pm_Poll(PortMidiStream *stream)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+M\+E\+X\+P\+O\+RT} {\bf Pm\+Error} Pm\+\_\+\+Poll (
\begin{DoxyParamCaption}
\item[{{\bf Port\+Midi\+Stream} $\ast$}]{stream}
\end{DoxyParamCaption}
)}\hypertarget{group__grp__io_ga54198ca9dc1af9d82ec5f44f661faeea}{}\label{group__grp__io_ga54198ca9dc1af9d82ec5f44f661faeea}
\hyperlink{group__grp__io_ga54198ca9dc1af9d82ec5f44f661faeea}{Pm\+\_\+\+Poll()} tests whether input is available, returning T\+R\+UE, F\+A\+L\+SE, or an error value. 

Definition at line 398 of file portmidi.\+c.

\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}!Pm\+\_\+\+Read@{Pm\+\_\+\+Read}}
\index{Pm\+\_\+\+Read@{Pm\+\_\+\+Read}!Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsubsection[{\texorpdfstring{Pm\+\_\+\+Read(\+Port\+Midi\+Stream $\ast$stream, Pm\+Event $\ast$buffer, int32\+\_\+t length)}{Pm_Read(PortMidiStream *stream, PmEvent *buffer, int32_t length)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+M\+E\+X\+P\+O\+RT} {\bf int} Pm\+\_\+\+Read (
\begin{DoxyParamCaption}
\item[{{\bf Port\+Midi\+Stream} $\ast$}]{stream, }
\item[{{\bf Pm\+Event} $\ast$}]{buffer, }
\item[{{\bf int32\+\_\+t}}]{length}
\end{DoxyParamCaption}
)}\hypertarget{group__grp__io_ga3d59225bc890ede974f245ada3de6456}{}\label{group__grp__io_ga3d59225bc890ede974f245ada3de6456}
\hyperlink{group__grp__io_ga3d59225bc890ede974f245ada3de6456}{Pm\+\_\+\+Read()} retrieves midi data into a buffer, and returns the number of events read. Result is a non-\/negative number unless an error occurs, in which case a Pm\+Error value will be returned.

Buffer Overflow

The problem\+: if an input overflow occurs, data will be lost, ultimately because there is no flow control all the way back to the data source. When data is lost, the receiver should be notified and some sort of graceful recovery should take place, e.\+g. you shouldn\textquotesingle{}t resume receiving in the middle of a long sysex message.

With a lock-\/free fifo, which is pretty much what we\textquotesingle{}re stuck with to enable portability to the Mac, it\textquotesingle{}s tricky for the producer and consumer to synchronously reset the buffer and resume normal operation.

Solution\+: the buffer managed by Port\+Midi will be flushed when an overflow occurs. The consumer (\hyperlink{group__grp__io_ga3d59225bc890ede974f245ada3de6456}{Pm\+\_\+\+Read()}) gets an error message (pm\+Buffer\+Overflow) and ordinary processing resumes as soon as a new message arrives. The remainder of a partial sysex message is not considered to be a \char`\"{}new
message\char`\"{} and will be flushed as well. 

Definition at line 357 of file portmidi.\+c.

\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}!Pm\+\_\+\+Write@{Pm\+\_\+\+Write}}
\index{Pm\+\_\+\+Write@{Pm\+\_\+\+Write}!Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsubsection[{\texorpdfstring{Pm\+\_\+\+Write(\+Port\+Midi\+Stream $\ast$stream, Pm\+Event $\ast$buffer, int32\+\_\+t length)}{Pm_Write(PortMidiStream *stream, PmEvent *buffer, int32_t length)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+M\+E\+X\+P\+O\+RT} {\bf Pm\+Error} Pm\+\_\+\+Write (
\begin{DoxyParamCaption}
\item[{{\bf Port\+Midi\+Stream} $\ast$}]{stream, }
\item[{{\bf Pm\+Event} $\ast$}]{buffer, }
\item[{{\bf int32\+\_\+t}}]{length}
\end{DoxyParamCaption}
)}\hypertarget{group__grp__io_ga82950117f003d28f9ca6536c00af985a}{}\label{group__grp__io_ga82950117f003d28f9ca6536c00af985a}
\hyperlink{group__grp__io_ga82950117f003d28f9ca6536c00af985a}{Pm\+\_\+\+Write()} writes midi data from a buffer. This may contain\+:
\begin{DoxyItemize}
\item short messages or
\item sysex messages that are converted into a sequence of \hyperlink{struct_pm_event}{Pm\+Event} structures, e.\+g. sending data from a file or forwarding them from midi input.
\end{DoxyItemize}

Use \hyperlink{group__grp__io_ga4bd5753bdfb53a1611bcdf5ba159fc87}{Pm\+\_\+\+Write\+Sys\+Ex()} to write a sysex message stored as a contiguous array of bytes.

Sysex data may contain embedded real-\/time messages. 

Definition at line 448 of file portmidi.\+c.

\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}!Pm\+\_\+\+Write\+Short@{Pm\+\_\+\+Write\+Short}}
\index{Pm\+\_\+\+Write\+Short@{Pm\+\_\+\+Write\+Short}!Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsubsection[{\texorpdfstring{Pm\+\_\+\+Write\+Short(\+Port\+Midi\+Stream $\ast$stream, Pm\+Timestamp when, int32\+\_\+t msg)}{Pm_WriteShort(PortMidiStream *stream, PmTimestamp when, int32_t msg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+M\+E\+X\+P\+O\+RT} {\bf Pm\+Error} Pm\+\_\+\+Write\+Short (
\begin{DoxyParamCaption}
\item[{{\bf Port\+Midi\+Stream} $\ast$}]{stream, }
\item[{{\bf Pm\+Timestamp}}]{when, }
\item[{{\bf int32\+\_\+t}}]{msg}
\end{DoxyParamCaption}
)}\hypertarget{group__grp__io_ga4a8cdd77e5b2ad4c16338eed475dfc6b}{}\label{group__grp__io_ga4a8cdd77e5b2ad4c16338eed475dfc6b}
\hyperlink{group__grp__io_ga4a8cdd77e5b2ad4c16338eed475dfc6b}{Pm\+\_\+\+Write\+Short()} writes a timestamped non-\/system-\/exclusive midi message. Messages are delivered in order as received, and timestamps must be non-\/decreasing. (But timestamps are ignored if the stream was opened with latency = 0.) 

Definition at line 581 of file portmidi.\+c.

\index{Reading and Writing Midi Messages@{Reading and Writing Midi Messages}!Pm\+\_\+\+Write\+Sys\+Ex@{Pm\+\_\+\+Write\+Sys\+Ex}}
\index{Pm\+\_\+\+Write\+Sys\+Ex@{Pm\+\_\+\+Write\+Sys\+Ex}!Reading and Writing Midi Messages@{Reading and Writing Midi Messages}}
\subsubsection[{\texorpdfstring{Pm\+\_\+\+Write\+Sys\+Ex(\+Port\+Midi\+Stream $\ast$stream, Pm\+Timestamp when, unsigned char $\ast$msg)}{Pm_WriteSysEx(PortMidiStream *stream, PmTimestamp when, unsigned char *msg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+M\+E\+X\+P\+O\+RT} {\bf Pm\+Error} Pm\+\_\+\+Write\+Sys\+Ex (
\begin{DoxyParamCaption}
\item[{{\bf Port\+Midi\+Stream} $\ast$}]{stream, }
\item[{{\bf Pm\+Timestamp}}]{when, }
\item[{unsigned char $\ast$}]{msg}
\end{DoxyParamCaption}
)}\hypertarget{group__grp__io_ga4bd5753bdfb53a1611bcdf5ba159fc87}{}\label{group__grp__io_ga4bd5753bdfb53a1611bcdf5ba159fc87}
\hyperlink{group__grp__io_ga4bd5753bdfb53a1611bcdf5ba159fc87}{Pm\+\_\+\+Write\+Sys\+Ex()} writes a timestamped system-\/exclusive midi message. 

Definition at line 591 of file portmidi.\+c.

