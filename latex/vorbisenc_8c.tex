\hypertarget{vorbisenc_8c}{}\section{C\+:/\+\_\+dev/\+Open\+U/\+Audacity/audacity/lib-\/src/libvorbis/lib/vorbisenc.c File Reference}
\label{vorbisenc_8c}\index{C\+:/\+\_\+dev/\+Open\+U/\+Audacity/audacity/lib-\/src/libvorbis/lib/vorbisenc.\+c@{C\+:/\+\_\+dev/\+Open\+U/\+Audacity/audacity/lib-\/src/libvorbis/lib/vorbisenc.\+c}}
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include \char`\"{}vorbis/codec.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vorbis/vorbisenc.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}codec\+\_\+internal.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}os.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}misc.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+44.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+44u.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+44p51.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+32.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+8.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+11.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+16.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+22.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}modes/setup\+\_\+\+X.\+h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structstatic__bookblock}{static\+\_\+bookblock}
\item 
struct \hyperlink{structvorbis__residue__template}{vorbis\+\_\+residue\+\_\+template}
\item 
struct \hyperlink{structvorbis__mapping__template}{vorbis\+\_\+mapping\+\_\+template}
\item 
struct \hyperlink{structvp__adjblock}{vp\+\_\+adjblock}
\item 
struct \hyperlink{structcompandblock}{compandblock}
\item 
struct \hyperlink{structatt3}{att3}
\item 
struct \hyperlink{structadj3}{adj3}
\item 
struct \hyperlink{structadj__stereo}{adj\+\_\+stereo}
\item 
struct \hyperlink{structnoiseguard}{noiseguard}
\item 
struct \hyperlink{structnoise3}{noise3}
\item 
struct \hyperlink{structve__setup__data__template}{ve\+\_\+setup\+\_\+data\+\_\+template}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structvp__adjblock}{vp\+\_\+adjblock} \hyperlink{vorbisenc_8c_a3f75775ea06e75038641b7fb881bf550}{vp\+\_\+adjblock}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi)
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_a0f7677f216936a6cd7fa28ddbccada74}{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi, long channels, long \hyperlink{seqread_8c_ad89d3fac2deab7a9cf6cfc8d15341b85}{rate}, float quality)
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_ab4e3d96c3008a29c615271d1f551c2a0}{vorbis\+\_\+encode\+\_\+init\+\_\+vbr} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi, long channels, long \hyperlink{seqread_8c_ad89d3fac2deab7a9cf6cfc8d15341b85}{rate}, float base\+\_\+quality)
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_ac73714f24500e18024e83104e9e09485}{vorbis\+\_\+encode\+\_\+setup\+\_\+managed} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi, long channels, long \hyperlink{seqread_8c_ad89d3fac2deab7a9cf6cfc8d15341b85}{rate}, long max\+\_\+bitrate, long nominal\+\_\+bitrate, long min\+\_\+bitrate)
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_a6571d9c349c540491256f1083e1ede71}{vorbis\+\_\+encode\+\_\+init} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi, long channels, long \hyperlink{seqread_8c_ad89d3fac2deab7a9cf6cfc8d15341b85}{rate}, long max\+\_\+bitrate, long nominal\+\_\+bitrate, long min\+\_\+bitrate)
\item 
\hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} \hyperlink{vorbisenc_8c_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl} (\hyperlink{structvorbis__info}{vorbis\+\_\+info} $\ast$vi, \hyperlink{xmltok_8h_a5a0d4a5641ce434f1d23533f2b2e6653}{int} number, \hyperlink{sound_8c_ae35f5844602719cf66324f4de2a658b3}{void} $\ast$arg)
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\index{vorbisenc.\+c@{vorbisenc.\+c}!vp\+\_\+adjblock@{vp\+\_\+adjblock}}
\index{vp\+\_\+adjblock@{vp\+\_\+adjblock}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vp\+\_\+adjblock}{vp_adjblock}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf vp\+\_\+adjblock}  {\bf vp\+\_\+adjblock}}\hypertarget{vorbisenc_8c_a3f75775ea06e75038641b7fb881bf550}{}\label{vorbisenc_8c_a3f75775ea06e75038641b7fb881bf550}


\subsection{Function Documentation}
\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+ctl@{vorbis\+\_\+encode\+\_\+ctl}}
\index{vorbis\+\_\+encode\+\_\+ctl@{vorbis\+\_\+encode\+\_\+ctl}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+ctl(vorbis\+\_\+info $\ast$vi, int number, void $\ast$arg)}{vorbis_encode_ctl(vorbis_info *vi, int number, void *arg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+ctl (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi, }
\item[{{\bf int}}]{number, }
\item[{{\bf void} $\ast$}]{arg}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_a5f398a378e20b8ce5e3341a582e773bd}{}\label{vorbisenc_8c_a5f398a378e20b8ce5e3341a582e773bd}
This function implements a generic interface to miscellaneous encoder settings similar to the classic U\+N\+IX \textquotesingle{}ioctl()\textquotesingle{} system call. Applications may use \hyperlink{vorbisenc_8h_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl()} to query or set bitrate management or quality mode details by using one of several {\itshape request} arguments detailed below. \hyperlink{vorbisenc_8h_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl()} must be called after one of \hyperlink{vorbisenc_8h_ac73714f24500e18024e83104e9e09485}{vorbis\+\_\+encode\+\_\+setup\+\_\+managed()} or \hyperlink{vorbisenc_8h_a0f7677f216936a6cd7fa28ddbccada74}{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr()}. When used to modify settings, \hyperlink{vorbisenc_8h_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl()} must be called before \hyperlink{vorbisenc_8h_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init()}.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct.\\
\hline
{\em number} & Specifies the desired action; See \hyperlink{vorbisenc_8h_encctlcodes}{the list}of available requests".\\
\hline
{\em arg} & void $\ast$ pointing to a data structure matching the request argument.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success. Any further return information (such as the result of a query) is placed into the storage pointed to by $\ast$arg.\\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Invalid argument, or an attempt to modify a setting after calling \hyperlink{vorbisenc_8h_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init()}.\\
\hline
{\em O\+V\+\_\+\+E\+I\+M\+PL} & Unimplemented or unknown request \\
\hline
\end{DoxyRetVals}


Definition at line 1013 of file vorbisenc.\+c.

\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+init@{vorbis\+\_\+encode\+\_\+init}}
\index{vorbis\+\_\+encode\+\_\+init@{vorbis\+\_\+encode\+\_\+init}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+init(vorbis\+\_\+info $\ast$vi, long channels, long rate, long max\+\_\+bitrate, long nominal\+\_\+bitrate, long min\+\_\+bitrate)}{vorbis_encode_init(vorbis_info *vi, long channels, long rate, long max_bitrate, long nominal_bitrate, long min_bitrate)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi, }
\item[{long}]{channels, }
\item[{long}]{rate, }
\item[{long}]{max\+\_\+bitrate, }
\item[{long}]{nominal\+\_\+bitrate, }
\item[{long}]{min\+\_\+bitrate}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_a6571d9c349c540491256f1083e1ede71}{}\label{vorbisenc_8c_a6571d9c349c540491256f1083e1ede71}
This is the primary function within libvorbisenc for setting up managed bitrate modes.

Before this function is called, the \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct should be initialized by using \hyperlink{codec_8h_af0ed4e74fe68802c7d337a2645e759d6}{vorbis\+\_\+info\+\_\+init()} from the libvorbis A\+PI. After encoding, \hyperlink{codec_8h_abaf171c1341b23e1c2eed7dab00d9f4a}{vorbis\+\_\+info\+\_\+clear()} should be called.

The max\+\_\+bitrate, nominal\+\_\+bitrate, and min\+\_\+bitrate settings are used to set constraints for the encoded file. This function uses these settings to select the appropriate encoding mode and set it up.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct. \\
\hline
{\em channels} & The number of channels to be encoded. \\
\hline
{\em rate} & The sampling rate of the source audio. \\
\hline
{\em max\+\_\+bitrate} & Desired maximum bitrate (limit). -\/1 indicates unset. \\
\hline
{\em nominal\+\_\+bitrate} & Desired average, or central, bitrate. -\/1 indicates unset. \\
\hline
{\em min\+\_\+bitrate} & Desired minimum bitrate. -\/1 indicates unset.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Zero for success, and negative values for failure.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success. \\
\hline
{\em O\+V\+\_\+\+E\+F\+A\+U\+LT} & Internal logic fault; indicates a bug or heap/stack corruption. \\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Invalid setup request, eg, out of range argument. \\
\hline
{\em O\+V\+\_\+\+E\+I\+M\+PL} & Unimplemented mode; unable to comply with bitrate request. \\
\hline
\end{DoxyRetVals}


Definition at line 990 of file vorbisenc.\+c.

\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+init\+\_\+vbr@{vorbis\+\_\+encode\+\_\+init\+\_\+vbr}}
\index{vorbis\+\_\+encode\+\_\+init\+\_\+vbr@{vorbis\+\_\+encode\+\_\+init\+\_\+vbr}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+init\+\_\+vbr(vorbis\+\_\+info $\ast$vi, long channels, long rate, float base\+\_\+quality)}{vorbis_encode_init_vbr(vorbis_info *vi, long channels, long rate, float base_quality)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+init\+\_\+vbr (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi, }
\item[{long}]{channels, }
\item[{long}]{rate, }
\item[{float}]{base\+\_\+quality}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_ab4e3d96c3008a29c615271d1f551c2a0}{}\label{vorbisenc_8c_ab4e3d96c3008a29c615271d1f551c2a0}
This is the primary function within libvorbisenc for setting up variable bitrate (\char`\"{}quality\char`\"{} based) modes.

Before this function is called, the \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct should be initialized by using \hyperlink{codec_8h_af0ed4e74fe68802c7d337a2645e759d6}{vorbis\+\_\+info\+\_\+init()} from the libvorbis A\+PI. After encoding, \hyperlink{codec_8h_abaf171c1341b23e1c2eed7dab00d9f4a}{vorbis\+\_\+info\+\_\+clear()} should be called.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct. \\
\hline
{\em channels} & The number of channels to be encoded. \\
\hline
{\em rate} & The sampling rate of the source audio. \\
\hline
{\em base\+\_\+quality} & Desired quality level, currently from -\/0.\+1 to 1.\+0 (lo to hi).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Zero for success, or a negative number for failure.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success \\
\hline
{\em O\+V\+\_\+\+E\+F\+A\+U\+LT} & Internal logic fault; indicates a bug or heap/stack corruption. \\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Invalid setup request, eg, out of range argument. \\
\hline
{\em O\+V\+\_\+\+E\+I\+M\+PL} & Unimplemented mode; unable to comply with quality level request. \\
\hline
\end{DoxyRetVals}


Definition at line 923 of file vorbisenc.\+c.

\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+setup\+\_\+init@{vorbis\+\_\+encode\+\_\+setup\+\_\+init}}
\index{vorbis\+\_\+encode\+\_\+setup\+\_\+init@{vorbis\+\_\+encode\+\_\+setup\+\_\+init}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+setup\+\_\+init(vorbis\+\_\+info $\ast$vi)}{vorbis_encode_setup_init(vorbis_info *vi)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+setup\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_ac3953ff69d05864e78d1858a544ed619}{}\label{vorbisenc_8c_ac3953ff69d05864e78d1858a544ed619}
This function performs the last stage of three-\/step encoding setup, as described in the A\+PI overview under managed bitrate modes.

Before this function is called, the \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct should be initialized by using \hyperlink{codec_8h_af0ed4e74fe68802c7d337a2645e759d6}{vorbis\+\_\+info\+\_\+init()} from the libvorbis A\+PI, one of \hyperlink{vorbisenc_8h_ac73714f24500e18024e83104e9e09485}{vorbis\+\_\+encode\+\_\+setup\+\_\+managed()} or \hyperlink{vorbisenc_8h_a0f7677f216936a6cd7fa28ddbccada74}{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr()} called to initialize the high-\/level encoding setup, and \hyperlink{vorbisenc_8h_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl()} called if necessary to make encoding setup changes. \hyperlink{vorbisenc_8h_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init()} finalizes the highlevel encoding structure into a complete encoding setup after which the application may make no further setup changes.

After encoding, \hyperlink{codec_8h_abaf171c1341b23e1c2eed7dab00d9f4a}{vorbis\+\_\+info\+\_\+clear()} should be called.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Zero for success, and negative values for failure.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success. \\
\hline
{\em O\+V\+\_\+\+E\+F\+A\+U\+LT} & Internal logic fault; indicates a bug or heap/stack corruption.\\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Attempt to use \hyperlink{vorbisenc_8h_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init()} without first calling one of \hyperlink{vorbisenc_8h_ac73714f24500e18024e83104e9e09485}{vorbis\+\_\+encode\+\_\+setup\+\_\+managed()} or \hyperlink{vorbisenc_8h_a0f7677f216936a6cd7fa28ddbccada74}{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr()} to initialize the high-\/level encoding setup \\
\hline
\end{DoxyRetVals}


Definition at line 681 of file vorbisenc.\+c.

\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+setup\+\_\+managed@{vorbis\+\_\+encode\+\_\+setup\+\_\+managed}}
\index{vorbis\+\_\+encode\+\_\+setup\+\_\+managed@{vorbis\+\_\+encode\+\_\+setup\+\_\+managed}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+setup\+\_\+managed(vorbis\+\_\+info $\ast$vi, long channels, long rate, long max\+\_\+bitrate, long nominal\+\_\+bitrate, long min\+\_\+bitrate)}{vorbis_encode_setup_managed(vorbis_info *vi, long channels, long rate, long max_bitrate, long nominal_bitrate, long min_bitrate)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+setup\+\_\+managed (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi, }
\item[{long}]{channels, }
\item[{long}]{rate, }
\item[{long}]{max\+\_\+bitrate, }
\item[{long}]{nominal\+\_\+bitrate, }
\item[{long}]{min\+\_\+bitrate}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_ac73714f24500e18024e83104e9e09485}{}\label{vorbisenc_8c_ac73714f24500e18024e83104e9e09485}
This function performs step-\/one of a three-\/step bitrate-\/managed encode setup. It functions similarly to the one-\/step setup performed by \hyperlink{vorbisenc_8c_a6571d9c349c540491256f1083e1ede71}{vorbis\+\_\+encode\+\_\+init} but allows an application to make further encode setup tweaks using \hyperlink{vorbisenc_8c_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl} before finally calling \hyperlink{vorbisenc_8c_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init} to complete the setup process.

Before this function is called, the \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct should be initialized by using \hyperlink{codec_8h_af0ed4e74fe68802c7d337a2645e759d6}{vorbis\+\_\+info\+\_\+init()} from the libvorbis A\+PI. After encoding, \hyperlink{codec_8h_abaf171c1341b23e1c2eed7dab00d9f4a}{vorbis\+\_\+info\+\_\+clear()} should be called.

The max\+\_\+bitrate, nominal\+\_\+bitrate, and min\+\_\+bitrate settings are used to set constraints for the encoded file. This function uses these settings to select the appropriate encoding mode and set it up.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct. \\
\hline
{\em channels} & The number of channels to be encoded. \\
\hline
{\em rate} & The sampling rate of the source audio. \\
\hline
{\em max\+\_\+bitrate} & Desired maximum bitrate (limit). -\/1 indicates unset. \\
\hline
{\em nominal\+\_\+bitrate} & Desired average, or central, bitrate. -\/1 indicates unset. \\
\hline
{\em min\+\_\+bitrate} & Desired minimum bitrate. -\/1 indicates unset.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Zero for success, and negative for failure.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success \\
\hline
{\em O\+V\+\_\+\+E\+F\+A\+U\+LT} & Internal logic fault; indicates a bug or heap/stack corruption. \\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Invalid setup request, eg, out of range argument. \\
\hline
{\em O\+V\+\_\+\+E\+I\+M\+PL} & Unimplemented mode; unable to comply with bitrate request. \\
\hline
\end{DoxyRetVals}


Definition at line 943 of file vorbisenc.\+c.

\index{vorbisenc.\+c@{vorbisenc.\+c}!vorbis\+\_\+encode\+\_\+setup\+\_\+vbr@{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr}}
\index{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr@{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr}!vorbisenc.\+c@{vorbisenc.\+c}}
\subsubsection[{\texorpdfstring{vorbis\+\_\+encode\+\_\+setup\+\_\+vbr(vorbis\+\_\+info $\ast$vi, long channels, long rate, float quality)}{vorbis_encode_setup_vbr(vorbis_info *vi, long channels, long rate, float quality)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} vorbis\+\_\+encode\+\_\+setup\+\_\+vbr (
\begin{DoxyParamCaption}
\item[{{\bf vorbis\+\_\+info} $\ast$}]{vi, }
\item[{long}]{channels, }
\item[{long}]{rate, }
\item[{float}]{quality}
\end{DoxyParamCaption}
)}\hypertarget{vorbisenc_8c_a0f7677f216936a6cd7fa28ddbccada74}{}\label{vorbisenc_8c_a0f7677f216936a6cd7fa28ddbccada74}
This function performs step-\/one of a three-\/step variable bitrate (quality-\/based) encode setup. It functions similarly to the one-\/step setup performed by \hyperlink{vorbisenc_8h_ab4e3d96c3008a29c615271d1f551c2a0}{vorbis\+\_\+encode\+\_\+init\+\_\+vbr()} but allows an application to make further encode setup tweaks using \hyperlink{vorbisenc_8h_a5f398a378e20b8ce5e3341a582e773bd}{vorbis\+\_\+encode\+\_\+ctl()} before finally calling \hyperlink{vorbisenc_8c_ac3953ff69d05864e78d1858a544ed619}{vorbis\+\_\+encode\+\_\+setup\+\_\+init} to complete the setup process.

Before this function is called, the \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct should be initialized by using \hyperlink{codec_8h_af0ed4e74fe68802c7d337a2645e759d6}{vorbis\+\_\+info\+\_\+init()} from the libvorbis A\+PI. After encoding, \hyperlink{codec_8h_abaf171c1341b23e1c2eed7dab00d9f4a}{vorbis\+\_\+info\+\_\+clear()} should be called.


\begin{DoxyParams}{Parameters}
{\em vi} & Pointer to an initialized \hyperlink{structvorbis__info}{vorbis\+\_\+info} struct. \\
\hline
{\em channels} & The number of channels to be encoded. \\
\hline
{\em rate} & The sampling rate of the source audio. \\
\hline
{\em quality} & Desired quality level, currently from -\/0.\+1 to 1.\+0 (lo to hi).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Zero for success, and negative values for failure.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Success \\
\hline
{\em O\+V\+\_\+\+E\+F\+A\+U\+LT} & Internal logic fault; indicates a bug or heap/stack corruption. \\
\hline
{\em O\+V\+\_\+\+E\+I\+N\+V\+AL} & Invalid setup request, eg, out of range argument. \\
\hline
{\em O\+V\+\_\+\+E\+I\+M\+PL} & Unimplemented mode; unable to comply with quality level request. \\
\hline
\end{DoxyRetVals}


Definition at line 902 of file vorbisenc.\+c.

