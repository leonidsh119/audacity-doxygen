<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="seqmwrite_8c" kind="file" language="C++">
    <compoundname>seqmwrite.c</compoundname>
    <includes local="yes">switches.h</includes>
    <includes local="no">stdio.h</includes>
    <includes refid="cext_8h" local="yes">cext.h</includes>
    <includes refid="userio_8h" local="yes">userio.h</includes>
    <includes refid="libnyquist_2nyquist_2cmt_2midicode_8h" local="yes">midicode.h</includes>
    <includes refid="libnyquist_2nyquist_2cmt_2mfmidi_8h" local="yes">mfmidi.h</includes>
    <includes refid="midifns_8h" local="yes">midifns.h</includes>
    <includes refid="timebase_8h" local="yes">timebase.h</includes>
    <includes refid="moxc_8h" local="yes">moxc.h</includes>
    <includes refid="seq_8h" local="yes">seq.h</includes>
    <includes refid="seqread_8h" local="yes">seqread.h</includes>
    <includes refid="seqmwrite_8h" local="yes">seqmwrite.h</includes>
    <incdepgraph>
      <node id="11492">
        <label>seqread.h</label>
        <link refid="seqread_8h"/>
      </node>
      <node id="11491">
        <label>seq.h</label>
        <link refid="seq_8h"/>
      </node>
      <node id="11483">
        <label>cleanup.h</label>
        <link refid="cleanup_8h"/>
      </node>
      <node id="11486">
        <label>mfmidi.h</label>
        <link refid="libnyquist_2nyquist_2cmt_2mfmidi_8h"/>
      </node>
      <node id="11482">
        <label>mem.h</label>
        <link refid="libnyquist_2nyquist_2cmt_2mem_8h"/>
      </node>
      <node id="11480">
        <label>string.h</label>
      </node>
      <node id="11481">
        <label>math.h</label>
      </node>
      <node id="11477">
        <label>switches.h</label>
      </node>
      <node id="11484">
        <label>userio.h</label>
        <link refid="userio_8h"/>
      </node>
      <node id="11487">
        <label>midifns.h</label>
        <link refid="midifns_8h"/>
        <childnode refid="11488" relation="include">
        </childnode>
      </node>
      <node id="11488">
        <label>midierr.h</label>
        <link refid="midierr_8h"/>
      </node>
      <node id="11490">
        <label>moxc.h</label>
        <link refid="moxc_8h"/>
      </node>
      <node id="11476">
        <label>C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c</label>
        <link refid="seqmwrite.c"/>
        <childnode refid="11477" relation="include">
        </childnode>
        <childnode refid="11478" relation="include">
        </childnode>
        <childnode refid="11479" relation="include">
        </childnode>
        <childnode refid="11484" relation="include">
        </childnode>
        <childnode refid="11485" relation="include">
        </childnode>
        <childnode refid="11486" relation="include">
        </childnode>
        <childnode refid="11487" relation="include">
        </childnode>
        <childnode refid="11489" relation="include">
        </childnode>
        <childnode refid="11490" relation="include">
        </childnode>
        <childnode refid="11491" relation="include">
        </childnode>
        <childnode refid="11492" relation="include">
        </childnode>
        <childnode refid="11493" relation="include">
        </childnode>
      </node>
      <node id="11493">
        <label>seqmwrite.h</label>
        <link refid="seqmwrite_8h"/>
      </node>
      <node id="11478">
        <label>stdio.h</label>
      </node>
      <node id="11485">
        <label>midicode.h</label>
        <link refid="libnyquist_2nyquist_2cmt_2midicode_8h"/>
      </node>
      <node id="11489">
        <label>timebase.h</label>
        <link refid="timebase_8h"/>
      </node>
      <node id="11479">
        <label>cext.h</label>
        <link refid="cext_8h"/>
        <childnode refid="11477" relation="include">
        </childnode>
        <childnode refid="11478" relation="include">
        </childnode>
        <childnode refid="11480" relation="include">
        </childnode>
        <childnode refid="11481" relation="include">
        </childnode>
        <childnode refid="11482" relation="include">
        </childnode>
        <childnode refid="11483" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="structsmf__write__seq" prot="public">smf_write_seq</innerclass>
      <sectiondef kind="var">
      <memberdef kind="variable" id="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" prot="public" static="no" mutable="no">
        <type>long</type>
        <definition>long chunk_size_marker</definition>
        <argsstring></argsstring>
        <name>chunk_size_marker</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="26" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="26" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" prot="public" static="no" mutable="no">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>int seti_counter</definition>
        <argsstring></argsstring>
        <name>seti_counter</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="27" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="27" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1a10ddddcfaf2196257faaa56e28b324cc" prot="public" static="no" mutable="no">
        <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
        <definition>time_type a_start_time</definition>
        <argsstring></argsstring>
        <name>a_start_time</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="28" column="1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" prot="public" static="no" mutable="no">
        <type>long</type>
        <definition>long last_event</definition>
        <argsstring></argsstring>
        <name>last_event</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="30" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="30" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" prot="public" static="no" mutable="no">
        <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
        <definition>time_type last_clock_event</definition>
        <argsstring></argsstring>
        <name>last_clock_event</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="31" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="31" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" prot="public" static="no" mutable="no">
        <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
        <definition>time_type last_tick_size</definition>
        <argsstring></argsstring>
        <name>last_tick_size</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="32" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="32" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structsmf__write__seq" kindref="compound">smf_write_seq</ref></type>
        <definition>struct smf_write_seq  smfw_seq</definition>
        <argsstring></argsstring>
        <name>smfw_seq</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="38" column="1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1aa85df2bb76931a50df646c42ac67b112" prot="public" static="no" mutable="no">
        <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
        <definition>seq_type sequence</definition>
        <argsstring></argsstring>
        <name>sequence</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="39" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seq.c" bodystart="29" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" prot="public" static="no" mutable="no">
        <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
        <definition>time_type clock_ticksize</definition>
        <argsstring></argsstring>
        <name>clock_ticksize</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="42" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seq.c" bodystart="33" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1a2256a473537c6dc943f1bd8b1013ca16" prot="public" static="no" mutable="no">
        <type><ref refid="cext_8h_1a7670a4e8a07d9ebb00411948b0bbf86d" kindref="member">boolean</ref></type>
        <definition>boolean clock_running</definition>
        <argsstring></argsstring>
        <name>clock_running</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="43" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seq.c" bodystart="34" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="seqmwrite_8c_1aa8598701b486b2a7b0b2752dabec1181" prot="public" static="no" mutable="no">
        <type><ref refid="cext_8h_1a7670a4e8a07d9ebb00411948b0bbf86d" kindref="member">boolean</ref></type>
        <definition>boolean use_midi_clock</definition>
        <argsstring></argsstring>
        <name>use_midi_clock</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="44" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="seqmwrite_8c_1ac5a7981e4b63f72c7a3dd11e85f0f006" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_bend</definition>
        <argsstring>()</argsstring>
        <name>smfw_bend</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="46" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a10ee6ade2508036308a7e464ac798f2a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_cause_noteoff</definition>
        <argsstring>()</argsstring>
        <name>smfw_cause_noteoff</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="47" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a4b2b46ea300375a17f0ded79c5e51c41" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_ctrl</definition>
        <argsstring>()</argsstring>
        <name>smfw_ctrl</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="48" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_deltatime</definition>
        <argsstring>()</argsstring>
        <name>smfw_deltatime</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="49" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="142" bodyend="158"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a5c44255d04005778f34a064c727300cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_dotrack</definition>
        <argsstring>()</argsstring>
        <name>smfw_dotrack</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="50" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a10567530937ccae6f5948e3f286d788f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_exclusive</definition>
        <argsstring>()</argsstring>
        <name>smfw_exclusive</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="51" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a55cc86350d9ed7b5121fffade76899e1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_noteoff</definition>
        <argsstring>()</argsstring>
        <name>smfw_noteoff</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="52" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1ab6d02c344c6100b5445eaa352bcacf26" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_noteon</definition>
        <argsstring>()</argsstring>
        <name>smfw_noteon</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="53" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1aafe5c6c98fc3ebaaf822702a42656734" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_process_event</definition>
        <argsstring>()</argsstring>
        <name>smfw_process_event</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="54" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_ramp_event</definition>
        <argsstring>(seq_type seq, event_type event, unsigned int value, unsigned int to_value, int increment, time_type step, int n)</argsstring>
        <name>smfw_ramp_event</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="seq_8h_1af6509ba8f4584d40a046340b73d2bd15" kindref="member">event_type</ref></type>
          <declname>event</declname>
        </param>
        <param>
          <type>unsigned <ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>value</declname>
        </param>
        <param>
          <type>unsigned <ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>to_value</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>increment</declname>
        </param>
        <param>
          <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
          <declname>step</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="55" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="437" bodyend="466"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a3a45b26a89ea071906f2a0be7d346ad5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_send_macro</definition>
        <argsstring>()</argsstring>
        <name>smfw_send_macro</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="58" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_touch</definition>
        <argsstring>(seq_type seq, int voice, int value)</argsstring>
        <name>smfw_touch</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>value</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="59" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="503" bodyend="509"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a6870c0b9678085b1dd3a5213670763ff" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void writevarlen</definition>
        <argsstring>()</argsstring>
        <name>writevarlen</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="60" column="1"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1ab73dbd5e56b4c1444c45339b0c1d467b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_bend</definition>
        <argsstring>(seq_type seq, int voice, int value)</argsstring>
        <name>smfw_bend</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>value</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="65" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="65" bodyend="72"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a4334a557cc7b474fcc001dc385e21cc9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_cause_noteoff</definition>
        <argsstring>(seq_type seq, time_type delay, int voice, int pitch)</argsstring>
        <name>smfw_cause_noteoff</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
          <declname>delay</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>pitch</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="84" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="84" bodyend="98"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1aa397b742aef4630931d395231f1227dc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_clock_event</definition>
        <argsstring>(time_type old_ticksize, time_type new_ticksize)</argsstring>
        <name>smfw_clock_event</name>
        <param>
          <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
          <declname>old_ticksize</declname>
        </param>
        <param>
          <type><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref></type>
          <declname>new_ticksize</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="100" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="100" bodyend="125"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a080e91776cd81cd877fdd5ebaef6725c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_ctrl</definition>
        <argsstring>(seq_type seq, int voice, int ctrl_name, int value)</argsstring>
        <name>smfw_ctrl</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>ctrl_name</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>value</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="130" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="130" bodyend="137"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1ab66eb81427165f80b8bb24083f8cf4c1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_dotrack</definition>
        <argsstring>(seq_type seq)</argsstring>
        <name>smfw_dotrack</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="162" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="162" bodyend="204"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a863e8f18e044ecc57b20986d389a88bf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_exclusive</definition>
        <argsstring>(int length, unsigned char *msg)</argsstring>
        <name>smfw_exclusive</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>length</declname>
        </param>
        <param>
          <type>unsigned char *</type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="208" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="208" bodyend="223"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1aa10d2829dd7ccf702237c416bc3eb626" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_msg_write</definition>
        <argsstring>(int n, unsigned char c1, unsigned char c2, unsigned char c3)</argsstring>
        <name>smfw_msg_write</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>n</declname>
        </param>
        <param>
          <type>unsigned char</type>
          <declname>c1</declname>
        </param>
        <param>
          <type>unsigned char</type>
          <declname>c2</declname>
        </param>
        <param>
          <type>unsigned char</type>
          <declname>c3</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="225" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="225" bodyend="242"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a6ba2e9344d79d67104a18e20121829bc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_noteoff</definition>
        <argsstring>(seq_type seq, int voice, int pitch)</argsstring>
        <name>smfw_noteoff</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>pitch</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="247" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="247" bodyend="254"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a60c1e755a14f553b6104ef1d7d5ccf70" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_noteon</definition>
        <argsstring>(seq_type seq, int voice, int pitch, int vel)</argsstring>
        <name>smfw_noteon</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>pitch</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>vel</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="262" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="262" bodyend="271"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a1544a61af1b649aea2ede851f37ad6bc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_process_event</definition>
        <argsstring>(seq_type seq)</argsstring>
        <name>smfw_process_event</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="276" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="276" bodyend="434"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a11141dadfbeafb7aefb001392e736674" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void smfw_send_macro</definition>
        <argsstring>(unsigned char *ptr, int voice, parameter, int parm_num, int value)</argsstring>
        <name>smfw_send_macro</name>
        <param>
          <type>unsigned char *</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>voice</declname>
        </param>
        <param>
          <type>parameter</type>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>parm_num</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>value</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="471" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="471" bodyend="498"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1a2051e9c2a9c4b52654cde8dfe908d3f3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>void seq_write_smf</definition>
        <argsstring>(seq_type seq, FILE *outfile)</argsstring>
        <name>seq_write_smf</name>
        <param>
          <type><ref refid="seq_8h_1a6ee3fb417f66f6b4cfcc515eef1f5d4a" kindref="member">seq_type</ref></type>
          <declname>seq</declname>
        </param>
        <param>
          <type>FILE *</type>
          <declname>outfile</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="512" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="512" bodyend="628"/>
      </memberdef>
      <memberdef kind="function" id="seqmwrite_8c_1aa2d024af417669e188a5b5f0fd8e1dfb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mm_8c_1a6a1d6e1a12975a4e9a0b5b952e79eaad" kindref="member">private</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>private void writevarlen</definition>
        <argsstring>(long value)</argsstring>
        <name>writevarlen</name>
        <param>
          <type>long</type>
          <declname>value</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" line="633" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c" bodystart="633" bodyend="655"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>created<sp/>by<sp/>DMH<sp/>(damonhorowitz):<sp/>write<sp/>seq_type<sp/>as<sp/>standard<sp/>midifile<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">/***************************************************************************</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/><sp/><sp/><sp/><sp/><sp/>Change<sp/>Log</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*<sp/><sp/>Date<sp/><sp/><sp/><sp/><sp/>|<sp/>Change</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*-----------+---------------------------------------------------------------</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>11-Mar-94<sp/>|<sp/>Created<sp/>Change<sp/>Log</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>11-Mar-94<sp/>|<sp/>PLu<sp/>:<sp/>Added<sp/>private<sp/>to<sp/>function<sp/>defs.</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*<sp/>28-Apr-03<sp/>|<sp/><sp/>DM<sp/>:<sp/>Change<sp/>#include&apos;s<sp/>for<sp/>portability</highlight></codeline>
<codeline lineno="9"><highlight class="comment">****************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;switches.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cext_8h" kindref="compound">cext.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="userio_8h" kindref="compound">userio.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h" kindref="compound">midicode.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="libnyquist_2nyquist_2cmt_2mfmidi_8h" kindref="compound">mfmidi.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="midifns_8h" kindref="compound">midifns.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="timebase_8h" kindref="compound">timebase.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="moxc_8h" kindref="compound">moxc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="seq_8h" kindref="compound">seq.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="seqread_8h" kindref="compound">seqread.h</ref>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>to<sp/>get<sp/>scale()<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="seqmwrite_8h" kindref="compound">seqmwrite.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" kindref="member">chunk_size_marker</ref>;</highlight></codeline>
<codeline lineno="27" refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" kindref="member">seti_counter</ref>;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/><ref refid="seqmwrite_8c_1a10ddddcfaf2196257faaa56e28b324cc" kindref="member">a_start_time</ref>;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30" refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*time<sp/>from<sp/>last_clock_event<sp/>to<sp/>the<sp/>last<sp/>event*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" refkind="member"><highlight class="normal"><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref>;</highlight></codeline>
<codeline lineno="32" refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" refkind="member"><highlight class="normal"><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>millisec<sp/>per<sp/>tick<sp/>shifted<sp/>16<sp/>bits<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="structsmf__write__seq" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structsmf__write__seq" kindref="compound">smf_write_seq</ref><sp/>{</highlight></codeline>
<codeline lineno="35" refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="36" refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref>;</highlight></codeline>
<codeline lineno="37" refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="seqmwrite_8c_1aa85df2bb76931a50df646c42ac67b112" kindref="member">sequence</ref>;<sp/></highlight><highlight class="comment">/*<sp/>this<sp/>is<sp/>a<sp/>global<sp/>to<sp/>be<sp/>accessed<sp/>by<sp/></highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>routines<sp/>called<sp/>from<sp/>the<sp/>sequence<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>clock<sp/>state:<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>millisec<sp/>per<sp/>tick<sp/>shifted<sp/>16<sp/>bits<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a2256a473537c6dc943f1bd8b1013ca16" kindref="member">clock_running</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TRUE<sp/>if<sp/>clock<sp/>is<sp/>running<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1aa8598701b486b2a7b0b2752dabec1181" kindref="member">use_midi_clock</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ac5a7981e4b63f72c7a3dd11e85f0f006" kindref="member">smfw_bend</ref>();</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a10ee6ade2508036308a7e464ac798f2a" kindref="member">smfw_cause_noteoff</ref>();</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a4b2b46ea300375a17f0ded79c5e51c41" kindref="member">smfw_ctrl</ref>();</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a5c44255d04005778f34a064c727300cb" kindref="member">smfw_dotrack</ref>();</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a10567530937ccae6f5948e3f286d788f" kindref="member">smfw_exclusive</ref>();</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a55cc86350d9ed7b5121fffade76899e1" kindref="member">smfw_noteoff</ref>();</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ab6d02c344c6100b5445eaa352bcacf26" kindref="member">smfw_noteon</ref>();</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1aafe5c6c98fc3ebaaf822702a42656734" kindref="member">smfw_process_event</ref>();</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" kindref="member">smfw_ramp_event</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/><ref refid="structevent__struct" kindref="compound">event_type</ref><sp/>event,<sp/></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>to_value,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>increment,</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>step,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a3a45b26a89ea071906f2a0be7d346ad5" kindref="member">smfw_send_macro</ref>();</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" kindref="member">smfw_touch</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a6870c0b9678085b1dd3a5213670763ff" kindref="member">writevarlen</ref>();</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_bend<sp/>--<sp/>write<sp/>a<sp/>pitch<sp/>bend<sp/>to<sp/>a<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="seqmwrite_8c_1ab73dbd5e56b4c1444c45339b0c1d467b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ac5a7981e4b63f72c7a3dd11e85f0f006" kindref="member">smfw_bend</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="66"><highlight class="normal">{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_bend<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>value);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1a0585fa061162b26f17693f0add57db6c" kindref="member">MIDI_BEND</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>((value<sp/>&amp;<sp/>0x1)<sp/>&lt;&lt;<sp/>6)<sp/>,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>(value<sp/>&gt;&gt;<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal">}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_cause_noteoff<sp/>--<sp/>schedule<sp/>a<sp/>noteoff<sp/>for<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/>NOTE:<sp/>this<sp/>is<sp/>called<sp/>by<sp/>smfw_process_event<sp/>when<sp/>it<sp/>handles<sp/>a<sp/>note</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/>event<sp/>node<sp/>in<sp/>a<sp/>seq_type&apos;s<sp/>event<sp/>list.<sp/><sp/>The<sp/>ordinary<sp/>moxc<sp/>scheduler</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/>is<sp/>used<sp/>to<sp/>&quot;schedule&quot;<sp/>the<sp/>noteoff<sp/>in<sp/>the<sp/>future.<sp/><sp/>In<sp/>reality,<sp/>the</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/>output<sp/>is<sp/>done<sp/>as<sp/>fast<sp/>as<sp/>possible<sp/>(by<sp/>attempting<sp/>an<sp/>infinite<sp/>rate),</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/>so<sp/>no<sp/>real<sp/>timing<sp/>delays<sp/>occur.<sp/><sp/>The<sp/>effect<sp/>is<sp/>to<sp/>sort<sp/>events<sp/>by<sp/>their</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/>specified<sp/>time.</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="seqmwrite_8c_1a4334a557cc7b474fcc001dc385e21cc9" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a10ee6ade2508036308a7e464ac798f2a" kindref="member">smfw_cause_noteoff</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/>delay,<sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/><ref refid="seqread_8c_1a7f083f7b76ea4d09b2820211a2b0d04e" kindref="member">pitch</ref>)</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>delay;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1a7f083f7b76ea4d09b2820211a2b0d04e" kindref="member">pitch</ref>;</highlight></codeline>
<codeline lineno="89"><highlight class="normal">{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;cause<sp/>noteoff<sp/>at<sp/>%ld...&quot;</highlight><highlight class="normal">,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref><sp/>+<sp/>delay);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>pitch<sp/>+=<sp/>seq-&gt;transpose;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(pitch<sp/>&lt;=<sp/>0)<sp/>pitch<sp/>+=<sp/>12;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(pitch<sp/>&gt;=<sp/>127)<sp/>pitch<sp/>-=<sp/>12;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;noteoff_count++;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="moxc_8c_1acaca1db2e4d549d9fd42caf9cc6b8a40" kindref="member">causepri</ref>((<ref refid="midifns_8h_1a90bc8a533ac78d3f6e076de78883fb75" kindref="member">delay_type</ref>)<sp/>delay,<sp/>10,<sp/>seq-&gt;noteoff_fn,</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seq,<sp/>voice,<sp/>pitch);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="98"><highlight class="normal">}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100" refid="seqmwrite_8c_1aa397b742aef4630931d395231f1227dc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1aa397b742aef4630931d395231f1227dc" kindref="member">smfw_clock_event</ref>(old_ticksize,<sp/>new_ticksize)</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>old_ticksize,<sp/>new_ticksize;</highlight></codeline>
<codeline lineno="102"><highlight class="normal">{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>temp_ticksize<sp/>=<sp/>new_ticksize;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>new_ticksize<sp/>=<sp/><ref refid="seqread_8c_1aa2a8c6fbe5ed24f9523eb4e01368e4bc" kindref="member">scale</ref>(new_ticksize,<sp/>375L,<sp/>1024L);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>(new_ticksize<sp/>&gt;&gt;<sp/>16)<sp/>*<sp/>24000<sp/>ms/clock<sp/>becomes<sp/>us/midiquarter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_clock:<sp/>write<sp/>%ld<sp/>(time:%ld)<sp/>-&gt;-&gt;-&gt;tempo<sp/>%ld\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_ticksize,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>,<sp/>2500L<sp/>/<sp/>(new_ticksize<sp/>/<sp/>24000));</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*use<sp/>old<sp/>ticksize<sp/>to<sp/>write<sp/>the<sp/>delta<sp/>for<sp/>the<sp/>clock<sp/>event*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>=<sp/>old_ticksize;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>=<sp/>temp_ticksize;</highlight><highlight class="comment">/*<sp/>reset<sp/>to<sp/>=<sp/>new_tick_size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x51,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x03,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((new_ticksize<sp/>&gt;&gt;<sp/>16)<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((new_ticksize<sp/>&gt;&gt;<sp/>8)<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>(new_ticksize<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref><sp/>=<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref><sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*no<sp/>time<sp/>expired<sp/>between<sp/>last<sp/>clockevent<sp/>and<sp/>last<sp/>event(they<sp/>are<sp/>the<sp/>same).*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*next<sp/>clock<sp/>event<sp/>will<sp/>be<sp/>exactly<sp/>the<sp/>next<sp/>this_event<sp/>from<sp/>last_clock_event*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal">}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_ctrl<sp/>--<sp/>write<sp/>a<sp/>control<sp/>change<sp/>to<sp/>a<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="seqmwrite_8c_1a080e91776cd81cd877fdd5ebaef6725c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a4b2b46ea300375a17f0ded79c5e51c41" kindref="member">smfw_ctrl</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ctrl_name,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="131"><highlight class="normal">{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_ctrl<sp/>%d:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>ctrl_name,<sp/>value);<sp/></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1a64b08db61b463b1769d8f18fae1ea8e4" kindref="member">MIDI_CTRL</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(ctrl_name,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(value,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="137"><highlight class="normal">}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_deltatime<sp/>--<sp/>write<sp/>the<sp/>time<sp/>difference<sp/>between<sp/>now<sp/>an<sp/>previous<sp/>event<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142" refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>()</highlight></codeline>
<codeline lineno="143"><highlight class="normal">{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>last_<sp/>and<sp/>clock_<sp/>are<sp/>different,<sp/>use<sp/>last_<sp/>for<sp/>clock<sp/>deltatime*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>use_ticksize<sp/>=<sp/>(<ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref><sp/>!=<sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref>)<sp/>?</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>:<sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>this_event<sp/>=<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref><sp/>-<sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref>;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;delta!<sp/>ticksize:<sp/>%lu<sp/>Lastev:<sp/>%ld<sp/>ThisevScaled:<sp/>%lu<sp/>Thisev:<sp/>%lu<sp/>&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>,<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>,<sp/><sp/>(this_event<sp/>*<sp/>((2500L<sp/>&lt;&lt;<sp/>16)<sp/>/<sp/>use_ticksize))<sp/>/<sp/>100,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this_event);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>this_event<sp/>=<sp/>((<ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref><sp/>-<sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref>)<sp/>*<sp/>((2500L<sp/>&lt;&lt;<sp/>16)<sp/>/<sp/>use_ticksize))<sp/>/<sp/>100;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;---<sp/>deltatime:<sp/>%lu\n&quot;</highlight><highlight class="normal">,<sp/>this_event<sp/>-<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a6870c0b9678085b1dd3a5213670763ff" kindref="member">writevarlen</ref>((</highlight><highlight class="keywordtype">long</highlight><highlight class="normal">)<sp/>(this_event<sp/>-<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>));</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref><sp/>=<sp/>this_event;<sp/></highlight></codeline>
<codeline lineno="158"><highlight class="normal">}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_dotrack<sp/>--<sp/>write<sp/>the<sp/>remainder<sp/>of<sp/>a<sp/>track<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="seqmwrite_8c_1ab66eb81427165f80b8bb24083f8cf4c1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a5c44255d04005778f34a064c727300cb" kindref="member">smfw_dotrack</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>end_marker;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structtimebase__struct" kindref="compound">timebase_type</ref><sp/>old_timebase<sp/>=<sp/><ref refid="moxc_8c_1ab19ffac9ae6cc0109f089a377dfd7fa1" kindref="member">timebase</ref>;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>chunk_size;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seq-&gt;runflag)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8c_1acfee310911c26d3820e7bd9d9e0f9c46" kindref="member">seq_stop</ref>(seq);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timebase_8c_1a90c4e2e12751cf3cb1ee643df6fc7d6f" kindref="member">timebase_use</ref>(seq-&gt;timebase);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timebase_8c_1aaaa00c5ca077b8868f9cd000b801b45d" kindref="member">set_rate</ref>(seq-&gt;timebase,<sp/><ref refid="timebase_8h_1a65063aeedc2457a7cdbfe4a9a65ceee6" kindref="member">STOPRATE</ref>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timebase_8c_1a94ab87fc8d67eee7fbac8e06c94af541" kindref="member">set_virttime</ref>(seq-&gt;timebase,<sp/>0L);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;current<sp/>=<sp/><ref refid="seq_8h_1acf719b85bb776dd482bb41ae31732852" kindref="member">seq_events</ref>(seq);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;noteoff_count<sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;runflag<sp/>=<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;paused<sp/>=<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref><sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref><sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;dotrack<sp/>(reset)<sp/>%d<sp/>%ld<sp/>(%lu)<sp/>\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref>,<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seq-&gt;current)<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="moxc_8c_1a667f7390a8435b47e027ae9ea2455cb9" kindref="member">cause</ref>((<ref refid="midifns_8h_1a90bc8a533ac78d3f6e076de78883fb75" kindref="member">delay_type</ref>)(seq-&gt;current-&gt;ntime<sp/>-<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>),<sp/><ref refid="seqmwrite_8c_1aafe5c6c98fc3ebaaf822702a42656734" kindref="member">smfw_process_event</ref>,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seq);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timebase_8c_1a94ab87fc8d67eee7fbac8e06c94af541" kindref="member">set_virttime</ref>(<ref refid="moxc_8c_1ab19ffac9ae6cc0109f089a377dfd7fa1" kindref="member">timebase</ref>,<sp/><ref refid="midifns_8h_1ae583bedb01edb77ee6ceb98e847969cb" kindref="member">MAXTIME</ref>);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="moxc_8c_1a926bfedcca4e1e25deb03f14acc1eaa6" kindref="member">catchup</ref>();</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0xFF,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight><highlight class="comment">/*end<sp/>of<sp/>track<sp/>chunk*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x2F,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>end_marker<sp/>=<sp/>ftell(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>fseek(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>,<sp/><ref refid="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" kindref="member">chunk_size_marker</ref>,<sp/>0);</highlight><highlight class="comment">/*go<sp/>back<sp/>to<sp/>enter<sp/>chunksize*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>chunk_size<sp/>=<sp/>(end_marker<sp/>-<sp/><ref refid="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" kindref="member">chunk_size_marker</ref>)<sp/>-<sp/>4;</highlight><highlight class="comment">/*<sp/>-<sp/>4<sp/>for<sp/>4<sp/>size<sp/>bytes*/</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bytes<sp/>written<sp/>in<sp/>previous<sp/>track:<sp/>%ld<sp/>\n\n&quot;</highlight><highlight class="normal">,<sp/>chunk_size);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((0xFF<sp/>&amp;<sp/>(chunk_size<sp/>&gt;&gt;<sp/>24))),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((0xFF<sp/>&amp;<sp/>(chunk_size<sp/>&gt;&gt;<sp/>16))),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((0xFF<sp/>&amp;<sp/>(chunk_size<sp/>&gt;&gt;<sp/>8))),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((0xFF<sp/>&amp;<sp/>chunk_size)),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>fseek(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>,<sp/>end_marker,<sp/>0);</highlight><highlight class="comment">/*return<sp/>file<sp/>pointer<sp/>to<sp/>end<sp/>of<sp/>track*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timebase_8c_1a90c4e2e12751cf3cb1ee643df6fc7d6f" kindref="member">timebase_use</ref>(old_timebase);</highlight></codeline>
<codeline lineno="204"><highlight class="normal">}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_exclusive<sp/>--<sp/>write<sp/>a<sp/>system<sp/>excl.<sp/>msg<sp/>to<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208" refid="seqmwrite_8c_1a863e8f18e044ecc57b20986d389a88bf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a10567530937ccae6f5948e3f286d788f" kindref="member">smfw_exclusive</ref>(<ref refid="test__lib_f_l_a_c_2format_8c_1ac94dc16b22556ba5fa815655f27442da" kindref="member">length</ref>,<sp/>msg)</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><ref refid="lib_2expat_8h_1a14bb8924daea0b48c7803f281f66e390" kindref="member">int</ref><sp/><ref refid="test__lib_f_l_a_c_2format_8c_1ac94dc16b22556ba5fa815655f27442da" kindref="member">length</ref>;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*msg;<sp/></highlight></codeline>
<codeline lineno="211"><highlight class="normal">{</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SYSEX<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(length<sp/>&gt;<sp/>length_count){<sp/></highlight><highlight class="comment">/*<sp/>*(msg-1)<sp/>!=<sp/>MIDI_EOX)<sp/>{<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(*msg++,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length_count++;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*(--msg)<sp/>!=<sp/><ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1a140c8cfa4bbf1a03494abdbd639d49f2" kindref="member">MIDI_EOX</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ERROR:<sp/>no<sp/>end<sp/>of<sp/>sysex\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="223"><highlight class="normal">}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225" refid="seqmwrite_8c_1aa10d2829dd7ccf702237c416bc3eb626" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1aa10d2829dd7ccf702237c416bc3eb626" kindref="member">smfw_msg_write</ref>(n,c1,<ref refid="conv2dtest_8m_1a869bd946456256c347112f5798b5b504" kindref="member">c2</ref>,c3)</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><ref refid="lib_2expat_8h_1a14bb8924daea0b48c7803f281f66e390" kindref="member">int</ref><sp/>n;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>c1,<ref refid="conv2dtest_8m_1a869bd946456256c347112f5798b5b504" kindref="member">c2</ref>,c3;</highlight></codeline>
<codeline lineno="228"><highlight class="normal">{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;MSGWRITE<sp/>%d<sp/>bytes<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/>n,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(n)<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>1:<sp/>putc(c1,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>2:<sp/>putc(c1,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(c2,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>3:<sp/>putc(c1,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(c2,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(c3,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal">}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_noteoff<sp/>--<sp/>write<sp/>noteoff<sp/>to<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247" refid="seqmwrite_8c_1a6ba2e9344d79d67104a18e20121829bc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a55cc86350d9ed7b5121fffade76899e1" kindref="member">smfw_noteoff</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1a7f083f7b76ea4d09b2820211a2b0d04e" kindref="member">pitch</ref>)</highlight></codeline>
<codeline lineno="248"><highlight class="normal">{</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_noteoff<sp/>%d:<sp/>%d<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/>voice,<sp/>pitch,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2mfmidi_8h_1a0ab3b6021702f310505c9827cf101385" kindref="member">NOTEOFF</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(pitch,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x40,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="254"><highlight class="normal">}<sp/></highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_noteon<sp/>--<sp/>write<sp/>noteon<sp/>to<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/>*<sp/>NOTE:<sp/>the<sp/>seq<sp/>parameter<sp/>is<sp/>not<sp/>used<sp/>here,<sp/>but<sp/>is<sp/>passed<sp/>in<sp/>by<sp/>the</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/>*<sp/>seq_noteon<sp/>macro,<sp/>so<sp/>we<sp/>have<sp/>to<sp/>have<sp/>a<sp/>placeholder<sp/>for<sp/>it.</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262" refid="seqmwrite_8c_1a60c1e755a14f553b6104ef1d7d5ccf70" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ab6d02c344c6100b5445eaa352bcacf26" kindref="member">smfw_noteon</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/><ref refid="seqread_8c_1a7f083f7b76ea4d09b2820211a2b0d04e" kindref="member">pitch</ref>,<sp/>vel)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/><ref refid="seqread_8c_1a7f083f7b76ea4d09b2820211a2b0d04e" kindref="member">pitch</ref>,<sp/>vel;</highlight></codeline>
<codeline lineno="265"><highlight class="normal">{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_noteon<sp/>%d:<sp/>%d<sp/>%d(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/>voice,<sp/>pitch,<sp/>vel,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2mfmidi_8h_1a597b408d8fe6dc61ce6837f0c1bb55ee" kindref="member">NOTEON</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(pitch,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(vel,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="271"><highlight class="normal">}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_process_event<sp/>--<sp/>write<sp/>a<sp/>seq<sp/>event<sp/>to<sp/>a<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276" refid="seqmwrite_8c_1a1544a61af1b649aea2ede851f37ad6bc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1aafe5c6c98fc3ebaaf822702a42656734" kindref="member">smfw_process_event</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>)</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="278"><highlight class="normal">{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="structevent__struct" kindref="compound">event_type</ref><sp/>event;</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!seq-&gt;runflag)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((event<sp/>=<sp/>seq-&gt;current)<sp/>&amp;&amp;<sp/>(event-&gt;<ref refid="structevent__struct_1ab3e215749b836371b7b3e00e5d6c771a" kindref="member">ntime</ref><sp/>&lt;=<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>))<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>)<sp/>==<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref>)<sp/>||<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*if<sp/>on<sp/>current<sp/>track*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(((<ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>)<sp/>-<sp/>16)<sp/>==<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref>)<sp/></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref><sp/>&gt;<sp/>0))<sp/>||</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>acknowledge<sp/>clock<sp/>change<sp/>on<sp/>all<sp/>tracks*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref><sp/>==<sp/><ref refid="seq_8h_1a8d4c7c263d98e1709375a5ebc2e060c7" kindref="member">CLOCK_VALUE</ref><sp/>&amp;&amp;<sp/><ref refid="seq_8h_1ae5277327e851124226bc331de0d6568b" kindref="member">vc_ctrl</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>)<sp/>==<sp/><ref refid="seq_8h_1ad0450796a03364bdf4e9e435b6bfa197" kindref="member">ESC_CTRL</ref>))<sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>process<sp/>all<sp/>current<sp/>(and<sp/>earlier)<sp/>events<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="seq_8h_1a8aa9ddd257787912e7be7fef751c9673" kindref="member">is_note</ref>(event))<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/***<sp/>play<sp/>a<sp/>note<sp/>or<sp/>rest<sp/>***/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>this<sp/>note<sp/>is<sp/>not<sp/>a<sp/>rest,<sp/>play<sp/>it<sp/>and<sp/>schedule<sp/>an<sp/>off<sp/>event<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref><sp/>!=<sp/><ref refid="seq_8h_1a3b079721db54c40a22a647affd93b3e5" kindref="member">NO_PITCH</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="seq_8h_1a807f23abb4de273477074c58063b9375" kindref="member">seq_channel_mask</ref>(seq)<sp/>&amp;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(1<sp/>&lt;&lt;<sp/>((voice<sp/>=<sp/><ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>))<sp/>-<sp/>1))))<sp/>{</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a932a85119fcf6841fad0e10bd80bdc1f" kindref="member">seq_noteon</ref>(seq,<sp/>voice,<sp/>(0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>),<sp/></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>(event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a3b05f65218a1caa9d02406871fb58954" kindref="member">note</ref>.<ref refid="unionnote__struct_1a28cbc03abb6e0d8b7607ca891e9061e9" kindref="member">ndur</ref><sp/>&amp;<sp/>0xFF));</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1aac18ad68b99a75735dd0e95b59a26eef" kindref="member">seq_cause_noteoff</ref>(seq,<sp/>(event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a3b05f65218a1caa9d02406871fb58954" kindref="member">note</ref>.<ref refid="unionnote__struct_1a28cbc03abb6e0d8b7607ca891e9061e9" kindref="member">ndur</ref>)<sp/>&gt;&gt;<sp/>8,<sp/></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>voice,<sp/>(0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>));<sp/></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/***<sp/>send<sp/>a<sp/>control<sp/>command<sp/>***/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>step;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>delta;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>increment;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>voice<sp/>=<sp/><ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_s_t_types_8h_1a718b4eb2652c286f4d42dc18a8e71a1a" kindref="member">ulong</ref><sp/>enabled<sp/>=<sp/><ref refid="seq_8h_1a807f23abb4de273477074c58063b9375" kindref="member">seq_channel_mask</ref>(seq)<sp/>&amp;<sp/>(1<sp/>&lt;&lt;<sp/>(voice<sp/>-<sp/>1));</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="seq_8h_1ae5277327e851124226bc331de0d6568b" kindref="member">vc_ctrl</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>))<sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1acf9901107bb3d4521c17b12025e2e7d4" kindref="member">PSWITCH_CTRL</ref>:</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;porta<sp/>%d<sp/>(time:%ld)...<sp/>&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a46243d137cbd8d8428bec9933f6bd13d" kindref="member">seq_midi_ctrl</ref>(seq,<sp/>voice,<sp/><ref refid="midifns_8h_1ab8383bf20b0de07c6d59131a6e1c71ca" kindref="member">PORTASWITCH</ref>,<sp/>0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a8b34cf975b3d90abbf823dd6f21f690c" kindref="member">MODWHEEL_CTRL</ref>:</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;modw<sp/>%d<sp/>(time:%ld)...&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a46243d137cbd8d8428bec9933f6bd13d" kindref="member">seq_midi_ctrl</ref>(seq,<sp/>voice,<sp/><ref refid="midifns_8h_1a3c93c67eda45eafabf02e6176f629113" kindref="member">MODWHEEL</ref>,<sp/>0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1ae0bc0d485c8b703f500edcc67b5b2c15" kindref="member">TOUCH_CTRL</ref>:</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;touch<sp/>%d<sp/>(time:%ld)...<sp/>&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1addb5d519ca3f8816b7979ad5a5d93582" kindref="member">seq_midi_touch</ref>(seq,<sp/>voice,<sp/>0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a1de03689b5588eca7c8bbabe0bcbc348" kindref="member">VOLUME_CTRL</ref>:</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ftvol<sp/>%d<sp/>(time:%ld)...&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a46243d137cbd8d8428bec9933f6bd13d" kindref="member">seq_midi_ctrl</ref>(seq,<sp/>voice,<sp/><ref refid="midifns_8h_1a4302e328ccc188b5a6c7f9cefc182e7d" kindref="member">VOLUME</ref>,<sp/>0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1aa0d5bc4672e69877b8d03907085fe47f" kindref="member">BEND_CTRL</ref>:</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bend<sp/>%d<sp/>(time:%ld)...<sp/>&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a652ffc664f2104c5c6a455cb4dc754b0" kindref="member">seq_midi_bend</ref>(seq,<sp/>voice,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a349c6cb5139f3be0ac6aef4efa01a101" kindref="member">PROGRAM_CTRL</ref>:</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;prog<sp/>%d<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1ac214d76a2221db38b283109496a784b8" kindref="member">MIDI_CH_PROGRAM</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1ad0450796a03364bdf4e9e435b6bfa197" kindref="member">ESC_CTRL</ref>:</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref>)<sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>this_event;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a2de18c1f291312fde2262273cdd5a157" kindref="member">CALL_VALUE</ref>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*called<sp/>routine<sp/>will<sp/>write<sp/>to<sp/>midifile<sp/>in<sp/>execution<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sequence<sp/>=<sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*(</highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.call.routine))(</highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.call.args);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a8d4c7c263d98e1709375a5ebc2e060c7" kindref="member">CLOCK_VALUE</ref>:</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref><sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.clock.ticksize;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;clockevent!<sp/>ticksize:<sp/>%lu<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref><sp/>&gt;<sp/>0)<sp/>{<sp/><sp/></highlight><highlight class="comment">/*<sp/>any<sp/>clock<sp/>before<sp/>this<sp/>is<sp/>already<sp/>recorded<sp/>in<sp/>the<sp/>header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref><sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>record<sp/>clock<sp/>event<sp/>on<sp/>tempo<sp/>track<sp/>=<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>cause<sp/>clock<sp/>write<sp/>in<sp/>half<sp/>a<sp/>newtick,<sp/>because<sp/>it<sp/>was<sp/>written<sp/>.5<sp/>tick<sp/>early*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="moxc_8c_1a667f7390a8435b47e027ae9ea2455cb9" kindref="member">cause</ref>((<ref refid="midifns_8h_1a90bc8a533ac78d3f6e076de78883fb75" kindref="member">delay_type</ref>)<sp/>(<ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref><sp/>&gt;&gt;<sp/>17),<sp/><ref refid="seqmwrite_8c_1aa397b742aef4630931d395231f1227dc" kindref="member">smfw_clock_event</ref>,<sp/></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref>,<sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>=<sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>;<sp/></highlight><highlight class="comment">/*set<sp/>new<sp/>ticksize*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">/*not<sp/>on<sp/>tempo<sp/>track*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this_event<sp/>=<sp/>((<ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref><sp/>-<sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref>)<sp/>*</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((2500L<sp/>&lt;&lt;<sp/>16)<sp/>/<sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref>))<sp/>/<sp/>100;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;track<sp/>!=<sp/>0:<sp/>Lastev:<sp/>%ld<sp/>Thisev:<sp/>%ld<sp/>NewLast:<sp/>%ld\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>,<sp/>this_event,<sp/>this_event<sp/>-<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref><sp/>=<sp/>0L<sp/>-<sp/>(this_event<sp/>-<sp/><ref refid="seqmwrite_8c_1accc001f11388d6896249fb50ac7d7d36" kindref="member">last_event</ref>);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1af7378b0074f684567495b1405ce77612" kindref="member">last_clock_event</ref><sp/>=<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*last_event<sp/>is<sp/>negative,<sp/>so<sp/>will<sp/>be<sp/>ADDED<sp/>to<sp/>next<sp/>this_event*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>=<sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>;</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;IGNORED\n&quot;</highlight><highlight class="normal">);</highlight><highlight class="comment">/*<sp/>if<sp/>virttime<sp/>&lt;=<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1abdaf852cc0d4abb635a16cb68c413806" kindref="member">MACCTRL_VALUE</ref>:</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;MACCTRL<sp/>%d:<sp/>%d<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a4bc36bc9c07a3509e68c385b2d0706af" kindref="member">macctrl</ref>.<ref refid="structmacctrl__struct_1ae4b92bc213bc02582531f8a654bc2b20" kindref="member">ctrl_number</ref>,<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a4bc36bc9c07a3509e68c385b2d0706af" kindref="member">macctrl</ref>.<ref refid="structmacctrl__struct_1a3b5198104e1880835d43ae50ac031ed1" kindref="member">value</ref>,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1a64b08db61b463b1769d8f18fae1ea8e4" kindref="member">MIDI_CTRL</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a4bc36bc9c07a3509e68c385b2d0706af" kindref="member">macctrl</ref>.<ref refid="structmacctrl__struct_1ae4b92bc213bc02582531f8a654bc2b20" kindref="member">ctrl_number</ref>,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a4bc36bc9c07a3509e68c385b2d0706af" kindref="member">macctrl</ref>.<ref refid="structmacctrl__struct_1a3b5198104e1880835d43ae50ac031ed1" kindref="member">value</ref>,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1acdcef2599eca9849c0dc8d1f4d90184a" kindref="member">MACRO_VALUE</ref>:</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;MACRO<sp/>sent<sp/>to...\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a3a45b26a89ea071906f2a0be7d346ad5" kindref="member">smfw_send_macro</ref>(event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a48f2d877f0cdb494754971cfac040bb5" kindref="member">macro</ref>.<ref refid="structmacro__struct_1a184bddb0a364ce6b35098937830fcd91" kindref="member">definition</ref>,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>voice,<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a48f2d877f0cdb494754971cfac040bb5" kindref="member">macro</ref>.<ref refid="structmacro__struct_1a879ef21de7afd7436c4631ea795e4a75" kindref="member">parameter</ref>,<sp/>-1,<sp/>0);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a6f236382247d1b19cf23b08fb5c16aa4" kindref="member">CTRLRAMP_VALUE</ref>:</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a306d75ea0e2b03140993b549b87e28ba" kindref="member">DEFRAMP_VALUE</ref>:<sp/>{</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="nasm_8h_1a5f350118b553429484632e5603292389" kindref="member">from</ref>,<sp/>to;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!enabled)<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.step;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref><sp/>==<sp/><ref refid="seq_8h_1a6f236382247d1b19cf23b08fb5c16aa4" kindref="member">CTRLRAMP_VALUE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;CTRLRAMP<sp/>(time:%ld)...&quot;</highlight><highlight class="normal">,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.u.ctrl.from_value;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.u.ctrl.to_value;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;DEFRAMP<sp/>(time:%ld)...&quot;</highlight><highlight class="normal">,<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.u.def.parameter[</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.u.def.parm_num];</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.u.def.to_value;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delta<sp/>=<sp/>to<sp/>-<sp/><ref refid="nasm_8h_1a5f350118b553429484632e5603292389" kindref="member">from</ref>;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>increment<sp/>=<sp/>delta;</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(delta<sp/>&lt;<sp/>0)<sp/>delta<sp/>=<sp/>-delta;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>RBD<sp/>-<sp/>Note:<sp/>Step<sp/>is<sp/>always<sp/>non-zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.dur<sp/>/<sp/>step;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>increment<sp/>=<sp/>(increment<sp/>&lt;&lt;<sp/>8)<sp/>/<sp/>n;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" kindref="member">smfw_ramp_event</ref>(seq,<sp/>event,<sp/>from<sp/>&lt;&lt;<sp/>8,<sp/>to<sp/>&lt;&lt;<sp/>8,<sp/></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>increment,<sp/>step,<sp/>n);</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seq-&gt;noteoff_count++;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1a9b766b7425184f0101d56e4d9f917201" kindref="member">SETI_VALUE</ref>:</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" kindref="member">seti_counter</ref>++;<sp/></highlight><highlight class="comment">/*will<sp/>be<sp/>printed<sp/>after<sp/>writing<sp/>is<sp/>completed*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(</highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.seti.int_to_set)<sp/>=<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1a20dfe512ec6949208fc4b9a52380d53a" kindref="member">seti</ref>.<ref refid="structseti__struct_1ac409612ea9196f885cead4486f71a1b0" kindref="member">value</ref>;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;unexpected<sp/>ESC_CTRL<sp/>value\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;unexpected<sp/>seq<sp/>data\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>seq-&gt;current<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;next;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seq-&gt;current)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>if<sp/>there<sp/>is<sp/>an<sp/>event:<sp/>delay,<sp/>and<sp/>then<sp/>process<sp/>again<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="moxc_8c_1a667f7390a8435b47e027ae9ea2455cb9" kindref="member">cause</ref>((<ref refid="midifns_8h_1a90bc8a533ac78d3f6e076de78883fb75" kindref="member">delay_type</ref>)(event-&gt;<ref refid="structevent__struct_1ab3e215749b836371b7b3e00e5d6c771a" kindref="member">ntime</ref><sp/>-<sp/><ref refid="moxc_8c_1ac473afd8b92b443dca44674fa889f697" kindref="member">virttime</ref>),<sp/><ref refid="seqmwrite_8c_1aafe5c6c98fc3ebaaf822702a42656734" kindref="member">smfw_process_event</ref>,<sp/>seq);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="434"><highlight class="normal">}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_ramp_event<sp/>--<sp/>generate<sp/>a<sp/>ramp<sp/>to<sp/>write*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437" refid="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" kindref="member">smfw_ramp_event</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/>event,<sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>,<sp/>to_value,<sp/>increment,<sp/>step,<sp/>n)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/>register<sp/><ref refid="structevent__struct" kindref="compound">event_type</ref><sp/>event;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>to_value;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>increment;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>step;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="445"><highlight class="normal">{</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ramp<sp/>of<sp/>%d:<sp/>%d<sp/>to<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>event-&gt;u.ramp.ctrl,<sp/>value<sp/>&gt;&gt;<sp/>8,</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_value<sp/>&gt;&gt;<sp/>8);<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seq-&gt;runflag)<sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref><sp/>=<sp/><ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;nvoice);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/>0)<sp/>value<sp/>=<sp/>to_value;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="moxc_8c_1a667f7390a8435b47e027ae9ea2455cb9" kindref="member">cause</ref>((<ref refid="midifns_8h_1a90bc8a533ac78d3f6e076de78883fb75" kindref="member">delay_type</ref>)step,<sp/><ref refid="seqmwrite_8c_1af8a90070be7422e7f3e23f0aa127e791" kindref="member">smfw_ramp_event</ref>,<sp/>seq,<sp/>event,<sp/>value<sp/>+<sp/>increment,</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_value,<sp/>increment,<sp/>step,<sp/>n<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(event-&gt;value<sp/>==<sp/><ref refid="seq_8h_1a6f236382247d1b19cf23b08fb5c16aa4" kindref="member">CTRLRAMP_VALUE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ctrl<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.ramp.ctrl;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ctrl<sp/>==<sp/>-<ref refid="seq_8h_1ae0bc0d485c8b703f500edcc67b5b2c15" kindref="member">TOUCH_CTRL</ref>)<sp/><ref refid="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" kindref="member">smfw_touch</ref>(seq,<sp/>voice,<sp/>value<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ctrl<sp/>==<sp/>-<ref refid="seq_8h_1aa0d5bc4672e69877b8d03907085fe47f" kindref="member">BEND_CTRL</ref>)<sp/><ref refid="seqmwrite_8c_1ac5a7981e4b63f72c7a3dd11e85f0f006" kindref="member">smfw_bend</ref>(seq,<sp/>voice,<sp/>value<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a4b2b46ea300375a17f0ded79c5e51c41" kindref="member">smfw_ctrl</ref>(seq,<sp/>voice,<sp/>ctrl,<sp/>value<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>must<sp/>be<sp/>DEFRAMP_VALUE<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a3a45b26a89ea071906f2a0be7d346ad5" kindref="member">smfw_send_macro</ref>(event-&gt;u.ramp.u.def.definition,</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seq_8h_1a4e42badfa3d9c66604fad69dfd948fbb" kindref="member">vc_voice</ref>(event-&gt;nvoice),</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>event-&gt;u.ramp.u.def.parameter,</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>event-&gt;u.ramp.u.def.parm_num,<sp/>value<sp/>&gt;&gt;<sp/>8);</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/>0)<sp/><ref refid="seq_8c_1ae2e0dd084e83b2d95e6cd09de8a41e3c" kindref="member">seq_end_event</ref>(seq);</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="466"><highlight class="normal">}</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_send_macro<sp/>--<sp/>write<sp/>msg<sp/>to<sp/>midi<sp/>file<sp/>from<sp/>a<sp/>seq<sp/>&quot;macro&quot;<sp/>event<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471" refid="seqmwrite_8c_1a11141dadfbeafb7aefb001392e736674" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a3a45b26a89ea071906f2a0be7d346ad5" kindref="member">smfw_send_macro</ref>(ptr,<sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/>parameter,<sp/>parm_num,<sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/>register<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*ptr;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>parameter[];</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>parm_num;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>;</highlight></codeline>
<codeline lineno="477"><highlight class="normal">{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>code,<sp/>*loc;</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((code<sp/>=<sp/>*ptr++))<sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loc<sp/>=<sp/>ptr<sp/>+<sp/>*ptr;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr++;</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(code<sp/>&lt;=<sp/><ref refid="seq_8h_1a7418f9520fdd7e58676d5b51a24a6bab" kindref="member">nmacroparms</ref>)<sp/>{</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code--;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*loc<sp/>=<sp/>(code<sp/>==<sp/>parm_num<sp/>?<sp/>value<sp/>:<sp/>parameter[code])<sp/>&amp;<sp/>0x7f;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(code<sp/>==<sp/><ref refid="seq_8h_1a7418f9520fdd7e58676d5b51a24a6bab" kindref="member">nmacroparms</ref><sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*loc<sp/>=<sp/>((voice<sp/>-<sp/>1)<sp/>&amp;<sp/>0xF)<sp/>|<sp/>*loc;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code<sp/>-=<sp/>(<ref refid="seq_8h_1a7418f9520fdd7e58676d5b51a24a6bab" kindref="member">nmacroparms</ref><sp/>+<sp/>2);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*loc<sp/>=<sp/>((code<sp/>==<sp/>parm_num<sp/>?<sp/>value<sp/>:<sp/>parameter[code])<sp/>&gt;&gt;<sp/>7)<sp/>&amp;<sp/>0x7F;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr[1]<sp/>==<sp/><ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1aa2197f6ca200566c0986e737edd211e4" kindref="member">MIDI_SYSEX</ref>)</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a10567530937ccae6f5948e3f286d788f" kindref="member">smfw_exclusive</ref>(*ptr,<sp/>ptr<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1aa10d2829dd7ccf702237c416bc3eb626" kindref="member">smfw_msg_write</ref>(*ptr,<sp/>ptr[1],<sp/>ptr[2],<sp/>ptr[3]);</highlight></codeline>
<codeline lineno="498"><highlight class="normal">}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>smfw_touch<sp/>--<sp/>write<sp/>aftertouch<sp/>msg<sp/>to<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503" refid="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" kindref="member">smfw_touch</ref>(<ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1adc9c046fb3ac286b5dc54bb302aedecc" kindref="member">voice</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="504"><highlight class="normal">{</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;smfw_touch<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>value);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a64d65168476514c99b24d0bbf0d9b02d" kindref="member">smfw_deltatime</ref>();</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(<ref refid="libnyquist_2nyquist_2cmt_2midicode_8h_1a3bbe71db78d44f6f45cdd778fc86ffbb" kindref="member">MIDI_TOUCH</ref><sp/>|<sp/>(voice<sp/>-<sp/>1),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(value,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="509"><highlight class="normal">}</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"></highlight></codeline>
<codeline lineno="512" refid="seqmwrite_8h_1a2051e9c2a9c4b52654cde8dfe908d3f3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a2051e9c2a9c4b52654cde8dfe908d3f3" kindref="member">seq_write_smf</ref>(<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>,<sp/><ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>)</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><ref refid="structseq__struct" kindref="compound">seq_type</ref><sp/><ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/>FILE<sp/>*<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>;</highlight></codeline>
<codeline lineno="515"><highlight class="normal">{</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>put_tick_size;</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ticksize<sp/>is<sp/>milliseconds<sp/>&lt;&lt;<sp/>16,<sp/>and<sp/>tickrate<sp/>=<sp/>24*tempo</highlight></codeline>
<codeline lineno="519"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>60000ms/min<sp/>/<sp/>(24<sp/>*<sp/>tempo)<sp/>=<sp/>2500/tempo<sp/>=<sp/>25</highlight></codeline>
<codeline lineno="520"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>25<sp/>&lt;&lt;<sp/>16<sp/>=<sp/>1638400<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="midifns_8h_1a3f787491db5dbc75c21b27d54e9ebae6" kindref="member">time_type</ref><sp/>starting_ticksize<sp/>=<sp/>1638400L;<sp/></highlight><highlight class="comment">/*default<sp/>midifile<sp/>tempo<sp/>100*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>track_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>track_count_marker;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="structevent__struct" kindref="compound">event_type</ref><sp/>event;</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" kindref="member">seti_counter</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*initialize<sp/>the<sp/>smfw_seq<sp/>struct*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref><sp/>=<sp/><ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref><sp/>=<sp/><ref refid="seq_8c_1a566ffc8148acfc4991038be3723d6936" kindref="member">seq_copy</ref>(seq);</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1aa7837b0e6a76089790b16bdd5f2e951b" kindref="member">cause_noteoff_fn</ref><sp/>=<sp/><ref refid="seqmwrite_8c_1a10ee6ade2508036308a7e464ac798f2a" kindref="member">smfw_cause_noteoff</ref>;</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1affda5ec2ecdb197885828ea556215d80" kindref="member">midi_bend_fn</ref><sp/><sp/><sp/><sp/>=<sp/><ref refid="seqmwrite_8c_1ac5a7981e4b63f72c7a3dd11e85f0f006" kindref="member">smfw_bend</ref>;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1a58780a55ec0f3ff87db12dfe8a76fc85" kindref="member">midi_ctrl_fn</ref><sp/><sp/><sp/><sp/>=<sp/><ref refid="seqmwrite_8c_1a4b2b46ea300375a17f0ded79c5e51c41" kindref="member">smfw_ctrl</ref>;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1ab6693e3eecd47c3e43879bc2d86e388e" kindref="member">midi_touch_fn</ref><sp/><sp/><sp/>=<sp/><ref refid="seqmwrite_8c_1ab3b0ef6cbcfe6c35cb945ef7e76cbd0a" kindref="member">smfw_touch</ref>;</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1a05d000bb501d7e26bbe4ac3182e0b172" kindref="member">noteoff_fn</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="seqmwrite_8c_1a55cc86350d9ed7b5121fffade76899e1" kindref="member">smfw_noteoff</ref>;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>-&gt;<ref refid="structseq__struct_1ac0db16fd627a17e659bbb86071eb0e75" kindref="member">noteon_fn</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="seqmwrite_8c_1ab6d02c344c6100b5445eaa352bcacf26" kindref="member">smfw_noteon</ref>;</highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/><ref refid="seq_8h_1acf719b85bb776dd482bb41ae31732852" kindref="member">seq_events</ref>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>);</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>search<sp/>for<sp/>clock<sp/>events<sp/>up<sp/>till<sp/>start<sp/>of<sp/>score<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>careful:<sp/>there<sp/>may<sp/>be<sp/>no<sp/>events<sp/>at<sp/>all<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(event<sp/>&amp;&amp;<sp/>event-&gt;<ref refid="structevent__struct_1ab3e215749b836371b7b3e00e5d6c771a" kindref="member">ntime</ref><sp/>&lt;=<sp/>0){</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;event<sp/>(time:%ld)\n&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1ab3e215749b836371b7b3e00e5d6c771a" kindref="member">ntime</ref>);<sp/></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="seq_8h_1ae5277327e851124226bc331de0d6568b" kindref="member">vc_ctrl</ref>(event-&gt;<ref refid="structevent__struct_1a0e9d02e921edc61fa27becba1d624d4e" kindref="member">nvoice</ref>)<sp/>==<sp/><ref refid="seq_8h_1ad0450796a03364bdf4e9e435b6bfa197" kindref="member">ESC_CTRL</ref><sp/>&amp;&amp;<sp/>event-&gt;<ref refid="structevent__struct_1afcefbf02b552912c716669fa2fffb997" kindref="member">value</ref><sp/>==<sp/><ref refid="seq_8h_1a8d4c7c263d98e1709375a5ebc2e060c7" kindref="member">CLOCK_VALUE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;clock<sp/>%lu<sp/>at<sp/>0\n&quot;</highlight><highlight class="normal">,<sp/>event-&gt;<ref refid="structevent__struct_1a60cb93d3e3c595ac444342c496e97d71" kindref="member">u</ref>.<ref refid="structevent__struct_1aa7356ebe86a978c9901f24c35680e6d8" kindref="member">clock</ref>.<ref refid="structclock__struct_1a6c25521841ffda4c2911b4e9e1fa5f57" kindref="member">ticksize</ref>);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>starting_ticksize<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;u.clock.ticksize;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">-&gt;next;</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x4D,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/></highlight><highlight class="comment">/*header:<sp/><sp/>MThd*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x54,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x68,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x64,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x06,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x01,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*format<sp/>1<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>track_count_marker<sp/>=<sp/>ftell(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*number<sp/>of<sp/>tracks<sp/>will<sp/>be<sp/>written<sp/>later*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*will<sp/>be<sp/>filled<sp/>by<sp/>track_count_marker*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x02,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight><highlight class="comment">/*division<sp/>resolution<sp/>of<sp/>600*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0x58,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>17;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>for<sp/>each<sp/>track...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((<ref refid="seq_8h_1a0f68a95c15f4abe5db4865e9012b55e6" kindref="member">seq_used_mask</ref>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>)<sp/>&gt;&gt;<sp/>(i<sp/>-<sp/>1))<sp/>&amp;<sp/>0x1)<sp/>||<sp/>(i<sp/>==<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;write<sp/>track<sp/>%d<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>i);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>track_count++;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref><sp/>=<sp/>starting_ticksize;</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a7146c4f56c4c602524873132c9a6a2e8" kindref="member">last_tick_size</ref><sp/>=<sp/>starting_ticksize;</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x4D,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight><highlight class="comment">/*track<sp/>header:<sp/>MTrk*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x54,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x72,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x6B,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1af76438490ad2af365038ed8553d29cd3" kindref="member">chunk_size_marker</ref><sp/>=<sp/>ftell(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);<sp/></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>size<sp/>of<sp/>chunk<sp/>will<sp/>be<sp/>written<sp/>later<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>will<sp/>be<sp/>filled<sp/>by<sp/>chunk_size_marker<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="589"><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/>tempo<sp/>and<sp/>time<sp/>signature<sp/>track<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight><highlight class="comment">/*<sp/>default<sp/>time<sp/>sig<sp/>stuff*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x58,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x04,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x04,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x02,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x18,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x08,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x00,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TEMPO:<sp/>inserted<sp/>here<sp/>in<sp/>case<sp/>default<sp/>is<sp/>used<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0xFF,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x51,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc(0x03,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ticksize<sp/>is<sp/>in<sp/>ms&lt;&lt;16,<sp/>so<sp/>to<sp/>get<sp/>milliseconds<sp/>per<sp/>tick,<sp/>it&apos;s</highlight></codeline>
<codeline lineno="606"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ticksize<sp/>/<sp/>65536.<sp/>To<sp/>get<sp/>beat<sp/>durations,<sp/>multiply<sp/>by<sp/>24<sp/></highlight></codeline>
<codeline lineno="607"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>get<sp/>ticksize<sp/>*<sp/>24<sp/>/<sp/>65536.<sp/>To<sp/>get<sp/>microseconds,<sp/></highlight></codeline>
<codeline lineno="608"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multiply<sp/>by<sp/>1000:<sp/>ticksize<sp/>*<sp/>24000<sp/>/<sp/>65536.<sp/>Divide<sp/>both</highlight></codeline>
<codeline lineno="609"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>constants<sp/>by<sp/>64<sp/>to<sp/>get<sp/>ticksize<sp/>*<sp/>375<sp/>/<sp/>1024<sp/>=<sp/></highlight></codeline>
<codeline lineno="610"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>microseconds<sp/>per<sp/>quarter<sp/>note.</highlight></codeline>
<codeline lineno="611"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>put_tick_size<sp/>=<sp/><ref refid="seqread_8c_1aa2a8c6fbe5ed24f9523eb4e01368e4bc" kindref="member">scale</ref>(<ref refid="seqmwrite_8c_1a0cf9bebf7696588e7fd8ea1c71d02a2a" kindref="member">clock_ticksize</ref>,<sp/>375L,<sp/>1024L);</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((put_tick_size<sp/>&gt;&gt;<sp/>16)<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>((put_tick_size<sp/>&gt;&gt;<sp/>8)<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>(put_tick_size<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1aedc9df4cdb646d9de42aff9ea477e335" kindref="member">track</ref><sp/>=<sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="seqmwrite_8c_1a5c44255d04005778f34a064c727300cb" kindref="member">smfw_dotrack</ref>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" kindref="member">seti_counter</ref>)<sp/></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>SETI<sp/>events<sp/>IGNORED!\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="seqmwrite_8c_1a31747f3952a8b2e6f18c6edd14d9c57c" kindref="member">seti_counter</ref>);</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="seq_8c_1acfee310911c26d3820e7bd9d9e0f9c46" kindref="member">seq_stop</ref>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a72ac3f8583c15f31fc4861c0ac45e14f" kindref="member">seq</ref>);</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>go<sp/>back<sp/>and<sp/>insert<sp/>number<sp/>of<sp/>tracks<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/>fseek(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>,<sp/>track_count_marker,<sp/>0);</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>putc(0xFF<sp/>&amp;<sp/>track_count,<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="conv2dtest_8m_1ae93e9d524fd1ef618af3d5070a8126eb" kindref="member">fclose</ref>(<ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="628"><highlight class="normal">}</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>writevarlen<sp/>--<sp/>write<sp/>a<sp/>variable<sp/>length<sp/>integer<sp/>to<sp/>midi<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633" refid="seqmwrite_8c_1aa2d024af417669e188a5b5f0fd8e1dfb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="seqmwrite_8c_1a6870c0b9678085b1dd3a5213670763ff" kindref="member">writevarlen</ref>(<ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/>register<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref>;</highlight></codeline>
<codeline lineno="635"><highlight class="normal">{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="_s_t_types_8h_1a718b4eb2652c286f4d42dc18a8e71a1a" kindref="member">ulong</ref><sp/><ref refid="recplay_8c_1adbbab5cb2248179d231690a1a02ff977" kindref="member">buffer</ref>;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;variable<sp/>length<sp/>quantity...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="639"><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer<sp/>=<sp/>value<sp/>&amp;<sp/>0x7f;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((value<sp/>&gt;&gt;=<sp/>7)<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer<sp/>&lt;&lt;=<sp/>8;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer<sp/>|=<sp/>0x80;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer<sp/>+=<sp/>(value<sp/>&amp;<sp/>0x7f);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;;)<sp/>{</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>byte<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/>putc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>(buffer<sp/>&amp;<sp/>0xFF),<sp/><ref refid="seqmwrite_8c_1ab5452ba147e99dda6d47918234e04211" kindref="member">smfw_seq</ref>.<ref refid="structsmf__write__seq_1a18b0698d035409dc42cd92d33c2dd936" kindref="member">outfile</ref>);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(buffer<sp/>&amp;<sp/>0x80)<sp/><sp/>buffer<sp/>&gt;&gt;=<sp/>8;</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="src_2flac_2main_8c_1a6f11ce505641910527169e5b39d693cc" kindref="member">debug</ref>)<sp/><ref refid="userio_8c_1aa7fe1fd5a722b3baba97b2fb02fa73a1" kindref="member">gprintf</ref>(<ref refid="userio_8h_1abf9c248762203aeb01092b253484d6e0" kindref="member">TRANS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;written!\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="655"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libnyquist/nyquist/cmt/seqmwrite.c"/>
  </compounddef>
</doxygen>
