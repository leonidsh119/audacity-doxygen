<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="pa__unix__oss_8c" kind="file" language="C++">
    <compoundname>pa_unix_oss.c</compoundname>
    <includes local="no">stdio.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">math.h</includes>
    <includes local="no">fcntl.h</includes>
    <includes local="no">sys/ioctl.h</includes>
    <includes local="no">unistd.h</includes>
    <includes local="no">pthread.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes refid="assert_8h" local="no">assert.h</includes>
    <includes local="no">errno.h</includes>
    <includes refid="lib-src_2libvorbis_2macos_2compat_2sys_2_types_8h" local="no">sys/types.h</includes>
    <includes local="no">sys/stat.h</includes>
    <includes local="no">sys/poll.h</includes>
    <includes local="no">limits.h</includes>
    <includes local="no">semaphore.h</includes>
    <includes refid="portaudio_8h" local="yes">portaudio.h</includes>
    <includes refid="pa__util_8h" local="yes">pa_util.h</includes>
    <includes refid="pa__allocation_8h" local="yes">pa_allocation.h</includes>
    <includes refid="pa__hostapi_8h" local="yes">pa_hostapi.h</includes>
    <includes refid="pa__stream_8h" local="yes">pa_stream.h</includes>
    <includes refid="pa__cpuload_8h" local="yes">pa_cpuload.h</includes>
    <includes refid="pa__process_8h" local="yes">pa_process.h</includes>
    <includes refid="pa__unix__util_8h" local="yes">pa_unix_util.h</includes>
    <includes refid="pa__debugprint_8h" local="yes">pa_debugprint.h</includes>
    <incdepgraph>
      <node id="30007">
        <label>sys/stat.h</label>
      </node>
      <node id="30004">
        <label>sys/types.h</label>
        <link refid="lib-src_2libvorbis_2macos_2compat_2sys_2_types_8h"/>
        <childnode refid="30005" relation="include">
        </childnode>
        <childnode refid="30006" relation="include">
        </childnode>
        <childnode refid="29995" relation="include">
        </childnode>
      </node>
      <node id="30014">
        <label>pa_hostapi.h</label>
        <link refid="pa__hostapi_8h"/>
        <childnode refid="30011" relation="include">
        </childnode>
      </node>
      <node id="30001">
        <label>stdlib.h</label>
      </node>
      <node id="30013">
        <label>pa_allocation.h</label>
        <link refid="pa__allocation_8h"/>
      </node>
      <node id="30021">
        <label>pa_unix_util.h</label>
        <link refid="pa__unix__util_8h"/>
        <childnode refid="30016" relation="include">
        </childnode>
        <childnode refid="30002" relation="include">
        </childnode>
        <childnode refid="30000" relation="include">
        </childnode>
        <childnode refid="30022" relation="include">
        </childnode>
      </node>
      <node id="30008">
        <label>sys/poll.h</label>
      </node>
      <node id="30003">
        <label>errno.h</label>
      </node>
      <node id="30017">
        <label>pa_process.h</label>
        <link refid="pa__process_8h"/>
        <childnode refid="30011" relation="include">
        </childnode>
        <childnode refid="30018" relation="include">
        </childnode>
        <childnode refid="30019" relation="include">
        </childnode>
      </node>
      <node id="29997">
        <label>fcntl.h</label>
      </node>
      <node id="29993">
        <label>C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c</label>
        <link refid="pa_unix_oss.c"/>
        <childnode refid="29994" relation="include">
        </childnode>
        <childnode refid="29995" relation="include">
        </childnode>
        <childnode refid="29996" relation="include">
        </childnode>
        <childnode refid="29997" relation="include">
        </childnode>
        <childnode refid="29998" relation="include">
        </childnode>
        <childnode refid="29999" relation="include">
        </childnode>
        <childnode refid="30000" relation="include">
        </childnode>
        <childnode refid="30001" relation="include">
        </childnode>
        <childnode refid="30002" relation="include">
        </childnode>
        <childnode refid="30003" relation="include">
        </childnode>
        <childnode refid="30004" relation="include">
        </childnode>
        <childnode refid="30007" relation="include">
        </childnode>
        <childnode refid="30008" relation="include">
        </childnode>
        <childnode refid="30009" relation="include">
        </childnode>
        <childnode refid="30010" relation="include">
        </childnode>
        <childnode refid="30011" relation="include">
        </childnode>
        <childnode refid="30012" relation="include">
        </childnode>
        <childnode refid="30013" relation="include">
        </childnode>
        <childnode refid="30014" relation="include">
        </childnode>
        <childnode refid="30015" relation="include">
        </childnode>
        <childnode refid="30016" relation="include">
        </childnode>
        <childnode refid="30017" relation="include">
        </childnode>
        <childnode refid="30021" relation="include">
        </childnode>
        <childnode refid="30023" relation="include">
        </childnode>
      </node>
      <node id="30016">
        <label>pa_cpuload.h</label>
        <link refid="pa__cpuload_8h"/>
      </node>
      <node id="29998">
        <label>sys/ioctl.h</label>
      </node>
      <node id="30002">
        <label>assert.h</label>
        <link refid="assert_8h"/>
      </node>
      <node id="30006">
        <label>alloca.h</label>
      </node>
      <node id="30009">
        <label>limits.h</label>
      </node>
      <node id="30000">
        <label>pthread.h</label>
      </node>
      <node id="30005">
        <label>MacTypes.h</label>
      </node>
      <node id="29995">
        <label>string.h</label>
      </node>
      <node id="29999">
        <label>unistd.h</label>
      </node>
      <node id="30019">
        <label>pa_dither.h</label>
        <link refid="pa__dither_8h"/>
        <childnode refid="30020" relation="include">
        </childnode>
      </node>
      <node id="30022">
        <label>signal.h</label>
      </node>
      <node id="30010">
        <label>semaphore.h</label>
      </node>
      <node id="30011">
        <label>portaudio.h</label>
        <link refid="portaudio_8h"/>
      </node>
      <node id="29996">
        <label>math.h</label>
      </node>
      <node id="30015">
        <label>pa_stream.h</label>
        <link refid="pa__stream_8h"/>
        <childnode refid="30011" relation="include">
        </childnode>
      </node>
      <node id="30020">
        <label>pa_types.h</label>
        <link refid="pa__types_8h"/>
      </node>
      <node id="30018">
        <label>pa_converters.h</label>
        <link refid="pa__converters_8h"/>
        <childnode refid="30011" relation="include">
        </childnode>
      </node>
      <node id="30023">
        <label>pa_debugprint.h</label>
        <link refid="pa__debugprint_8h"/>
      </node>
      <node id="29994">
        <label>stdio.h</label>
      </node>
      <node id="30012">
        <label>pa_util.h</label>
        <link refid="pa__util_8h"/>
        <childnode refid="30011" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="struct_pa_o_s_s_host_api_representation" prot="public">PaOSSHostApiRepresentation</innerclass>
    <innerclass refid="struct_pa_oss_stream_component" prot="public">PaOssStreamComponent</innerclass>
    <innerclass refid="struct_pa_oss_stream" prot="public">PaOssStream</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" prot="public" static="no">
        <name>ENSURE_</name>
        <param><defname>expr</defname></param>
        <param><defname>code</defname></param>
        <initializer>do { \
        <ref refid="sndfile__save_8m_1a55944e1fa1bcc1bfc6185bc610b0a930" kindref="member">if</ref>( <ref refid="pa__unix__util_8h_1a9acc330d508b9a3b775cfdf7ce405e7d" kindref="member">UNLIKELY</ref>( (sysErr_ = (expr)) &lt; 0 ) ) \
        { \
            /* <ref refid="pa__util_8h_1a9c3ad627c13c1d695fef054c216667f7" kindref="member">PaUtil_SetLastHostErrorInfo</ref> should only be used <ref refid="latency_8c_1a7d946209d777cb95fe30364b8d321207" kindref="member">in</ref> <ref refid="nasm_8h_1aaf57ffcfef0bee04f46c6ada2a905a8c" kindref="member">the</ref> <ref refid="_simple_block_file_test_8cpp_1ae66f6b31b5ad750f1fe042a706a4e3d4" kindref="member">main</ref> thread */ \
            <ref refid="sndfile__save_8m_1a55944e1fa1bcc1bfc6185bc610b0a930" kindref="member">if</ref>( (code) == <ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref> &amp;&amp; pthread_self() == mainThread_ ) \
            { \
                <ref refid="pa__util_8h_1a9c3ad627c13c1d695fef054c216667f7" kindref="member">PaUtil_SetLastHostErrorInfo</ref>( <ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aea9afdcbf978e7b8b48db08a7c5208ebe4" kindref="member">paOSS</ref>, sysErr_, strerror( errno ) ); \
            } \
            \
            <ref refid="pa__debugprint_8h_1a775ad90aa83e8a15e724f1b0fc55a0d3" kindref="member">PaUtil_DebugPrint</ref>(( &quot;Expression &apos;&quot; #expr &quot;&apos; failed <ref refid="latency_8c_1a7d946209d777cb95fe30364b8d321207" kindref="member">in</ref> &apos;&quot; __FILE__ &quot;&apos;, line: &quot; STRINGIZE( __LINE__ ) &quot;\n&quot; )); \
            result = (code); \
            goto <ref refid="sndfile__save_8m_1ada4b423bc19e6ff5c5b514e55f518a82" kindref="member">error</ref>; \
        } \
    } while( 0 );</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="97" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="97" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__unix__oss_8c_1aec73a2ca552a1d579edc3e438dca805e" prot="public" static="no">
        <name>AFMT_S16_NE</name>
        <initializer>Get_AFMT_S16_NE()</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="114" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="114" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" prot="public" static="no">
        <name>StreamMode</name>
        <enumvalue id="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" prot="public">
          <name>StreamMode_In</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" prot="public">
          <name>StreamMode_Out</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="196" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="196" bodyend="199"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="pa__unix__oss_8c_1a71e62e12d9bfdf9a67c4c77567c53f89" prot="public" static="no">
        <type>struct <ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref></type>
        <definition>typedef struct PaOssStream
 PaOssStream</definition>
        <argsstring></argsstring>
        <name>PaOssStream</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Implementation specific representation of a PaStream. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="194" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="pa__unix__oss_8c_1a40633327d4f079222c0e21130bb761a8" prot="public" static="yes" mutable="no">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>int sysErr_</definition>
        <argsstring></argsstring>
        <name>sysErr_</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="93" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="93" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="pa__unix__oss_8c_1abc783c1d973a2b1dbef83dd219e359a2" prot="public" static="yes" mutable="no">
        <type>pthread_t</type>
        <definition>pthread_t mainThread_</definition>
        <argsstring></argsstring>
        <name>mainThread_</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="94" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="94" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="pa__unix__oss_8c_1ae814809ef2515d8ea0f4afff147ccc66" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>static int Get_AFMT_S16_NE</definition>
        <argsstring>(void)</argsstring>
        <name>Get_AFMT_S16_NE</name>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="119" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="119" bodyend="125"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1aceda435bfe9c0d0959dcd41043016c6c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void Terminate</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi)</argsstring>
        <name>Terminate</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="203" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="592" bodyend="603"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1addd36fca55daaf757e041555254b05e3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsFormatSupported</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, double sampleRate)</argsstring>
        <name>IsFormatSupported</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="204" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="605" bodyend="720"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ac43ea176a845c04786718d19a88b9455" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError OpenStream</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi, PaStream **s, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, double sampleRate, unsigned long framesPerBuffer, PaStreamFlags streamFlags, PaStreamCallback *streamCallback, void *userData)</argsstring>
        <name>OpenStream</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> **</type>
          <declname>s</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>framesPerBuffer</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref></type>
          <declname>streamFlags</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref> *</type>
          <declname>streamCallback</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>userData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Open a PA OSS stream.</para><para>Aspect StreamChannels: The number of channels is specified per direction (in/out), and can differ between the two. However, OSS doesn&apos;t support separate configuration spaces for capture and playback so if both directions are the same device we will demand the same number of channels. The number of channels can range from 1 to the maximum supported by the device.</para><para>Aspect BufferSettings: If framesPerBuffer != paFramesPerBufferUnspecified the number of frames per callback must reflect this, in addition the host latency per device should approximate the corresponding suggestedLatency. Based on these constraints we need to determine a number of frames per host buffer that both capture and playback can agree on (they can be different devices), the buffer processor can adapt between host and user buffer size, but the ratio should preferably be integral. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="208" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1184" bodyend="1289"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6684024dfdc36122d40cf7adae0e4322" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError CloseStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>CloseStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
          <defname>s</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Close the stream. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="217" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1779" bodyend="1790"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1afa58dcb70fc29aa4c667d6d07b748f6e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError StartStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>StartStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
          <defname>s</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Start the stream.</para><para>Aspect StreamState: After returning, the stream shall be in the Active state, implying that an eventual callback will be repeatedly called in a separate thread. If a separate thread is started this function will block untill it has started processing audio, otherwise audio processing is started directly. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="218" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1798" bodyend="1820"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a39e942c55c24e34c3796d29d61889370" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError StopStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>StopStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
          <defname>s</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Stop the stream.</para><para>Aspect StreamState: This will cause the stream to transition to the Stopped state, playing all enqueued buffers. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="219" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1851" bodyend="1854"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a28c623db69cda01e15f064fd2bf84f0f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError AbortStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>AbortStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
          <defname>s</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Abort the stream.</para><para>Aspect StreamState: This will cause the stream to transition to the Stopped state, discarding all enqueued buffers. Note that the buffers are not currently correctly discarded, this is difficult without closing the OSS device. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="220" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1862" bodyend="1865"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1aa9f1516c5edd9ea34b8e150f662f8f4e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsStreamStopped</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>IsStreamStopped</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Is the stream in the Stopped state. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="221" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1870" bodyend="1875"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a4f3f06c27a57b78bf59b603f30b6b466" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsStreamActive</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>IsStreamActive</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
          <defname>s</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Is the stream in the Active state. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="222" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1880" bodyend="1885"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ab41ee17db1430b9bb3957324f6ac20f1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
        <definition>static PaTime GetStreamTime</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamTime</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="223" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1887" bodyend="1909"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a3877d53c30b8b20f35f362ef07b998cd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>static double GetStreamCpuLoad</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamCpuLoad</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="224" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1912" bodyend="1917"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a9e7f111c33d1e80f40473846864e84fa" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError ReadStream</definition>
        <argsstring>(PaStream *stream, void *buffer, unsigned long frames)</argsstring>
        <name>ReadStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>frames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="225" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1927" bodyend="1968"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a0cfb7772846808945bd521d23d5626eb" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError WriteStream</definition>
        <argsstring>(PaStream *stream, const void *buffer, unsigned long frames)</argsstring>
        <name>WriteStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>frames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="226" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1971" bodyend="2011"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a82aa1e30985c7924247e8f45fc356d46" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>signed long</type>
        <definition>static signed long GetStreamReadAvailable</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamReadAvailable</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="227" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="2014" bodyend="2025"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ad7ee6bd74b3109101f1eb4ca0514c8b0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>signed long</type>
        <definition>static signed long GetStreamWriteAvailable</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamWriteAvailable</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="228" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="2029" bodyend="2044"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ab742b4c46c986b42712dd8009fb397e8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError BuildDeviceList</definition>
        <argsstring>(PaOSSHostApiRepresentation *hostApi)</argsstring>
        <name>BuildDeviceList</name>
        <param>
          <type><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
          <defname>ossApi</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Query host devices.</para><para>Loop over host devices and query their capabilitiesu</para><para>Aspect DeviceCapabilities: This function calls QueryDevice on each device entry and receives a filled in <ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> object per device, these are placed in the host api representation&apos;s deviceInfos array. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="229" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="521" bodyend="590"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1af5c5907fd84ab3bea3a107d7ff4d4c04" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>PaError PaOSS_Initialize</definition>
        <argsstring>(PaUtilHostApiRepresentation **hostApi, PaHostApiIndex hostApiIndex)</argsstring>
        <name>PaOSS_Initialize</name>
        <param>
          <type><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> **</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref></type>
          <declname>hostApiIndex</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initialize the OSS API implementation.</para><para>This function will initialize host API datastructures and query host devices for information.</para><para>Aspect DeviceCapabilities: Enumeration of host API devices is initiated from here</para><para>Aspect FreeResources: If an error is encountered under way we have to free each resource allocated in this function, this happens with the usual &quot;error&quot; label. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="241" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="241" bodyend="290"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1acbff329a34e7d0af90f65a35b845ed7e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>PaError PaUtil_InitializeDeviceInfo</definition>
        <argsstring>(PaDeviceInfo *deviceInfo, const char *name, PaHostApiIndex hostApiIndex, int maxInputChannels, int maxOutputChannels, PaTime defaultLowInputLatency, PaTime defaultLowOutputLatency, PaTime defaultHighInputLatency, PaTime defaultHighOutputLatency, double defaultSampleRate, PaUtilAllocationGroup *allocations)</argsstring>
        <name>PaUtil_InitializeDeviceInfo</name>
        <param>
          <type><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> *</type>
          <declname>deviceInfo</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref></type>
          <declname>hostApiIndex</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>maxInputChannels</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>maxOutputChannels</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
          <declname>defaultLowInputLatency</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
          <declname>defaultLowOutputLatency</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
          <declname>defaultHighInputLatency</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
          <declname>defaultHighOutputLatency</declname>
        </param>
        <param>
          <type>double</type>
          <declname>defaultSampleRate</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_util_allocation_group" kindref="compound">PaUtilAllocationGroup</ref> *</type>
          <declname>allocations</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="292" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="292" bodyend="319"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1abdc36fa469471992b1f9810744a073b9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>static int CalcHigherLogTwo</definition>
        <argsstring>(int n)</argsstring>
        <name>CalcHigherLogTwo</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="321" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="321" bodyend="326"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a333f1f3e36d2ab7ed0ebe9ed23dd73bf" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError QueryDirection</definition>
        <argsstring>(const char *deviceName, StreamMode mode, double *defaultSampleRate, int *maxChannelCount, double *defaultLowLatency, double *defaultHighLatency)</argsstring>
        <name>QueryDirection</name>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
          <declname>deviceName</declname>
        </param>
        <param>
          <type><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref></type>
          <declname>mode</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>defaultSampleRate</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref> *</type>
          <declname>maxChannelCount</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>defaultLowLatency</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>defaultHighLatency</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="328" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="328" bodyend="448"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1aa57de504d9f789e2a478e263d4db2430" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError QueryDevice</definition>
        <argsstring>(char *deviceName, PaOSSHostApiRepresentation *ossApi, PaDeviceInfo **deviceInfo)</argsstring>
        <name>QueryDevice</name>
        <param>
          <type>char *</type>
          <declname>deviceName</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref> *</type>
          <declname>ossApi</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> **</type>
          <declname>deviceInfo</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Query OSS device.</para><para>This is where <ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> objects are constructed and filled in with relevant information.</para><para>Aspect DeviceCapabilities: The inferred device capabilities are recorded in a <ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> object that is constructed in place. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="457" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="457" bodyend="512"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ad72b8ddbd7c96b49f52f4a79413c108b" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError ValidateParameters</definition>
        <argsstring>(const PaStreamParameters *parameters, const PaDeviceInfo *deviceInfo, StreamMode mode)</argsstring>
        <name>ValidateParameters</name>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>parameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> *</type>
          <declname>deviceInfo</declname>
        </param>
        <param>
          <type><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref></type>
          <declname>mode</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Validate stream parameters.</para><para>Aspect StreamChannels: We verify that the number of channels is within the allowed range for the device </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="726" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="726" bodyend="745"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a52aa8ff1c147cfd92b6e1679765ad337" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStreamComponent_Initialize</definition>
        <argsstring>(PaOssStreamComponent *component, const PaStreamParameters *parameters, int callbackMode, int fd, const char *deviceName)</argsstring>
        <name>PaOssStreamComponent_Initialize</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>parameters</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>callbackMode</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>fd</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
          <declname>deviceName</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="747" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="747" bodyend="771"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a0f6ea850dc008279ed333fee8a12629d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void PaOssStreamComponent_Terminate</definition>
        <argsstring>(PaOssStreamComponent *component)</argsstring>
        <name>PaOssStreamComponent_Terminate</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="773" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="773" bodyend="786"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6b72c0f232fb3e85940c2a605b193131" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError ModifyBlocking</definition>
        <argsstring>(int fd, int blocking)</argsstring>
        <name>ModifyBlocking</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>fd</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>blocking</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="788" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="788" bodyend="804"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6913a583b13d5fb2656a8a23c5e2b920" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError OpenDevices</definition>
        <argsstring>(const char *idevName, const char *odevName, int *idev, int *odev)</argsstring>
        <name>OpenDevices</name>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
          <declname>idevName</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
          <declname>odevName</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref> *</type>
          <declname>idev</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref> *</type>
          <declname>odev</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Open input and output devices.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>idev</parametername>
</parameternamelist>
<parameterdescription>
<para>Returned input device file descriptor. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>odev</parametername>
</parameternamelist>
<parameterdescription>
<para>Returned output device file descriptor. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="811" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="811" bodyend="850"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ae168882036adac7a77111f2c33af88c2" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStream_Initialize</definition>
        <argsstring>(PaOssStream *stream, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, PaStreamCallback callback, void *userData, PaStreamFlags streamFlags, PaOSSHostApiRepresentation *ossApi)</argsstring>
        <name>PaOssStream_Initialize</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref></type>
          <declname>callback</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>userData</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref></type>
          <declname>streamFlags</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref> *</type>
          <declname>ossApi</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="852" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="852" bodyend="906"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a60855ab75ead8cf1ccf04447e9a287aa" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void PaOssStream_Terminate</definition>
        <argsstring>(PaOssStream *stream)</argsstring>
        <name>PaOssStream_Terminate</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="908" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="908" bodyend="923"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6a582f15334ab3348102137e790f404d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError Pa2OssFormat</definition>
        <argsstring>(PaSampleFormat paFormat, int *ossFormat)</argsstring>
        <name>Pa2OssFormat</name>
        <param>
          <type><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref></type>
          <declname>paFormat</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref> *</type>
          <declname>ossFormat</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Translate from PA format to OSS native. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="928" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="928" bodyend="946"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a69545d3c61580a88012865cfdc446453" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError GetAvailableFormats</definition>
        <argsstring>(PaOssStreamComponent *component, PaSampleFormat *availableFormats)</argsstring>
        <name>GetAvailableFormats</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref> *</type>
          <declname>availableFormats</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Return the PA-compatible formats that this device can support. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="951" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="951" bodyend="971"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1aa8c0d3c062f61d0d27e4199cdf165cab" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>unsigned <ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>static unsigned int PaOssStreamComponent_FrameSize</definition>
        <argsstring>(PaOssStreamComponent *component)</argsstring>
        <name>PaOssStreamComponent_FrameSize</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="973" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="973" bodyend="976"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a40e3b07639703ae0cbd2c55f21b5b349" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>unsigned long</type>
        <definition>static unsigned long PaOssStreamComponent_BufferSize</definition>
        <argsstring>(PaOssStreamComponent *component)</argsstring>
        <name>PaOssStreamComponent_BufferSize</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Buffer size in bytes. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="981" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="981" bodyend="984"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a0a1c964b780117abf912455651b59d73" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStreamComponent_Configure</definition>
        <argsstring>(PaOssStreamComponent *component, double sampleRate, unsigned long framesPerBuffer, StreamMode streamMode, PaOssStreamComponent *master)</argsstring>
        <name>PaOssStreamComponent_Configure</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>framesPerBuffer</declname>
        </param>
        <param>
          <type><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref></type>
          <declname>streamMode</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>master</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Configure stream component device parameters. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="988" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="988" bodyend="1084"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a23f889e169b2750d44544aab8ab4abec" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStreamComponent_Read</definition>
        <argsstring>(PaOssStreamComponent *component, unsigned long *frames)</argsstring>
        <name>PaOssStreamComponent_Read</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <param>
          <type>unsigned long *</type>
          <declname>frames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1086" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1086" bodyend="1098"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a603aa17c24f18c8c447e5ca1f7289639" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStreamComponent_Write</definition>
        <argsstring>(PaOssStreamComponent *component, unsigned long *frames)</argsstring>
        <name>PaOssStreamComponent_Write</name>
        <param>
          <type><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref> *</type>
          <declname>component</declname>
        </param>
        <param>
          <type>unsigned long *</type>
          <declname>frames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1100" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1100" bodyend="1112"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ad5e257509b12074e801813849b765124" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStream_Configure</definition>
        <argsstring>(PaOssStream *stream, double sampleRate, unsigned long framesPerBuffer, double *inputLatency, double *outputLatency)</argsstring>
        <name>PaOssStream_Configure</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>framesPerBuffer</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>inputLatency</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>outputLatency</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Configure the stream according to input/output parameters.</para><para>Aspect StreamChannels: The minimum number of channels supported by the device may exceed that requested by the user, if so we&apos;ll record the actual number of host channels and adapt later. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1119" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1119" bodyend="1167"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a61bac7855856312bedd1afdcafbc342a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStream_WaitForFrames</definition>
        <argsstring>(PaOssStream *stream, unsigned long *frames)</argsstring>
        <name>PaOssStream_WaitForFrames</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>unsigned long *</type>
          <declname>frames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Poll on I/O filedescriptors.</para><para>Poll till we&apos;ve determined there&apos;s data for read or write. In the full-duplex case, we don&apos;t want to hang around forever waiting for either input or output frames, so whenever we have a timed out filedescriptor we check if we&apos;re nearing under/overrun for the other direction (critical limit set at one buffer). If so, we exit the waiting state, and go on with what we got. We align the number of frames on a host buffer boundary because it is possible that the buffer size differs for the two directions and the host buffer size is a compromise between the two. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1301" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1301" bodyend="1455"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a17b293751b96f387dbb5cae41ef06fd8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStream_Prepare</definition>
        <argsstring>(PaOssStream *stream)</argsstring>
        <name>PaOssStream_Prepare</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Prepare stream for capture/playback.</para><para>In order to synchronize capture and playback properly we use the SETTRIGGER command. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1461" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1461" bodyend="1515"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1abb2a2be8481e0cb8ac49cb6ea2c1e744" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError PaOssStream_Stop</definition>
        <argsstring>(PaOssStream *stream, int abort)</argsstring>
        <name>PaOssStream_Stop</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>abort</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Stop audio processing </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1520" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1520" bodyend="1549"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ae31769054b2cbea634e78e3025de571c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void OnExit</definition>
        <argsstring>(void *data)</argsstring>
        <name>OnExit</name>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>data</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Clean up after thread exit.</para><para>Aspect StreamState: If the user has registered a streamFinishedCallback it will be called here </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1555" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1555" bodyend="1572"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1ad165ae89ff9e03afbe302b62e82d3106" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError SetUpBuffers</definition>
        <argsstring>(PaOssStream *stream, unsigned long framesAvail)</argsstring>
        <name>SetUpBuffers</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>framesAvail</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1574" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1574" bodyend="1592"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1aab284f9be7875e4ae7a6712befbd72ec" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
        <definition>static void* PaOSS_AudioThreadProc</definition>
        <argsstring>(void *userData)</argsstring>
        <name>PaOSS_AudioThreadProc</name>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>userData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Thread procedure for callback processing.</para><para>Aspect StreamState: StartStream will wait on this to initiate audio processing, useful in case the callback should be used for buffer priming. When the stream is cancelled a separate function will take care of the transition to the <ref refid="class_callback" kindref="compound">Callback</ref> Finished state (the stream isn&apos;t considered Stopped before StopStream() or AbortStream() are called). </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1601" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1601" bodyend="1774"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6b62e3cc7888efa9fe8dde6de3e4d62e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError RealStop</definition>
        <argsstring>(PaOssStream *stream, int abort)</argsstring>
        <name>RealStop</name>
        <param>
          <type><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>abort</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="1822" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="1822" bodyend="1844"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a04ef585326928abf290637297eb595cc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
        <definition>const char* PaOSS_GetStreamInputDevice</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>PaOSS_GetStreamInputDevice</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="2046" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="2046" bodyend="2056"/>
      </memberdef>
      <memberdef kind="function" id="pa__unix__oss_8c_1a6ff7dc5b755a20f07c8ff7d5151e205d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
        <definition>const char* PaOSS_GetStreamOutputDevice</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>PaOSS_GetStreamOutputDevice</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" line="2058" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c" bodystart="2058" bodyend="2068"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>$Id:<sp/>pa_unix_oss.c<sp/>1894<sp/>2013-06-08<sp/>19:30:41Z<sp/>gineera<sp/>$</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>PortAudio<sp/>Portable<sp/>Real-Time<sp/>Audio<sp/>Library</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Latest<sp/>Version<sp/>at:<sp/>http://www.portaudio.com</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>OSS<sp/>implementation<sp/>by:</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/><sp/><sp/>Douglas<sp/>Repetto</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/><sp/><sp/>Phil<sp/>Burk</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/><sp/><sp/>Dominic<sp/>Mazzoni</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/><sp/><sp/>Arve<sp/>Knudsen</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>Based<sp/>on<sp/>the<sp/>Open<sp/>Source<sp/>API<sp/>proposed<sp/>by<sp/>Ross<sp/>Bencina</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>1999-2002<sp/>Ross<sp/>Bencina,<sp/>Phil<sp/>Burk</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>Permission<sp/>is<sp/>hereby<sp/>granted,<sp/>free<sp/>of<sp/>charge,<sp/>to<sp/>any<sp/>person<sp/>obtaining</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>a<sp/>copy<sp/>of<sp/>this<sp/>software<sp/>and<sp/>associated<sp/>documentation<sp/>files</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>(the<sp/>&quot;Software&quot;),<sp/>to<sp/>deal<sp/>in<sp/>the<sp/>Software<sp/>without<sp/>restriction,</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>including<sp/>without<sp/>limitation<sp/>the<sp/>rights<sp/>to<sp/>use,<sp/>copy,<sp/>modify,<sp/>merge,</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>publish,<sp/>distribute,<sp/>sublicense,<sp/>and/or<sp/>sell<sp/>copies<sp/>of<sp/>the<sp/>Software,</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>and<sp/>to<sp/>permit<sp/>persons<sp/>to<sp/>whom<sp/>the<sp/>Software<sp/>is<sp/>furnished<sp/>to<sp/>do<sp/>so,</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>subject<sp/>to<sp/>the<sp/>following<sp/>conditions:</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>The<sp/>above<sp/>copyright<sp/>notice<sp/>and<sp/>this<sp/>permission<sp/>notice<sp/>shall<sp/>be</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>included<sp/>in<sp/>all<sp/>copies<sp/>or<sp/>substantial<sp/>portions<sp/>of<sp/>the<sp/>Software.</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>THE<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>&quot;AS<sp/>IS&quot;,<sp/>WITHOUT<sp/>WARRANTY<sp/>OF<sp/>ANY<sp/>KIND,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>EXPRESS<sp/>OR<sp/>IMPLIED,<sp/>INCLUDING<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO<sp/>THE<sp/>WARRANTIES<sp/>OF</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>MERCHANTABILITY,<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>AND<sp/>NONINFRINGEMENT.</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>AUTHORS<sp/>OR<sp/>COPYRIGHT<sp/>HOLDERS<sp/>BE<sp/>LIABLE<sp/>FOR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>ANY<sp/>CLAIM,<sp/>DAMAGES<sp/>OR<sp/>OTHER<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>AN<sp/>ACTION<sp/>OF</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>CONTRACT,<sp/>TORT<sp/>OR<sp/>OTHERWISE,<sp/>ARISING<sp/>FROM,<sp/>OUT<sp/>OF<sp/>OR<sp/>IN<sp/>CONNECTION</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/>WITH<sp/>THE<sp/>SOFTWARE<sp/>OR<sp/>THE<sp/>USE<sp/>OR<sp/>OTHER<sp/>DEALINGS<sp/>IN<sp/>THE<sp/>SOFTWARE.</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/>The<sp/>text<sp/>above<sp/>constitutes<sp/>the<sp/>entire<sp/>PortAudio<sp/>license;<sp/>however,</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/>the<sp/>PortAudio<sp/>community<sp/>also<sp/>makes<sp/>the<sp/>following<sp/>non-binding<sp/>requests:</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/>Any<sp/>person<sp/>wishing<sp/>to<sp/>distribute<sp/>modifications<sp/>to<sp/>the<sp/>Software<sp/>is</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/>requested<sp/>to<sp/>send<sp/>the<sp/>modifications<sp/>to<sp/>the<sp/>original<sp/>developer<sp/>so<sp/>that</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>they<sp/>can<sp/>be<sp/>incorporated<sp/>into<sp/>the<sp/>canonical<sp/>version.<sp/>It<sp/>is<sp/>also</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/>requested<sp/>that<sp/>these<sp/>non-binding<sp/>requests<sp/>be<sp/>included<sp/>along<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/>license<sp/>above.</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;fcntl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/ioctl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;pthread.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="assert_8h" kindref="compound">assert.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="lib-src_2libvorbis_2macos_2compat_2sys_2_types_8h" kindref="compound">sys/types.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/stat.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/poll.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;limits.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;semaphore.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_SYS_SOUNDCARD_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;sys/soundcard.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>ifdef<sp/>__NetBSD__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>DEVICE_NAME_BASE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;/dev/audio&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>DEVICE_NAME_BASE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;/dev/dsp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>defined(HAVE_LINUX_SOUNDCARD_H)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;linux/soundcard.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>define<sp/>DEVICE_NAME_BASE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;/dev/dsp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>defined(HAVE_MACHINE_SOUNDCARD_H)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;machine/soundcard.h&gt;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>JH20010905<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>define<sp/>DEVICE_NAME_BASE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;/dev/audio&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>error<sp/>No<sp/>sound<sp/>card<sp/>header<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="portaudio_8h" kindref="compound">portaudio.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__util_8h" kindref="compound">pa_util.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__allocation_8h" kindref="compound">pa_allocation.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__hostapi_8h" kindref="compound">pa_hostapi.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__stream_8h" kindref="compound">pa_stream.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__cpuload_8h" kindref="compound">pa_cpuload.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__process_8h" kindref="compound">pa_process.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__unix__util_8h" kindref="compound">pa_unix_util.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__debugprint_8h" kindref="compound">pa_debugprint.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sysErr_;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>pthread_t<sp/>mainThread_;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Check<sp/>return<sp/>value<sp/>of<sp/>system<sp/>call,<sp/>and<sp/>map<sp/>it<sp/>to<sp/>PaError<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ENSURE_(expr,<sp/>code)<sp/>\</highlight></codeline>
<codeline lineno="98"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>do<sp/>{<sp/>\</highlight></codeline>
<codeline lineno="99"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>UNLIKELY(<sp/>(sysErr_<sp/>=<sp/>(expr))<sp/>&lt;<sp/>0<sp/>)<sp/>)<sp/>\</highlight></codeline>
<codeline lineno="100"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>\</highlight></codeline>
<codeline lineno="101"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PaUtil_SetLastHostErrorInfo<sp/>should<sp/>only<sp/>be<sp/>used<sp/>in<sp/>the<sp/>main<sp/>thread<sp/>*/</highlight><highlight class="preprocessor"><sp/>\</highlight></codeline>
<codeline lineno="102"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>(code)<sp/>==<sp/>paUnanticipatedHostError<sp/>&amp;&amp;<sp/>pthread_self()<sp/>==<sp/>mainThread_<sp/>)<sp/>\</highlight></codeline>
<codeline lineno="103"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>\</highlight></codeline>
<codeline lineno="104"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PaUtil_SetLastHostErrorInfo(<sp/>paOSS,<sp/>sysErr_,<sp/>strerror(<sp/>errno<sp/>)<sp/>);<sp/>\</highlight></codeline>
<codeline lineno="105"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>\</highlight></codeline>
<codeline lineno="106"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\</highlight></codeline>
<codeline lineno="107"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PaUtil_DebugPrint((<sp/>&quot;Expression<sp/>&apos;&quot;<sp/>#expr<sp/>&quot;&apos;<sp/>failed<sp/>in<sp/>&apos;&quot;<sp/>__FILE__<sp/>&quot;&apos;,<sp/>line:<sp/>&quot;<sp/>STRINGIZE(<sp/>__LINE__<sp/>)<sp/>&quot;\n&quot;<sp/>));<sp/>\</highlight></codeline>
<codeline lineno="108"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>(code);<sp/>\</highlight></codeline>
<codeline lineno="109"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>goto<sp/>error;<sp/>\</highlight></codeline>
<codeline lineno="110"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>\</highlight></codeline>
<codeline lineno="111"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>}<sp/>while(<sp/>0<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>AFMT_S16_NE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114" refid="pa__unix__oss_8c_1aec73a2ca552a1d579edc3e438dca805e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>AFMT_S16_NE<sp/><sp/>Get_AFMT_S16_NE()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="comment">/*********************************************************************</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/>Some<sp/>versions<sp/>of<sp/>OSS<sp/>do<sp/>not<sp/>define<sp/>AFMT_S16_NE.<sp/>So<sp/>check<sp/>CPU.</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/>PowerPC<sp/>is<sp/>Big<sp/>Endian.<sp/>X86<sp/>is<sp/>Little<sp/>Endian.</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>Get_AFMT_S16_NE(<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="120"><highlight class="normal">{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>testData<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)<sp/>&amp;testData;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isLittle<sp/>=<sp/>(<sp/>*ptr<sp/>==<sp/>1<sp/>);<sp/></highlight><highlight class="comment">/*<sp/>Does<sp/>address<sp/>point<sp/>to<sp/>least<sp/>significant<sp/>byte?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>isLittle<sp/>?<sp/>AFMT_S16_LE<sp/>:<sp/>AFMT_S16_BE;</highlight></codeline>
<codeline lineno="125"><highlight class="normal">}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>PaOSSHostApiRepresentation<sp/>-<sp/>host<sp/>api<sp/>datastructure<sp/>specific<sp/>to<sp/>this<sp/>implementation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="struct_pa_o_s_s_host_api_representation" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal">{</highlight></codeline>
<codeline lineno="132" refid="struct_pa_o_s_s_host_api_representation_1ac41d15472e8618ce2a600232b1d5a898" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/><ref refid="struct_pa_o_s_s_host_api_representation_1ac41d15472e8618ce2a600232b1d5a898" kindref="member">inheritedHostApiRep</ref>;</highlight></codeline>
<codeline lineno="133" refid="struct_pa_o_s_s_host_api_representation_1ad69a240ffe51786e65a14f9f004d7793" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_stream_interface" kindref="compound">PaUtilStreamInterface</ref><sp/><ref refid="struct_pa_o_s_s_host_api_representation_1ad69a240ffe51786e65a14f9f004d7793" kindref="member">callbackStreamInterface</ref>;</highlight></codeline>
<codeline lineno="134" refid="struct_pa_o_s_s_host_api_representation_1a95f6c2c3b94b920664c06014c68bbfc6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_stream_interface" kindref="compound">PaUtilStreamInterface</ref><sp/><ref refid="struct_pa_o_s_s_host_api_representation_1a95f6c2c3b94b920664c06014c68bbfc6" kindref="member">blockingStreamInterface</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_allocation_group" kindref="compound">PaUtilAllocationGroup</ref><sp/>*<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138" refid="struct_pa_o_s_s_host_api_representation_1adf310f504bc17e4642a1acee89379d61" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/><ref refid="struct_pa_o_s_s_host_api_representation_1adf310f504bc17e4642a1acee89379d61" kindref="member">hostApiIndex</ref>;</highlight></codeline>
<codeline lineno="139"><highlight class="normal">}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref>;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="struct_pa_oss_stream_component" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal">{</highlight></codeline>
<codeline lineno="151" refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>;</highlight></codeline>
<codeline lineno="152" refid="struct_pa_oss_stream_component_1a4fdcd3579fbc2db73c4db6e0f5b2a5ad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="struct_pa_oss_stream_component_1a4fdcd3579fbc2db73c4db6e0f5b2a5ad" kindref="member">devName</ref>;</highlight></codeline>
<codeline lineno="153" refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref>,<sp/>hostChannelCount;</highlight></codeline>
<codeline lineno="154" refid="struct_pa_oss_stream_component_1ae7c7baf67ac9b4459a63a192ee4c156a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_component_1ae7c7baf67ac9b4459a63a192ee4c156a" kindref="member">userInterleaved</ref>;</highlight></codeline>
<codeline lineno="155" refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>;</highlight></codeline>
<codeline lineno="156" refid="struct_pa_oss_stream_component_1a6a23ff2b04e56455303915b50d22bdf6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/><ref refid="struct_pa_oss_stream_component_1a6a23ff2b04e56455303915b50d22bdf6" kindref="member">userFormat</ref>,<sp/>hostFormat;</highlight></codeline>
<codeline lineno="157" refid="struct_pa_oss_stream_component_1a1d75c6753337e2e1b41b7208dce08cf5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_component_1a1d75c6753337e2e1b41b7208dce08cf5" kindref="member">latency</ref>;</highlight></codeline>
<codeline lineno="158" refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>hostFrames,<sp/><ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref>;</highlight></codeline>
<codeline lineno="159" refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>**<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref>;<sp/></highlight><highlight class="comment">/*<sp/>For<sp/>non-interleaved<sp/>blocking<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal">}<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref>;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="165" refid="struct_pa_oss_stream" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref></highlight></codeline>
<codeline lineno="166"><highlight class="normal">{</highlight></codeline>
<codeline lineno="167" refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_stream_representation" kindref="compound">PaUtilStreamRepresentation</ref><sp/><ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>;</highlight></codeline>
<codeline lineno="168" refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_cpu_load_measurer" kindref="compound">PaUtilCpuLoadMeasurer</ref><sp/><ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref>;</highlight></codeline>
<codeline lineno="169" refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_buffer_processor" kindref="compound">PaUtilBufferProcessor</ref><sp/><ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171" refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_threading" kindref="compound">PaUtilThreading</ref><sp/><ref refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" kindref="member">threading</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173" refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref>;</highlight></codeline>
<codeline lineno="174" refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref>;</highlight></codeline>
<codeline lineno="175" refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Have<sp/>the<sp/>devices<sp/>been<sp/>triggered<sp/>yet<sp/>(first<sp/>start)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177" refid="struct_pa_oss_stream_1ae0985c22b9f0382faede4f48cd2071ea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1ae0985c22b9f0382faede4f48cd2071ea" kindref="member">isActive</ref>;</highlight></codeline>
<codeline lineno="178" refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" kindref="member">isStopped</ref>;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180" refid="struct_pa_oss_stream_1ab6ce13dd52a50ff036c85bddb0259859" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1ab6ce13dd52a50ff036c85bddb0259859" kindref="member">lastPosPtr</ref>;</highlight></codeline>
<codeline lineno="181" refid="struct_pa_oss_stream_1a90d0de71db73bc00497e7a2fce9c2ce4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a90d0de71db73bc00497e7a2fce9c2ce4" kindref="member">lastStreamBytes</ref>;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183" refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref>;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185" refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" kindref="member">callbackMode</ref>;</highlight></codeline>
<codeline lineno="188" refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref>,<sp/><ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref>;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190" refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>,<sp/>*<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>;</highlight></codeline>
<codeline lineno="191" refid="struct_pa_oss_stream_1a0640a35e51badac6cb590bf436749766" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a0640a35e51badac6cb590bf436749766" kindref="member">pollTimeout</ref>;</highlight></codeline>
<codeline lineno="192" refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>sem_t<sp/><ref refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" kindref="member">semaphore</ref>;</highlight></codeline>
<codeline lineno="193"><highlight class="normal">}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><ref refid="pa__unix__oss_8c_1a71e62e12d9bfdf9a67c4c77567c53f89" kindref="member">PaOssStream</ref>;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196" refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="197" refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref>,</highlight></codeline>
<codeline lineno="198" refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" kindref="member">StreamMode_Out</ref></highlight></codeline>
<codeline lineno="199"><highlight class="normal">}<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref>;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>prototypes<sp/>for<sp/>functions<sp/>declared<sp/>in<sp/>this<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Terminate(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi<sp/>);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsFormatSupported(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>OpenStream(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>**<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesPerBuffer,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref><sp/>streamFlags,</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>*streamCallback,</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CloseStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StartStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StopStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>AbortStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamStopped(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamActive(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>GetStreamTime(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>GetStreamCpuLoad(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core__blocking_8c_1a9e7f111c33d1e80f40473846864e84fa" kindref="member">ReadStream</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structbuffer" kindref="compound">buffer</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core__blocking_8c_1a0cfb7772846808945bd521d23d5626eb" kindref="member">WriteStream</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structbuffer" kindref="compound">buffer</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">signed</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__blocking_8c_1a82aa1e30985c7924247e8f45fc356d46" kindref="member">GetStreamReadAvailable</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">signed</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__blocking_8c_1ad7ee6bd74b3109101f1eb4ca0514c8b0" kindref="member">GetStreamWriteAvailable</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>BuildDeviceList(<sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*hostApi<sp/>);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="241" refid="pa__unix__hostapis_8c_1aed532530783a78f32b4b1c28583767d7" refkind="member"><highlight class="normal"><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__unix__oss_8c_1af5c5907fd84ab3bea3a107d7ff4d4c04" kindref="member">PaOSS_Initialize</ref>(<sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>**hostApi,<sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/>hostApiIndex<sp/>)</highlight></codeline>
<codeline lineno="242"><highlight class="normal">{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossHostApi<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>ossHostApi<sp/>=<sp/>(<ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref>*)<ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref>)<sp/>),</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>=<sp/><ref refid="pa__allocation_8c_1a9cc7370b73e75f690ab0a0360e7fffee" kindref="member">PaUtil_CreateAllocationGroup</ref>(),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1adf310f504bc17e4642a1acee89379d61" kindref="member">hostApiIndex</ref><sp/>=<sp/>hostApiIndex;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>host<sp/>API<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>*hostApi<sp/>=<sp/>&amp;ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1ac41d15472e8618ce2a600232b1d5a898" kindref="member">inheritedHostApiRep</ref>;</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a1f3a8c465488e7af8024237256d80c14" kindref="member">structVersion</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.type<sp/>=<sp/><ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aea9afdcbf978e7b8b48db08a7c5208ebe4" kindref="member">paOSS</ref>;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;OSS&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;Terminate<sp/>=<sp/>Terminate;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;OpenStream<sp/>=<sp/>OpenStream;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;IsFormatSupported<sp/>=<sp/>IsFormatSupported;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>BuildDeviceList(<sp/>ossHostApi<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a7ae912708e0bb060028f25e6f95333b7" kindref="member">PaUtil_InitializeStreamInterface</ref>(<sp/>&amp;ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1ad69a240ffe51786e65a14f9f004d7793" kindref="member">callbackStreamInterface</ref>,<sp/>CloseStream,<sp/>StartStream,</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StopStream,<sp/>AbortStream,<sp/>IsStreamStopped,<sp/>IsStreamActive,</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetStreamTime,<sp/>GetStreamCpuLoad,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1ae7a66186864e1f27f9e274e1de562219" kindref="member">PaUtil_DummyRead</ref>,<sp/><ref refid="pa__stream_8c_1a827035da5bb7141143595519b0c0edc7" kindref="member">PaUtil_DummyWrite</ref>,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1aa43032a8fcb0d7b271f6049e4dc69e5c" kindref="member">PaUtil_DummyGetReadAvailable</ref>,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1aa4742249759bc11f31590db47cd19c2b" kindref="member">PaUtil_DummyGetWriteAvailable</ref><sp/>);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a7ae912708e0bb060028f25e6f95333b7" kindref="member">PaUtil_InitializeStreamInterface</ref>(<sp/>&amp;ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a95f6c2c3b94b920664c06014c68bbfc6" kindref="member">blockingStreamInterface</ref>,<sp/>CloseStream,<sp/>StartStream,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StopStream,<sp/>AbortStream,<sp/>IsStreamStopped,<sp/>IsStreamActive,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetStreamTime,<sp/><ref refid="pa__stream_8c_1aba19e5ce44bb3621b6ca257959c30b43" kindref="member">PaUtil_DummyGetCpuLoad</ref>,</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1a9e7f111c33d1e80f40473846864e84fa" kindref="member">ReadStream</ref>,<sp/><ref refid="pa__mac__core__blocking_8c_1a0cfb7772846808945bd521d23d5626eb" kindref="member">WriteStream</ref>,<sp/><ref refid="pa__mac__core__blocking_8c_1a82aa1e30985c7924247e8f45fc356d46" kindref="member">GetStreamReadAvailable</ref>,<sp/><ref refid="pa__mac__core__blocking_8c_1ad7ee6bd74b3109101f1eb4ca0514c8b0" kindref="member">GetStreamWriteAvailable</ref><sp/>);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/>mainThread_<sp/>=<sp/>pthread_self();</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ossHostApi<sp/>)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>)</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aa83a07899e8db63d415d03f68b1f8a3d" kindref="member">PaUtil_FreeAllAllocations</ref>(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aefcb1143eaa768c2b555bd203f1c9deb" kindref="member">PaUtil_DestroyAllocationGroup</ref>(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>ossHostApi<sp/>);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="290"><highlight class="normal">}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292" refid="pa__unix__oss_8c_1acbff329a34e7d0af90f65a35b845ed7e" refkind="member"><highlight class="normal"><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__unix__oss_8c_1acbff329a34e7d0af90f65a35b845ed7e" kindref="member">PaUtil_InitializeDeviceInfo</ref>(<sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref>,<sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/>hostApiIndex,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxInputChannels,</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxOutputChannels,<sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>defaultLowInputLatency,<sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>defaultLowOutputLatency,<sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>defaultHighInputLatency,</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>defaultHighOutputLatency,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>defaultSampleRate,<sp/><ref refid="struct_pa_util_allocation_group" kindref="compound">PaUtilAllocationGroup</ref><sp/>*allocations<sp/><sp/>)</highlight></codeline>
<codeline lineno="295"><highlight class="normal">{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a2d726add4cd2af78a94c052b3a7df568" kindref="member">structVersion</ref><sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>allocations<sp/>)</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>=<sp/>strlen(<sp/>name<sp/>)<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref><sp/>=<sp/><ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(<sp/>allocations,<sp/>len<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>,<sp/>name,<sp/>len<sp/>);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref><sp/>=<sp/><ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1afe741e4d185069577f7e74b78fdef5a4" kindref="member">hostApi</ref><sp/>=<sp/>hostApiIndex;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>=<sp/>maxInputChannels;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>=<sp/>maxOutputChannels;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1aad6629064b8c7cf043d237ea0a5cc534" kindref="member">defaultLowInputLatency</ref><sp/>=<sp/>defaultLowInputLatency;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a89e60515505eea8d668ede3a26a19ac6" kindref="member">defaultLowOutputLatency</ref><sp/>=<sp/>defaultLowOutputLatency;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a4214826038fcaf374beb9816024e6c9f" kindref="member">defaultHighInputLatency</ref><sp/>=<sp/>defaultHighInputLatency;</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a2a43dbc2b158806a937065bda037070e" kindref="member">defaultHighOutputLatency</ref><sp/>=<sp/>defaultHighOutputLatency;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a68f435353bfe1a4c9b632203a9afcacb" kindref="member">defaultSampleRate</ref><sp/>=<sp/>defaultSampleRate;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="319"><highlight class="normal">}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>CalcHigherLogTwo(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>)</highlight></codeline>
<codeline lineno="322"><highlight class="normal">{</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>log2<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>(1&lt;&lt;log2)<sp/>&lt;<sp/>n<sp/>)<sp/>log2++;</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>log2;</highlight></codeline>
<codeline lineno="326"><highlight class="normal">}</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>QueryDirection(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*deviceName,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref><sp/>mode,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*defaultSampleRate,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*maxChannelCount,</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*defaultLowLatency,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*defaultHighLatency<sp/>)</highlight></codeline>
<codeline lineno="330"><highlight class="normal">{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numChannels,<sp/>maxNumChannels;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>busy<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>devHandle<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sr;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>*maxChannelCount<sp/>=<sp/>0;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Default<sp/>value<sp/>in<sp/>case<sp/>this<sp/>fails<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>temp,<sp/>frgmt;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>fragFrames;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(devHandle<sp/>=<sp/>open(<sp/>deviceName,<sp/>(mode<sp/>==<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref><sp/>?<sp/><ref refid="sndread_8c_1a7a68c9ffaac7dbcd652225dd7c06a54b" kindref="member">O_RDONLY</ref><sp/>:<sp/>O_WRONLY)<sp/>|<sp/>O_NONBLOCK<sp/>))<sp/><sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>errno<sp/>==<sp/>EBUSY<sp/>||<sp/>errno<sp/>==<sp/>EAGAIN<sp/>)</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Device<sp/>%s<sp/>busy\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>deviceName<sp/>));</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ignore<sp/>ENOENT,<sp/>which<sp/>means<sp/>we&apos;ve<sp/>tried<sp/>a<sp/>non-existent<sp/>device<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>errno<sp/>!=<sp/>ENOENT<sp/>)</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Can&apos;t<sp/>access<sp/>device<sp/>%s:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>deviceName,<sp/>strerror(<sp/>errno<sp/>)<sp/>));</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref>;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Negotiate<sp/>for<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>channels<sp/>for<sp/>this<sp/>device.<sp/>PLB20010927</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Consider<sp/>up<sp/>to<sp/>16<sp/>as<sp/>the<sp/>upper<sp/>number<sp/>of<sp/>channels.</highlight></codeline>
<codeline lineno="360"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Variable<sp/>maxNumChannels<sp/>should<sp/>contain<sp/>the<sp/>actual<sp/>upper<sp/>limit<sp/>after<sp/>the<sp/>call.</highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Thanks<sp/>to<sp/>John<sp/>Lazzaro<sp/>and<sp/>Heiko<sp/>Purnhagen<sp/>for<sp/>suggestions.</highlight></codeline>
<codeline lineno="362"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>maxNumChannels<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>numChannels<sp/>=<sp/>1;<sp/>numChannels<sp/>&lt;=<sp/>16;<sp/>numChannels++<sp/>)</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>numChannels;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ioctl(<sp/>devHandle,<sp/>SNDCTL_DSP_CHANNELS,<sp/>&amp;temp<sp/>)<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>busy<sp/>=<sp/>EAGAIN<sp/>==<sp/>errno<sp/>||<sp/>EBUSY<sp/>==<sp/>errno;</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ioctl()<sp/>failed<sp/>so<sp/>bail<sp/>out<sp/>if<sp/>we<sp/>already<sp/>have<sp/>stereo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>maxNumChannels<sp/>&gt;=<sp/>2<sp/>)</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ioctl()<sp/>worked<sp/>but<sp/>bail<sp/>out<sp/>if<sp/>it<sp/>does<sp/>not<sp/>support<sp/>numChannels.</highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>We<sp/>don&apos;t<sp/>want<sp/>to<sp/>leave<sp/>gaps<sp/>in<sp/>the<sp/>numChannels<sp/>supported.</highlight></codeline>
<codeline lineno="378"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(numChannels<sp/>&gt;<sp/>2)<sp/>&amp;&amp;<sp/>(temp<sp/>!=<sp/>numChannels)<sp/>)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>temp<sp/>&gt;<sp/>maxNumChannels<sp/>)</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxNumChannels<sp/>=<sp/>temp;<sp/></highlight><highlight class="comment">/*<sp/>Save<sp/>maximum.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A:<sp/>We&apos;re<sp/>able<sp/>to<sp/>open<sp/>a<sp/>device<sp/>for<sp/>capture<sp/>if<sp/>it&apos;s<sp/>busy<sp/>playing<sp/>back<sp/>and<sp/>vice<sp/>versa,</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>but<sp/>we<sp/>can&apos;t<sp/>configure<sp/>anything<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>==<sp/>maxNumChannels<sp/>&amp;&amp;<sp/>busy<sp/>)</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref>;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>above<sp/>negotiation<sp/>may<sp/>fail<sp/>for<sp/>an<sp/>old<sp/>driver<sp/>so<sp/>try<sp/>this<sp/>older<sp/>technique.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>maxNumChannels<sp/>&lt;<sp/>1<sp/>)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stereo<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ioctl(<sp/>devHandle,<sp/>SNDCTL_DSP_STEREO,<sp/>&amp;stereo<sp/>)<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxNumChannels<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxNumChannels<sp/>=<sp/>(stereo)<sp/>?<sp/>2<sp/>:<sp/>1;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>use<sp/>SNDCTL_DSP_STEREO,<sp/>maxNumChannels<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>maxNumChannels<sp/>));</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>During<sp/>channel<sp/>negotiation,<sp/>the<sp/>last<sp/>ioctl()<sp/>may<sp/>have<sp/>failed.<sp/>This<sp/>can</highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>also<sp/>cause<sp/>sample<sp/>rate<sp/>negotiation<sp/>to<sp/>fail.<sp/>Hence<sp/>the<sp/>following,<sp/>to<sp/>return</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>a<sp/>supported<sp/>number<sp/>of<sp/>channels.<sp/>SG20011005<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>use<sp/>most<sp/>reasonable<sp/>default<sp/>value<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numChannels<sp/>=<sp/><ref refid="pa__unix__util_8h_1aea604351950df064043e9512ef7a222f" kindref="member">PA_MIN</ref>(<sp/>maxNumChannels,<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>devHandle,<sp/>SNDCTL_DSP_CHANNELS,<sp/>&amp;numChannels<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>supported<sp/>sample<sp/>rate<sp/>closest<sp/>to<sp/>44100<sp/>Hz<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>*defaultSampleRate<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sr<sp/>=<sp/>44100;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>devHandle,<sp/>SNDCTL_DSP_SPEED,<sp/>&amp;sr<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*defaultSampleRate<sp/>=<sp/>sr;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>*maxChannelCount<sp/>=<sp/>maxNumChannels;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attempt<sp/>to<sp/>set<sp/>low<sp/>latency<sp/>with<sp/>4<sp/>frags-per-buffer,<sp/>128<sp/>frames-per-frag<sp/>(total<sp/>buffer<sp/>512<sp/>frames)</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>since<sp/>the<sp/>ioctl<sp/>sets<sp/>bytes,<sp/>multiply<sp/>by<sp/>numChannels,<sp/>and<sp/>base<sp/>on<sp/>2<sp/>bytes-per-sample,<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>fragFrames<sp/>=<sp/>128;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>frgmt<sp/>=<sp/>(4<sp/>&lt;&lt;<sp/>16)<sp/>+<sp/>(CalcHigherLogTwo(<sp/>fragFrames<sp/>*<sp/>numChannels<sp/>*<sp/>2<sp/>)<sp/>&amp;<sp/>0xffff);</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>devHandle,<sp/>SNDCTL_DSP_SETFRAGMENT,<sp/>&amp;frgmt<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Use<sp/>the<sp/>value<sp/>set<sp/>by<sp/>the<sp/>ioctl<sp/>to<sp/>give<sp/>the<sp/>latency<sp/>achieved<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/>fragFrames<sp/>=<sp/>pow(<sp/>2,<sp/>frgmt<sp/>&amp;<sp/>0xffff<sp/>)<sp/>/<sp/>(numChannels<sp/>*<sp/>2);</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>*defaultLowLatency<sp/>=<sp/>((frgmt<sp/>&gt;&gt;<sp/>16)<sp/>-<sp/>1)<sp/>*<sp/>fragFrames<sp/>/<sp/>*defaultSampleRate;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cannot<sp/>now<sp/>try<sp/>setting<sp/>a<sp/>high<sp/>latency<sp/>(device<sp/>would<sp/>need<sp/>closing<sp/>and<sp/>opening<sp/>again).<sp/><sp/>Make</highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>high-latency<sp/>4<sp/>times<sp/>the<sp/>low<sp/>unless<sp/>the<sp/>fragFrames<sp/>are<sp/>significantly<sp/>more<sp/>than<sp/>requested<sp/>128<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>(fragFrames<sp/>&lt;<sp/>256)<sp/>?<sp/>4<sp/>:<sp/>(fragFrames<sp/>&lt;<sp/>512)<sp/>?<sp/>2<sp/>:<sp/>1;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>*defaultHighLatency<sp/>=<sp/>temp<sp/>*<sp/>*defaultLowLatency;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>devHandle<sp/>&gt;=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(<sp/>devHandle<sp/>);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="448"><highlight class="normal">}</highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>QueryDevice(<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*deviceName,<sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossApi,<sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>**deviceInfo<sp/>)</highlight></codeline>
<codeline lineno="458"><highlight class="normal">{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>=<sp/>-1.;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxInputChannels,<sp/>maxOutputChannels;</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>defaultLowInputLatency,<sp/>defaultLowOutputLatency,<sp/>defaultHighInputLatency,<sp/>defaultHighOutputLatency;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>tmpRes<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>busy<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/>*deviceInfo<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>douglas:</highlight></codeline>
<codeline lineno="468"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>we<sp/>have<sp/>to<sp/>do<sp/>this<sp/>querying<sp/>in<sp/>a<sp/>slightly<sp/>different<sp/>order.<sp/>apparently</highlight></codeline>
<codeline lineno="469"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>some<sp/>sound<sp/>cards<sp/>will<sp/>give<sp/>you<sp/>different<sp/>info<sp/>based<sp/>on<sp/>their<sp/>settins.</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>e.g.<sp/>a<sp/>card<sp/>might<sp/>give<sp/>you<sp/>stereo<sp/>at<sp/>22kHz<sp/>but<sp/>only<sp/>mono<sp/>at<sp/>44kHz.</highlight></codeline>
<codeline lineno="471"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>correct<sp/>order<sp/>for<sp/>OSS<sp/>is:<sp/>format,<sp/>channels,<sp/>sample<sp/>rate</highlight></codeline>
<codeline lineno="472"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aspect<sp/>StreamChannels:<sp/>The<sp/>number<sp/>of<sp/>channels<sp/>supported<sp/>for<sp/>a<sp/>device<sp/>may<sp/>depend<sp/>on<sp/>the<sp/>mode<sp/>it<sp/>is</highlight></codeline>
<codeline lineno="475"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>opened<sp/>in,<sp/>it<sp/>may<sp/>have<sp/>more<sp/>channels<sp/>available<sp/>for<sp/>capture<sp/>than<sp/>playback<sp/>and<sp/>vice<sp/>versa.<sp/>Therefore</highlight></codeline>
<codeline lineno="476"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>we<sp/>will<sp/>open<sp/>the<sp/>device<sp/>in<sp/>both<sp/>read-<sp/>and<sp/>write-only<sp/>mode<sp/>to<sp/>determine<sp/>the<sp/>supported<sp/>number.</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(tmpRes<sp/>=<sp/>QueryDirection(<sp/>deviceName,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref>,<sp/>&amp;sampleRate,<sp/>&amp;maxInputChannels,<sp/>&amp;defaultLowInputLatency,</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;defaultHighInputLatency<sp/>))<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>tmpRes<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>)</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Querying<sp/>device<sp/>%s<sp/>for<sp/>capture<sp/>failed!\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>deviceName<sp/>));</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PA_ENSURE(<sp/>tmpRes<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++busy;</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(tmpRes<sp/>=<sp/>QueryDirection(<sp/>deviceName,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" kindref="member">StreamMode_Out</ref>,<sp/>&amp;sampleRate,<sp/>&amp;maxOutputChannels,<sp/>&amp;defaultLowOutputLatency,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;defaultHighOutputLatency<sp/>))<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>tmpRes<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>)</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Querying<sp/>device<sp/>%s<sp/>for<sp/>playback<sp/>failed!\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>deviceName<sp/>));</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PA_ENSURE(<sp/>tmpRes<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++busy;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>0<sp/>&lt;=<sp/>busy<sp/>&amp;&amp;<sp/>busy<sp/>&lt;=<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>2<sp/>==<sp/>busy<sp/>)<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Both<sp/>directions<sp/>are<sp/>unavailable<sp/>to<sp/>us<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref>;</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>*deviceInfo<sp/>=<sp/><ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(<sp/>ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref>,<sp/>sizeof<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>)<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="pa__unix__oss_8c_1acbff329a34e7d0af90f65a35b845ed7e" kindref="member">PaUtil_InitializeDeviceInfo</ref>(<sp/>*deviceInfo,<sp/>deviceName,<sp/>ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1adf310f504bc17e4642a1acee89379d61" kindref="member">hostApiIndex</ref>,<sp/>maxInputChannels,<sp/>maxOutputChannels,</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>defaultLowInputLatency,<sp/>defaultLowOutputLatency,<sp/>defaultHighInputLatency,<sp/>defaultHighOutputLatency,<sp/>sampleRate,</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="512"><highlight class="normal">}</highlight></codeline>
<codeline lineno="513"><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>BuildDeviceList(<sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossApi<sp/>)</highlight></codeline>
<codeline lineno="522"><highlight class="normal">{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*commonApi<sp/>=<sp/>&amp;ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1ac41d15472e8618ce2a600232b1d5a898" kindref="member">inheritedHostApiRep</ref>;</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numDevices<sp/>=<sp/>0,<sp/>maxDeviceInfos<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>**deviceInfos<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>These<sp/>two<sp/>will<sp/>be<sp/>set<sp/>to<sp/>the<sp/>first<sp/>working<sp/>input<sp/>and<sp/>output<sp/>device,<sp/>respectively<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a85a62057c3479d3efaa477d8562cf21d" kindref="member">defaultInputDevice</ref><sp/>=<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref>;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a62632690b5f7906d3c9bfdab91e7f4b2" kindref="member">defaultOutputDevice</ref><sp/>=<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref>;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>devices<sp/>by<sp/>calling<sp/>QueryDevice<sp/>on<sp/>each</highlight></codeline>
<codeline lineno="534"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>potential<sp/>device<sp/>names.<sp/><sp/>When<sp/>we<sp/>find<sp/>a<sp/>valid<sp/>one,</highlight></codeline>
<codeline lineno="535"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>add<sp/>it<sp/>to<sp/>a<sp/>linked<sp/>list.</highlight></codeline>
<codeline lineno="536"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>A:<sp/>Set<sp/>an<sp/>arbitrary<sp/>of<sp/>100<sp/>devices,<sp/>should<sp/>probably<sp/>be<sp/>a<sp/>smarter<sp/>way.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>100;<sp/>i++<sp/>)</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>deviceName[32];</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>testResult;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>i<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="win_2msvc_2switches_8h_1aa367b75c5aed883fef5befbdf04835a4" kindref="member">snprintf</ref>(deviceName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(deviceName),<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>DEVICE_NAME_BASE);</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="win_2msvc_2switches_8h_1aa367b75c5aed883fef5befbdf04835a4" kindref="member">snprintf</ref>(deviceName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(deviceName),<sp/></highlight><highlight class="stringliteral">&quot;%s%d&quot;</highlight><highlight class="normal">,<sp/>DEVICE_NAME_BASE,<sp/>i);</highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PA_DEBUG((&quot;%s:<sp/>trying<sp/>device<sp/>%s\n&quot;,<sp/>__FUNCTION__,<sp/>deviceName<sp/>));<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(testResult<sp/>=<sp/>QueryDevice(<sp/>deviceName,<sp/>ossApi,<sp/>&amp;deviceInfo<sp/>))<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>testResult<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>testResult<sp/>);</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++numDevices;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!deviceInfos<sp/>||<sp/>numDevices<sp/>&gt;<sp/>maxDeviceInfos<sp/>)</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxDeviceInfos<sp/>*=<sp/>2;</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>deviceInfos<sp/>=<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>**)<sp/>realloc(<sp/>deviceInfos,<sp/>maxDeviceInfos<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*)<sp/>),</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>devIdx<sp/>=<sp/>numDevices<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfos[devIdx]<sp/>=<sp/>deviceInfo;</highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a85a62057c3479d3efaa477d8562cf21d" kindref="member">defaultInputDevice</ref><sp/>==<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref><sp/>&amp;&amp;<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a85a62057c3479d3efaa477d8562cf21d" kindref="member">defaultInputDevice</ref><sp/>=<sp/>devIdx;</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a62632690b5f7906d3c9bfdab91e7f4b2" kindref="member">defaultOutputDevice</ref><sp/>==<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref><sp/>&amp;&amp;<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a62632690b5f7906d3c9bfdab91e7f4b2" kindref="member">defaultOutputDevice</ref><sp/>=<sp/>devIdx;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Make<sp/>an<sp/>array<sp/>of<sp/>PaDeviceInfo<sp/>pointers<sp/>out<sp/>of<sp/>the<sp/>linked<sp/>list<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((</highlight><highlight class="stringliteral">&quot;PaOSS<sp/>%s:<sp/>Total<sp/>number<sp/>of<sp/>devices<sp/>found:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>numDevices));</highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref><sp/>=<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>**)<ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>*)<sp/>*<sp/>numDevices<sp/>);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(<sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>,<sp/>deviceInfos,<sp/>numDevices<sp/>*<sp/>sizeof<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*)<sp/>);</highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/>commonApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a44e3adfaba0117a6780e2493468c96b1" kindref="member">deviceCount</ref><sp/>=<sp/>numDevices;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>free(<sp/>deviceInfos<sp/>);</highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="590"><highlight class="normal">}</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Terminate(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi<sp/>)</highlight></codeline>
<codeline lineno="593"><highlight class="normal">{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossHostApi<sp/>=<sp/>(<ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref>*)hostApi;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>)</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aa83a07899e8db63d415d03f68b1f8a3d" kindref="member">PaUtil_FreeAllAllocations</ref>(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aefcb1143eaa768c2b555bd203f1c9deb" kindref="member">PaUtil_DestroyAllocationGroup</ref>(<sp/>ossHostApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a415955a7a7bc861ff215e58958f23184" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>ossHostApi<sp/>);</highlight></codeline>
<codeline lineno="603"><highlight class="normal">}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsFormatSupported(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>)</highlight></codeline>
<codeline lineno="609"><highlight class="normal">{</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1ad79317e65bde63d76c4b8e711ac5a361" kindref="member">PaDeviceIndex</ref><sp/>device;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*deviceName;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inputChannelCount,<sp/>outputChannelCount;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tempDevHandle<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>flags;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>inputSampleFormat,<sp/>outputSampleFormat;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSampleFormat<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="625"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>input<sp/>device<sp/>can<sp/>support<sp/>inputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="633"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>validate<sp/>inputStreamInfo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref><sp/>)</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a44f6cce375a3d38af28652179a400403" kindref="member">paIncompatibleHostApiSpecificStreamInfo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>this<sp/>implementation<sp/>doesn&apos;t<sp/>use<sp/>custom<sp/>stream<sp/>info<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSampleFormat<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="649"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>output<sp/>device<sp/>can<sp/>support<sp/>inputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>validate<sp/>outputStreamInfo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref><sp/>)</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a44f6cce375a3d38af28652179a400403" kindref="member">paIncompatibleHostApiSpecificStreamInfo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>this<sp/>implementation<sp/>doesn&apos;t<sp/>use<sp/>custom<sp/>stream<sp/>info<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inputChannelCount<sp/>==<sp/>0<sp/>&amp;&amp;<sp/>outputChannelCount<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>full<sp/>duplex,<sp/>make<sp/>sure<sp/>that<sp/>they&apos;re<sp/>the<sp/>same<sp/>device<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>outputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>!=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>)</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="675"><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>full<sp/>duplex,<sp/>also<sp/>make<sp/>sure<sp/>that<sp/>they&apos;re<sp/>the<sp/>same<sp/>number<sp/>of<sp/>channels<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>outputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>!=<sp/>outputChannelCount)</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>open<sp/>the<sp/>device<sp/>so<sp/>we<sp/>can<sp/>do<sp/>more<sp/>tests<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputChannelCount<sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__front_8c_1a07ed030327e33935a807f671f4840936" kindref="member">PaUtil_DeviceIndexToHostApiDeviceIndex</ref>(&amp;device,<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>,<sp/>hostApi);</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>)</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__front_8c_1a07ed030327e33935a807f671f4840936" kindref="member">PaUtil_DeviceIndexToHostApiDeviceIndex</ref>(&amp;device,<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>,<sp/>hostApi);</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>)</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo<sp/>=<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[device];</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceName<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>flags<sp/>=<sp/>O_NONBLOCK;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="winfun_8c_1ab24f32995c1d94525943b4568cce20cb" kindref="member">if</ref><sp/>(inputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>outputChannelCount<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>O_RDWR;</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inputChannelCount<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/><ref refid="sndread_8c_1a7a68c9ffaac7dbcd652225dd7c06a54b" kindref="member">O_RDONLY</ref>;</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>O_WRONLY;</highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>tempDevHandle<sp/>=<sp/>open(<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>,<sp/>flags<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>);</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PaOssStream_Configure<sp/>will<sp/>do<sp/>the<sp/>rest<sp/>of<sp/>the<sp/>checking<sp/>for<sp/>us<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PA_ENSURE(<sp/>PaOssStream_Configure(<sp/>tempDevHandle,<sp/>deviceName,<sp/>outputChannelCount,<sp/>&amp;sampleRate<sp/>)<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>everything<sp/>succeeded!<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>tempDevHandle<sp/>&gt;=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(<sp/>tempDevHandle<sp/>);</highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="720"><highlight class="normal">}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>ValidateParameters(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*parameters,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref><sp/>mode<sp/>)</highlight></codeline>
<codeline lineno="727"><highlight class="normal">{</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxChans;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>parameters<sp/>);</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>parameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/>maxChans<sp/>=<sp/>(mode<sp/>==<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref><sp/>?<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>:</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref>);</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>parameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>&gt;<sp/>maxChans<sp/>)</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="745"><highlight class="normal">}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStreamComponent_Initialize(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*parameters,</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" kindref="member">callbackMode</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>fd,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*deviceName<sp/>)</highlight></codeline>
<codeline lineno="749"><highlight class="normal">{</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(<sp/>component,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref>)<sp/>);</highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref><sp/>=<sp/>fd;</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a4fdcd3579fbc2db73c4db6e0f5b2a5ad" kindref="member">devName</ref><sp/>=<sp/>deviceName;</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref><sp/>=<sp/>parameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a6a23ff2b04e56455303915b50d22bdf6" kindref="member">userFormat</ref><sp/>=<sp/>parameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a1d75c6753337e2e1b41b7208dce08cf5" kindref="member">latency</ref><sp/>=<sp/>parameters-&gt;<ref refid="struct_pa_stream_parameters_1aa1e80ac0551162fd091db8936ccbe9a0" kindref="member">suggestedLatency</ref>;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1ae7c7baf67ac9b4459a63a192ee4c156a" kindref="member">userInterleaved</ref><sp/>=<sp/>!(parameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/>&amp;<sp/><ref refid="portaudio_8h_1a1d79f0b88812cef5364b276dbbc898b5" kindref="member">paNonInterleaved</ref>);</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" kindref="member">callbackMode</ref><sp/>&amp;&amp;<sp/>!component-&gt;<ref refid="struct_pa_oss_stream_component_1ae7c7baf67ac9b4459a63a192ee4c156a" kindref="member">userInterleaved</ref><sp/>)</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pre-allocate<sp/>non-interleaved<sp/>user<sp/>provided<sp/>buffers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref><sp/>=<sp/><ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)<sp/>*<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref><sp/>),</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="771"><highlight class="normal">}</highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>PaOssStreamComponent_Terminate(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component<sp/>)</highlight></codeline>
<codeline lineno="774"><highlight class="normal">{</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref><sp/>&gt;=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref><sp/>);</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref><sp/>)</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref><sp/>);</highlight></codeline>
<codeline lineno="781"><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref><sp/>)</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref><sp/>);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="786"><highlight class="normal">}</highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>ModifyBlocking(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>fd,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blocking<sp/>)</highlight></codeline>
<codeline lineno="789"><highlight class="normal">{</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>fflags;</highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>fflags<sp/>=<sp/>fcntl(<sp/>fd,<sp/>F_GETFL<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>blocking<sp/>)</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflags<sp/>&amp;=<sp/>~O_NONBLOCK;</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflags<sp/>|=<sp/>O_NONBLOCK;</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>fcntl(<sp/>fd,<sp/>F_SETFL,<sp/>fflags<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="804"><highlight class="normal">}</highlight></codeline>
<codeline lineno="805"><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>OpenDevices(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*idevName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*odevName,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*idev,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*odev<sp/>)</highlight></codeline>
<codeline lineno="812"><highlight class="normal">{</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>flags<sp/>=<sp/>O_NONBLOCK,<sp/>duplex<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/>*idev<sp/>=<sp/>*odev<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>idevName<sp/>&amp;&amp;<sp/>odevName<sp/>)</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>duplex<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>O_RDWR;</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>idevName<sp/>)</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/><ref refid="sndread_8c_1a7a68c9ffaac7dbcd652225dd7c06a54b" kindref="member">O_RDONLY</ref>;</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>O_WRONLY;</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>open<sp/>first<sp/>in<sp/>nonblocking<sp/>mode,<sp/>in<sp/>case<sp/>it&apos;s<sp/>busy...</highlight></codeline>
<codeline lineno="828"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>A:<sp/>then<sp/>unset<sp/>the<sp/>non-blocking<sp/>attribute<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>flags<sp/>&amp;<sp/>O_NONBLOCK<sp/>);</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>idevName<sp/>)</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>*idev<sp/>=<sp/>open(<sp/>idevName,<sp/>flags<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>);</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>*idev,<sp/>1<sp/>)<sp/>);<sp/></highlight><highlight class="comment">/*<sp/>Blocking<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>odevName<sp/>)</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!idevName<sp/>)</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>*odev<sp/>=<sp/>open(<sp/>odevName,<sp/>flags<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a467dac712e45745d8b0d8cd429fd1a01" kindref="member">paDeviceUnavailable</ref><sp/>);</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>*odev,<sp/>1<sp/>)<sp/>);<sp/></highlight><highlight class="comment">/*<sp/>Blocking<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>*odev<sp/>=<sp/>dup(<sp/>*idev<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="847"><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="850"><highlight class="normal">}</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStream_Initialize(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>callback,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref>,<sp/><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref><sp/>streamFlags,</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossApi<sp/>)</highlight></codeline>
<codeline lineno="855"><highlight class="normal">{</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idev,<sp/>odev;</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi<sp/>=<sp/>&amp;ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1ac41d15472e8618ce2a600232b1d5a898" kindref="member">inheritedHostApiRep</ref>;</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*idevName<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>*odevName<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="860"><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="862"><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(<sp/>stream,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>)<sp/>);</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" kindref="member">isStopped</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="pa__unix__util_8c_1abec767adc928dfb8a8afa46a596cd828" kindref="member">PaUtil_InitializeThreading</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" kindref="member">threading</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>&amp;&amp;<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>)</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="873"><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>idevName<sp/>=<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>]-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>odevName<sp/>=<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>]-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>OpenDevices(<sp/>idevName,<sp/>odevName,<sp/>&amp;idev,<sp/>&amp;odev<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>=<sp/><ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref>)<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Initialize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>,<sp/>inputParameters,<sp/>callback<sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>idev,<sp/>idevName<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>=<sp/><ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref>)<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Initialize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>,<sp/>outputParameters,<sp/>callback<sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>odev,<sp/>odevName<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="889"><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>callback<sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a0e3a44086f5baa62308dfd6df77396e0" kindref="member">PaUtil_InitializeStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>,</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1ad69a240ffe51786e65a14f9f004d7793" kindref="member">callbackStreamInterface</ref>,<sp/>callback,<sp/><ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" kindref="member">callbackMode</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a0e3a44086f5baa62308dfd6df77396e0" kindref="member">PaUtil_InitializeStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>,</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;ossApi-&gt;<ref refid="struct_pa_o_s_s_host_api_representation_1a95f6c2c3b94b920664c06014c68bbfc6" kindref="member">blockingStreamInterface</ref>,<sp/>callback,<sp/><ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>sem_init(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" kindref="member">semaphore</ref>,<sp/>0,<sp/>0<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a4851f9f753cdad3e7a89380d6589816c" kindref="member">paInternalError</ref><sp/>);</highlight></codeline>
<codeline lineno="903"><highlight class="normal"></highlight></codeline>
<codeline lineno="904"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="906"><highlight class="normal">}</highlight></codeline>
<codeline lineno="907"><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>PaOssStream_Terminate(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>)</highlight></codeline>
<codeline lineno="909"><highlight class="normal">{</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="911"><highlight class="normal"></highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1ac30f6c0d3138ef52c63c94fd1a53ea86" kindref="member">PaUtil_TerminateStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref><sp/>);</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8c_1a2c519ba45de8cb5907a5f0648405b9cd" kindref="member">PaUtil_TerminateThreading</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" kindref="member">threading</ref><sp/>);</highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PaOssStreamComponent_Terminate(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>);</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PaOssStreamComponent_Terminate(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>);</highlight></codeline>
<codeline lineno="919"><highlight class="normal"></highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/>sem_destroy(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" kindref="member">semaphore</ref><sp/>);</highlight></codeline>
<codeline lineno="921"><highlight class="normal"></highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="923"><highlight class="normal">}</highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>Pa2OssFormat(<sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>paFormat,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ossFormat<sp/>)</highlight></codeline>
<codeline lineno="929"><highlight class="normal">{</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>paFormat<sp/>)</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1ad826044e4ffe7b16bf990803ab77df37" kindref="member">paUInt8</ref>:</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ossFormat<sp/>=<sp/>AFMT_U8;</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a058ecfb48ac9f0efad7a7b0d446efe3e" kindref="member">paInt8</ref>:</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ossFormat<sp/>=<sp/>AFMT_S8;</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1ab284f8e0a161d78ede863aec45461dbd" kindref="member">paInt16</ref>:</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ossFormat<sp/>=<sp/><ref refid="pa__unix__oss_8c_1aec73a2ca552a1d579edc3e438dca805e" kindref="member">AFMT_S16_NE</ref>;</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a4851f9f753cdad3e7a89380d6589816c" kindref="member">paInternalError</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>shouldn&apos;t<sp/>happen<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="946"><highlight class="normal">}</highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>GetAvailableFormats(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component,<sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>*availableFormats<sp/>)</highlight></codeline>
<codeline lineno="952"><highlight class="normal">{</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structmask" kindref="compound">mask</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>frmts<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETFMTS,<sp/>&amp;mask<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>mask<sp/>&amp;<sp/>AFMT_U8<sp/>)</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frmts<sp/>|=<sp/><ref refid="portaudio_8h_1ad826044e4ffe7b16bf990803ab77df37" kindref="member">paUInt8</ref>;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>mask<sp/>&amp;<sp/>AFMT_S8<sp/>)</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frmts<sp/>|=<sp/><ref refid="portaudio_8h_1a058ecfb48ac9f0efad7a7b0d446efe3e" kindref="member">paInt8</ref>;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>mask<sp/>&amp;<sp/><ref refid="pa__unix__oss_8c_1aec73a2ca552a1d579edc3e438dca805e" kindref="member">AFMT_S16_NE</ref><sp/>)</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frmts<sp/>|=<sp/><ref refid="portaudio_8h_1ab284f8e0a161d78ede863aec45461dbd" kindref="member">paInt16</ref>;</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref>;</highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/>*availableFormats<sp/>=<sp/>frmts;</highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="971"><highlight class="normal">}</highlight></codeline>
<codeline lineno="972"><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>PaOssStreamComponent_FrameSize(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component<sp/>)</highlight></codeline>
<codeline lineno="974"><highlight class="normal">{</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a541ed0b734df2631bc4c229acf92abc1" kindref="member">Pa_GetSampleSize</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref><sp/>)<sp/>*<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref>;</highlight></codeline>
<codeline lineno="976"><highlight class="normal">}</highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>PaOssStreamComponent_BufferSize(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component<sp/>)</highlight></codeline>
<codeline lineno="982"><highlight class="normal">{</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>PaOssStreamComponent_FrameSize(<sp/>component<sp/>)<sp/>*<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>*<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref>;</highlight></codeline>
<codeline lineno="984"><highlight class="normal">}</highlight></codeline>
<codeline lineno="985"><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStreamComponent_Configure(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerBuffer,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791f" kindref="member">StreamMode</ref><sp/>streamMode,<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*master<sp/>)</highlight></codeline>
<codeline lineno="990"><highlight class="normal">{</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>temp,<sp/>nativeFormat;</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sr<sp/>=<sp/>(<ref refid="lib_2expat_8h_1a14bb8924daea0b48c7803f281f66e390" kindref="member">int</ref>)<ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>availableFormats<sp/>=<sp/>0,<sp/>hostFormat<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>chans<sp/>=<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref>;</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>frgmt;</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numBufs;</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytesPerBuf;</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>bufSz;</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>fragSz;</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/>audio_buf_info<sp/>bufInfo;</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>may<sp/>have<sp/>a<sp/>situation<sp/>where<sp/>only<sp/>one<sp/>component<sp/>(the<sp/>master)<sp/>is<sp/>configured,<sp/>if<sp/>both<sp/>point<sp/>to<sp/>the<sp/>same<sp/>device.</highlight></codeline>
<codeline lineno="1004"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>In<sp/>that<sp/>case,<sp/>the<sp/>second<sp/>component<sp/>will<sp/>copy<sp/>settings<sp/>from<sp/>the<sp/>other<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!master<sp/>)</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aspect<sp/>BufferSettings:<sp/>If<sp/>framesPerBuffer<sp/>is<sp/>unspecified<sp/>we<sp/>have<sp/>to<sp/>infer<sp/>a<sp/>suitable<sp/>fragment<sp/>size.</highlight></codeline>
<codeline lineno="1008"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>The<sp/>hardware<sp/>need<sp/>not<sp/>respect<sp/>the<sp/>requested<sp/>fragment<sp/>size,<sp/>so<sp/>we<sp/>may<sp/>have<sp/>to<sp/>adapt.</highlight></codeline>
<codeline lineno="1009"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>framesPerBuffer<sp/>==<sp/><ref refid="portaudio_8h_1ac1e20b97c1858a59bc62823573c59f0b" kindref="member">paFramesPerBufferUnspecified</ref><sp/>)</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aim<sp/>for<sp/>4<sp/>fragments<sp/>in<sp/>the<sp/>complete<sp/>buffer;<sp/>the<sp/>latency<sp/>comes<sp/>from<sp/>3<sp/>of<sp/>these<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fragSz<sp/>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>long)(component-&gt;<ref refid="struct_pa_oss_stream_component_1a1d75c6753337e2e1b41b7208dce08cf5" kindref="member">latency</ref><sp/>*<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>/<sp/>3);</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bufSz<sp/>=<sp/>fragSz<sp/>*<sp/>4;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fragSz<sp/>=<sp/>framesPerBuffer;</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bufSz<sp/>=<sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>long)(component-&gt;<ref refid="struct_pa_oss_stream_component_1a1d75c6753337e2e1b41b7208dce08cf5" kindref="member">latency</ref><sp/>*<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>)<sp/>+<sp/>fragSz;<sp/></highlight><highlight class="comment">/*<sp/>Latency<sp/>+<sp/>1<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"></highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>GetAvailableFormats(<sp/>component,<sp/>&amp;availableFormats<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostFormat<sp/>=<sp/><ref refid="pa__converters_8c_1a74195475fe92d6b7b71de247f2b08184" kindref="member">PaUtil_SelectClosestAvailableFormat</ref>(<sp/>availableFormats,<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a6a23ff2b04e56455303915b50d22bdf6" kindref="member">userFormat</ref><sp/>);</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>OSS<sp/>demands<sp/>at<sp/>least<sp/>2<sp/>buffers,<sp/>and<sp/>16<sp/>bytes<sp/>per<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numBufs<sp/>=<sp/>(<ref refid="lib_2expat_8h_1a14bb8924daea0b48c7803f281f66e390" kindref="member">int</ref>)<ref refid="pa__unix__util_8h_1a4bc529f0326c76adbfea99f629a119bf" kindref="member">PA_MAX</ref>(<sp/>bufSz<sp/>/<sp/>fragSz,<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bytesPerBuf<sp/>=<sp/><ref refid="pa__unix__util_8h_1a4bc529f0326c76adbfea99f629a119bf" kindref="member">PA_MAX</ref>(<sp/>fragSz<sp/>*<sp/><ref refid="portaudio_8h_1a541ed0b734df2631bc4c229acf92abc1" kindref="member">Pa_GetSampleSize</ref>(<sp/>hostFormat<sp/>)<sp/>*<sp/>chans,<sp/>16<sp/>);</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>fragment<sp/>parameters<sp/>are<sp/>encoded<sp/>like<sp/>this:</highlight></codeline>
<codeline lineno="1030"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Most<sp/>significant<sp/>byte:<sp/>number<sp/>of<sp/>fragments</highlight></codeline>
<codeline lineno="1031"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Least<sp/>significant<sp/>byte:<sp/>exponent<sp/>of<sp/>fragment<sp/>size<sp/>(i.e.,<sp/>for<sp/>256,<sp/>8)</highlight></codeline>
<codeline lineno="1032"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frgmt<sp/>=<sp/>(numBufs<sp/>&lt;&lt;<sp/>16)<sp/>+<sp/>(CalcHigherLogTwo(<sp/>bytesPerBuf<sp/>)<sp/>&amp;<sp/>0xffff);</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETFRAGMENT,<sp/>&amp;frgmt<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>A:<sp/>according<sp/>to<sp/>the<sp/>OSS<sp/>programmer&apos;s<sp/>guide<sp/>parameters<sp/>should<sp/>be<sp/>set<sp/>in<sp/>this<sp/>order:</highlight></codeline>
<codeline lineno="1037"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>format,<sp/>channels,<sp/>rate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>format<sp/>should<sp/>be<sp/>deemed<sp/>good<sp/>before<sp/>we<sp/>get<sp/>this<sp/>far<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>Pa2OssFormat(<sp/>hostFormat,<sp/>&amp;temp<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nativeFormat<sp/>=<sp/>temp;</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETFMT,<sp/>&amp;temp<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>temp<sp/>==<sp/>nativeFormat,<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a4851f9f753cdad3e7a89380d6589816c" kindref="member">paInternalError</ref><sp/>);</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>try<sp/>to<sp/>set<sp/>the<sp/>number<sp/>of<sp/>channels<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_CHANNELS,<sp/>&amp;chans<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref><sp/>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>XXX:<sp/>Should<sp/>be<sp/>paInvalidChannelCount?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It&apos;s<sp/>possible<sp/>that<sp/>the<sp/>minimum<sp/>number<sp/>of<sp/>host<sp/>channels<sp/>is<sp/>greater<sp/>than<sp/>what<sp/>the<sp/>user<sp/>requested<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>chans<sp/>&gt;=<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref>,<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>try<sp/>to<sp/>set<sp/>the<sp/>sample<sp/>rate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SPEED,<sp/>&amp;sr<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a30a98097c3b6d9789077b72c26ae7c24" kindref="member">paInvalidSampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>reject<sp/>if<sp/>there&apos;s<sp/>no<sp/>sample<sp/>rate<sp/>within<sp/>1%<sp/>of<sp/>the<sp/>one<sp/>requested<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(fabs(<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>-<sp/>sr<sp/>)<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>)<sp/>&gt;<sp/>0.01<sp/>)</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((</highlight><highlight class="stringliteral">&quot;%s:<sp/>Wanted<sp/>%f,<sp/>closest<sp/>sample<sp/>rate<sp/>was<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/>sr<sp/>));</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a30a98097c3b6d9789077b72c26ae7c24" kindref="member">paInvalidSampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>streamMode<sp/>==<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref><sp/>?<sp/>SNDCTL_DSP_GETISPACE<sp/>:<sp/>SNDCTL_DSP_GETOSPACE,<sp/>&amp;bufInfo<sp/>),</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref><sp/>=<sp/>bufInfo.fragstotal;</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>needs<sp/>to<sp/>be<sp/>the<sp/>last<sp/>ioctl<sp/>call<sp/>before<sp/>the<sp/>first<sp/>read/write,<sp/>according<sp/>to<sp/>the<sp/>OSS<sp/>programmer&apos;s<sp/>guide<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETBLKSIZE,<sp/>&amp;bytesPerBuf<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>=<sp/>bytesPerBuf<sp/>/<sp/><ref refid="portaudio_8h_1a541ed0b734df2631bc4c229acf92abc1" kindref="member">Pa_GetSampleSize</ref>(<sp/>hostFormat<sp/>)<sp/>/<sp/>chans;</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>=<sp/>chans;</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref><sp/>=<sp/>hostFormat;</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref><sp/>=<sp/>master-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref>;</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>=<sp/>master-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>=<sp/>master-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref>;</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref><sp/>=<sp/>master-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref>;</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"></highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref><sp/>=<sp/><ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/>PaOssStreamComponent_BufferSize(<sp/>component<sp/>)<sp/>),</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStreamComponent_Read(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*frames<sp/>)</highlight></codeline>
<codeline lineno="1087"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>=<sp/>*frames<sp/>*<sp/>PaOssStreamComponent_FrameSize(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="win_2msvc_2switches_8h_1a8af93bbb66534e14d651bbb0638ee796" kindref="member">ssize_t</ref><sp/>bytesRead;</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"></highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>bytesRead<sp/>=<sp/>read(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>len<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/>*frames<sp/>=<sp/>bytesRead<sp/>/<sp/>PaOssStreamComponent_FrameSize(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>Handle<sp/>condition<sp/>where<sp/>number<sp/>of<sp/>frames<sp/>read<sp/>doesn&apos;t<sp/>equal<sp/>number<sp/>of<sp/>frames<sp/>requested<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"></highlight></codeline>
<codeline lineno="1100"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStreamComponent_Write(<sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*frames<sp/>)</highlight></codeline>
<codeline lineno="1101"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>=<sp/>*frames<sp/>*<sp/>PaOssStreamComponent_FrameSize(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="win_2msvc_2switches_8h_1a8af93bbb66534e14d651bbb0638ee796" kindref="member">ssize_t</ref><sp/>bytesWritten;</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"></highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>bytesWritten<sp/>=<sp/>write(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>len<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/>*frames<sp/>=<sp/>bytesWritten<sp/>/<sp/>PaOssStreamComponent_FrameSize(<sp/>component<sp/>);</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>Handle<sp/>condition<sp/>where<sp/>number<sp/>of<sp/>frames<sp/>written<sp/>doesn&apos;t<sp/>equal<sp/>number<sp/>of<sp/>frames<sp/>requested<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"></highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1112"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStream_Configure(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesPerBuffer,</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*inputLatency,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*outputLatency<sp/>)</highlight></codeline>
<codeline lineno="1121"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>duplex<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>;</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"></highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>should<sp/>request<sp/>full<sp/>duplex<sp/>first<sp/>thing<sp/>after<sp/>opening<sp/>the<sp/>device<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>duplex<sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>)</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETDUPLEX,<sp/>0<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>;</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Configure(<sp/>component,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/>framesPerBuffer,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref>,</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>&gt;<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>&gt;<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*inputLatency<sp/>=<sp/>(component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>*<sp/>(component-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref><sp/>-<sp/>1))<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream_component" kindref="compound">PaOssStreamComponent</ref><sp/>*component<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>,<sp/>*master<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>?<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>:<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Configure(<sp/>component,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/>framesPerBuffer,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" kindref="member">StreamMode_Out</ref>,</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>master<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>&gt;<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>&gt;<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*outputLatency<sp/>=<sp/>(component-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>*<sp/>(component-&gt;<ref refid="struct_pa_oss_stream_component_1ad912ac4010429731817692641b7181ec" kindref="member">numBufs</ref><sp/>-<sp/>1))<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>duplex<sp/>)</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerHostBuffer<sp/>=<sp/><ref refid="pa__unix__util_8h_1aea604351950df064043e9512ef7a222f" kindref="member">PA_MIN</ref>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>);</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerHostBuffer<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerHostBuffer<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"></highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref><sp/>=<sp/><ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref>;</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0640a35e51badac6cb590bf436749766" kindref="member">pollTimeout</ref><sp/>=<sp/>(<ref refid="lib_2expat_8h_1a14bb8924daea0b48c7803f281f66e390" kindref="member">int</ref>)<sp/>ceil(<sp/>1e6<sp/>*<sp/>framesPerHostBuffer<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Period<sp/>in<sp/>usecs,<sp/>rounded<sp/>up<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a9200fdee790d9155bc35d03be51ee2dd" kindref="member">sampleRate</ref><sp/>=<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"></highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1167"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"></highlight></codeline>
<codeline lineno="1169"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>see<sp/>pa_hostapi.h<sp/>for<sp/>a<sp/>list<sp/>of<sp/>validity<sp/>guarantees<sp/>made<sp/>about<sp/>OpenStream<sp/>parameters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>OpenStream(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>**<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesPerBuffer,</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref><sp/>streamFlags,</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>*streamCallback,</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>)</highlight></codeline>
<codeline lineno="1193"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref><sp/>*ossHostApi<sp/>=<sp/>(<ref refid="struct_pa_o_s_s_host_api_representation" kindref="compound">PaOSSHostApiRepresentation</ref>*)hostApi;</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inputChannelCount<sp/>=<sp/>0,<sp/>outputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>inputSampleFormat<sp/>=<sp/>0,<sp/>outputSampleFormat<sp/>=<sp/>0,<sp/>inputHostFormat<sp/>=<sp/>0,<sp/>outputHostFormat<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*inputDeviceInfo<sp/>=<sp/>0,<sp/>*outputDeviceInfo<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bpInitialized<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>inLatency<sp/>=<sp/>0.,<sp/>outLatency<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"></highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>validate<sp/>platform<sp/>specific<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(streamFlags<sp/>&amp;<sp/><ref refid="portaudio_8h_1a8522957e1bf814b9782d3a0e314c8b51" kindref="member">paPlatformSpecificFlags</ref>)<sp/>!=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aa5e7d0d9ea49ef845a93c89a3d138294" kindref="member">paInvalidFlag</ref>;<sp/></highlight><highlight class="comment">/*<sp/>unexpected<sp/>platform<sp/>specific<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1207"><highlight class="normal"></highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="1211"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputDeviceInfo<sp/>=<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>];</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ValidateParameters(<sp/>inputParameters,<sp/>inputDeviceInfo,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791faee4552042ee189f6046abc4a7ba35a7c" kindref="member">StreamMode_In</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSampleFormat<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputDeviceInfo<sp/>=<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>];</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ValidateParameters(<sp/>outputParameters,<sp/>outputDeviceInfo,<sp/><ref refid="pa__unix__oss_8c_1a5b53090612b0845fc9b0fa2ac6cb791fa2d79178c2be03f37e753d279113f93ed" kindref="member">StreamMode_Out</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"></highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSampleFormat<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aspect<sp/>StreamChannels:<sp/>We<sp/>currently<sp/>demand<sp/>that<sp/>number<sp/>of<sp/>input<sp/>and<sp/>output<sp/>channels<sp/>are<sp/>the<sp/>same,<sp/>if<sp/>the<sp/>same</highlight></codeline>
<codeline lineno="1228"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>device<sp/>is<sp/>opened<sp/>for<sp/>both<sp/>directions</highlight></codeline>
<codeline lineno="1229"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputChannelCount<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>outputChannelCount<sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>)</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>!=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>)</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"></highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Round<sp/>framesPerBuffer<sp/>to<sp/>the<sp/>next<sp/>power-of-two<sp/>to<sp/>make<sp/>OSS<sp/>happy.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>framesPerBuffer<sp/>!=<sp/><ref refid="portaudio_8h_1ac1e20b97c1858a59bc62823573c59f0b" kindref="member">paFramesPerBufferUnspecified</ref><sp/>)</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerBuffer<sp/>&amp;=<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref>;</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>framesPerBuffer<sp/>&gt;<sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;<sp/>i<sp/>&lt;&lt;=<sp/>1)<sp/>;</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesPerBuffer<sp/>=<sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"></highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>allocate<sp/>and<sp/>do<sp/>basic<sp/>initialization<sp/>of<sp/>the<sp/>stream<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1adaa396943350072fdd811837f9bead54" kindref="member">PA_UNLESS</ref>(<sp/>stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)<ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>)<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref><sp/>);</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_Initialize(<sp/>stream,<sp/>inputParameters,<sp/>outputParameters,<sp/>streamCallback,<sp/>userData,<sp/>streamFlags,<sp/>ossHostApi<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"></highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_Configure(<sp/>stream,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/>framesPerBuffer,<sp/>&amp;inLatency,<sp/>&amp;outLatency<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"></highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a8cffac188367367b6c5c5ed8e0b1fe46" kindref="member">PaUtil_InitializeCpuLoadMeasurer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref>,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputHostFormat<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref>;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a1f5339e0fef75cea66d9153235698399" kindref="member">inputLatency</ref><sp/>=<sp/>inLatency<sp/>+</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ae5a4104d7132396436e179825e2a3847" kindref="member">PaUtil_GetBufferProcessorInputLatencyFrames</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref><sp/>)<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputHostFormat<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1aa41af4e1aeb5a24218a5fb6b629ade02" kindref="member">hostFormat</ref>;</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a372a81f39d90a85ae62225e9f57a7840" kindref="member">outputLatency</ref><sp/>=<sp/>outLatency<sp/>+</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a853a8cd0e8d214406aa83ef3ef3d1102" kindref="member">PaUtil_GetBufferProcessorOutputLatencyFrames</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref><sp/>)<sp/>/<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>buffer<sp/>processor<sp/>with<sp/>fixed<sp/>host<sp/>buffer<sp/>size.</highlight></codeline>
<codeline lineno="1269"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Aspect<sp/>StreamSampleFormat:<sp/>Here<sp/>we<sp/>commit<sp/>the<sp/>user<sp/>and<sp/>host<sp/>sample<sp/>formats,<sp/>PA<sp/>infrastructure<sp/>will</highlight></codeline>
<codeline lineno="1270"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>convert<sp/>between<sp/>the<sp/>two.</highlight></codeline>
<codeline lineno="1271"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="pa__process_8c_1aaae7001566f528cf2d3cd453bf05c5d5" kindref="member">PaUtil_InitializeBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount,<sp/>inputSampleFormat,<sp/>inputHostFormat,<sp/>outputChannelCount,<sp/>outputSampleFormat,</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputHostFormat,<sp/><ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>,<sp/>streamFlags,<sp/>framesPerBuffer,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref>,</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8h_1a16c84d8c0ac62944797f530bf852484fa5e79e1ea4d8f114cfe83caa9b08610d8" kindref="member">paUtilFixedHostBufferSize</ref>,<sp/>streamCallback,<sp/>userData<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/>bpInitialized<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>=<sp/>(<ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*)stream;</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"></highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>bpInitialized<sp/>)</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1acf4e607f9c25ec2db5efd02ef1adb188" kindref="member">PaUtil_TerminateBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref><sp/>);</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream<sp/>)</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PaOssStream_Terminate(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"></highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1289"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStream_WaitForFrames(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*frames<sp/>)</highlight></codeline>
<codeline lineno="1302"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pollPlayback<sp/>=<sp/>0,<sp/>pollCapture<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>captureAvail<sp/>=<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref>,<sp/>playbackAvail<sp/>=<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref>,<sp/>commonAvail;</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/>audio_buf_info<sp/>bufInfo;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>int<sp/>ofs<sp/>=<sp/>0,<sp/>nfds<sp/>=<sp/>stream-&gt;nfds;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/>fd_set<sp/>readFds,<sp/>writeFds;</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nfds<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">timeval<sp/>selectTimeval<sp/>=<sp/>{0,<sp/>0};</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>timeout<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0640a35e51badac6cb590bf436749766" kindref="member">pollTimeout</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>In<sp/>usecs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>captureFd<sp/>=<sp/>-1,<sp/>playbackFd<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"></highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"></highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollCapture<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>captureFd<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>;</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stream-&gt;capture-&gt;pfd-&gt;events<sp/>=<sp/>POLLIN;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollPlayback<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>playbackFd<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>;</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stream-&gt;playback-&gt;pfd-&gt;events<sp/>=<sp/>POLLOUT;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"></highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/>FD_ZERO(<sp/>&amp;readFds<sp/>);</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/>FD_ZERO(<sp/>&amp;writeFds<sp/>);</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"></highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>pollPlayback<sp/>||<sp/>pollCapture<sp/>)</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>PTHREAD_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_testcancel();</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>indefinite<sp/>waiting<sp/>on<sp/>thread<sp/>not<sp/>supporting<sp/>cancelation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>||<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>)</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Cancelling<sp/>PaOssStream_WaitForFrames\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*frames)<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>select<sp/>may<sp/>modify<sp/>the<sp/>timeout<sp/>parameter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selectTimeval.tv_usec<sp/>=<sp/>timeout;</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfds<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pollCapture<sp/>)</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FD_SET(<sp/>captureFd,<sp/>&amp;readFds<sp/>);</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfds<sp/>=<sp/>captureFd<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pollPlayback<sp/>)</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FD_SET(<sp/>playbackFd,<sp/>&amp;writeFds<sp/>);</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfds<sp/>=<sp/><ref refid="pa__unix__util_8h_1a4bc529f0326c76adbfea99f629a119bf" kindref="member">PA_MAX</ref>(<sp/>nfds,<sp/>playbackFd<sp/>+<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>select(<sp/>nfds,<sp/>&amp;readFds,<sp/>&amp;writeFds,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>&amp;selectTimeval<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1363"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>poll(<sp/>stream-&gt;pfds<sp/>+<sp/>ofs,<sp/>nfds,<sp/>stream-&gt;pollTimeout<sp/>)<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1364"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1365"><highlight class="comment"></highlight></codeline>
<codeline lineno="1366"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ENSURE_(<sp/>-1,<sp/>paUnanticipatedHostError<sp/>);</highlight></codeline>
<codeline lineno="1367"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1368"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1369"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>PTHREAD_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_testcancel();</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>indefinite<sp/>waiting<sp/>on<sp/>thread<sp/>not<sp/>supporting<sp/>cancelation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>||<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>)</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Cancelling<sp/>PaOssStream_WaitForFrames\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*frames)<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pollCapture<sp/>)</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FD_ISSET(<sp/>captureFd,<sp/>&amp;readFds<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FD_CLR(<sp/>captureFd,<sp/>&amp;readFds<sp/>);</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollCapture<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1388"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>stream-&gt;capture-&gt;pfd-&gt;revents<sp/>&amp;<sp/>POLLIN<sp/>)</highlight></codeline>
<codeline lineno="1389"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1390"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--nfds;</highlight></codeline>
<codeline lineno="1391"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++ofs;</highlight></codeline>
<codeline lineno="1392"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollCapture<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1393"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1394"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>Timed<sp/>out,<sp/>go<sp/>on<sp/>with<sp/>playback?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*PA_DEBUG((<sp/>&quot;%s:<sp/>Trying<sp/>to<sp/>poll<sp/>again<sp/>for<sp/>capture<sp/>frames,<sp/>pollTimeout:<sp/>%d\n&quot;,</highlight></codeline>
<codeline lineno="1398"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>stream-&gt;pollTimeout<sp/>));*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pollPlayback<sp/>)</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>FD_ISSET(<sp/>playbackFd,<sp/>&amp;writeFds<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FD_CLR(<sp/>playbackFd,<sp/>&amp;writeFds<sp/>);</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollPlayback<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1409"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>stream-&gt;playback-&gt;pfd-&gt;revents<sp/>&amp;<sp/>POLLOUT<sp/>)</highlight></codeline>
<codeline lineno="1410"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1411"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--nfds;</highlight></codeline>
<codeline lineno="1412"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pollPlayback<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1413"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1414"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)<sp/><sp/></highlight><highlight class="comment">/*<sp/>Timed<sp/>out,<sp/>go<sp/>on<sp/>with<sp/>capture?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*PA_DEBUG((<sp/>&quot;%s:<sp/>Trying<sp/>to<sp/>poll<sp/>again<sp/>for<sp/>playback<sp/>frames,<sp/>pollTimeout:<sp/>%d\n\n&quot;,</highlight></codeline>
<codeline lineno="1418"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>stream-&gt;pollTimeout<sp/>));*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>captureFd,<sp/>SNDCTL_DSP_GETISPACE,<sp/>&amp;bufInfo<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>captureAvail<sp/>=<sp/>bufInfo.fragments<sp/>*<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!captureAvail<sp/>)</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>captureAvail:<sp/>0\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__<sp/>));</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"></highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>captureAvail<sp/>=<sp/>captureAvail<sp/>==<sp/>0<sp/>?<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref><sp/>:<sp/>captureAvail;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Disregard<sp/>if<sp/>zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>playbackFd,<sp/>SNDCTL_DSP_GETOSPACE,<sp/>&amp;bufInfo<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>playbackAvail<sp/>=<sp/>bufInfo.fragments<sp/>*<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!playbackAvail<sp/>)</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>playbackAvail:<sp/>0\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__<sp/>));</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>playbackAvail<sp/>=<sp/>playbackAvail<sp/>==<sp/>0<sp/>?<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref><sp/>:<sp/>playbackAvail;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Disregard<sp/>if<sp/>zero<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>commonAvail<sp/>=<sp/><ref refid="pa__unix__util_8h_1aea604351950df064043e9512ef7a222f" kindref="member">PA_MIN</ref>(<sp/>captureAvail,<sp/>playbackAvail<sp/>);</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>commonAvail<sp/>==<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref><sp/>)</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>commonAvail<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/>commonAvail<sp/>-=<sp/>commonAvail<sp/>%<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref>;</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>commonAvail<sp/>!=<sp/><ref refid="macint_8h_1a9ec306f36d50c7375e74f0d1c55a3a67" kindref="member">INT_MAX</ref><sp/>);</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>commonAvail<sp/>&gt;=<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/>*frames<sp/>=<sp/>commonAvail;</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1455"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"></highlight></codeline>
<codeline lineno="1461"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStream_Prepare(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>)</highlight></codeline>
<codeline lineno="1462"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>enableBits<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"></highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref><sp/>)</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"></highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>OSS<sp/>reference<sp/>instructs<sp/>us<sp/>to<sp/>clear<sp/>direction<sp/>bits<sp/>before<sp/>setting<sp/>them.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETTRIGGER,<sp/>&amp;enableBits<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETTRIGGER,<sp/>&amp;enableBits<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>bufSz<sp/>=<sp/>PaOssStreamComponent_BufferSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>);</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>0,<sp/>bufSz<sp/>);</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"></highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Looks<sp/>like<sp/>we<sp/>have<sp/>to<sp/>turn<sp/>off<sp/>blocking<sp/>before<sp/>we<sp/>try<sp/>this,<sp/>but<sp/>if<sp/>we<sp/>don&apos;t<sp/>fill<sp/>the<sp/>buffer</highlight></codeline>
<codeline lineno="1481"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>OSS<sp/>will<sp/>complain.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>0<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(1)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>write(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>bufSz<sp/>)<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>1<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"></highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>)</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enableBits<sp/>=<sp/>PCM_ENABLE_INPUT<sp/>|<sp/>PCM_ENABLE_OUTPUT;</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETTRIGGER,<sp/>&amp;enableBits<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enableBits<sp/>=<sp/>PCM_ENABLE_INPUT;</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETTRIGGER,<sp/>&amp;enableBits<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enableBits<sp/>=<sp/>PCM_ENABLE_OUTPUT;</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_SETTRIGGER,<sp/>&amp;enableBits<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ok,<sp/>we<sp/>have<sp/>triggered<sp/>the<sp/>stream<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"></highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1515"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>PaOssStream_Stop(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>abort<sp/>)</highlight></codeline>
<codeline lineno="1521"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"></highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Looks<sp/>like<sp/>the<sp/>only<sp/>safe<sp/>way<sp/>to<sp/>stop<sp/>audio<sp/>without<sp/>reopening<sp/>the<sp/>device<sp/>is<sp/>SNDCTL_DSP_POST.</highlight></codeline>
<codeline lineno="1525"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Also<sp/>disable<sp/>capture/playback<sp/>till<sp/>the<sp/>stream<sp/>is<sp/>started<sp/>again.</highlight></codeline>
<codeline lineno="1526"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>captureErr<sp/>=<sp/>0,<sp/>playbackErr<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(captureErr<sp/>=<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_POST,<sp/>0<sp/>))<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Failed<sp/>to<sp/>stop<sp/>capture<sp/>device,<sp/>error:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>captureErr<sp/>));</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>&amp;&amp;<sp/>!stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>)</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(playbackErr<sp/>=<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_POST,<sp/>0<sp/>))<sp/>&lt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>Failed<sp/>to<sp/>stop<sp/>playback<sp/>device,<sp/>error:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>playbackErr<sp/>));</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>captureErr<sp/>||<sp/>playbackErr<sp/>)</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref>;</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"></highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1549"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"></highlight></codeline>
<codeline lineno="1555"><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_menus_8h_1aedcd0979dd6860e7f1a9ce54ecdd18ba" kindref="member">OnExit</ref>(<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref><sp/>)</highlight></codeline>
<codeline lineno="1556"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*)<sp/>data;</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>data<sp/>);</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a31e622efc7504297b2191c3fe616b2ee" kindref="member">PaUtil_ResetCpuLoadMeasurer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref><sp/>);</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"></highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/>PaOssStream_Stop(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>);</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"></highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;OnExit:<sp/>Stoppage\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"></highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Eventually<sp/>notify<sp/>user<sp/>all<sp/>buffers<sp/>have<sp/>played<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a9132c3be1600907f747c38d64f4a4a3e" kindref="member">streamFinishedCallback</ref><sp/>)</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a9132c3be1600907f747c38d64f4a4a3e" kindref="member">streamFinishedCallback</ref>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0d731c9d8936b9303931b5c5fbc40f7e" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a5d47c8cae02066d877bc7c670adb61ad" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>state<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ae0985c22b9f0382faede4f48cd2071ea" kindref="member">isActive</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1572"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"></highlight></codeline>
<codeline lineno="1574"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>SetUpBuffers(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesAvail<sp/>)</highlight></codeline>
<codeline lineno="1575"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"></highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>0,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>framesAvail<sp/>);</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1adba29b453fea9e5abfba02dbcb01bd09" kindref="member">PaUtil_SetInterleavedOutputChannels</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>0,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1dc65eb1e69dd6739e4dad4d74bf3785" kindref="member">PaUtil_SetOutputFrameCount</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>framesAvail<sp/>);</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"></highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1592"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"></highlight></codeline>
<codeline lineno="1601"><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*PaOSS_AudioThreadProc(<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>)</highlight></codeline>
<codeline lineno="1602"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)userData;</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesAvail<sp/>=<sp/>0,<sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>callbackResult<sp/>=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref>;</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>See<sp/>if<sp/>SNDCTL_DSP_TRIGGER<sp/>has<sp/>been<sp/>issued<sp/>already<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>initiateProcessing<sp/>=<sp/><ref refid="struct_pa_oss_stream_1abd3e8fb7cc3560fda0f0827055058915" kindref="member">triggered</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Already<sp/>triggered?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a55a005924bcfa0424594f4f65cd4ae82" kindref="member">PaStreamCallbackFlags</ref><sp/>cbFlags<sp/>=<sp/>0;<sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>might<sp/>want<sp/>to<sp/>keep<sp/>state<sp/>across<sp/>iterations<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_stream_callback_time_info" kindref="compound">PaStreamCallbackTimeInfo</ref><sp/>timeInfo<sp/>=<sp/>{0,0,0};<sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>IMPLEMENT<sp/>ME<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1611"><highlight class="normal"></highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1613"><highlight class="comment">#if<sp/>(<sp/>SOUND_VERSION<sp/>&gt;<sp/>0x030904<sp/>)</highlight></codeline>
<codeline lineno="1614"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>audio_errinfo<sp/>errinfo;</highlight></codeline>
<codeline lineno="1615"><highlight class="comment">#endif</highlight></codeline>
<codeline lineno="1616"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"></highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_cleanup_push(<sp/>&amp;<ref refid="_menus_8h_1aedcd0979dd6860e7f1a9ce54ecdd18ba" kindref="member">OnExit</ref>,<sp/>stream<sp/>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Execute<sp/>OnExit<sp/>when<sp/>exiting<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1621"><highlight class="normal"></highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>first<sp/>time<sp/>the<sp/>stream<sp/>is<sp/>started<sp/>we<sp/>use<sp/>SNDCTL_DSP_TRIGGER<sp/>to<sp/>accurately<sp/>start<sp/>capture<sp/>and</highlight></codeline>
<codeline lineno="1623"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>playback<sp/>in<sp/>sync,<sp/>when<sp/>the<sp/>stream<sp/>is<sp/>restarted<sp/>after<sp/>being<sp/>stopped<sp/>we<sp/>simply<sp/>start<sp/>by<sp/>reading/</highlight></codeline>
<codeline lineno="1624"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>writing.</highlight></codeline>
<codeline lineno="1625"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_Prepare(<sp/>stream<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"></highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>are<sp/>to<sp/>initiate<sp/>processing<sp/>implicitly<sp/>by<sp/>reading/writing<sp/>data,<sp/>we<sp/>start<sp/>off<sp/>in<sp/>blocking<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>initiateProcessing<sp/>)</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Make<sp/>sure<sp/>devices<sp/>are<sp/>in<sp/>blocking<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"></highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>1<sp/>)</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>PTHREAD_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_testcancel();</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>indefinite<sp/>waiting<sp/>on<sp/>thread<sp/>not<sp/>supporting<sp/>cancelation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Aborting<sp/>callback<sp/>thread\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>&amp;&amp;<sp/>callbackResult<sp/>==<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref><sp/>)</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Setting<sp/>callbackResult<sp/>to<sp/>paComplete\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callbackResult<sp/>=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32aa01800db52ead393d8b0016f63d76650" kindref="member">paComplete</ref>;</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Aspect<sp/>StreamState:<sp/>Because<sp/>of<sp/>the<sp/>messy<sp/>OSS<sp/>scheme<sp/>we<sp/>can&apos;t<sp/>explicitly<sp/>trigger<sp/>device<sp/>start<sp/>unless</highlight></codeline>
<codeline lineno="1656"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>stream<sp/>has<sp/>been<sp/>recently<sp/>started,<sp/>we<sp/>will<sp/>have<sp/>to<sp/>go<sp/>right<sp/>ahead<sp/>and<sp/>read/write<sp/>in<sp/>blocking</highlight></codeline>
<codeline lineno="1657"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>fashion<sp/>to<sp/>trigger<sp/>operation.<sp/>Therefore<sp/>we<sp/>begin<sp/>with<sp/>processing<sp/>one<sp/>host<sp/>buffer<sp/>before<sp/>we<sp/>switch</highlight></codeline>
<codeline lineno="1658"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>non-blocking<sp/>mode.</highlight></codeline>
<codeline lineno="1659"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!initiateProcessing<sp/>)</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Wait<sp/>on<sp/>available<sp/>frames<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_WaitForFrames(<sp/>stream,<sp/>&amp;framesAvail<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>framesAvail<sp/>%<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref><sp/>==<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesAvail<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0f4eb82448f8ed9c9fbb6637c864d61c" kindref="member">framesPerHostBuffer</ref>;</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"></highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>framesAvail<sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames<sp/>=<sp/>framesAvail;</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"></highlight></codeline>
<codeline lineno="1675"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>PTHREAD_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_testcancel();</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>)</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Setting<sp/>callbackResult<sp/>to<sp/>paComplete\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callbackResult<sp/>=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32aa01800db52ead393d8b0016f63d76650" kindref="member">paComplete</ref>;</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"></highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>indefinite<sp/>waiting<sp/>on<sp/>thread<sp/>not<sp/>supporting<sp/>cancelation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Aborting<sp/>callback<sp/>thread\n&quot;</highlight><highlight class="normal"><sp/>));</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a83fdceefb7dff41725ba4f1f13a80f79" kindref="member">PaUtil_BeginCpuLoadMeasurement</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref><sp/>);</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"></highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Read(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>,<sp/>&amp;frames<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>frames<sp/>&lt;<sp/>framesAvail<sp/>)</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>%lu<sp/>less<sp/>frames<sp/>than<sp/>requested\n&quot;</highlight><highlight class="normal">,<sp/>framesAvail<sp/>-<sp/>frames<sp/>));</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesAvail<sp/>=<sp/>frames;</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"></highlight></codeline>
<codeline lineno="1703"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>(<sp/>SOUND_VERSION<sp/>&gt;=<sp/>0x030904<sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1705"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Check<sp/>with<sp/>OSS<sp/>to<sp/>see<sp/>if<sp/>there<sp/>have<sp/>been<sp/>any<sp/>under/overruns</highlight></codeline>
<codeline lineno="1706"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>since<sp/>last<sp/>time<sp/>we<sp/>checked.</highlight></codeline>
<codeline lineno="1707"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1709"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>ioctl(<sp/>stream-&gt;deviceHandle,<sp/>SNDCTL_DSP_GETERROR,<sp/>&amp;errinfo<sp/>)<sp/>&gt;=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1710"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1711"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>errinfo.play_underruns<sp/>)</highlight></codeline>
<codeline lineno="1712"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cbFlags<sp/>|=<sp/>paOutputUnderflow<sp/>;</highlight></codeline>
<codeline lineno="1713"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>errinfo.record_underruns<sp/>)</highlight></codeline>
<codeline lineno="1714"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cbFlags<sp/>|=<sp/>paInputUnderflow<sp/>;</highlight></codeline>
<codeline lineno="1715"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1716"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="1717"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PA_DEBUG((<sp/>&quot;SNDCTL_DSP_GETERROR<sp/>command<sp/>failed:<sp/>%s\n&quot;,<sp/>strerror(<sp/>errno<sp/>)<sp/>));</highlight></codeline>
<codeline lineno="1718"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1719"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1720"><highlight class="normal"></highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1388263b1c5b765797abe767af6dbe80" kindref="member">PaUtil_BeginBufferProcessing</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>&amp;timeInfo,</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cbFlags<sp/>);</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cbFlags<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>SetUpBuffers(<sp/>stream,<sp/>framesAvail<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"></highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>=<sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>==<sp/>framesAvail<sp/>);</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a8c29cc1cf3b6fd9bf18a2c3fc9f0ef2a" kindref="member">PaUtil_EndCpuLoadMeasurement</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref>,<sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>);</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"></highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frames<sp/>=<sp/>framesAvail;</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"></highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStreamComponent_Write(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>,<sp/>&amp;frames<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>frames<sp/>&lt;<sp/>framesAvail<sp/>)</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>handle<sp/>bytesWritten<sp/>!=<sp/>bytesRequested<sp/>(slippage?)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Wrote<sp/>%lu<sp/>less<sp/>frames<sp/>than<sp/>requested\n&quot;</highlight><highlight class="normal">,<sp/>framesAvail<sp/>-<sp/>frames<sp/>));</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1742"><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesAvail<sp/>-=<sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref>;</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>+=<sp/><ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref>;</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>callbackResult<sp/>!=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref><sp/>)</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"></highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>initiateProcessing<sp/>||<sp/>!triggered<sp/>)</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Non-blocking<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>0<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>&amp;&amp;<sp/>!stream-&gt;<ref refid="struct_pa_oss_stream_1a07e910fb0e37c6edd896bb26652f2731" kindref="member">sharedDevice</ref><sp/>)</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>ModifyBlocking(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>0<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"></highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initiateProcessing<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sem_post(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" kindref="member">semaphore</ref><sp/>);</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>callbackResult<sp/>!=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref><sp/>)</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>=<sp/>callbackResult<sp/>==<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acaf141eb5d71420ffb4474da1dbd8de2" kindref="member">paAbort</ref>;</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>||<sp/><ref refid="pa__process_8c_1aa718d784f39b7daad2cc4775677c2e84" kindref="member">PaUtil_IsBufferProcessorOutputEmpty</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref><sp/>)<sp/>)</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"></highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_cleanup_pop(<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"></highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_exit(<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>);</highlight></codeline>
<codeline lineno="1774"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CloseStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1780"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"></highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"></highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1acf4e607f9c25ec2db5efd02ef1adb188" kindref="member">PaUtil_TerminateBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref><sp/>);</highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/>PaOssStream_Terminate(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"></highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1790"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StartStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1799"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"></highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ae0985c22b9f0382faede4f48cd2071ea" kindref="member">isActive</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" kindref="member">isStopped</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ab6ce13dd52a50ff036c85bddb0259859" kindref="member">lastPosPtr</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a90d0de71db73bc00497e7a2fce9c2ce4" kindref="member">lastStreamBytes</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"></highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>only<sp/>use<sp/>the<sp/>thread<sp/>for<sp/>callback<sp/>streams<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>.<ref refid="struct_pa_util_buffer_processor_1af6577f767ed4c58d5e511d125e6b1c4a" kindref="member">streamCallback</ref><sp/>)</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="pa__unix__util_8c_1a8e9b99116311cbfda679ce1d252562d4" kindref="member">PaUtil_StartThreading</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" kindref="member">threading</ref>,<sp/>&amp;PaOSS_AudioThreadProc,<sp/>stream<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sem_wait(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1ae7d78176c917f2ca1ee2fc9a55ef833e" kindref="member">semaphore</ref><sp/>);</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_Prepare(<sp/>stream<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"></highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1820"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>RealStop(<sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>abort<sp/>)</highlight></codeline>
<codeline lineno="1823"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a20a58bc0a5255b639b1ea40fce962261" kindref="member">callbackMode</ref><sp/>)</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>abort<sp/>)</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"></highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/><ref refid="pa__unix__util_8c_1a02b4c61d57c95e1ae0768cd21bf04538" kindref="member">PaUtil_CancelThreading</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1abed200ca0a101d18139b4773d41526f6" kindref="member">threading</ref>,<sp/>!abort,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"></highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1af8fd6b50f04c65318fbc6ed298cc9520" kindref="member">callbackStop</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a27bbffabcaa98b6302ffa2dbd1836f1a" kindref="member">callbackAbort</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__unix__util_8h_1a2b87696eb7e08bcdbf3abc631780fa74" kindref="member">PA_ENSURE</ref>(<sp/>PaOssStream_Stop(<sp/>stream,<sp/>abort<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"></highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" kindref="member">isStopped</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"></highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1844"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"></highlight></codeline>
<codeline lineno="1851"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StopStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1852"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>RealStop(<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*)s,<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1854"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"></highlight></codeline>
<codeline lineno="1862"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>AbortStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1863"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>RealStop(<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*)s,<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1865"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"></highlight></codeline>
<codeline lineno="1870"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamStopped(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1871"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"></highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(stream-&gt;<ref refid="struct_pa_oss_stream_1a3c19a7322bb3dc1426ee448c821724bc" kindref="member">isStopped</ref>);</highlight></codeline>
<codeline lineno="1875"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"></highlight></codeline>
<codeline lineno="1880"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamActive(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1881"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"></highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(stream-&gt;<ref refid="struct_pa_oss_stream_1ae0985c22b9f0382faede4f48cd2071ea" kindref="member">isActive</ref>);</highlight></codeline>
<codeline lineno="1885"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>GetStreamTime(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1888"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/>count_info<sp/><ref refid="lib_2expat_8h_1a20806b446e455c50dc5653b7d43e3de2" kindref="member">info</ref>;</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>delta;</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"></highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETOPTR,<sp/>&amp;info)<sp/>==<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delta<sp/>=<sp/>(<sp/>info.bytes<sp/>-<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ab6ce13dd52a50ff036c85bddb0259859" kindref="member">lastPosPtr</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>&amp;<sp/>0x000FFFFF*/</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)(stream-&gt;<ref refid="struct_pa_oss_stream_1a90d0de71db73bc00497e7a2fce9c2ce4" kindref="member">lastStreamBytes</ref><sp/>+<sp/>delta)<sp/>/<sp/>PaOssStreamComponent_FrameSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)<sp/>/<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETIPTR,<sp/>&amp;info)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delta<sp/>=<sp/>(info.bytes<sp/>-<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ab6ce13dd52a50ff036c85bddb0259859" kindref="member">lastPosPtr</ref>)<sp/></highlight><highlight class="comment">/*&amp;<sp/>0x000FFFFF*/</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)(stream-&gt;<ref refid="struct_pa_oss_stream_1a90d0de71db73bc00497e7a2fce9c2ce4" kindref="member">lastStreamBytes</ref><sp/>+<sp/>delta)<sp/>/<sp/>PaOssStreamComponent_FrameSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)<sp/>/<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"></highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>the<sp/>ioctl<sp/>failed,<sp/>but<sp/>we<sp/>can<sp/>still<sp/>give<sp/>a<sp/>coarse<sp/>estimate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1907"><highlight class="normal"></highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a3710a34d8822deb12fb6edcfc1abc6c9" kindref="member">framesProcessed</ref><sp/>/<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a43cf201ba8bace361a7c34ecf707c8cd" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1909"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"></highlight></codeline>
<codeline lineno="1911"><highlight class="normal"></highlight></codeline>
<codeline lineno="1912"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>GetStreamCpuLoad(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="1913"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"></highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__cpuload_8c_1af7bff59bbfe46a388e21633bf49ea0d6" kindref="member">PaUtil_GetCpuLoad</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1aa62961e9043374ae1517162fcdeec84d" kindref="member">cpuLoadMeasurer</ref><sp/>);</highlight></codeline>
<codeline lineno="1917"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"></highlight></codeline>
<codeline lineno="1919"><highlight class="normal"></highlight></codeline>
<codeline lineno="1920"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1921"><highlight class="comment"><sp/><sp/><sp/><sp/>As<sp/>separate<sp/>stream<sp/>interfaces<sp/>are<sp/>used<sp/>for<sp/>blocking<sp/>and<sp/>callback</highlight></codeline>
<codeline lineno="1922"><highlight class="comment"><sp/><sp/><sp/><sp/>streams,<sp/>the<sp/>following<sp/>functions<sp/>can<sp/>be<sp/>guaranteed<sp/>to<sp/>only<sp/>be<sp/>called</highlight></codeline>
<codeline lineno="1923"><highlight class="comment"><sp/><sp/><sp/><sp/>for<sp/>blocking<sp/>streams.</highlight></codeline>
<codeline lineno="1924"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1925"><highlight class="normal"></highlight></codeline>
<codeline lineno="1926"><highlight class="normal"></highlight></codeline>
<codeline lineno="1927"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core__blocking_8c_1a9e7f111c33d1e80f40473846864e84fa" kindref="member">ReadStream</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structbuffer" kindref="compound">buffer</ref>,</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames<sp/>)</highlight></codeline>
<codeline lineno="1930"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytesRequested,<sp/>bytesRead;</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesRequested;</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*userBuffer;</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"></highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>user<sp/>input<sp/>is<sp/>non-interleaved,<sp/>PaUtil_CopyInput<sp/>will<sp/>manipulate<sp/>the<sp/>channel<sp/>pointers,</highlight></codeline>
<codeline lineno="1938"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>so<sp/>we<sp/>copy<sp/>the<sp/>user<sp/>provided<sp/>pointers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>.<ref refid="struct_pa_util_buffer_processor_1a08fb4a5b71ccc3aa1893d8e6c035d192" kindref="member">userInputIsInterleaved</ref><sp/>)</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userBuffer<sp/>=<sp/><ref refid="recplay_8c_1adbbab5cb2248179d231690a1a02ff977" kindref="member">buffer</ref>;</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>Copy<sp/>channels<sp/>into<sp/>local<sp/>array<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userBuffer<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref>;</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)userBuffer,<sp/><ref refid="structbuffer" kindref="compound">buffer</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)<sp/>*<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"></highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>frames<sp/>)</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesRequested<sp/>=<sp/><ref refid="pa__unix__util_8h_1aea604351950df064043e9512ef7a222f" kindref="member">PA_MIN</ref>(<sp/>frames,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>);</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"></highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/>bytesRequested<sp/>=<sp/>framesRequested<sp/>*<sp/>PaOssStreamComponent_FrameSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>);</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>(bytesRead<sp/>=<sp/>read(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>bytesRequested<sp/>)),</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>bytesRequested<sp/>!=<sp/>bytesRead<sp/>)</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Requested<sp/>%d<sp/>bytes,<sp/>read<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>bytesRequested,<sp/>bytesRead<sp/>));</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref>;</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"></highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>);</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>0,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ad0eca03235f47de0591865f8097df4d0" kindref="member">PaUtil_CopyInput</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>&amp;userBuffer,<sp/>framesRequested<sp/>);</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/>frames<sp/>-=<sp/>framesRequested;</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="1968"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"></highlight></codeline>
<codeline lineno="1971"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core__blocking_8c_1a0cfb7772846808945bd521d23d5626eb" kindref="member">WriteStream</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structbuffer" kindref="compound">buffer</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames<sp/>)</highlight></codeline>
<codeline lineno="1972"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytesRequested,<sp/>bytesWritten;</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesConverted;</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*userBuffer;</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"></highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>user<sp/>output<sp/>is<sp/>non-interleaved,<sp/>PaUtil_CopyOutput<sp/>will<sp/>manipulate<sp/>the<sp/>channel<sp/>pointers,</highlight></codeline>
<codeline lineno="1980"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>so<sp/>we<sp/>copy<sp/>the<sp/>user<sp/>provided<sp/>pointers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>.<ref refid="struct_pa_util_buffer_processor_1a3be95f50566a88ebdc2697cde95d042e" kindref="member">userOutputIsInterleaved</ref><sp/>)</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userBuffer<sp/>=<sp/><ref refid="recplay_8c_1adbbab5cb2248179d231690a1a02ff977" kindref="member">buffer</ref>;</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Copy<sp/>channels<sp/>into<sp/>local<sp/>array<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userBuffer<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a416e24ef585da06a25b1a651c6da9154" kindref="member">userBuffers</ref>;</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)userBuffer,<sp/><ref refid="structbuffer" kindref="compound">buffer</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)<sp/>*<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a12a88cd8c43b4d70b78b8c3da9403943" kindref="member">userChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"></highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>frames<sp/>)</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1dc65eb1e69dd6739e4dad4d74bf3785" kindref="member">PaUtil_SetOutputFrameCount</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref><sp/>);</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1adba29b453fea9e5abfba02dbcb01bd09" kindref="member">PaUtil_SetInterleavedOutputChannels</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>0,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1afb06f5b856942cabc3732432503d3cb1" kindref="member">hostChannelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"></highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/>framesConverted<sp/>=<sp/><ref refid="pa__process_8c_1a61859778b9d4997a6be1de038136fcf4" kindref="member">PaUtil_CopyOutput</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_oss_stream_1a0b2602b258a473831c538c58b568a0f6" kindref="member">bufferProcessor</ref>,<sp/>&amp;userBuffer,<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/>frames<sp/>-=<sp/>framesConverted;</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"></highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/>bytesRequested<sp/>=<sp/>framesConverted<sp/>*<sp/>PaOssStreamComponent_FrameSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>);</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>(bytesWritten<sp/>=<sp/>write(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a5fc847bff7f7e76d02c5427f2d1cace9" kindref="member">buffer</ref>,<sp/>bytesRequested<sp/>)),</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"></highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>bytesRequested<sp/>!=<sp/>bytesWritten<sp/>)</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__debugprint_8h_1a6452e5dde90d9c4ef698559e3f928b17" kindref="member">PA_DEBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Requested<sp/>%d<sp/>bytes,<sp/>wrote<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>bytesRequested,<sp/>bytesWritten<sp/>));</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref>;</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"></highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2011"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"></highlight></codeline>
<codeline lineno="2013"><highlight class="normal"></highlight></codeline>
<codeline lineno="2014"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">signed</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__blocking_8c_1a82aa1e30985c7924247e8f45fc356d46" kindref="member">GetStreamReadAvailable</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2015"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/>audio_buf_info<sp/><ref refid="lib_2expat_8h_1a20806b446e455c50dc5653b7d43e3de2" kindref="member">info</ref>;</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"></highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETISPACE,<sp/>&amp;info<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>info.fragments<sp/>*<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1af1038464cf9b2905e8024479ae79958e" kindref="member">hostFrames</ref>;</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"></highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2025"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"></highlight></codeline>
<codeline lineno="2027"><highlight class="normal"></highlight></codeline>
<codeline lineno="2028"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TODO:<sp/>Compute<sp/>number<sp/>of<sp/>allocated<sp/>bytes<sp/>somewhere<sp/>else,<sp/>can<sp/>we<sp/>use<sp/>ODELAY<sp/>with<sp/>capture<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2029"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">signed</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__blocking_8c_1ad7ee6bd74b3109101f1eb4ca0514c8b0" kindref="member">GetStreamWriteAvailable</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2030"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>delay<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>SNDCTL_DSP_GETODELAY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__unix__oss_8c_1af6598be0b460d5228f0c6f386d9bf306" kindref="member">ENSURE_</ref>(<sp/>ioctl(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a8d09b328d855276bb629abc1d072f9ae" kindref="member">fd</ref>,<sp/>SNDCTL_DSP_GETODELAY,<sp/>&amp;delay<sp/>),<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref><sp/>);</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(PaOssStreamComponent_BufferSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)<sp/>-<sp/>delay)<sp/>/<sp/>PaOssStreamComponent_FrameSize(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>);</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Conditionally<sp/>compile<sp/>this<sp/>to<sp/>avoid<sp/>warning<sp/>about<sp/>unused<sp/>label<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2040"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>SNDCTL_DSP_GETODELAY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2045"><highlight class="normal"></highlight></codeline>
<codeline lineno="2046" refid="pa__unix__oss_8c_1a04ef585326928abf290637297eb595cc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="pa__unix__oss_8c_1a04ef585326928abf290637297eb595cc" kindref="member">PaOSS_GetStreamInputDevice</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2047"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref><sp/>)</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1a8f72686fa2b8f688bb41363c6dcf097c" kindref="member">capture</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a4fdcd3579fbc2db73c4db6e0f5b2a5ad" kindref="member">devName</ref>;</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2056"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"></highlight></codeline>
<codeline lineno="2058" refid="pa__unix__oss_8c_1a6ff7dc5b755a20f07c8ff7d5151e205d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="pa__unix__oss_8c_1a6ff7dc5b755a20f07c8ff7d5151e205d" kindref="member">PaOSS_GetStreamOutputDevice</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2059"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_oss_stream" kindref="compound">PaOssStream</ref>*)s;</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"></highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref><sp/>)</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream-&gt;<ref refid="struct_pa_oss_stream_1ad0a29997c2144457023c2557357418fd" kindref="member">playback</ref>-&gt;<ref refid="struct_pa_oss_stream_component_1a4fdcd3579fbc2db73c4db6e0f5b2a5ad" kindref="member">devName</ref>;</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"></highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2068"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/oss/pa_unix_oss.c"/>
  </compounddef>
</doxygen>
