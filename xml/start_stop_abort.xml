<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="start_stop_abort" kind="page">
    <compoundname>start_stop_abort</compoundname>
    <title>Starting, Stopping and Aborting a Stream</title>
    <detaileddescription>
<sect1 id="start_stop_abort_1tut_startstop1">
<title>Starting, Stopping and Aborting a Stream</title>
<para>PortAudio will not start playing back audio until you start the stream. After calling <ref refid="portaudio_8h_1a7432aadd26c40452da12fa99fc1a047b" kindref="member">Pa_StartStream()</ref>, PortAudio will start calling your callback function to perform the audio processing.</para><para><programlisting><codeline><highlight class="normal">err<sp/>=<sp/>Pa_StartStream(<sp/>stream<sp/>);</highlight></codeline>
<codeline><highlight class="normal">if(<sp/>err<sp/>!=<sp/>paNoError<sp/>)<sp/>goto<sp/>error;</highlight></codeline>
</programlisting></para><para>You can communicate with your callback routine through the data structure you passed in on the open call, or through global variables, or using other interprocess communication techniques, but please be aware that your callback function may be called at interrupt time when your foreground process is least expecting it. So avoid sharing complex data structures that are easily corrupted like double linked lists, and avoid using locks such as mutexs as this may cause your callback function to block and therefore drop audio. Such techniques may even cause deadlock on some platforms.</para><para>PortAudio will continue to call your callback and process audio until you stop the stream. This can be done in one of several ways, but, before we do so, we&apos;ll want to see that some of our audio gets processed by sleeping for a few seconds. This is easy to do with <ref refid="portaudio_8h_1a1b3c20044c9401c42add29475636e83d" kindref="member">Pa_Sleep()</ref>, which is used by many of the examples in the patests/ directory for exactly this purpose. Note that, for a variety of reasons, you can not rely on this function for accurate scheduling, so your stream may not run for exactly the same amount of time as you expect, but it&apos;s good enough for our example.</para><para><programlisting><codeline><highlight class="normal">/*<sp/>Sleep<sp/>for<sp/>several<sp/>seconds.<sp/>*/</highlight></codeline>
<codeline><highlight class="normal">Pa_Sleep(NUM_SECONDS*1000);</highlight></codeline>
</programlisting></para><para>Now we need to stop playback. There are several ways to do this, the simplest of which is to call <ref refid="portaudio_8h_1af18dd60220251286c337631a855e38a0" kindref="member">Pa_StopStream()</ref>:</para><para><programlisting><codeline><highlight class="normal">err<sp/>=<sp/>Pa_StopStream(<sp/>stream<sp/>);</highlight></codeline>
<codeline><highlight class="normal">if(<sp/>err<sp/>!=<sp/>paNoError<sp/>)<sp/>goto<sp/>error;</highlight></codeline>
</programlisting></para><para><ref refid="portaudio_8h_1af18dd60220251286c337631a855e38a0" kindref="member">Pa_StopStream()</ref> is designed to make sure that the buffers you&apos;ve processed in your callback are all played, which may cause some delay. Alternatively, you could call <ref refid="portaudio_8h_1a138e57abde4e833c457b64895f638a25" kindref="member">Pa_AbortStream()</ref>. On some platforms, aborting the stream is much faster and may cause some data processed by your callback not to be played.</para><para>Another way to stop the stream is to return either paComplete, or paAbort from your callback. paComplete ensures that the last buffer is played whereas paAbort stops the stream as soon as possible. If you stop the stream using this technique, you will need to call <ref refid="portaudio_8h_1af18dd60220251286c337631a855e38a0" kindref="member">Pa_StopStream()</ref> before starting the stream again.</para><para>Previous: <ref refid="open_default_stream" kindref="compound">Opening a Stream Using Defaults</ref> | Next: <ref refid="terminating_portaudio" kindref="compound">Closing a Stream and Terminating PortAudio</ref> </para></sect1>
    </detaileddescription>
  </compounddef>
</doxygen>
