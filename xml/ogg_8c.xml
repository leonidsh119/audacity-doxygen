<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="ogg_8c" kind="file" language="C++">
    <compoundname>ogg.c</compoundname>
    <includes refid="sfconfig_8h" local="yes">sfconfig.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">fcntl.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">ctype.h</includes>
    <includes local="no">time.h</includes>
    <includes local="no">math.h</includes>
    <includes local="yes">sndfile.h</includes>
    <includes refid="sfendian_8h" local="yes">sfendian.h</includes>
    <includes refid="libsndfile_2src_2common_8h" local="yes">common.h</includes>
    <incdepgraph>
      <node id="19958">
        <label>sfendian.h</label>
        <link refid="sfendian_8h"/>
        <childnode refid="19949" relation="include">
        </childnode>
      </node>
      <node id="19948">
        <label>C:/_dev/OpenU/Audacity/audacity/lib-src/libsndfile/src/ogg.c</label>
        <link refid="ogg.c"/>
        <childnode refid="19949" relation="include">
        </childnode>
        <childnode refid="19951" relation="include">
        </childnode>
        <childnode refid="19952" relation="include">
        </childnode>
        <childnode refid="19953" relation="include">
        </childnode>
        <childnode refid="19954" relation="include">
        </childnode>
        <childnode refid="19955" relation="include">
        </childnode>
        <childnode refid="19956" relation="include">
        </childnode>
        <childnode refid="19957" relation="include">
        </childnode>
        <childnode refid="19958" relation="include">
        </childnode>
        <childnode refid="19959" relation="include">
        </childnode>
      </node>
      <node id="19960">
        <label>stdlib.h</label>
      </node>
      <node id="19952">
        <label>fcntl.h</label>
      </node>
      <node id="19957">
        <label>sndfile.h</label>
      </node>
      <node id="19953">
        <label>string.h</label>
      </node>
      <node id="19949">
        <label>sfconfig.h</label>
        <link refid="sfconfig_8h"/>
        <childnode refid="19950" relation="include">
        </childnode>
      </node>
      <node id="19959">
        <label>common.h</label>
        <link refid="libsndfile_2src_2common_8h"/>
        <childnode refid="19949" relation="include">
        </childnode>
        <childnode refid="19960" relation="include">
        </childnode>
        <childnode refid="19953" relation="include">
        </childnode>
        <childnode refid="19957" relation="include">
        </childnode>
      </node>
      <node id="19955">
        <label>time.h</label>
      </node>
      <node id="19956">
        <label>math.h</label>
      </node>
      <node id="19954">
        <label>ctype.h</label>
      </node>
      <node id="19950">
        <label>config.h</label>
      </node>
      <node id="19951">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="ogg_8c_1a30f411702a560189e5545dd902ba4c48" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>int ogg_open</definition>
        <argsstring>(SF_PRIVATE *psf)</argsstring>
        <name>ogg_open</name>
        <param>
          <type><ref refid="libsndfile_2src_2common_8h_1ab5debd339ecaf40f50a223e218900c24" kindref="member">SF_PRIVATE</ref> *</type>
          <declname>psf</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libsndfile/src/ogg.c" line="1188" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/libsndfile/src/ogg.c" bodystart="1188" bodyend="1192"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment">**<sp/>Copyright<sp/>(C)<sp/>2002-2011<sp/>Erik<sp/>de<sp/>Castro<sp/>Lopo<sp/>&lt;erikd@mega-nerd.com&gt;</highlight></codeline>
<codeline lineno="3"><highlight class="comment">**<sp/>Copyright<sp/>(C)<sp/>2007<sp/>John<sp/>ffitch</highlight></codeline>
<codeline lineno="4"><highlight class="comment">**</highlight></codeline>
<codeline lineno="5"><highlight class="comment">**<sp/>This<sp/>program<sp/>is<sp/>free<sp/>software<sp/>;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="6"><highlight class="comment">**<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="7"><highlight class="comment">**<sp/>the<sp/>Free<sp/>Software<sp/>Foundation<sp/>;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or</highlight></codeline>
<codeline lineno="8"><highlight class="comment">**<sp/>(at<sp/>your<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="9"><highlight class="comment">**</highlight></codeline>
<codeline lineno="10"><highlight class="comment">**<sp/>This<sp/>program<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,</highlight></codeline>
<codeline lineno="11"><highlight class="comment">**<sp/>but<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY<sp/>;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of</highlight></codeline>
<codeline lineno="12"><highlight class="comment">**<sp/>MERCHANTABILITY<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the</highlight></codeline>
<codeline lineno="13"><highlight class="comment">**<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="14"><highlight class="comment">**</highlight></codeline>
<codeline lineno="15"><highlight class="comment">**<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="16"><highlight class="comment">**<sp/>along<sp/>with<sp/>this<sp/>program<sp/>;<sp/>if<sp/>not,<sp/>write<sp/>to<sp/>the<sp/>Free<sp/>Software</highlight></codeline>
<codeline lineno="17"><highlight class="comment">**<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="18"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="21"><highlight class="comment">**<sp/><sp/>Much<sp/>of<sp/>this<sp/>code<sp/>is<sp/>based<sp/>on<sp/>the<sp/>examples<sp/>in<sp/>libvorbis<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="22"><highlight class="comment">**<sp/>XIPHOPHORUS<sp/>Company<sp/>http://www.xiph.org/<sp/>which<sp/>has<sp/>a<sp/>BSD-style<sp/>Licence</highlight></codeline>
<codeline lineno="23"><highlight class="comment">**<sp/>Copyright<sp/>(c)<sp/>2002,<sp/>Xiph.org<sp/>Foundation</highlight></codeline>
<codeline lineno="24"><highlight class="comment">**</highlight></codeline>
<codeline lineno="25"><highlight class="comment">**<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="26"><highlight class="comment">**<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="27"><highlight class="comment">**<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="28"><highlight class="comment">**</highlight></codeline>
<codeline lineno="29"><highlight class="comment">**<sp/>-<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="30"><highlight class="comment">**<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="31"><highlight class="comment">**</highlight></codeline>
<codeline lineno="32"><highlight class="comment">**<sp/>-<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="33"><highlight class="comment">**<sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="34"><highlight class="comment">**<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="35"><highlight class="comment">**</highlight></codeline>
<codeline lineno="36"><highlight class="comment">**<sp/>-<sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>the<sp/>Xiph.org<sp/>Foundation<sp/>nor<sp/>the<sp/>names<sp/>of<sp/>its</highlight></codeline>
<codeline lineno="37"><highlight class="comment">**<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived<sp/>from</highlight></codeline>
<codeline lineno="38"><highlight class="comment">**<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="39"><highlight class="comment">**</highlight></codeline>
<codeline lineno="40"><highlight class="comment">**<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS</highlight></codeline>
<codeline lineno="41"><highlight class="comment">**<sp/>``AS<sp/>IS&apos;&apos;<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT</highlight></codeline>
<codeline lineno="42"><highlight class="comment">**<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR</highlight></codeline>
<codeline lineno="43"><highlight class="comment">**<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/><sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>FOUNDATION</highlight></codeline>
<codeline lineno="44"><highlight class="comment">**<sp/>OR<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,</highlight></codeline>
<codeline lineno="45"><highlight class="comment">**<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT</highlight></codeline>
<codeline lineno="46"><highlight class="comment">**<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES<sp/>;<sp/>LOSS<sp/>OF<sp/>USE,</highlight></codeline>
<codeline lineno="47"><highlight class="comment">**<sp/>DATA,<sp/>OR<sp/>PROFITS<sp/>;<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY</highlight></codeline>
<codeline lineno="48"><highlight class="comment">**<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT</highlight></codeline>
<codeline lineno="49"><highlight class="comment">**<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE</highlight></codeline>
<codeline lineno="50"><highlight class="comment">**<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="51"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="sfconfig_8h" kindref="compound">sfconfig.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;fcntl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;ctype.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;time.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>HAVE_UNISTD_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;sndfile.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="sfendian_8h" kindref="compound">sfendian.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="libsndfile_2src_2common_8h" kindref="compound">common.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>HAVE_EXTERNAL_LIBS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="codec_8h" kindref="compound">vorbis/codec.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="vorbisenc_8h" kindref="compound">vorbis/vorbisenc.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>convert_func<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**)<sp/>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/>ogg_read_header<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>log_data)<sp/>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/>ogg_write_header<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>calc_length)<sp/>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/>ogg_close<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)<sp/>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/>ogg_command<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>command,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>datasize)<sp/>;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_seek<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mode,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="layer12_8c_1a33d71f23ba2052d17f0b754dc35265b0" kindref="member">offset</ref>)<sp/>;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_read_s<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_read_i<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_read_f<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_read_d<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_write_s<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_write_i<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_write_f<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_write_d<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>)<sp/>;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_read_sample<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens,<sp/>convert_func<sp/>*transfn)<sp/>;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><sp/><sp/>ogg_length<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)<sp/>;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>id<sp/>;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref><sp/>;</highlight></codeline>
<codeline lineno="96"><highlight class="normal">}<sp/>STR_PAIRS<sp/>;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>STR_PAIRS<sp/>vorbis_metatypes<sp/>[]<sp/>=</highlight></codeline>
<codeline lineno="99"><highlight class="normal">{<sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5acc0345590e46aa4c2ebd284d7becde48" kindref="member">SF_STR_TITLE</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Title&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5ae5237fd1a51b6b513310778f32293346" kindref="member">SF_STR_COPYRIGHT</ref>,<sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Copyright&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a9c72b262cab1903924fad40d5d8bcee3" kindref="member">SF_STR_SOFTWARE</ref>,<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Software&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5aa22c34098bd0d323df315e78e027ea57" kindref="member">SF_STR_ARTIST</ref>,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Artist&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a83960dedfa2ca567c41bf74678842952" kindref="member">SF_STR_COMMENT</ref>,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Comment&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a3f5015b5e35ec5cd9b6c41a871b1f2eb" kindref="member">SF_STR_DATE</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Date&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5acf734a9551356927a5a4866ac0a6d434" kindref="member">SF_STR_ALBUM</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Album&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a0374c0f8282517ebf72f96732a6de00a" kindref="member">SF_STR_LICENSE</ref>,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;License&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5af97622810c6cc69643e7a9dc276a0867" kindref="member">SF_STR_TRACKNUMBER</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Tracknumber&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a8b4856d636025a844feb8adf89af1403" kindref="member">SF_STR_GENRE</ref>,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Genre&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="109"><highlight class="normal">}<sp/>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sync<sp/>and<sp/>verify<sp/>incoming<sp/>physical<sp/>bitstream<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__sync__state" kindref="compound">ogg_sync_state</ref><sp/>oy<sp/>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Take<sp/>physical<sp/>pages,<sp/>weld<sp/>into<sp/>a<sp/>logical<sp/>stream<sp/>of<sp/>packets<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__stream__state" kindref="compound">ogg_stream_state</ref><sp/>os<sp/>;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>One<sp/>Ogg<sp/>bitstream<sp/>page.<sp/><sp/>Vorbis<sp/>packets<sp/>are<sp/>inside<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__page" kindref="compound">ogg_page</ref><sp/>og<sp/>;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>One<sp/>raw<sp/>packet<sp/>of<sp/>data<sp/>for<sp/>decode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>op<sp/>;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>eos<sp/>;</highlight></codeline>
<codeline lineno="121"><highlight class="normal">}<sp/>OGG_PRIVATE<sp/>;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Count<sp/>current<sp/>location<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>loc<sp/>;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Struct<sp/>that<sp/>stores<sp/>all<sp/>the<sp/>static<sp/>vorbis<sp/>bitstream<sp/>settings<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__info" kindref="compound">vorbis_info</ref><sp/>vi<sp/>;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Struct<sp/>that<sp/>stores<sp/>all<sp/>the<sp/>bitstream<sp/>user<sp/>comments<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__comment" kindref="compound">vorbis_comment</ref><sp/>vc<sp/>;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ventral<sp/>working<sp/>state<sp/>for<sp/>the<sp/>packet-&gt;PCM<sp/>decoder<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__dsp__state" kindref="compound">vorbis_dsp_state</ref><sp/>vd<sp/>;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Local<sp/>working<sp/>space<sp/>for<sp/>packet-&gt;PCM<sp/>decode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__block" kindref="compound">vorbis_block</ref><sp/>vb<sp/>;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Encoding<sp/>quality<sp/>in<sp/>range<sp/>[0.0,<sp/>1.0].<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>quality<sp/>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal">}<sp/>VORBIS_PRIVATE<sp/>;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal">ogg_read_header<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>log_data)</highlight></codeline>
<codeline lineno="141"><highlight class="normal">{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="recplay_8c_1adbbab5cb2248179d231690a1a02ff977" kindref="member">buffer</ref><sp/>;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/>bytes<sp/>;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/>nn<sp/>;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>odata-&gt;eos<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Weird<sp/>stuff<sp/>happens<sp/>if<sp/>these<sp/>aren&apos;t<sp/>called.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a675ce59aae7b53cba0ed6a8bf913ae98" kindref="member">ogg_stream_reset</ref><sp/>(&amp;odata-&gt;os)<sp/>;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1aac95c26af4c17a724fe8c574fb7d04ec" kindref="member">ogg_sync_reset</ref><sp/>(&amp;odata-&gt;oy)<sp/>;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Grab<sp/>some<sp/>data<sp/>at<sp/>the<sp/>head<sp/>of<sp/>the<sp/>stream.<sp/><sp/>We<sp/>want<sp/>the<sp/>first<sp/>page</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>(which<sp/>is<sp/>guaranteed<sp/>to<sp/>be<sp/>small<sp/>and<sp/>only<sp/>contain<sp/>the<sp/>Vorbis</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>stream<sp/>initial<sp/>header)<sp/>We<sp/>need<sp/>the<sp/>first<sp/>page<sp/>to<sp/>get<sp/>the<sp/>stream</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>serialno.</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Expose<sp/>the<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>buffer<sp/>=<sp/><ref refid="ogg_8h_1a699610803ac0cd2cc36224e57e7f783c" kindref="member">ogg_sync_buffer</ref><sp/>(&amp;odata-&gt;oy,<sp/>4096L)<sp/>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Grab<sp/>the<sp/>part<sp/>of<sp/>the<sp/>header<sp/>that<sp/>has<sp/>already<sp/>been<sp/>read.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy<sp/>(buffer,<sp/>psf-&gt;<ref refid="structsf__private__tag_1a0cf96c0a7464d4333f992bdb5b0034c4" kindref="member">header</ref>,<sp/>psf-&gt;<ref refid="structsf__private__tag_1a45506b1c2fefbd78e955364b7664a820" kindref="member">headindex</ref>)<sp/>;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>bytes<sp/>=<sp/>psf-&gt;<ref refid="structsf__private__tag_1a45506b1c2fefbd78e955364b7664a820" kindref="member">headindex</ref><sp/>;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Submit<sp/>a<sp/>4k<sp/>block<sp/>to<sp/>libvorbis&apos;<sp/>Ogg<sp/>layer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>bytes<sp/>+=<sp/><ref refid="libsndfile_2src_2common_8h_1a16c707d5a2175650aacd6b9cbdfe0f85" kindref="member">psf_fread</ref><sp/>(buffer<sp/>+<sp/>psf-&gt;<ref refid="structsf__private__tag_1a45506b1c2fefbd78e955364b7664a820" kindref="member">headindex</ref>,<sp/>1,<sp/>4096<sp/>-<sp/>psf-&gt;<ref refid="structsf__private__tag_1a45506b1c2fefbd78e955364b7664a820" kindref="member">headindex</ref>,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abd197a9cda5a6cec788c65c79530e20d" kindref="member">ogg_sync_wrote</ref><sp/>(&amp;odata-&gt;oy,<sp/>bytes)<sp/>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>first<sp/>page.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((nn<sp/>=<sp/><ref refid="ogg_8h_1abcb8ea90cec5a3e5bb19686432c11da6" kindref="member">ogg_sync_pageout</ref><sp/>(&amp;odata-&gt;oy,<sp/>&amp;odata-&gt;og))<sp/>!=<sp/>1)</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Have<sp/>we<sp/>simply<sp/>run<sp/>out<sp/>of<sp/>data?<sp/><sp/>If<sp/>so,<sp/>we&apos;re<sp/>done.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bytes<sp/>&lt;<sp/>4096)</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Error<sp/>case.<sp/><sp/>Must<sp/>not<sp/>be<sp/>Vorbis<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Input<sp/>does<sp/>not<sp/>appear<sp/>to<sp/>be<sp/>an<sp/>Ogg<sp/>bitstream.\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Get<sp/>the<sp/>serial<sp/>number<sp/>and<sp/>set<sp/>up<sp/>the<sp/>rest<sp/>of<sp/>decode.</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Serialno<sp/>first<sp/>;<sp/>use<sp/>it<sp/>to<sp/>set<sp/>up<sp/>a<sp/>logical<sp/>stream.</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a305dff20a5476305be61e46f6b34d4e1" kindref="member">ogg_stream_clear</ref><sp/>(&amp;odata-&gt;os)<sp/>;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abbbbea9bc3d14e9aff39582854d96d94" kindref="member">ogg_stream_init</ref><sp/>(&amp;odata-&gt;os,<sp/><ref refid="ogg_8h_1a6194aa97806e93b0889a3b376c7ceb8f" kindref="member">ogg_page_serialno</ref><sp/>(&amp;odata-&gt;og))<sp/>;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>This<sp/>function<sp/>(ogg_read_header)<sp/>gets<sp/>called<sp/>multiple<sp/>times,<sp/>so<sp/>the<sp/>OGG</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>and<sp/>vorbis<sp/>structs<sp/>have<sp/>to<sp/>be<sp/>cleared<sp/>every<sp/>time<sp/>we<sp/>pass<sp/>through<sp/>to</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>prevent<sp/>memory<sp/>leaks.</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a6a89cd06e8119b22a2d6a565e2d92c4e" kindref="member">vorbis_block_clear</ref><sp/>(&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a3af19007415290a3f237e9a821bfe616" kindref="member">vorbis_dsp_clear</ref><sp/>(&amp;vdata-&gt;vd)<sp/>;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a2fd38dcf146b850e88f281978b580d3e" kindref="member">vorbis_comment_clear</ref><sp/>(&amp;vdata-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1abaf171c1341b23e1c2eed7dab00d9f4a" kindref="member">vorbis_info_clear</ref><sp/>(&amp;vdata-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Extract<sp/>the<sp/>initial<sp/>header<sp/>from<sp/>the<sp/>first<sp/>page<sp/>and<sp/>verify<sp/>that<sp/>the</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Ogg<sp/>bitstream<sp/>is<sp/>in<sp/>fact<sp/>Vorbis<sp/>data.</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/><sp/><sp/><sp/>**</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>I<sp/>handle<sp/>the<sp/>initial<sp/>header<sp/>first<sp/>instead<sp/>of<sp/>just<sp/>having<sp/>the<sp/>code</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>read<sp/>all<sp/>three<sp/>Vorbis<sp/>headers<sp/>at<sp/>once<sp/>because<sp/>reading<sp/>the<sp/>initial</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>header<sp/>is<sp/>an<sp/>easy<sp/>way<sp/>to<sp/>identify<sp/>a<sp/>Vorbis<sp/>bitstream<sp/>and<sp/>it&apos;s</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>useful<sp/>to<sp/>see<sp/>that<sp/>functionality<sp/>seperated<sp/>out.</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1af0ed4e74fe68802c7d337a2645e759d6" kindref="member">vorbis_info_init</ref><sp/>(&amp;vdata-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a0bab2093941e2bb89651d62ca5997676" kindref="member">vorbis_comment_init</ref><sp/>(&amp;vdata-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1a60db38b6032f1fb0729e14adb61f11a2" kindref="member">ogg_stream_pagein</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Error<sp/>;<sp/>stream<sp/>version<sp/>mismatch<sp/>perhaps.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>reading<sp/>first<sp/>page<sp/>of<sp/>Ogg<sp/>bitstream<sp/>data\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;op)<sp/>!=<sp/>1)</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>page?<sp/>must<sp/>not<sp/>be<sp/>vorbis.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>reading<sp/>initial<sp/>header<sp/>packet.\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1af1192fabbd28f89d048de1b381463219" kindref="member">vorbis_synthesis_headerin</ref><sp/>(&amp;vdata-&gt;vi,<sp/>&amp;vdata-&gt;vc,<sp/>&amp;odata-&gt;op)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Error<sp/>case<sp/>;<sp/>not<sp/>a<sp/>vorbis<sp/>header.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;This<sp/>Ogg<sp/>bitstream<sp/>does<sp/>not<sp/>contain<sp/>Vorbis<sp/>audio<sp/>data.\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="232"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Common<sp/>Ogg<sp/>metadata<sp/>fields?</highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>TITLE,<sp/>VERSION,<sp/>ALBUM,<sp/>TRACKNUMBER,<sp/>ARTIST,<sp/>PERFORMER,<sp/>COPYRIGHT,<sp/>LICENSE,</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>ORGANIZATION,<sp/>DESCRIPTION,<sp/>GENRE,<sp/>DATE,<sp/>LOCATION,<sp/>CONTACT,<sp/>ISRC,</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(log_data)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="rfft2d_test_m_l_8m_1adc468c70fb574ebd07287b38d0d0676d" kindref="member">k</ref><sp/>;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>0<sp/>;<sp/>k<sp/>&lt;<sp/><ref refid="libsndfile_2programs_2common_8h_1a841615a63f4a3aa18337897953874909" kindref="member">ARRAY_LEN</ref><sp/>(vorbis_metatypes)<sp/>;<sp/>k++)</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*dd<sp/>;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dd<sp/>=<sp/><ref refid="codec_8h_1a469806c950230e3058c9f8d8b8f4381b" kindref="member">vorbis_comment_query</ref><sp/>(&amp;vdata-&gt;vc,<sp/>vorbis_metatypes<sp/>[k].name,<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dd<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1ad9838e85f6a708472d626b17b0b892a6" kindref="member">psf_store_string</ref><sp/>(psf,<sp/>vorbis_metatypes<sp/>[k].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>dd)<sp/>;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>At<sp/>this<sp/>point,<sp/>we&apos;re<sp/>sure<sp/>we&apos;re<sp/>Vorbis.<sp/>We&apos;ve<sp/>set<sp/>up<sp/>the<sp/>logical<sp/>(Ogg)</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>bitstream<sp/>decoder.<sp/>Get<sp/>the<sp/>comment<sp/>and<sp/>codebook<sp/>headers<sp/>and<sp/>set<sp/>up<sp/>the</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Vorbis<sp/>decoder.</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/><sp/><sp/><sp/>**</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>The<sp/>next<sp/>two<sp/>packets<sp/>in<sp/>order<sp/>are<sp/>the<sp/>comment<sp/>and<sp/>codebook<sp/>headers.</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>They&apos;re<sp/>likely<sp/>large<sp/>and<sp/>may<sp/>span<sp/>multiple<sp/>pages.<sp/><sp/>Thus<sp/>we<sp/>reead</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>and<sp/>submit<sp/>data<sp/>until<sp/>we<sp/>get<sp/>our<sp/>two<sp/>pacakets,<sp/>watching<sp/>that<sp/>no</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>pages<sp/>are<sp/>missing.<sp/><sp/>If<sp/>a<sp/>page<sp/>is<sp/>missing,<sp/>error<sp/>out<sp/>;<sp/>losing<sp/>a</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>header<sp/>page<sp/>is<sp/>the<sp/>only<sp/>place<sp/>where<sp/>missing<sp/>data<sp/>is<sp/>fatal.</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0<sp/>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Count<sp/>of<sp/>number<sp/>of<sp/>packets<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1abcb8ea90cec5a3e5bb19686432c11da6" kindref="member">ogg_sync_pageout</ref><sp/>(&amp;odata-&gt;oy,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Need<sp/>more<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>=<sp/><ref refid="ogg_8h_1a699610803ac0cd2cc36224e57e7f783c" kindref="member">ogg_sync_buffer</ref><sp/>(&amp;odata-&gt;oy,<sp/>4096)<sp/>;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bytes<sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a16c707d5a2175650aacd6b9cbdfe0f85" kindref="member">psf_fread</ref><sp/>(buffer,<sp/>1,<sp/>4096,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bytes<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;End<sp/>of<sp/>file<sp/>before<sp/>finding<sp/>all<sp/>Vorbis<sp/>headers!\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nn<sp/>=<sp/><ref refid="ogg_8h_1abd197a9cda5a6cec788c65c79530e20d" kindref="member">ogg_sync_wrote</ref><sp/>(&amp;odata-&gt;oy,<sp/>bytes)<sp/>;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>Don&apos;t<sp/>complain<sp/>about<sp/>missing<sp/>or<sp/>corrupt<sp/>data<sp/>yet.<sp/>We&apos;ll</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>catch<sp/>it<sp/>at<sp/>the<sp/>packet<sp/>output<sp/>phase.</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>We<sp/>can<sp/>ignore<sp/>any<sp/>errors<sp/>here<sp/>as<sp/>they&apos;ll<sp/>also<sp/>become<sp/>apparent</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>at<sp/>packetout.</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nn<sp/>=<sp/><ref refid="ogg_8h_1a60db38b6032f1fb0729e14adb61f11a2" kindref="member">ogg_stream_pagein</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;op)<sp/>;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>Uh<sp/>oh<sp/>;<sp/>data<sp/>at<sp/>some<sp/>point<sp/>was<sp/>corrupted<sp/>or<sp/>missing!</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>We<sp/>can&apos;t<sp/>tolerate<sp/>that<sp/>in<sp/>a<sp/>header.<sp/>Die.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Corrupt<sp/>secondary<sp/>header.<sp/>Exiting.\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a5cd648cc23797459a9951874c1eb282c" kindref="member">SFE_MALFORMED_FILE</ref><sp/>;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1af1192fabbd28f89d048de1b381463219" kindref="member">vorbis_synthesis_headerin</ref><sp/>(&amp;vdata-&gt;vi,<sp/>&amp;vdata-&gt;vc,<sp/>&amp;odata-&gt;op)<sp/>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i++<sp/>;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(log_data)</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>printed_metadata_msg<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="rfft2d_test_m_l_8m_1adc468c70fb574ebd07287b38d0d0676d" kindref="member">k</ref><sp/>;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;\nBitstream<sp/>is<sp/>%d<sp/>channel,<sp/>%D<sp/>Hz\n&quot;</highlight><highlight class="normal">,<sp/>vdata-&gt;vi.channels,<sp/>vdata-&gt;vi.rate)<sp/>;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Encoded<sp/>by:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>vdata-&gt;vc.vendor)<sp/>;</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Throw<sp/>the<sp/>comments<sp/>plus<sp/>a<sp/>few<sp/>lines<sp/>about<sp/>the<sp/>bitstream<sp/>we&apos;re<sp/>decoding.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>0<sp/>;<sp/>k<sp/>&lt;<sp/><ref refid="libsndfile_2programs_2common_8h_1a841615a63f4a3aa18337897953874909" kindref="member">ARRAY_LEN</ref><sp/>(vorbis_metatypes)<sp/>;<sp/>k++)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*dd<sp/>;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dd<sp/>=<sp/><ref refid="codec_8h_1a469806c950230e3058c9f8d8b8f4381b" kindref="member">vorbis_comment_query</ref><sp/>(&amp;vdata-&gt;vc,<sp/>vorbis_metatypes<sp/>[k].name,<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dd<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(printed_metadata_msg<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Metadata<sp/>:\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printed_metadata_msg<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1ad9838e85f6a708472d626b17b0b892a6" kindref="member">psf_store_string</ref><sp/>(psf,<sp/>vorbis_metatypes<sp/>[k].</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>dd)<sp/>;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>%-10s<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>vorbis_metatypes<sp/>[k].<ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref>,<sp/>dd)<sp/>;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;End\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1acfd248e20ab1c58b57aafc7b16404a5f" kindref="member">samplerate</ref><sp/><sp/>=<sp/>vdata-&gt;vi.rate<sp/>;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/><sp/><sp/><sp/>=<sp/>vdata-&gt;vi.channels<sp/>;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1a36a7c3ae9a8229797f19267b4ba07361" kindref="member">format</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1ac6bea760bc75e449a80b8cc28bf9a2feaaaef1f7e663487eefbe4106de44ea7fd" kindref="member">SF_FORMAT_OGG</ref><sp/>|<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1ac6bea760bc75e449a80b8cc28bf9a2fea029114057a7956f3c94ae18d269faf61" kindref="member">SF_FORMAT_VORBIS</ref><sp/>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>OK,<sp/>got<sp/>and<sp/>parsed<sp/>all<sp/>three<sp/>headers.<sp/>Initialize<sp/>the<sp/>Vorbis</highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>packet-&gt;PCM<sp/>decoder.</highlight></codeline>
<codeline lineno="335"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Central<sp/>decode<sp/>state.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a44bb00553295f2a9088e169cf4a3eb07" kindref="member">vorbis_synthesis_init</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>Local<sp/>state<sp/>for<sp/>most<sp/>of<sp/>the<sp/>decode<sp/>so<sp/>multiple<sp/>block<sp/>decodes<sp/>can</highlight></codeline>
<codeline lineno="339"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>proceed<sp/>in<sp/>parallel.<sp/>We<sp/>could<sp/>init<sp/>multiple<sp/>vorbis_block<sp/>structures</highlight></codeline>
<codeline lineno="340"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>for<sp/>vd<sp/>here.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1ab6d85544ab746e98fc63308f6bed27a0" kindref="member">vorbis_block_init</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>vdata-&gt;loc<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="346"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal">ogg_write_header<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a86d500a34c624c2cae56bc25a31b12f3" kindref="member">UNUSED</ref><sp/>(calc_length))</highlight></codeline>
<codeline lineno="350"><highlight class="normal">{</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="rfft2d_test_m_l_8m_1adc468c70fb574ebd07287b38d0d0676d" kindref="member">k</ref>,<sp/>ret<sp/>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1af0ed4e74fe68802c7d337a2645e759d6" kindref="member">vorbis_info_init</ref><sp/>(&amp;vdata-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>style<sp/>of<sp/>encoding<sp/>should<sp/>be<sp/>selectable<sp/>here,<sp/>VBR<sp/>quality<sp/>mode.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="vorbisenc_8h_1ab4e3d96c3008a29c615271d1f551c2a0" kindref="member">vorbis_encode_init_vbr</ref><sp/>(&amp;vdata-&gt;vi,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1acfd248e20ab1c58b57aafc7b16404a5f" kindref="member">samplerate</ref>,<sp/>vdata-&gt;quality)<sp/>;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="vorbisenc_8h_1a6571d9c349c540491256f1083e1ede71" kindref="member">vorbis_encode_init</ref><sp/>(&amp;vdata-&gt;vi,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1acfd248e20ab1c58b57aafc7b16404a5f" kindref="member">samplerate</ref>,<sp/>-1,<sp/>128000,<sp/>-1)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>average<sp/>bitrate<sp/>mode<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>(<sp/><ref refid="vorbisenc_8h_1ac73714f24500e18024e83104e9e09485" kindref="member">vorbis_encode_setup_managed</ref><sp/>(&amp;vdata-&gt;vi,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1acfd248e20ab1c58b57aafc7b16404a5f" kindref="member">samplerate</ref>,<sp/>-1,<sp/>128000,<sp/>-1)<sp/>||</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="vorbisenc_8h_1a5f398a378e20b8ce5e3341a582e773bd" kindref="member">vorbis_encode_ctl</ref><sp/>(&amp;vdata-&gt;vi,<sp/><ref refid="vorbisenc_8h_1a34c3170d227b6368041e59c1dc7ed6e4" kindref="member">OV_ECTL_RATEMANAGE_AVG</ref>,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>||</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="vorbisenc_8h_1ac3953ff69d05864e78d1858a544ed619" kindref="member">vorbis_encode_setup_init</ref><sp/>(&amp;vdata-&gt;vi))<sp/>;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ret)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a99b94f0f511f5e3ec9f7bb4e6f432858" kindref="member">SFE_BAD_OPEN_FORMAT</ref><sp/>;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>vdata-&gt;loc<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>add<sp/>a<sp/>comment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a0bab2093941e2bb89651d62ca5997676" kindref="member">vorbis_comment_init</ref><sp/>(&amp;vdata-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a0d0b69d0f7018455ad15ff735a6403fb" kindref="member">vorbis_comment_add_tag</ref><sp/>(&amp;vdata-&gt;vc,<sp/></highlight><highlight class="stringliteral">&quot;ENCODER&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;libsndfile&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k<sp/>=<sp/>0<sp/>;<sp/>k<sp/>&lt;<sp/><ref refid="libsndfile_2src_2common_8h_1abd03920bd79f3db0728bb0716e5e2c71" kindref="member">SF_MAX_STRINGS</ref><sp/>;<sp/>k++)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/><ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref><sp/>;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1a65b23e105d51eaa8b0d8029a2e64d641" kindref="member">strings</ref><sp/>[k].<ref refid="struct_s_t_r___d_a_t_a_1aefed1fdf91377f70241c10d70853cea1" kindref="member">type</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1a65b23e105d51eaa8b0d8029a2e64d641" kindref="member">strings</ref><sp/>[k].<ref refid="struct_s_t_r___d_a_t_a_1aefed1fdf91377f70241c10d70853cea1" kindref="member">type</ref>)</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5acc0345590e46aa4c2ebd284d7becde48" kindref="member">SF_STR_TITLE</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;TITLE&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5ae5237fd1a51b6b513310778f32293346" kindref="member">SF_STR_COPYRIGHT</ref><sp/>:<sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;COPYRIGHT&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a9c72b262cab1903924fad40d5d8bcee3" kindref="member">SF_STR_SOFTWARE</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SOFTWARE&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5aa22c34098bd0d323df315e78e027ea57" kindref="member">SF_STR_ARTIST</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ARTIST&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a83960dedfa2ca567c41bf74678842952" kindref="member">SF_STR_COMMENT</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;COMMENT&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a3f5015b5e35ec5cd9b6c41a871b1f2eb" kindref="member">SF_STR_DATE</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;DATE&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5acf734a9551356927a5a4866ac0a6d434" kindref="member">SF_STR_ALBUM</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ALBUM&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a0374c0f8282517ebf72f96732a6de00a" kindref="member">SF_STR_LICENSE</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;LICENSE&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5af97622810c6cc69643e7a9dc276a0867" kindref="member">SF_STR_TRACKNUMBER</ref><sp/>:<sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;TRACKNUMBER&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a5347260c3611a5e649db7a4a8370d3c5a8b4856d636025a844feb8adf89af1403" kindref="member">SF_STR_GENRE</ref><sp/>:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;GENRE&quot;</highlight><highlight class="normal"><sp/>;<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal"><sp/>:<sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a0d0b69d0f7018455ad15ff735a6403fb" kindref="member">vorbis_comment_add_tag</ref><sp/>(&amp;vdata-&gt;vc,<sp/>name,<sp/>psf-&gt;<ref refid="structsf__private__tag_1a65b23e105d51eaa8b0d8029a2e64d641" kindref="member">strings</ref><sp/>[k].<ref refid="struct_s_t_r___d_a_t_a_1a03863afa1eb7369641c60e233c56f986" kindref="member">str</ref>)<sp/>;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>up<sp/>the<sp/>analysis<sp/>state<sp/>and<sp/>auxiliary<sp/>encoding<sp/>storage<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1abdcd5ee6f4e60c13505170a0f0ec752c" kindref="member">vorbis_analysis_init</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1ab6d85544ab746e98fc63308f6bed27a0" kindref="member">vorbis_block_init</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Set<sp/>up<sp/>our<sp/>packet-&gt;stream<sp/>encoder.</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Pick<sp/>a<sp/>random<sp/>serial<sp/>number<sp/>;<sp/>that<sp/>way<sp/>we<sp/>can<sp/>more<sp/>likely<sp/>build</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>chained<sp/>streams<sp/>just<sp/>by<sp/>concatenation.</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abbbbea9bc3d14e9aff39582854d96d94" kindref="member">ogg_stream_init</ref><sp/>(&amp;odata-&gt;os,<sp/><ref refid="src_2common_8c_1abd8efa2c77686423ad6247ecec07ced2" kindref="member">psf_rand_int32</ref><sp/>())<sp/>;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Vorbis<sp/>streams<sp/>begin<sp/>with<sp/>three<sp/>headers<sp/>;<sp/>the<sp/>initial<sp/>header<sp/>(with</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>most<sp/>of<sp/>the<sp/>codec<sp/>setup<sp/>parameters)<sp/>which<sp/>is<sp/>mandated<sp/>by<sp/>the<sp/>Ogg</highlight></codeline>
<codeline lineno="413"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bitstream<sp/>spec.<sp/><sp/>The<sp/>second<sp/>header<sp/>holds<sp/>any<sp/>comment<sp/>fields.<sp/><sp/>The</highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>third<sp/>header<sp/>holds<sp/>the<sp/>bitstream<sp/>codebook.<sp/><sp/>We<sp/>merely<sp/>need<sp/>to</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>make<sp/>the<sp/>headers,<sp/>then<sp/>pass<sp/>them<sp/>to<sp/>libvorbis<sp/>one<sp/>at<sp/>a<sp/>time<sp/>;</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>libvorbis<sp/>handles<sp/>the<sp/>additional<sp/>Ogg<sp/>bitstream<sp/>constraints<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>header<sp/>;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>header_comm<sp/>;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>header_code<sp/>;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>result<sp/>;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a76b877e3ab680d7537ec58ebd7fa990a" kindref="member">vorbis_analysis_headerout</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vc,<sp/>&amp;header,<sp/>&amp;header_comm,<sp/>&amp;header_code)<sp/>;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a57ec8183300b01784037b7fd845894e4" kindref="member">ogg_stream_packetin</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;header)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>automatically<sp/>placed<sp/>in<sp/>its<sp/>own<sp/>page<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a57ec8183300b01784037b7fd845894e4" kindref="member">ogg_stream_packetin</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;header_comm)<sp/>;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a57ec8183300b01784037b7fd845894e4" kindref="member">ogg_stream_packetin</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;header_code)<sp/>;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>ensures<sp/>the<sp/>actual</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>audio<sp/>data<sp/>will<sp/>start<sp/>on<sp/>a<sp/>new<sp/>page,<sp/>as<sp/>per<sp/>spec</highlight></codeline>
<codeline lineno="430"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((result<sp/>=<sp/><ref refid="ogg_8h_1aae837247e0edb7003c7ce5b7ae76d20e" kindref="member">ogg_stream_flush</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og))<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.header,<sp/>1,<sp/>odata-&gt;og.header_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.body,<sp/>1,<sp/>odata-&gt;og.body_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="438"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal">ogg_close<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)</highlight></codeline>
<codeline lineno="442"><highlight class="normal">{</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(odata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>vdata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>Clean<sp/>up<sp/>this<sp/>logical<sp/>bitstream<sp/>;<sp/>before<sp/>exit<sp/>we<sp/>shuld<sp/>see<sp/>if<sp/>we&apos;re</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>followed<sp/>by<sp/>another<sp/>[chained].<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aba0363a05c5d908f7af983ca82a7b881" kindref="member">file</ref>.<ref refid="struct_p_s_f___f_i_l_e_1a79dc5fc1f9c6e1da23a11014d105e7fd" kindref="member">mode</ref><sp/>==<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a775634eda7917b3f2142895169300799a449991ce14cb1b9715cf444ffdb9e4a0" kindref="member">SFM_WRITE</ref>)</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1a1de6b77d7eee2f755d0cfecc4dbafdb7" kindref="member">write_current</ref><sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ogg_write_header<sp/>(psf,<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1ae527e6764c45e6e8a23c60d777496adf" kindref="member">vorbis_analysis_wrote</ref><sp/>(&amp;vdata-&gt;vd,<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1a0c75b86b435cd45905ff62e2b9c93ab1" kindref="member">vorbis_analysis_blockout</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vb)<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>analysis,<sp/>assume<sp/>we<sp/>want<sp/>to<sp/>use<sp/>bitrate<sp/>management<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a3873974078caf99893e6268e5ce6d896" kindref="member">vorbis_analysis</ref><sp/>(&amp;vdata-&gt;vb,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a7efe5889f6919053b8ab8d69e61ac995" kindref="member">vorbis_bitrate_addblock</ref><sp/>(&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1a37418540741db649a608cac3d2be440f" kindref="member">vorbis_bitrate_flushpacket</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;odata-&gt;op))</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>weld<sp/>the<sp/>packet<sp/>into<sp/>the<sp/>bitstream<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a57ec8183300b01784037b7fd845894e4" kindref="member">ogg_stream_packetin</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;op)<sp/>;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>write<sp/>out<sp/>pages<sp/>(if<sp/>any)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!odata-&gt;eos)</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1a75f6056bc13fa979a2443a3c309dc83f" kindref="member">ogg_stream_pageout</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)<sp/>break<sp/>;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.header,<sp/>1,<sp/>odata-&gt;og.header_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.body,<sp/>1,<sp/>odata-&gt;og.body_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>this<sp/>could<sp/>be<sp/>set<sp/>above,<sp/>but<sp/>for<sp/>illustrative<sp/>purposes,<sp/>I<sp/>do</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>it<sp/>here<sp/>(to<sp/>show<sp/>that<sp/>vorbis<sp/>does<sp/>know<sp/>where<sp/>the<sp/>stream<sp/>ends)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1ad970fa8d2ee19a0c965a45f55f108ec6" kindref="member">ogg_page_eos</ref><sp/>(&amp;odata-&gt;og))<sp/>odata-&gt;eos<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ogg_page<sp/>and<sp/>ogg_packet<sp/>structs<sp/>always<sp/>point<sp/>to<sp/>storage<sp/>in</highlight></codeline>
<codeline lineno="486"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>libvorbis.<sp/><sp/>They<sp/>are<sp/>never<sp/>freed<sp/>or<sp/>manipulated<sp/>directly<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a6a89cd06e8119b22a2d6a565e2d92c4e" kindref="member">vorbis_block_clear</ref><sp/>(&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a3af19007415290a3f237e9a821bfe616" kindref="member">vorbis_dsp_clear</ref><sp/>(&amp;vdata-&gt;vd)<sp/>;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a2fd38dcf146b850e88f281978b580d3e" kindref="member">vorbis_comment_clear</ref><sp/>(&amp;vdata-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1abaf171c1341b23e1c2eed7dab00d9f4a" kindref="member">vorbis_info_clear</ref><sp/>(&amp;vdata-&gt;vi)<sp/>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>must<sp/>be<sp/>called<sp/>last<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>should<sp/>look<sp/>here<sp/>to<sp/>reopen<sp/>if<sp/>chained<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>OK,<sp/>clean<sp/>up<sp/>the<sp/>framer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a43833b30d583f7522224fb28849fc479" kindref="member">ogg_sync_clear</ref><sp/>(&amp;odata-&gt;oy)<sp/>;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a305dff20a5476305be61e46f6b34d4e1" kindref="member">ogg_stream_clear</ref><sp/>(&amp;odata-&gt;os)<sp/>;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="499"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_close<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><ref refid="ogg_8c_1a30f411702a560189e5545dd902ba4c48" kindref="member">ogg_open</ref><sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)</highlight></codeline>
<codeline lineno="503"><highlight class="normal">{<sp/><sp/><sp/>OGG_PRIVATE*<sp/>odata<sp/>=<sp/>calloc<sp/>(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(OGG_PRIVATE))<sp/>;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE*<sp/>vdata<sp/>=<sp/>calloc<sp/>(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(VORBIS_PRIVATE))<sp/>;</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref><sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(vdata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>odata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a72471cad460e0551a75875d116c3083f" kindref="member">SFE_MALLOC_FAILED</ref><sp/>;</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>=<sp/>odata<sp/>;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>=<sp/>vdata<sp/>;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aba0363a05c5d908f7af983ca82a7b881" kindref="member">file</ref>.<ref refid="struct_p_s_f___f_i_l_e_1a79dc5fc1f9c6e1da23a11014d105e7fd" kindref="member">mode</ref><sp/>==<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a775634eda7917b3f2142895169300799a1860040e1c905b2fe2dd7dded86d2544" kindref="member">SFM_RDWR</ref>)</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a3b2c3513f6d7ce8a509001fb59b54b1b" kindref="member">SFE_BAD_MODE_RW</ref><sp/>;</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>HAVE_VORBIS_VERSION_STRING</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Vorbis<sp/>library<sp/>version<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="codec_8h_1ad54273667de6e0d9b226cc0826ffca95" kindref="member">vorbis_version_string</ref><sp/>())<sp/>;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aba0363a05c5d908f7af983ca82a7b881" kindref="member">file</ref>.<ref refid="struct_p_s_f___f_i_l_e_1a79dc5fc1f9c6e1da23a11014d105e7fd" kindref="member">mode</ref><sp/>==<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a775634eda7917b3f2142895169300799a125531fe9c895237bccd35736370e815" kindref="member">SFM_READ</ref>)</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Call<sp/>this<sp/>here<sp/>so<sp/>it<sp/>only<sp/>gets<sp/>called<sp/>once,<sp/>so<sp/>no<sp/>memory<sp/>is<sp/>leaked.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a20504c78ff5a937b38729c6b220e78a6" kindref="member">ogg_sync_init</ref><sp/>(&amp;odata-&gt;oy)<sp/>;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((error<sp/>=<sp/>ogg_read_header<sp/>(psf,<sp/>1)))</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>error<sp/>;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a7f813848322d038dbe4714d9121ac9f7" kindref="member">read_short</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>ogg_read_s<sp/>;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a7ffead80fd790ded8757932ca0288cf3" kindref="member">read_int</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ogg_read_i<sp/>;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a43a78efc967ec86bee19dea5bda1d06b" kindref="member">read_float</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>ogg_read_f<sp/>;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a70b02cbeb50a539b35752b57512fab1b" kindref="member">read_double</ref><sp/><sp/><sp/><sp/>=<sp/>ogg_read_d<sp/>;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1a80838e7063ecc3d8d7ff9f92ab1efdfb" kindref="member">frames</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ogg_length<sp/>(psf)<sp/>;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1af651f92f5e5c247a4f0d11fbc9b5c9c1" kindref="member">container_close</ref><sp/>=<sp/>ogg_close<sp/>;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aba0363a05c5d908f7af983ca82a7b881" kindref="member">file</ref>.<ref refid="struct_p_s_f___f_i_l_e_1a79dc5fc1f9c6e1da23a11014d105e7fd" kindref="member">mode</ref><sp/>==<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a775634eda7917b3f2142895169300799a449991ce14cb1b9715cf444ffdb9e4a0" kindref="member">SFM_WRITE</ref>)</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>the<sp/>default<sp/>vorbis<sp/>quality<sp/>here.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vdata-&gt;quality<sp/>=<sp/>0.4<sp/>;</highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a41db5f9e03f8f5ab24bce4534b3c1c98" kindref="member">write_header</ref><sp/><sp/><sp/>=<sp/>ogg_write_header<sp/>;</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a5445a02635d3ab4a3256621954b0114e" kindref="member">write_short</ref><sp/><sp/><sp/><sp/>=<sp/>ogg_write_s<sp/>;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1ac8ef0841aefa0fb9ac22b1045dc713f7" kindref="member">write_int</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ogg_write_i<sp/>;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1ac284efc7c4ba744880cf2d4d1c6fd85a" kindref="member">write_float</ref><sp/><sp/><sp/><sp/>=<sp/>ogg_write_f<sp/>;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aad7738ff79d160943eeeaa8f4b551f37" kindref="member">write_double</ref><sp/><sp/><sp/>=<sp/>ogg_write_d<sp/>;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1a80838e7063ecc3d8d7ff9f92ab1efdfb" kindref="member">frames</ref><sp/>=<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2config_8h_1a2a594c90b41e9b0140f28724f80b763a" kindref="member">SF_COUNT_MAX</ref><sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Unknown<sp/>really<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1ad24506f93bce90fd79743e25f6aa9391" kindref="member">str_flags</ref><sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a39b4e25c4e8f5fed29720be17a532fa8a8527612d6bc16641fc191de13ecab9cf" kindref="member">SF_STR_ALLOW_START</ref><sp/>;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aed7b77416664bb490620dac7ae612084" kindref="member">bytewidth</ref><sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a4216875ecce622f520ef19f87aee3400" kindref="member">blockwidth</ref><sp/>=<sp/>psf-&gt;<ref refid="structsf__private__tag_1aed7b77416664bb490620dac7ae612084" kindref="member">bytewidth</ref><sp/>*<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1ab36e940f006babe39879e21e743650ca" kindref="member">seek</ref><sp/>=<sp/>ogg_seek<sp/>;</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a7303acd2f12402fa584c71e54395da28" kindref="member">command</ref><sp/>=<sp/>ogg_command<sp/>;</highlight></codeline>
<codeline lineno="555"><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME,<sp/>FIXME,<sp/>FIXME<sp/>:<sp/>Hack<sp/>these<sp/>here<sp/>for<sp/>now<sp/>and<sp/>correct<sp/>later.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1a36a7c3ae9a8229797f19267b4ba07361" kindref="member">format</ref><sp/>=<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1ac6bea760bc75e449a80b8cc28bf9a2feaaaef1f7e663487eefbe4106de44ea7fd" kindref="member">SF_FORMAT_OGG</ref><sp/>|<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1ac6bea760bc75e449a80b8cc28bf9a2fea029114057a7956f3c94ae18d269faf61" kindref="member">SF_FORMAT_VORBIS</ref><sp/>;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1a5f4c7cb564c05f6c3eeac9164a806544" kindref="member">sections</ref><sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a6103a42652ababfafc5c6ee8cab05396" kindref="member">datalength</ref><sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a62eab65784107dfa9ec026a4e0d5c80e" kindref="member">dataoffset</ref><sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>FIXME.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>error<sp/>;</highlight></codeline>
<codeline lineno="565"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_open<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal">ogg_command<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>command,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>datasize)</highlight></codeline>
<codeline lineno="569"><highlight class="normal">{<sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/>switch<sp/>(command)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1aff44cf33e83896b8e5102305d23db5aca4c6ada6a85c507ee77fbe541f9c28284" kindref="member">SFC_SET_VBR_ENCODING_QUALITY</ref><sp/>:</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(data<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>datasize<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1<sp/>;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1ac6a5ca05f37ab57aa894027ebe7b587b" kindref="member">have_written</ref>)</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1<sp/>;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vdata-&gt;quality<sp/>=<sp/>*((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/>data)<sp/>;</highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clip<sp/>range.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vdata-&gt;quality<sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a313119b975743b98e65bbf3d9ea3487f" kindref="member">SF_MAX</ref><sp/>(0.0,<sp/><ref refid="libsndfile_2src_2common_8h_1a3df86d111b485a40ab450ee7be44ed45" kindref="member">SF_MIN</ref><sp/>(1.0,<sp/>vdata-&gt;quality))<sp/>;</highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>:<sp/>Setting<sp/>SFC_SET_VBR_ENCODING_QUALITY<sp/>to<sp/>%f.\n&quot;</highlight><highlight class="normal">,<sp/>__func__,<sp/>vdata-&gt;quality)<sp/>;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;</highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal"><sp/>:</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="590"><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="592"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_command<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal">ogg_rnull<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref>,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="libsndfile_2src_2common_8h_1a86d500a34c624c2cae56bc25a31b12f3" kindref="member">UNUSED</ref><sp/>(vptr),<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a86d500a34c624c2cae56bc25a31b12f3" kindref="member">UNUSED</ref><sp/>(off)<sp/>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channels,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**<ref refid="libsndfile_2src_2common_8h_1a86d500a34c624c2cae56bc25a31b12f3" kindref="member">UNUSED</ref><sp/>(pcm))</highlight></codeline>
<codeline lineno="596"><highlight class="normal">{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>samples<sp/>*<sp/>channels<sp/>;</highlight></codeline>
<codeline lineno="598"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_rnull<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal">ogg_rshort<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>samples,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*vptr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>off,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channels,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**pcm)</highlight></codeline>
<codeline lineno="602"><highlight class="normal">{</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>*ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">short</highlight><highlight class="normal">*)<sp/>vptr<sp/>+<sp/>off<sp/>;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0,<sp/>j,<sp/>n<sp/>;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0<sp/>;<sp/>j<sp/>&lt;<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;<sp/>j++)</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0<sp/>;<sp/>n<sp/>&lt;<sp/>channels<sp/>;<sp/>n++)</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref><sp/>=<sp/>pcm<sp/>[n][j]<sp/>;</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="unix_2switches_8h_1adcedbae5c6b15fd285667e9eb523aedb" kindref="member">CPU_CLIPS_POSITIVE</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/>value<sp/>&gt;=<sp/>1.0)</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>0x7fff<sp/>;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="unix_2switches_8h_1a890b0d95c754812b0939c2d9c01cdeaa" kindref="member">CPU_CLIPS_NEGATIVE</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/>value<sp/>&lt;=<sp/>-1.0)</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>0x8000<sp/>;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/><ref refid="real_8h_1a483e8f95ebd254c9279e0ada03a9a6e8" kindref="member">lrintf</ref><sp/>(value<sp/>*<sp/>32767.0<ref refid="rfft2d_test_m_l_8m_1aacd36fb6ac9ce14cec71f2ca852524d4" kindref="member">f</ref>)<sp/>;</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="622"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_rshort<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal">ogg_rint<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>samples,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*vptr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>off,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channels,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**pcm)</highlight></codeline>
<codeline lineno="626"><highlight class="normal">{</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*)<sp/>vptr<sp/>+<sp/>off<sp/>;</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0,<sp/>j,<sp/>n<sp/>;</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0<sp/>;<sp/>j<sp/>&lt;<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;<sp/>j++)</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0<sp/>;<sp/>n<sp/>&lt;<sp/>channels<sp/>;<sp/>n++)</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>value<sp/>=<sp/>pcm<sp/>[n][j]<sp/>;</highlight></codeline>
<codeline lineno="633"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="unix_2switches_8h_1adcedbae5c6b15fd285667e9eb523aedb" kindref="member">CPU_CLIPS_POSITIVE</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/>value<sp/>&gt;=<sp/>1.0)</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>0x7fffffff<sp/>;</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="unix_2switches_8h_1a890b0d95c754812b0939c2d9c01cdeaa" kindref="member">CPU_CLIPS_NEGATIVE</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/>value<sp/>&lt;=<sp/>-1.0)</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>0x80000000<sp/>;</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/><ref refid="real_8h_1a483e8f95ebd254c9279e0ada03a9a6e8" kindref="member">lrintf</ref><sp/>(value<sp/>*<sp/>2147483647.0<ref refid="rfft2d_test_m_l_8m_1aacd36fb6ac9ce14cec71f2ca852524d4" kindref="member">f</ref>)<sp/>;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="647"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_rint<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal">ogg_rfloat<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>samples,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*vptr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>off,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channels,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**pcm)</highlight></codeline>
<codeline lineno="651"><highlight class="normal">{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*)<sp/>vptr<sp/>+<sp/>off<sp/>;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0,<sp/>j,<sp/>n<sp/>;</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0<sp/>;<sp/>j<sp/>&lt;<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;<sp/>j++)</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0<sp/>;<sp/>n<sp/>&lt;<sp/>channels<sp/>;<sp/>n++)</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>pcm<sp/>[n][j]<sp/>;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="658"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_rfloat<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal">ogg_rdouble<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>samples,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*vptr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>off,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channels,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**pcm)</highlight></codeline>
<codeline lineno="662"><highlight class="normal">{</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*)<sp/>vptr<sp/>+<sp/>off<sp/>;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0,<sp/>j,<sp/>n<sp/>;</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0<sp/>;<sp/>j<sp/>&lt;<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;<sp/>j++)</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0<sp/>;<sp/>n<sp/>&lt;<sp/>channels<sp/>;<sp/>n++)</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr<sp/>[i++]<sp/>=<sp/>pcm<sp/>[n][j]<sp/>;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="669"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_rdouble<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="673"><highlight class="normal">ogg_read_sample<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens,<sp/>convert_func<sp/>*transfn)</highlight></codeline>
<codeline lineno="674"><highlight class="normal">{</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>result,<sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref>,<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref>,<sp/>i<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**pcm<sp/>;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>lens<sp/>/<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((samples<sp/>=<sp/><ref refid="codec_8h_1ac8d21b854dbcb022dab0b46521e9de31" kindref="member">vorbis_synthesis_pcmout</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;pcm))<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(samples<sp/>&gt;<sp/>len)<sp/>samples<sp/>=<sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>;</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+=<sp/>transfn<sp/>(samples,<sp/>ptr,<sp/>i,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,<sp/>pcm)<sp/>;</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>-=<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>tell<sp/>libvorbis<sp/>how<sp/>many<sp/>samples<sp/>we<sp/>actually<sp/>consumed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a81b9782f945ca76509f79cdf5777b4cb" kindref="member">vorbis_synthesis_read</ref><sp/>(&amp;vdata-&gt;vd,<sp/>samples)<sp/>;</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vdata-&gt;loc<sp/>+=<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>this<sp/>necessary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>start0<sp/>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Jump<sp/>into<sp/>the<sp/>nasty<sp/>nest<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>!odata-&gt;eos)</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>!odata-&gt;eos)</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1abcb8ea90cec5a3e5bb19686432c11da6" kindref="member">ogg_sync_pageout</ref><sp/>(&amp;odata-&gt;oy,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)<sp/>break<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>need<sp/>more<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>missing<sp/>or<sp/>corrupt<sp/>data<sp/>at<sp/>this<sp/>page<sp/>position<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;Corrupt<sp/>or<sp/>missing<sp/>data<sp/>in<sp/>bitstream<sp/>;<sp/>continuing...\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>can<sp/>safely<sp/>ignore<sp/>errors<sp/>at<sp/>this<sp/>point<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a60db38b6032f1fb0729e14adb61f11a2" kindref="member">ogg_stream_pagein</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>start0:</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(1)</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;op)<sp/>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>need<sp/>more<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>missing<sp/>or<sp/>corrupt<sp/>data<sp/>at<sp/>this<sp/>page<sp/>position<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>no<sp/>reason<sp/>to<sp/>complain<sp/>;<sp/>already<sp/>complained<sp/>above<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>we<sp/>have<sp/>a<sp/>packet.<sp/><sp/><sp/><sp/>Decode<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1ad74ed4c29400ef6d23b14846c8c4ccb4" kindref="member">vorbis_synthesis</ref><sp/>(&amp;vdata-&gt;vb,<sp/>&amp;odata-&gt;op)<sp/>==<sp/>0)<sp/></highlight><highlight class="comment">/*<sp/>test<sp/>for<sp/>success!<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1acbcda429474c093c54fd9e2ffaee2547" kindref="member">vorbis_synthesis_blockin</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="719"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/>The<sp/>**pcm<sp/>variable<sp/>is<sp/>a<sp/>multichannel<sp/>float<sp/>vector.<sp/><sp/><sp/><sp/>In<sp/>stereo,<sp/>for</highlight></codeline>
<codeline lineno="720"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/>example,<sp/>pcm<sp/>[0]<sp/>is<sp/>left,<sp/>and<sp/>pcm<sp/>[1]<sp/>is<sp/>right.<sp/><sp/><sp/>samples<sp/>is</highlight></codeline>
<codeline lineno="721"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/>the<sp/>size<sp/>of<sp/>each<sp/>channel.<sp/><sp/><sp/><sp/><sp/>Convert<sp/>the<sp/>float<sp/>values</highlight></codeline>
<codeline lineno="722"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/>(-1.&lt;=range&lt;=1.)<sp/>to<sp/>whatever<sp/>PCM<sp/>format<sp/>and<sp/>write<sp/>it<sp/>out.</highlight></codeline>
<codeline lineno="723"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((samples<sp/>=<sp/><ref refid="codec_8h_1ac8d21b854dbcb022dab0b46521e9de31" kindref="member">vorbis_synthesis_pcmout</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;pcm))<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(samples&gt;len)<sp/>samples<sp/>=<sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>;</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+=<sp/>transfn<sp/>(samples,<sp/>ptr,<sp/>i,<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,<sp/>pcm)<sp/>;</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>-=<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>tell<sp/>libvorbis<sp/>how<sp/>many<sp/>samples<sp/>we<sp/>actually<sp/>consumed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a81b9782f945ca76509f79cdf5777b4cb" kindref="member">vorbis_synthesis_read</ref><sp/>(&amp;vdata-&gt;vd,<sp/>samples)<sp/>;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vdata-&gt;loc<sp/>+=<sp/><ref refid="test__rw__echo_8c_1a39c8d1039645bc924aecc49d76f472a0" kindref="member">samples</ref><sp/>;</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Is<sp/>this<sp/>necessary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1ad970fa8d2ee19a0c965a45f55f108ec6" kindref="member">ogg_page_eos</ref><sp/>(&amp;odata-&gt;og))<sp/>odata-&gt;eos<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!odata-&gt;eos)</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="recplay_8c_1adbbab5cb2248179d231690a1a02ff977" kindref="member">buffer</ref><sp/>;</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytes<sp/>;</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>=<sp/><ref refid="ogg_8h_1a699610803ac0cd2cc36224e57e7f783c" kindref="member">ogg_sync_buffer</ref><sp/>(&amp;odata-&gt;oy,<sp/>4096)<sp/>;</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bytes<sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a16c707d5a2175650aacd6b9cbdfe0f85" kindref="member">psf_fread</ref><sp/>(buffer,<sp/>1,<sp/>4096,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abd197a9cda5a6cec788c65c79530e20d" kindref="member">ogg_sync_wrote</ref><sp/>(&amp;odata-&gt;oy,<sp/>bytes)<sp/>;</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bytes<sp/>==<sp/>0)<sp/>odata-&gt;eos<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="750"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_sample<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="753"><highlight class="normal">ogg_read_s<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="754"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ogg_read_sample<sp/>(psf,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<sp/>ptr,<sp/>lens,<sp/>ogg_rshort)<sp/>;</highlight></codeline>
<codeline lineno="755"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_s<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="758"><highlight class="normal">ogg_read_i<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="759"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ogg_read_sample<sp/>(psf,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<sp/>ptr,<sp/>lens,<sp/>ogg_rint)<sp/>;</highlight></codeline>
<codeline lineno="760"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_i<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="763"><highlight class="normal">ogg_read_f<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="764"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ogg_read_sample<sp/>(psf,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<sp/>ptr,<sp/>lens,<sp/>ogg_rfloat)<sp/>;</highlight></codeline>
<codeline lineno="765"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_f<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="768"><highlight class="normal">ogg_read_d<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="769"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ogg_read_sample<sp/>(psf,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<sp/>ptr,<sp/>lens,<sp/>ogg_rdouble)<sp/>;</highlight></codeline>
<codeline lineno="770"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_read_d<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight><highlight class="comment">/*==============================================================================</highlight></codeline>
<codeline lineno="773"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal">ogg_write_samples<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/>OGG_PRIVATE<sp/>*odata,<sp/>VORBIS_PRIVATE<sp/>*vdata,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_frames)</highlight></codeline>
<codeline lineno="777"><highlight class="normal">{</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1ae527e6764c45e6e8a23c60d777496adf" kindref="member">vorbis_analysis_wrote</ref><sp/>(&amp;vdata-&gt;vd,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="781"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>Vorbis<sp/>does<sp/>some<sp/>data<sp/>preanalysis,<sp/>then<sp/>divvies<sp/>up<sp/>blocks<sp/>for</highlight></codeline>
<codeline lineno="782"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>more<sp/>involved<sp/>(potentially<sp/>parallel)<sp/>processing.<sp/>Get<sp/>a<sp/>single</highlight></codeline>
<codeline lineno="783"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/><sp/>block<sp/>for<sp/>encoding<sp/>now.</highlight></codeline>
<codeline lineno="784"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1a0c75b86b435cd45905ff62e2b9c93ab1" kindref="member">vorbis_analysis_blockout</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;vdata-&gt;vb)<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>analysis,<sp/>assume<sp/>we<sp/>want<sp/>to<sp/>use<sp/>bitrate<sp/>management<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a3873974078caf99893e6268e5ce6d896" kindref="member">vorbis_analysis</ref><sp/>(&amp;vdata-&gt;vb,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>;</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a7efe5889f6919053b8ab8d69e61ac995" kindref="member">vorbis_bitrate_addblock</ref><sp/>(&amp;vdata-&gt;vb)<sp/>;</highlight></codeline>
<codeline lineno="790"><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1a37418540741db649a608cac3d2be440f" kindref="member">vorbis_bitrate_flushpacket</ref><sp/>(&amp;vdata-&gt;vd,<sp/>&amp;odata-&gt;op))</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>weld<sp/>the<sp/>packet<sp/>into<sp/>the<sp/>bitstream<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a57ec8183300b01784037b7fd845894e4" kindref="member">ogg_stream_packetin</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;op)<sp/>;</highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>write<sp/>out<sp/>pages<sp/>(if<sp/>any)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!odata-&gt;eos)</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>result<sp/>=<sp/><ref refid="ogg_8h_1a75f6056bc13fa979a2443a3c309dc83f" kindref="member">ogg_stream_pageout</ref><sp/>(&amp;odata-&gt;os,<sp/>&amp;odata-&gt;og)<sp/>;</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.header,<sp/>1,<sp/>odata-&gt;og.header_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1a183f23ab33e38e7e1c88034f3e69272d" kindref="member">psf_fwrite</ref><sp/>(odata-&gt;og.body,<sp/>1,<sp/>odata-&gt;og.body_len,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="803"><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>This<sp/>could<sp/>be<sp/>set<sp/>above,<sp/>but<sp/>for<sp/>illustrative<sp/>purposes,<sp/>I<sp/>do</highlight></codeline>
<codeline lineno="805"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>it<sp/>here<sp/>(to<sp/>show<sp/>that<sp/>vorbis<sp/>does<sp/>know<sp/>where<sp/>the<sp/>stream<sp/>ends)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1ad970fa8d2ee19a0c965a45f55f108ec6" kindref="member">ogg_page_eos</ref><sp/>(&amp;odata-&gt;og))</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>odata-&gt;eos<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/>vdata-&gt;loc<sp/>+=<sp/>in_frames<sp/>;</highlight></codeline>
<codeline lineno="813"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="817"><highlight class="normal">ogg_write_s<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">short</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="818"><highlight class="normal">{</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/><ref refid="layer3_8c_1a4b8bfe70f28d6faddcb10d6ecf8c1989" kindref="member">m</ref>,<sp/>j<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_frames<sp/>=<sp/>lens<sp/>/<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**buffer<sp/>=<sp/><ref refid="codec_8h_1ab57487095e7cb8ab66f57e6c9b6400cd" kindref="member">vorbis_analysis_buffer</ref><sp/>(&amp;vdata-&gt;vd,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>in_frames<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(m<sp/>=<sp/>0<sp/>;<sp/>m<sp/>&lt;<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;<sp/>m++)</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>[m][i]<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>(ptr<sp/>[j++])<sp/>/<sp/>32767.0<ref refid="rfft2d_test_m_l_8m_1aacd36fb6ac9ce14cec71f2ca852524d4" kindref="member">f</ref><sp/>;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/>ogg_write_samples<sp/>(psf,<sp/>odata,<sp/>vdata,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="829"><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>lens<sp/>;</highlight></codeline>
<codeline lineno="831"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_s<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight></codeline>
<codeline lineno="833"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="834"><highlight class="normal">ogg_write_i<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="835"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/><ref refid="layer3_8c_1a4b8bfe70f28d6faddcb10d6ecf8c1989" kindref="member">m</ref>,<sp/>j<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_frames<sp/>=<sp/>lens<sp/>/<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**buffer<sp/>=<sp/><ref refid="codec_8h_1ab57487095e7cb8ab66f57e6c9b6400cd" kindref="member">vorbis_analysis_buffer</ref><sp/>(&amp;vdata-&gt;vd,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>in_frames<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(m<sp/>=<sp/>0<sp/>;<sp/>m<sp/>&lt;<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;<sp/>m++)</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>[m][i]<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>(ptr<sp/>[j++])<sp/>/<sp/>2147483647.0<ref refid="rfft2d_test_m_l_8m_1aacd36fb6ac9ce14cec71f2ca852524d4" kindref="member">f</ref><sp/>;</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/>ogg_write_samples<sp/>(psf,<sp/>odata,<sp/>vdata,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="845"><highlight class="normal"></highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>lens<sp/>;</highlight></codeline>
<codeline lineno="847"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_i<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="850"><highlight class="normal">ogg_write_f<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="851"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/><ref refid="layer3_8c_1a4b8bfe70f28d6faddcb10d6ecf8c1989" kindref="member">m</ref>,<sp/>j<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_frames<sp/>=<sp/>lens<sp/>/<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**buffer<sp/>=<sp/><ref refid="codec_8h_1ab57487095e7cb8ab66f57e6c9b6400cd" kindref="member">vorbis_analysis_buffer</ref><sp/>(&amp;vdata-&gt;vd,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>in_frames<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(m<sp/>=<sp/>0<sp/>;<sp/>m<sp/>&lt;<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;<sp/>m++)</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>[m][i]<sp/>=<sp/>ptr<sp/>[j++]<sp/>;</highlight></codeline>
<codeline lineno="859"><highlight class="normal"></highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/>ogg_write_samples<sp/>(psf,<sp/>odata,<sp/>vdata,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>lens<sp/>;</highlight></codeline>
<codeline lineno="863"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_f<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="866"><highlight class="normal">ogg_write_d<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*ptr,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lens)</highlight></codeline>
<codeline lineno="867"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/><ref refid="layer3_8c_1a4b8bfe70f28d6faddcb10d6ecf8c1989" kindref="member">m</ref>,<sp/>j<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_frames<sp/>=<sp/>lens<sp/>/<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>**buffer<sp/>=<sp/><ref refid="codec_8h_1ab57487095e7cb8ab66f57e6c9b6400cd" kindref="member">vorbis_analysis_buffer</ref><sp/>(&amp;vdata-&gt;vd,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/>in_frames<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(m<sp/>=<sp/>0<sp/>;<sp/>m<sp/>&lt;<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref><sp/>;<sp/>m++)</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer<sp/>[m][i]<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>ptr<sp/>[j++]<sp/>;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/>ogg_write_samples<sp/>(psf,<sp/>odata,<sp/>vdata,<sp/>in_frames)<sp/>;</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>lens<sp/>;</highlight></codeline>
<codeline lineno="879"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_write_d<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="882"><highlight class="normal">ogg_seek<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a86d500a34c624c2cae56bc25a31b12f3" kindref="member">UNUSED</ref><sp/>(mode),<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="layer12_8c_1a33d71f23ba2052d17f0b754dc35265b0" kindref="member">offset</ref>)</highlight></codeline>
<codeline lineno="883"><highlight class="normal">{</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/>OGG_PRIVATE<sp/>*odata<sp/>=<sp/>(OGG_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a341b979e324bee0c7ed22304ef7ac4bb" kindref="member">container_data</ref><sp/>;</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/>VORBIS_PRIVATE<sp/>*vdata<sp/>=<sp/>(VORBIS_PRIVATE<sp/>*)<sp/>psf-&gt;<ref refid="structsf__private__tag_1a266b8812fba304c9f79c9b0d8af7d7cd" kindref="member">codec_data</ref><sp/>;</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(odata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>vdata<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="889"><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(offset<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a4213ea059db3a7b9453342f6e9714649" kindref="member">error</ref><sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9a7fa3bac66305cf7c7ff3b7b161c12fbc" kindref="member">SFE_BAD_SEEK</ref><sp/>;</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref>)<sp/>-1)<sp/>;</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aba0363a05c5d908f7af983ca82a7b881" kindref="member">file</ref>.<ref refid="struct_p_s_f___f_i_l_e_1a79dc5fc1f9c6e1da23a11014d105e7fd" kindref="member">mode</ref><sp/>==<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a775634eda7917b3f2142895169300799a125531fe9c895237bccd35736370e815" kindref="member">SFM_READ</ref>)</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="lib_2expat_8h_1a15a257516a87decb971420e718853137" kindref="member">target</ref><sp/>=<sp/>offset<sp/>-<sp/>vdata-&gt;loc<sp/>;</highlight></codeline>
<codeline lineno="897"><highlight class="normal"></highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(target<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>12<sp/>to<sp/>allow<sp/>for<sp/>OggS<sp/>bit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1af9e75e7591ba5f797ad58c0a8aaaffb1" kindref="member">psf_fseek</ref><sp/>(psf,<sp/>12,<sp/>SEEK_SET)<sp/>;</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ogg_read_header<sp/>(psf,<sp/>0)<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>state<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>=<sp/><ref refid="layer12_8c_1a33d71f23ba2052d17f0b754dc35265b0" kindref="member">offset</ref><sp/>;</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(target<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>m<sp/>=<sp/>target<sp/>&gt;<sp/>4096<sp/>?<sp/>4096<sp/>:<sp/><ref refid="lib_2expat_8h_1a15a257516a87decb971420e718853137" kindref="member">target</ref><sp/>;</highlight></codeline>
<codeline lineno="907"><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="909"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>Need<sp/>to<sp/>multiply<sp/>by<sp/>channels<sp/>here<sp/>because<sp/>the<sp/>seek<sp/>is<sp/>done<sp/>in</highlight></codeline>
<codeline lineno="910"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>terms<sp/>of<sp/>frames<sp/>and<sp/>the<sp/>read<sp/>function<sp/>is<sp/>done<sp/>in<sp/>terms<sp/>of</highlight></codeline>
<codeline lineno="911"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/><sp/>samples.</highlight></codeline>
<codeline lineno="912"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ogg_read_sample<sp/>(psf,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>m<sp/>*<sp/>psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1aad5220b31d2672bf83d3cf4cea0b2826" kindref="member">channels</ref>,<sp/>ogg_rnull)<sp/>;</highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>-=<sp/><ref refid="layer3_8c_1a4b8bfe70f28d6faddcb10d6ecf8c1989" kindref="member">m</ref><sp/>;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>vdata-&gt;loc<sp/>;</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="920"><highlight class="normal"></highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="922"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_seek<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight><highlight class="comment">/*==============================================================================</highlight></codeline>
<codeline lineno="925"><highlight class="comment">**<sp/><sp/>Most<sp/>of<sp/>the<sp/>following<sp/>code<sp/>was<sp/>snipped<sp/>from<sp/>Mike<sp/>Smith&apos;s<sp/>ogginfo<sp/>utility</highlight></codeline>
<codeline lineno="926"><highlight class="comment">**<sp/><sp/>which<sp/>is<sp/>part<sp/>of<sp/>vorbis-tools.</highlight></codeline>
<codeline lineno="927"><highlight class="comment">**<sp/><sp/>Vorbis<sp/>tools<sp/>is<sp/>released<sp/>under<sp/>the<sp/>GPL<sp/>but<sp/>Mike<sp/>has<sp/>kindly<sp/>allowed<sp/>the</highlight></codeline>
<codeline lineno="928"><highlight class="comment">**<sp/><sp/>following<sp/>to<sp/>be<sp/>relicensed<sp/>as<sp/>LGPL<sp/>for<sp/>libsndfile.</highlight></codeline>
<codeline lineno="929"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal">{</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isillegal<sp/>;</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>shownillegal<sp/>;</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isnew<sp/>;</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="convtest_8m_1afb358f48b1646c750fb9da6c6585be2b" kindref="member">end</ref><sp/>;</highlight></codeline>
<codeline lineno="937"><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="lib-src_2ffmpeg_2win32_2stdint_8h_1a6eb1e68cc391dd753bc8ce896dbb8315" kindref="member">uint32_t</ref><sp/>serial<sp/>;<sp/></highlight><highlight class="comment">/*<sp/>must<sp/>be<sp/>32<sp/>bit<sp/>unsigned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__stream__state" kindref="compound">ogg_stream_state</ref><sp/>os<sp/>;</highlight></codeline>
<codeline lineno="940"><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__info" kindref="compound">vorbis_info</ref><sp/>vi<sp/>;</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structvorbis__comment" kindref="compound">vorbis_comment</ref><sp/>vc<sp/>;</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>lastgranulepos<sp/>;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>doneheaders<sp/>;</highlight></codeline>
<codeline lineno="945"><highlight class="normal">}<sp/>stream_processor<sp/>;</highlight></codeline>
<codeline lineno="946"><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal">{</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/>stream_processor<sp/>*streams<sp/>;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>allocated<sp/>;</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>used<sp/>;</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>in_headers<sp/>;</highlight></codeline>
<codeline lineno="953"><highlight class="normal">}<sp/>stream_set<sp/>;</highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>stream_set<sp/>*</highlight></codeline>
<codeline lineno="956"><highlight class="normal">create_stream_set<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="957"><highlight class="normal">{<sp/><sp/><sp/>stream_set<sp/>*</highlight><highlight class="keyword">set</highlight><highlight class="normal"><sp/>=<sp/>calloc<sp/>(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(stream_set))<sp/>;</highlight></codeline>
<codeline lineno="958"><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">set</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;streams<sp/>=<sp/>calloc<sp/>(5,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(stream_processor))<sp/>;</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;allocated<sp/>=<sp/>5<sp/>;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="964"><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>set<sp/>;</highlight></codeline>
<codeline lineno="966"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>create_stream_set<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal">vorbis_end<sp/>(stream_processor<sp/>*stream,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>*<sp/>len)</highlight></codeline>
<codeline lineno="970"><highlight class="normal">{<sp/><sp/><sp/>*len<sp/>+=<sp/>stream-&gt;lastgranulepos<sp/>;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a2fd38dcf146b850e88f281978b580d3e" kindref="member">vorbis_comment_clear</ref><sp/>(&amp;stream-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="codec_8h_1abaf171c1341b23e1c2eed7dab00d9f4a" kindref="member">vorbis_info_clear</ref><sp/>(&amp;stream-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="973"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>vorbis_end<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal">free_stream_set<sp/>(stream_set<sp/>*</highlight><highlight class="keyword">set</highlight><highlight class="normal">,<sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>*<sp/>len)</highlight></codeline>
<codeline lineno="977"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>;</highlight></codeline>
<codeline lineno="978"><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!set-&gt;streams<sp/>[i].end)</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vorbis_end<sp/>(&amp;set-&gt;streams<sp/>[i],<sp/>len)<sp/>;</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a305dff20a5476305be61e46f6b34d4e1" kindref="member">ogg_stream_clear</ref><sp/>(&amp;set-&gt;streams<sp/>[i].os)<sp/>;</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/>free<sp/>(set-&gt;streams)<sp/>;</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/>free<sp/>(</highlight><highlight class="keyword">set</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="987"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>free_stream_set<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal">streams_open<sp/>(stream_set<sp/>*</highlight><highlight class="keyword">set</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="991"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/>res<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="992"><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!set-&gt;streams<sp/>[i].end)</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>++<sp/>;</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>res<sp/>;</highlight></codeline>
<codeline lineno="997"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>streams_open<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"></highlight></codeline>
<codeline lineno="999"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>stream_processor<sp/>*</highlight></codeline>
<codeline lineno="1000"><highlight class="normal">find_stream_processor<sp/>(stream_set<sp/>*</highlight><highlight class="keyword">set</highlight><highlight class="normal">,<sp/><ref refid="structogg__page" kindref="compound">ogg_page</ref><sp/>*page)</highlight></codeline>
<codeline lineno="1001"><highlight class="normal">{<sp/><sp/><sp/><ref refid="lib-src_2ffmpeg_2win32_2stdint_8h_1a6eb1e68cc391dd753bc8ce896dbb8315" kindref="member">uint32_t</ref><sp/>serial<sp/>=<sp/><ref refid="ogg_8h_1a6194aa97806e93b0889a3b376c7ceb8f" kindref="member">ogg_page_serialno</ref><sp/>(page)<sp/>;</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>,<sp/>found<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>invalid<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/>stream_processor<sp/>*stream<sp/>;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0<sp/>;<sp/>i<sp/>&lt;<sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used<sp/>;<sp/>i++)</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(serial<sp/>==<sp/>set-&gt;streams<sp/>[i].serial)</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>have<sp/>a<sp/>match!<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>=<sp/>&amp;<sp/>(</highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;streams<sp/>[<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>])<sp/>;</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;in_headers<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>we<sp/>have<sp/>detected<sp/>EOS,<sp/>then<sp/>this<sp/>can&apos;t<sp/>occur<sp/>here.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stream-&gt;end)</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>stream-&gt;isillegal<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream<sp/>;</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;isnew<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;end<sp/>=<sp/><ref refid="ogg_8h_1ad970fa8d2ee19a0c965a45f55f108ec6" kindref="member">ogg_page_eos</ref><sp/>(page)<sp/>;</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;serial<sp/>=<sp/>serial<sp/>;</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream<sp/>;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>there<sp/>are<sp/>streams<sp/>open,<sp/>and<sp/>we&apos;ve<sp/>reached<sp/>the<sp/>end<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="1029"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/>headers,<sp/>then<sp/>we<sp/>can&apos;t<sp/>be<sp/>starting<sp/>a<sp/>new<sp/>stream.</highlight></codeline>
<codeline lineno="1030"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/>XXX:<sp/>might<sp/>this<sp/>sometimes<sp/>catch<sp/>ok<sp/>streams<sp/>if<sp/>EOS<sp/>flag<sp/>is<sp/>missing,</highlight></codeline>
<codeline lineno="1031"><highlight class="comment"><sp/><sp/><sp/><sp/>**<sp/>but<sp/>the<sp/>stream<sp/>is<sp/>otherwise<sp/>ok?</highlight></codeline>
<codeline lineno="1032"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(streams_open<sp/>(</highlight><highlight class="keyword">set</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>!set-&gt;in_headers)</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalid<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;in_headers<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(set-&gt;allocated<sp/>&lt;<sp/>set-&gt;used)</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>=<sp/>&amp;</highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;streams<sp/>[</highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used]<sp/>;</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;allocated<sp/>+=<sp/>5<sp/>;</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;streams<sp/>=<sp/>realloc<sp/>(set-&gt;streams,<sp/>sizeof<sp/>(stream_processor)<sp/>*<sp/>set-&gt;allocated)<sp/>;</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>=<sp/>&amp;</highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;streams<sp/>[</highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used]<sp/>;</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal">-&gt;used++<sp/>;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;isnew<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;isillegal<sp/>=<sp/>invalid<sp/>;</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>res<sp/>;</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>packet<sp/>;</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>end<sp/>up<sp/>processing<sp/>the<sp/>header<sp/>page<sp/>twice,<sp/>but<sp/>that&apos;s<sp/>ok.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abbbbea9bc3d14e9aff39582854d96d94" kindref="member">ogg_stream_init</ref><sp/>(&amp;stream-&gt;os,<sp/>serial)<sp/>;</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a60db38b6032f1fb0729e14adb61f11a2" kindref="member">ogg_stream_pagein</ref><sp/>(&amp;stream-&gt;os,<sp/>page)<sp/>;</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;stream-&gt;os,<sp/>&amp;packet)<sp/>;</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(res<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>;</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(packet.<ref refid="structogg__packet_1a4438269ce6025d8817865ae66d5881f1" kindref="member">bytes</ref><sp/>&gt;=<sp/>7<sp/>&amp;&amp;<sp/>memcmp<sp/>(packet.<ref refid="structogg__packet_1a57e7096985ec8766dce415e248767c32" kindref="member">packet</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\x01vorbis&quot;</highlight><highlight class="normal">,<sp/>7)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;lastgranulepos<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1a0bab2093941e2bb89651d62ca5997676" kindref="member">vorbis_comment_init</ref><sp/>(&amp;stream-&gt;vc)<sp/>;</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="codec_8h_1af0ed4e74fe68802c7d337a2645e759d6" kindref="member">vorbis_info_init</ref><sp/>(&amp;stream-&gt;vi)<sp/>;</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res<sp/>=<sp/><ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;stream-&gt;os,<sp/>&amp;packet)<sp/>;</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>re-init,<sp/>ready<sp/>for<sp/>processing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a305dff20a5476305be61e46f6b34d4e1" kindref="member">ogg_stream_clear</ref><sp/>(&amp;stream-&gt;os)<sp/>;</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abbbbea9bc3d14e9aff39582854d96d94" kindref="member">ogg_stream_init</ref><sp/>(&amp;stream-&gt;os,<sp/>serial)<sp/>;</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;end<sp/>=<sp/><ref refid="ogg_8h_1ad970fa8d2ee19a0c965a45f55f108ec6" kindref="member">ogg_page_eos</ref><sp/>(page)<sp/>;</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;serial<sp/>=<sp/>serial<sp/>;</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream<sp/>;</highlight></codeline>
<codeline lineno="1079"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>find_stream_processor<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1080"><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal">ogg_length_get_next_page<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf,<sp/><ref refid="structogg__sync__state" kindref="compound">ogg_sync_state</ref><sp/>*<sp/>osync,<sp/><ref refid="structogg__page" kindref="compound">ogg_page</ref><sp/>*page)</highlight></codeline>
<codeline lineno="1083"><highlight class="normal">{<sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seq_8h_1aea3cfda4f3a9f978ec759f206cf186fe" kindref="member">CHUNK_SIZE</ref><sp/>=<sp/>4500<sp/>;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1abcb8ea90cec5a3e5bb19686432c11da6" kindref="member">ogg_sync_pageout</ref><sp/>(osync,<sp/>page)<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>buffer<sp/>=<sp/><ref refid="ogg_8h_1a699610803ac0cd2cc36224e57e7f783c" kindref="member">ogg_sync_buffer</ref><sp/>(osync,<sp/>CHUNK_SIZE)<sp/>;</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytes<sp/>=<sp/><ref refid="libsndfile_2src_2common_8h_1a16c707d5a2175650aacd6b9cbdfe0f85" kindref="member">psf_fread</ref><sp/>(buffer,<sp/>1,<sp/>4096,<sp/>psf)<sp/>;</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bytes<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="ogg_8h_1abd197a9cda5a6cec788c65c79530e20d" kindref="member">ogg_sync_wrote</ref><sp/>(osync,<sp/>0)<sp/>;</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1abd197a9cda5a6cec788c65c79530e20d" kindref="member">ogg_sync_wrote</ref><sp/>(osync,<sp/>bytes)<sp/>;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_length_get_next_page<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="normal"></highlight></codeline>
<codeline lineno="1100"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="1101"><highlight class="normal">ogg_length_aux<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*<sp/>psf)</highlight></codeline>
<codeline lineno="1102"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__sync__state" kindref="compound">ogg_sync_state</ref><sp/>osync<sp/>;</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structogg__page" kindref="compound">ogg_page</ref><sp/>page<sp/>;</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>gotpage<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>len<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/>stream_set<sp/>*processors<sp/>;</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/>processors<sp/>=<sp/>create_stream_set<sp/>()<sp/>;</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(processors<sp/>==<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0<sp/>;<sp/><sp/></highlight><highlight class="comment">//<sp/>out<sp/>of<sp/>memory?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a20504c78ff5a937b38729c6b220e78a6" kindref="member">ogg_sync_init</ref><sp/>(&amp;osync)<sp/>;</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"></highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(ogg_length_get_next_page<sp/>(psf,<sp/>&amp;osync,<sp/>&amp;page))</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream_processor<sp/>*<ref refid="xmltok_8h_1a94b60f3beb36ae85555d36dc9816769c" kindref="member">p</ref><sp/>=<sp/>find_stream_processor<sp/>(processors,<sp/>&amp;page)<sp/>;</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gotpage<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!p)</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>len<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>break<sp/>;</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"></highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(p-&gt;isillegal<sp/>&amp;&amp;<sp/>!p-&gt;shownillegal)</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p-&gt;shownillegal<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>it&apos;s<sp/>a<sp/>new<sp/>stream,<sp/>we<sp/>want<sp/>to<sp/>continue<sp/>processing<sp/>this<sp/>page</highlight></codeline>
<codeline lineno="1129"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**<sp/>anyway<sp/>to<sp/>suppress<sp/>additional<sp/>spurious<sp/>errors</highlight></codeline>
<codeline lineno="1130"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!p-&gt;isnew)<sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!p-&gt;isillegal)</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="structogg__packet" kindref="compound">ogg_packet</ref><sp/>packet<sp/>;</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>header<sp/>=<sp/>0<sp/>;</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a60db38b6032f1fb0729e14adb61f11a2" kindref="member">ogg_stream_pagein</ref><sp/>(&amp;p-&gt;os,<sp/>&amp;page)<sp/>;</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(p-&gt;doneheaders<sp/>&lt;<sp/>3)</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="ogg_8h_1a387e608bc7cc9d39e74c962475f2e9d4" kindref="member">ogg_stream_packetout</ref><sp/>(&amp;p-&gt;os,<sp/>&amp;packet)<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(p-&gt;doneheaders<sp/>&lt;<sp/>3)</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="codec_8h_1af1192fabbd28f89d048de1b381463219" kindref="member">vorbis_synthesis_headerin</ref><sp/>(&amp;p-&gt;vi,<sp/>&amp;p-&gt;vc,<sp/>&amp;packet)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>continue<sp/>;</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p-&gt;doneheaders<sp/>++<sp/>;</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!header)</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/>gp<sp/>=<sp/><ref refid="ogg_8h_1a538a0abd2b69e7548eb6638475ede669" kindref="member">ogg_page_granulepos</ref><sp/>(&amp;page)<sp/>;</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gp<sp/>&gt;<sp/>0)<sp/>p-&gt;lastgranulepos<sp/>=<sp/>gp<sp/>;</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(p-&gt;end)</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/>vorbis_end<sp/>(p,<sp/>&amp;len)<sp/>;</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p-&gt;isillegal<sp/>=<sp/>1<sp/>;</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>;</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"></highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ogg_8h_1a43833b30d583f7522224fb28849fc479" kindref="member">ogg_sync_clear</ref><sp/>(&amp;osync)<sp/>;</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/>free_stream_set<sp/>(processors,<sp/>&amp;len)<sp/>;</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1af86d325fecfc8f47b61fbf5a5146f582" kindref="member">len</ref><sp/>;</highlight></codeline>
<codeline lineno="1165"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_length_aux<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"></highlight></codeline>
<codeline lineno="1167"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref></highlight></codeline>
<codeline lineno="1168"><highlight class="normal">ogg_length<sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal">{<sp/><sp/><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2sndfile_8h_1a398121a5f562230ea7f772528fff5f84" kindref="member">sf_count_t</ref><sp/><ref refid="test__lib_f_l_a_c_2format_8c_1ac94dc16b22556ba5fa815655f27442da" kindref="member">length</ref><sp/>;</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>error<sp/>;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"></highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(psf-&gt;<ref refid="structsf__private__tag_1aaa8084e49c5f62998a50e5d6d57e11bd" kindref="member">sf</ref>.<ref refid="struct_s_f___i_n_f_o_1ad8978123d4122e137e9500f65d28ac31" kindref="member">seekable</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="mac_2config_2i386_2lib-src_2libsndfile_2src_2config_8h_1a2a594c90b41e9b0140f28724f80b763a" kindref="member">SF_COUNT_MAX</ref><sp/>;</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1af9e75e7591ba5f797ad58c0a8aaaffb1" kindref="member">psf_fseek</ref><sp/>(psf,<sp/>0,<sp/>SEEK_SET)<sp/>;</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/>length<sp/>=<sp/>ogg_length_aux<sp/>(psf)<sp/>;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"></highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libsndfile_2src_2common_8h_1af9e75e7591ba5f797ad58c0a8aaaffb1" kindref="member">psf_fseek</ref><sp/>(psf,<sp/>12,<sp/>SEEK_SET)<sp/>;</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((error<sp/>=<sp/>ogg_read_header<sp/>(psf,<sp/>0))<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psf-&gt;<ref refid="structsf__private__tag_1a4213ea059db3a7b9453342f6e9714649" kindref="member">error</ref><sp/>=<sp/>error<sp/>;</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="test__lib_f_l_a_c_2format_8c_1ac94dc16b22556ba5fa815655f27442da" kindref="member">length</ref><sp/>;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_length<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/></highlight><highlight class="comment">/*<sp/>HAVE_EXTERNAL_LIBS<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1188" refid="ogg_8c_1a30f411702a560189e5545dd902ba4c48" refkind="member"><highlight class="normal"><ref refid="ogg_8c_1a30f411702a560189e5545dd902ba4c48" kindref="member">ogg_open</ref><sp/><sp/><sp/><sp/>(<ref refid="structsf__private__tag" kindref="compound">SF_PRIVATE</ref><sp/>*psf)</highlight></codeline>
<codeline lineno="1189"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2common_8c_1a79339bae8c0e3af5468b507d261922a5" kindref="member">psf_log_printf</ref><sp/>(psf,<sp/></highlight><highlight class="stringliteral">&quot;This<sp/>version<sp/>of<sp/>libsndfile<sp/>was<sp/>compiled<sp/>without<sp/>Ogg/Vorbis<sp/>support.\n&quot;</highlight><highlight class="normal">)<sp/>;</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libsndfile_2src_2common_8h_1a34df7cc7f69a8ec535eec8a524dcbaf9af778091b644aa8bda3ca598a3ca7223c" kindref="member">SFE_UNIMPLEMENTED</ref><sp/>;</highlight></codeline>
<codeline lineno="1192"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>ogg_open<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1193"><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/libsndfile/src/ogg.c"/>
  </compounddef>
</doxygen>
