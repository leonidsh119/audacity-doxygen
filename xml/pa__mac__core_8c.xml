<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="pa__mac__core_8c" kind="file" language="C++">
    <compoundname>pa_mac_core.c</compoundname>
    <includes refid="pa__mac__core__internal_8h" local="yes">pa_mac_core_internal.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">libkern/OSAtomic.h</includes>
    <includes refid="pa__mac__core_8h" local="yes">pa_mac_core.h</includes>
    <includes refid="pa__mac__core__utilities_8h" local="yes">pa_mac_core_utilities.h</includes>
    <includes refid="pa__mac__core__blocking_8h" local="yes">pa_mac_core_blocking.h</includes>
    <incdepgraph>
      <node id="29777">
        <label>CoreAudio/CoreAudio.h</label>
      </node>
      <node id="29775">
        <label>C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c</label>
        <link refid="pa_mac_core.c"/>
        <childnode refid="29776" relation="include">
        </childnode>
        <childnode refid="29795" relation="include">
        </childnode>
        <childnode refid="29796" relation="include">
        </childnode>
        <childnode refid="29797" relation="include">
        </childnode>
        <childnode refid="29793" relation="include">
        </childnode>
        <childnode refid="29792" relation="include">
        </childnode>
      </node>
      <node id="29776">
        <label>pa_mac_core_internal.h</label>
        <link refid="pa__mac__core__internal_8h"/>
        <childnode refid="29777" relation="include">
        </childnode>
        <childnode refid="29778" relation="include">
        </childnode>
        <childnode refid="29779" relation="include">
        </childnode>
        <childnode refid="29780" relation="include">
        </childnode>
        <childnode refid="29781" relation="include">
        </childnode>
        <childnode refid="29782" relation="include">
        </childnode>
        <childnode refid="29783" relation="include">
        </childnode>
        <childnode refid="29784" relation="include">
        </childnode>
        <childnode refid="29785" relation="include">
        </childnode>
        <childnode refid="29786" relation="include">
        </childnode>
        <childnode refid="29787" relation="include">
        </childnode>
        <childnode refid="29791" relation="include">
        </childnode>
        <childnode refid="29792" relation="include">
        </childnode>
      </node>
      <node id="29793">
        <label>pa_mac_core_utilities.h</label>
        <link refid="pa__mac__core__utilities_8h"/>
        <childnode refid="29794" relation="include">
        </childnode>
        <childnode refid="29781" relation="include">
        </childnode>
        <childnode refid="29782" relation="include">
        </childnode>
        <childnode refid="29779" relation="include">
        </childnode>
        <childnode refid="29780" relation="include">
        </childnode>
      </node>
      <node id="29783">
        <label>pa_hostapi.h</label>
        <link refid="pa__hostapi_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
      </node>
      <node id="29785">
        <label>pa_allocation.h</label>
        <link refid="pa__allocation_8h"/>
      </node>
      <node id="29787">
        <label>pa_process.h</label>
        <link refid="pa__process_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
        <childnode refid="29788" relation="include">
        </childnode>
        <childnode refid="29789" relation="include">
        </childnode>
      </node>
      <node id="29796">
        <label>libkern/OSAtomic.h</label>
      </node>
      <node id="29786">
        <label>pa_cpuload.h</label>
        <link refid="pa__cpuload_8h"/>
      </node>
      <node id="29778">
        <label>CoreServices/CoreServices.h</label>
      </node>
      <node id="29779">
        <label>AudioUnit/AudioUnit.h</label>
      </node>
      <node id="29794">
        <label>pthread.h</label>
      </node>
      <node id="29795">
        <label>string.h</label>
      </node>
      <node id="29780">
        <label>AudioToolbox/AudioToolbox.h</label>
      </node>
      <node id="29789">
        <label>pa_dither.h</label>
        <link refid="pa__dither_8h"/>
        <childnode refid="29790" relation="include">
        </childnode>
      </node>
      <node id="29791">
        <label>pa_ringbuffer.h</label>
        <link refid="pa__ringbuffer_8h"/>
      </node>
      <node id="29781">
        <label>portaudio.h</label>
        <link refid="portaudio_8h"/>
      </node>
      <node id="29784">
        <label>pa_stream.h</label>
        <link refid="pa__stream_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
      </node>
      <node id="29790">
        <label>pa_types.h</label>
        <link refid="pa__types_8h"/>
      </node>
      <node id="29788">
        <label>pa_converters.h</label>
        <link refid="pa__converters_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
      </node>
      <node id="29792">
        <label>pa_mac_core_blocking.h</label>
        <link refid="pa__mac__core__blocking_8h"/>
        <childnode refid="29791" relation="include">
        </childnode>
        <childnode refid="29781" relation="include">
        </childnode>
        <childnode refid="29793" relation="include">
        </childnode>
      </node>
      <node id="29797">
        <label>pa_mac_core.h</label>
        <link refid="pa__mac__core_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
        <childnode refid="29779" relation="include">
        </childnode>
        <childnode refid="29780" relation="include">
        </childnode>
      </node>
      <node id="29782">
        <label>pa_util.h</label>
        <link refid="pa__util_8h"/>
        <childnode refid="29781" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="pa__mac__core_8c_1a7ab4a20ecccd368c383dcf5ed152141e" prot="public" static="no">
        <name>PA_MAC_SMALL_BUFFER_SIZE</name>
        <initializer>(64)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="81" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="81" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a341f496004a3608bb6534632b2399cf8" prot="public" static="no">
        <name>RING_BUFFER_ADVANCE_DENOMINATOR</name>
        <initializer>(4)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="258" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="258" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a1afb825b4c44e8bdfbb68e2ec9938577" prot="public" static="no">
        <name>PA_AUHAL_SET_LAST_HOST_ERROR</name>
        <param><defname>errorCode</defname></param>
        <param><defname>errorText</defname></param>
        <initializer><ref refid="pa__util_8h_1a9c3ad627c13c1d695fef054c216667f7" kindref="member">PaUtil_SetLastHostErrorInfo</ref>( <ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aeaa7295ccb885c47b70c829f8236161d1a" kindref="member">paCoreAudio</ref>, <ref refid="xmlparse_8c_1adf47938902be0f6a9c144226d02fd634" kindref="member">errorCode</ref>, errorText )</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="309" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="309" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" prot="public" static="no">
        <name>ERR_WRAP</name>
        <param><defname>mac_err</defname></param>
        <initializer>do { result = mac_err ; <ref refid="seqread_8c_1aad9ebcdde542d8b2075615388ff15a9c" kindref="member">line</ref> = __LINE__ ; <ref refid="sndfile__save_8m_1a55944e1fa1bcc1bfc6185bc610b0a930" kindref="member">if</ref> ( result != noErr ) goto <ref refid="sndfile__save_8m_1ada4b423bc19e6ff5c5b514e55f518a82" kindref="member">error</ref> ; } while(0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1266" column="9"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a29bfcd9536b7a2bdb81a88e904e06098" prot="public" static="no">
        <name>HOST_TIME_TO_PA_TIME</name>
        <param><defname>x</defname></param>
        <initializer>( AudioConvertHostTimeToNanos( (x) ) * 1.0E-09) /* convert to nanoseconds and then to seconds */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2098" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2098" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" prot="public" static="no">
        <name>RING_BUFFER_EMPTY</name>
        <initializer>(1000)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2105" column="9" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2105" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" prot="public" static="no">
        <name>ERR_WRAP</name>
        <param><defname>mac_err</defname></param>
        <initializer>do { result = mac_err ; <ref refid="sndfile__save_8m_1a55944e1fa1bcc1bfc6185bc610b0a930" kindref="member">if</ref> ( result != noErr ) <ref refid="hashrout_8h_1a9842e92184417c07866419916b2b3ce3" kindref="member">return</ref> <ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(result) ; } while(0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2675" column="9"/>
      </memberdef>
      <memberdef kind="define" id="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" prot="public" static="no">
        <name>ERR_WRAP</name>
        <param><defname>mac_err</defname></param>
        <initializer>do { result = mac_err ; <ref refid="sndfile__save_8m_1a55944e1fa1bcc1bfc6185bc610b0a930" kindref="member">if</ref> ( result != noErr ) <ref refid="hashrout_8h_1a9842e92184417c07866419916b2b3ce3" kindref="member">return</ref> <ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(result) ; } while(0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2723" column="9"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="pa__mac__core_8c_1aab157a5c0fcbc36b024338c4efb3b71d" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* channelName</definition>
        <argsstring></argsstring>
        <name>channelName</name>
        <initializer>= <ref refid="px__mixer_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="109" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="109" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="pa__mac__core_8c_1adf1138e8a91679c18bf1e741e92329c7" prot="public" static="yes" mutable="no">
        <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
        <definition>int channelNameSize</definition>
        <argsstring></argsstring>
        <name>channelNameSize</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="110" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="110" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="pa__mac__core_8c_1a9d5b7af64c23abc3f0a9431bb12af330" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>PaError PaMacCore_Initialize</definition>
        <argsstring>(PaUtilHostApiRepresentation **hostApi, PaHostApiIndex index)</argsstring>
        <name>PaMacCore_Initialize</name>
        <param>
          <type><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> **</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref></type>
          <declname>index</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="84" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="718" bodyend="861"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a385859d73470082d74a998b45981910d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>void PaMacCore_SetupStreamInfo</definition>
        <argsstring>(PaMacCoreStreamInfo *data, const unsigned long flags)</argsstring>
        <name>PaMacCore_SetupStreamInfo</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>flags</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Functions Use this function to initialize a paMacCoreStreamInfo struct using the requested flags. Note that channel mapping is turned off after a call to this function. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>The datastructure to initialize </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>flags</parametername>
</parameternamelist>
<parameterdescription>
<para>The flags to initialize the datastructure with. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="90" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="90" bodyend="99"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a38dcd57a6d716de1bf6b66ec42544c9d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>void PaMacCore_SetupChannelMap</definition>
        <argsstring>(PaMacCoreStreamInfo *data, const SInt32 *const channelMap, const unsigned long channelMapSize)</argsstring>
        <name>PaMacCore_SetupChannelMap</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> SInt32 *<ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref></type>
          <declname>channelMap</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>channelMapSize</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>call this after pa_SetupMacCoreStreamInfo to use channel mapping as described in notes.txt. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>The stream info structure to assign a channel mapping to </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>channelMap</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel map array, as described in notes.txt. This array pointer will be used directly (ie the underlying data will not be copied), so the caller should not free the array until after the stream has been opened. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>channelMapSize</parametername>
</parameternamelist>
<parameterdescription>
<para>The size of the channel map array. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="104" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="104" bodyend="108"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ab32eb341c93a12e10f0d2430e1f33f5c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="mac_2config_2i386_2lib-src_2libsoxr_2soxr-config_8h_1abb452686968e48b67397da5f97445f5b" kindref="member">bool</ref></type>
        <definition>static bool ensureChannelNameSize</definition>
        <argsstring>(int size)</argsstring>
        <name>ensureChannelNameSize</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="111" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="111" bodyend="122"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aa8d59756f200f1e97f651c14c961f2d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> char *</type>
        <definition>const char* PaMacCore_GetChannelName</definition>
        <argsstring>(int device, int channelIndex, bool input)</argsstring>
        <name>PaMacCore_GetChannelName</name>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>device</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>channelIndex</declname>
        </param>
        <param>
          <type><ref refid="mac_2config_2i386_2lib-src_2libsoxr_2soxr-config_8h_1abb452686968e48b67397da5f97445f5b" kindref="member">bool</ref></type>
          <declname>input</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns a statically allocated string with the device&apos;s name for the given channel. NULL will be returned on failure.</para><para>This function&apos;s implemenation is not complete!</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>device</parametername>
</parameternamelist>
<parameterdescription>
<para>The PortAudio device index. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel number who&apos;s name is requested. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>a statically allocated string with the name of the device. Because this string is statically allocated, it must be coppied if it is to be saved and used by the user after another call to this function. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="126" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="126" bodyend="200"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aa470cfe0a7a53a6bc7eab4b18f670d31" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>PaError PaMacCore_GetBufferSizeRange</definition>
        <argsstring>(PaDeviceIndex device, long *minBufferSizeFrames, long *maxBufferSizeFrames)</argsstring>
        <name>PaMacCore_GetBufferSizeRange</name>
        <param>
          <type><ref refid="portaudio_8h_1ad79317e65bde63d76c4b8e711ac5a361" kindref="member">PaDeviceIndex</ref></type>
          <declname>device</declname>
        </param>
        <param>
          <type>long *</type>
          <declname>minBufferSizeFrames</declname>
        </param>
        <param>
          <type>long *</type>
          <declname>maxBufferSizeFrames</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieve the range of legal native buffer sizes for the specificed device, in sample frames.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>device</parametername>
</parameternamelist>
<parameterdescription>
<para>The global index of the PortAudio device about which the query is being made. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>minBufferSizeFrames</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to the location which will receive the minimum buffer size value. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>maxBufferSizeFrames</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to the location which will receive the maximum buffer size value.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para>kAudioDevicePropertyBufferFrameSizeRange <ref refid="latency_8c_1a7d946209d777cb95fe30364b8d321207" kindref="member">in</ref> <ref refid="nasm_8h_1aaf57ffcfef0bee04f46c6ada2a905a8c" kindref="member">the</ref> CoreAudio SDK. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="203" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="203" bodyend="235"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ad1631115a64682f8e14fadd0a75c027f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>AudioDeviceID</type>
        <definition>AudioDeviceID PaMacCore_GetStreamInputDevice</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>PaMacCore_GetStreamInputDevice</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieve the AudioDeviceID of the input device assigned to an open stream</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>s</parametername>
</parameternamelist>
<parameterdescription>
<para>The stream to query.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A valid AudioDeviceID, or NULL if an error occurred. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="238" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="238" bodyend="244"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a25379f181725095041d159e3bdc8cd8c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>AudioDeviceID</type>
        <definition>AudioDeviceID PaMacCore_GetStreamOutputDevice</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>PaMacCore_GetStreamOutputDevice</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieve the AudioDeviceID of the output device assigned to an open stream</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>s</parametername>
</parameternamelist>
<parameterdescription>
<para>The stream to query.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A valid AudioDeviceID, or NULL if an error occurred. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="246" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="246" bodyend="252"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aceda435bfe9c0d0959dcd41043016c6c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void Terminate</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi)</argsstring>
        <name>Terminate</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="260" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="864" bodyend="889"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1addd36fca55daaf757e041555254b05e3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsFormatSupported</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, double sampleRate)</argsstring>
        <name>IsFormatSupported</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>These first checks are standard PA checks. We do some fancier checks later. </para>        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="261" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="892" bodyend="988"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ac43ea176a845c04786718d19a88b9455" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError OpenStream</definition>
        <argsstring>(struct PaUtilHostApiRepresentation *hostApi, PaStream **s, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, double sampleRate, unsigned long framesPerBuffer, PaStreamFlags streamFlags, PaStreamCallback *streamCallback, void *userData)</argsstring>
        <name>OpenStream</name>
        <param>
          <type>struct <ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref> *</type>
          <declname>hostApi</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> **</type>
          <declname>s</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type>unsigned long</type>
          <declname>framesPerBuffer</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref></type>
          <declname>streamFlags</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref> *</type>
          <declname>streamCallback</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>userData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="265" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1683" bodyend="2095"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a6684024dfdc36122d40cf7adae0e4322" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError CloseStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>CloseStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="274" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2587" bodyend="2666"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1afa58dcb70fc29aa4c667d6d07b748f6e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError StartStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>StartStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="275" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2668" bodyend="2693"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a39e942c55c24e34c3796d29d61889370" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError StopStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>StopStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="276" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2710" bodyend="2771"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a28c623db69cda01e15f064fd2bf84f0f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError AbortStream</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>AbortStream</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="277" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2773" bodyend="2779"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aa9f1516c5edd9ea34b8e150f662f8f4e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsStreamStopped</definition>
        <argsstring>(PaStream *s)</argsstring>
        <name>IsStreamStopped</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="278" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2782" bodyend="2788"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a4f3f06c27a57b78bf59b603f30b6b466" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError IsStreamActive</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>IsStreamActive</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="279" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2791" bodyend="2796"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aeb3491d1ed49c219c757101e56f51758" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref></type>
        <definition>PaTime GetStreamTime</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamTime</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="280" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2100" bodyend="2103"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a7b0eccd80a4ff1f14813c3ac482852ae" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus AudioIOProc</definition>
        <argsstring>(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData)</argsstring>
        <name>AudioIOProc</name>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>inRefCon</declname>
        </param>
        <param>
          <type>AudioUnitRenderActionFlags *</type>
          <declname>ioActionFlags</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> AudioTimeStamp *</type>
          <declname>inTimeStamp</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>inBusNumber</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>inNumberFrames</declname>
        </param>
        <param>
          <type>AudioBufferList *</type>
          <declname>ioData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="281" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2141" bodyend="2580"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a3877d53c30b8b20f35f362ef07b998cd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>static double GetStreamCpuLoad</definition>
        <argsstring>(PaStream *stream)</argsstring>
        <name>GetStreamCpuLoad</name>
        <param>
          <type><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="287" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2799" bodyend="2805"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1afe5b9717fbf73209d7813639d6d456ce" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError GetChannelInfo</definition>
        <argsstring>(PaMacAUHAL *auhalHostApi, PaDeviceInfo *deviceInfo, AudioDeviceID macCoreDeviceId, int isInput)</argsstring>
        <name>GetChannelInfo</name>
        <param>
          <type><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref> *</type>
          <declname>auhalHostApi</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> *</type>
          <declname>deviceInfo</declname>
        </param>
        <param>
          <type>AudioDeviceID</type>
          <declname>macCoreDeviceId</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>isInput</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="289" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="576" bodyend="644"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1addafc3901c160b054a1d77ec790b96d4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError OpenAndSetupOneAudioUnit</definition>
        <argsstring>(const PaMacCoreStream *stream, const PaStreamParameters *inStreamParams, const PaStreamParameters *outStreamParams, const UInt32 requestedFramesPerBuffer, UInt32 *actualInputFramesPerBuffer, UInt32 *actualOutputFramesPerBuffer, const PaMacAUHAL *auhalHostApi, AudioUnit *audioUnit, AudioConverterRef *srConverter, AudioDeviceID *audioDevice, const double sampleRate, void *refCon)</argsstring>
        <name>OpenAndSetupOneAudioUnit</name>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inStreamParams</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outStreamParams</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> UInt32</type>
          <declname>requestedFramesPerBuffer</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>actualInputFramesPerBuffer</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>actualOutputFramesPerBuffer</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref> *</type>
          <declname>auhalHostApi</declname>
        </param>
        <param>
          <type>AudioUnit *</type>
          <declname>audioUnit</declname>
        </param>
        <param>
          <type>AudioConverterRef *</type>
          <declname>srConverter</declname>
        </param>
        <param>
          <type>AudioDeviceID *</type>
          <declname>audioDevice</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>refCon</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="294" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1162" bodyend="1615"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ad56fab0e345db536b9548a8588214370" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void startStopCallback</definition>
        <argsstring>(void *inRefCon, AudioUnit ci, AudioUnitPropertyID inID, AudioUnitScope inScope, AudioUnitElement inElement)</argsstring>
        <name>startStopCallback</name>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>inRefCon</declname>
        </param>
        <param>
          <type>AudioUnit</type>
          <declname>ci</declname>
        </param>
        <param>
          <type>AudioUnitPropertyID</type>
          <declname>inID</declname>
        </param>
        <param>
          <type>AudioUnitScope</type>
          <declname>inScope</declname>
        </param>
        <param>
          <type>AudioUnitElement</type>
          <declname>inElement</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="315" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="315" bodyend="340"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a531bc264c485ab6c431678141fb647fb" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError gatherDeviceInfo</definition>
        <argsstring>(PaMacAUHAL *auhalHostApi)</argsstring>
        <name>gatherDeviceInfo</name>
        <param>
          <type><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref> *</type>
          <declname>auhalHostApi</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="345" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="345" bodyend="427"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ae6ec6a9cf304bf3f30e59429abd0a1f9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError ClipToDeviceBufferSize</definition>
        <argsstring>(AudioDeviceID macCoreDeviceId, int isInput, UInt32 desiredSize, UInt32 *allowedSize)</argsstring>
        <name>ClipToDeviceBufferSize</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>macCoreDeviceId</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>desiredSize</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>allowedSize</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="434" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="434" bodyend="445"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a5c69e836b9d31cec0d255a74a68221e5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError CalculateFixedDeviceLatency</definition>
        <argsstring>(AudioDeviceID macCoreDeviceId, int isInput, UInt32 *fixedLatencyPtr)</argsstring>
        <name>CalculateFixedDeviceLatency</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>macCoreDeviceId</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>fixedLatencyPtr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="508" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="508" bodyend="540"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a487e017e8c33167b27200dd9a5eefd9c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError CalculateDefaultDeviceLatencies</definition>
        <argsstring>(AudioDeviceID macCoreDeviceId, int isInput, UInt32 *lowLatencyFramesPtr, UInt32 *highLatencyFramesPtr)</argsstring>
        <name>CalculateDefaultDeviceLatencies</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>macCoreDeviceId</declname>
        </param>
        <param>
          <type><ref refid="xmltok_8h_1a5a0d4a5641ce434f1d23533f2b2e6653" kindref="member">int</ref></type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>lowLatencyFramesPtr</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>highLatencyFramesPtr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="543" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="543" bodyend="572"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a13983da2a49679e058a0f59d0ffb511e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref></type>
        <definition>static PaError InitializeDeviceInfo</definition>
        <argsstring>(PaMacAUHAL *auhalHostApi, PaDeviceInfo *deviceInfo, AudioDeviceID macCoreDeviceId, PaHostApiIndex hostApiIndex)</argsstring>
        <name>InitializeDeviceInfo</name>
        <param>
          <type><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref> *</type>
          <declname>auhalHostApi</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref> *</type>
          <declname>deviceInfo</declname>
        </param>
        <param>
          <type>AudioDeviceID</type>
          <declname>macCoreDeviceId</declname>
        </param>
        <param>
          <type><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref></type>
          <declname>hostApiIndex</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="647" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="647" bodyend="716"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a4c14e20c7057164c2faea287789767c4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void InitializeDeviceProperties</definition>
        <argsstring>(PaMacCoreDeviceProperties *deviceProperties)</argsstring>
        <name>InitializeDeviceProperties</name>
        <param>
          <type><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref> *</type>
          <declname>deviceProperties</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="991" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="991" bodyend="996"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a34fea5a0d91ccf47c0430b0ea05a93a3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Float64</type>
        <definition>static Float64 CalculateSoftwareLatencyFromProperties</definition>
        <argsstring>(PaMacCoreStream *stream, PaMacCoreDeviceProperties *deviceProperties)</argsstring>
        <name>CalculateSoftwareLatencyFromProperties</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref> *</type>
          <declname>deviceProperties</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="998" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="998" bodyend="1002"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a4d08231b01cca389c1708bf9c543e08f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Float64</type>
        <definition>static Float64 CalculateHardwareLatencyFromProperties</definition>
        <argsstring>(PaMacCoreStream *stream, PaMacCoreDeviceProperties *deviceProperties)</argsstring>
        <name>CalculateHardwareLatencyFromProperties</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref> *</type>
          <declname>deviceProperties</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1004" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1004" bodyend="1007"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a413b2f5cb7880cb69d5e46a3ee4befb0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void UpdateTimeStampOffsets</definition>
        <argsstring>(PaMacCoreStream *stream)</argsstring>
        <name>UpdateTimeStampOffsets</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1013" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1013" bodyend="1037"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aaac271ece6f184694155e868bef405ab" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus UpdateSampleRateFromDeviceProperty</definition>
        <argsstring>(PaMacCoreStream *stream, AudioDeviceID deviceID, Boolean isInput, AudioDevicePropertyID sampleRatePropertyID)</argsstring>
        <name>UpdateSampleRateFromDeviceProperty</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>AudioDeviceID</type>
          <declname>deviceID</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>AudioDevicePropertyID</type>
          <declname>sampleRatePropertyID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1042" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1042" bodyend="1055"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aedd87ed917110b709caefca581f6bc0a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus AudioDevicePropertyActualSampleRateListenerProc</definition>
        <argsstring>(AudioDeviceID inDevice, UInt32 inChannel, Boolean isInput, AudioDevicePropertyID inPropertyID, void *inClientData)</argsstring>
        <name>AudioDevicePropertyActualSampleRateListenerProc</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>inDevice</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>inChannel</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>AudioDevicePropertyID</type>
          <declname>inPropertyID</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>inClientData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1057" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1057" bodyend="1070"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1ab919589c9d83f068d56154a18a9428f5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus QueryUInt32DeviceProperty</definition>
        <argsstring>(AudioDeviceID deviceID, Boolean isInput, AudioDevicePropertyID propertyID, UInt32 *outValue)</argsstring>
        <name>QueryUInt32DeviceProperty</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>deviceID</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>AudioDevicePropertyID</type>
          <declname>propertyID</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>outValue</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1073" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1073" bodyend="1083"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1aa4cbb7440376aaab8fb93b6370f7320a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus AudioDevicePropertyGenericListenerProc</definition>
        <argsstring>(AudioDeviceID inDevice, UInt32 inChannel, Boolean isInput, AudioDevicePropertyID inPropertyID, void *inClientData)</argsstring>
        <name>AudioDevicePropertyGenericListenerProc</name>
        <param>
          <type>AudioDeviceID</type>
          <declname>inDevice</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>inChannel</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <param>
          <type>AudioDevicePropertyID</type>
          <declname>inPropertyID</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>inClientData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1085" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1085" bodyend="1118"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a7cef4f790de4db9e0c6d43732a508b99" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus SetupDevicePropertyListeners</definition>
        <argsstring>(PaMacCoreStream *stream, AudioDeviceID deviceID, Boolean isInput)</argsstring>
        <name>SetupDevicePropertyListeners</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>AudioDeviceID</type>
          <declname>deviceID</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1123" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1123" bodyend="1146"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a899878215cccf769892232215890b72c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref></type>
        <definition>static void CleanupDevicePropertyListeners</definition>
        <argsstring>(PaMacCoreStream *stream, AudioDeviceID deviceID, Boolean isInput)</argsstring>
        <name>CleanupDevicePropertyListeners</name>
        <param>
          <type><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref> *</type>
          <declname>stream</declname>
        </param>
        <param>
          <type>AudioDeviceID</type>
          <declname>deviceID</declname>
        </param>
        <param>
          <type>Boolean</type>
          <declname>isInput</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1148" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1148" bodyend="1159"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a80cd0a86a63cb6886759e5b466d89d7a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>UInt32</type>
        <definition>static UInt32 CalculateOptimalBufferSize</definition>
        <argsstring>(PaMacAUHAL *auhalHostApi, const PaStreamParameters *inputParameters, const PaStreamParameters *outputParameters, UInt32 fixedInputLatency, UInt32 fixedOutputLatency, double sampleRate, UInt32 requestedFramesPerBuffer)</argsstring>
        <name>CalculateOptimalBufferSize</name>
        <param>
          <type><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref> *</type>
          <declname>auhalHostApi</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>inputParameters</declname>
        </param>
        <param>
          <type><ref refid="getopt1_8c_1a2c212835823e3c54a8ab6d95c652660e" kindref="member">const</ref> <ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref> *</type>
          <declname>outputParameters</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>fixedInputLatency</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>fixedOutputLatency</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sampleRate</declname>
        </param>
        <param>
          <type>UInt32</type>
          <declname>requestedFramesPerBuffer</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="1619" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="1619" bodyend="1679"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a54a0852f41a93a3838e9c9235ab9e5dd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>OSStatus</type>
        <definition>static OSStatus ringBufferIOProc</definition>
        <argsstring>(AudioConverterRef inAudioConverter, UInt32 *ioDataSize, void **outData, void *inUserData)</argsstring>
        <name>ringBufferIOProc</name>
        <param>
          <type>AudioConverterRef</type>
          <declname>inAudioConverter</declname>
        </param>
        <param>
          <type>UInt32 *</type>
          <declname>ioDataSize</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> **</type>
          <declname>outData</declname>
        </param>
        <param>
          <type><ref refid="sound_8c_1ae35f5844602719cf66324f4de2a658b3" kindref="member">void</ref> *</type>
          <declname>inUserData</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2107" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2107" bodyend="2134"/>
      </memberdef>
      <memberdef kind="function" id="pa__mac__core_8c_1a22d18bb334f0533e25293a3a23525383" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>ComponentResult</type>
        <definition>static ComponentResult BlockWhileAudioUnitIsRunning</definition>
        <argsstring>(AudioUnit audioUnit, AudioUnitElement element)</argsstring>
        <name>BlockWhileAudioUnitIsRunning</name>
        <param>
          <type>AudioUnit</type>
          <declname>audioUnit</declname>
        </param>
        <param>
          <type>AudioUnitElement</type>
          <declname>element</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" line="2697" column="1" bodyfile="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c" bodystart="2697" bodyend="2708"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Implementation<sp/>of<sp/>the<sp/>PortAudio<sp/>API<sp/>for<sp/>Apple<sp/>AUHAL</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>PortAudio<sp/>Portable<sp/>Real-Time<sp/>Audio<sp/>Library</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Latest<sp/>Version<sp/>at:<sp/>http://www.portaudio.com</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>Written<sp/>by<sp/>Bjorn<sp/>Roche<sp/>of<sp/>XO<sp/>Audio<sp/>LLC,<sp/>from<sp/>PA<sp/>skeleton<sp/>code.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>Portions<sp/>copied<sp/>from<sp/>code<sp/>by<sp/>Dominic<sp/>Mazzoni<sp/>(who<sp/>wrote<sp/>a<sp/>HAL<sp/>implementation)</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>Dominic&apos;s<sp/>code<sp/>was<sp/>based<sp/>on<sp/>code<sp/>by<sp/>Phil<sp/>Burk,<sp/>Darren<sp/>Gibbs,</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>Gord<sp/>Peters,<sp/>Stephane<sp/>Letz,<sp/>and<sp/>Greg<sp/>Pfiel.</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>The<sp/>following<sp/>people<sp/>also<sp/>deserve<sp/>acknowledgements:</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>Olivier<sp/>Tristan<sp/>for<sp/>feedback<sp/>and<sp/>testing</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>Glenn<sp/>Zelniker<sp/>and<sp/>Z-Systems<sp/>engineering<sp/>for<sp/>sponsoring<sp/>the<sp/>Blocking<sp/>I/O</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>interface.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>Based<sp/>on<sp/>the<sp/>Open<sp/>Source<sp/>API<sp/>proposed<sp/>by<sp/>Ross<sp/>Bencina</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>1999-2002<sp/>Ross<sp/>Bencina,<sp/>Phil<sp/>Burk</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>Permission<sp/>is<sp/>hereby<sp/>granted,<sp/>free<sp/>of<sp/>charge,<sp/>to<sp/>any<sp/>person<sp/>obtaining</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>a<sp/>copy<sp/>of<sp/>this<sp/>software<sp/>and<sp/>associated<sp/>documentation<sp/>files</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>(the<sp/>&quot;Software&quot;),<sp/>to<sp/>deal<sp/>in<sp/>the<sp/>Software<sp/>without<sp/>restriction,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>including<sp/>without<sp/>limitation<sp/>the<sp/>rights<sp/>to<sp/>use,<sp/>copy,<sp/>modify,<sp/>merge,</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>publish,<sp/>distribute,<sp/>sublicense,<sp/>and/or<sp/>sell<sp/>copies<sp/>of<sp/>the<sp/>Software,</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>and<sp/>to<sp/>permit<sp/>persons<sp/>to<sp/>whom<sp/>the<sp/>Software<sp/>is<sp/>furnished<sp/>to<sp/>do<sp/>so,</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>subject<sp/>to<sp/>the<sp/>following<sp/>conditions:</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/>The<sp/>above<sp/>copyright<sp/>notice<sp/>and<sp/>this<sp/>permission<sp/>notice<sp/>shall<sp/>be</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/>included<sp/>in<sp/>all<sp/>copies<sp/>or<sp/>substantial<sp/>portions<sp/>of<sp/>the<sp/>Software.</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*<sp/>THE<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>&quot;AS<sp/>IS&quot;,<sp/>WITHOUT<sp/>WARRANTY<sp/>OF<sp/>ANY<sp/>KIND,</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/>EXPRESS<sp/>OR<sp/>IMPLIED,<sp/>INCLUDING<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO<sp/>THE<sp/>WARRANTIES<sp/>OF</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/>MERCHANTABILITY,<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>AND<sp/>NONINFRINGEMENT.</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>AUTHORS<sp/>OR<sp/>COPYRIGHT<sp/>HOLDERS<sp/>BE<sp/>LIABLE<sp/>FOR</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/>ANY<sp/>CLAIM,<sp/>DAMAGES<sp/>OR<sp/>OTHER<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>AN<sp/>ACTION<sp/>OF</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/>CONTRACT,<sp/>TORT<sp/>OR<sp/>OTHERWISE,<sp/>ARISING<sp/>FROM,<sp/>OUT<sp/>OF<sp/>OR<sp/>IN<sp/>CONNECTION</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>WITH<sp/>THE<sp/>SOFTWARE<sp/>OR<sp/>THE<sp/>USE<sp/>OR<sp/>OTHER<sp/>DEALINGS<sp/>IN<sp/>THE<sp/>SOFTWARE.</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/>The<sp/>text<sp/>above<sp/>constitutes<sp/>the<sp/>entire<sp/>PortAudio<sp/>license;<sp/>however,<sp/></highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/>the<sp/>PortAudio<sp/>community<sp/>also<sp/>makes<sp/>the<sp/>following<sp/>non-binding<sp/>requests:</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/>Any<sp/>person<sp/>wishing<sp/>to<sp/>distribute<sp/>modifications<sp/>to<sp/>the<sp/>Software<sp/>is</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/>requested<sp/>to<sp/>send<sp/>the<sp/>modifications<sp/>to<sp/>the<sp/>original<sp/>developer<sp/>so<sp/>that</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/>they<sp/>can<sp/>be<sp/>incorporated<sp/>into<sp/>the<sp/>canonical<sp/>version.<sp/>It<sp/>is<sp/>also<sp/></highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>requested<sp/>that<sp/>these<sp/>non-binding<sp/>requests<sp/>be<sp/>included<sp/>along<sp/>with<sp/>the<sp/></highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/>license<sp/>above.</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="comment">/*<sp/>FIXME:<sp/>not<sp/>all<sp/>error<sp/>conditions<sp/>call<sp/>PaUtil_SetLastHostErrorInfo()</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/>PaMacCore_SetError()<sp/>will<sp/>do<sp/>this.</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__mac__core__internal_8h" kindref="compound">pa_mac_core_internal.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>strlen(),<sp/>memcmp()<sp/>etc.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;libkern/OSAtomic.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__mac__core_8h" kindref="compound">pa_mac_core.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__mac__core__utilities_8h" kindref="compound">pa_mac_core_utilities.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pa__mac__core__blocking_8h" kindref="compound">pa_mac_core_blocking.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal">{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>__cplusplus<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>This<sp/>is<sp/>a<sp/>reasonable<sp/>size<sp/>for<sp/>a<sp/>small<sp/>buffer<sp/>based<sp/>on<sp/>experience.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="pa__mac__core_8c_1a7ab4a20ecccd368c383dcf5ed152141e" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>PA_MAC_SMALL_BUFFER_SIZE<sp/><sp/><sp/><sp/>(64)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>prototypes<sp/>for<sp/>functions<sp/>declared<sp/>in<sp/>this<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core_8c_1a9d5b7af64c23abc3f0a9431bb12af330" kindref="member">PaMacCore_Initialize</ref>(<sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>**hostApi,<sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/>index<sp/>);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/>Function<sp/>declared<sp/>in<sp/>pa_mac_core.h.<sp/>Sets<sp/>up<sp/>a<sp/>PaMacCoreStreamInfoStruct</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>requested<sp/>flags<sp/>and<sp/>initializes<sp/>channel<sp/>map.</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="pa__mac__core_8c_1a385859d73470082d74a998b45981910d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core_8c_1a385859d73470082d74a998b45981910d" kindref="member">PaMacCore_SetupStreamInfo</ref>(<sp/><sp/><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref><sp/>*<ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>flags<sp/>)</highlight></codeline>
<codeline lineno="91"><highlight class="normal">{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/>bzero(<sp/>data,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1a6a208a662332f447094b382a00a2a635" kindref="member">size</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref><sp/>);</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1a63f4110b767bfbf2fa09b88f3252d91e" kindref="member">hostApiType</ref><sp/>=<sp/><ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aeaa7295ccb885c47b70c829f8236161d1a" kindref="member">paCoreAudio</ref>;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1ad5ef9592026b8e98f2bf17a61677b064" kindref="member">version</ref><sp/>=<sp/>0x01;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1afe018712e7c57198176ed72cb18f9938" kindref="member">flags</ref><sp/>=<sp/>flags;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1a2339c27ad6b84924be79bf73e4402bd4" kindref="member">channelMap</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1aab3ecc35ef267ecebc8874d399061b87" kindref="member">channelMapSize</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="99"><highlight class="normal">}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*<sp/>Function<sp/>declared<sp/>in<sp/>pa_mac_core.h.<sp/>Adds<sp/>channel<sp/>mapping<sp/>to<sp/>a<sp/>PaMacCoreStreamInfoStruct</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="pa__mac__core_8c_1a38dcd57a6d716de1bf6b66ec42544c9d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core_8c_1a38dcd57a6d716de1bf6b66ec42544c9d" kindref="member">PaMacCore_SetupChannelMap</ref>(<sp/><ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref><sp/>*<ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>SInt32<sp/>*<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>channelMap,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>channelMapSize<sp/>)</highlight></codeline>
<codeline lineno="105"><highlight class="normal">{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1a2339c27ad6b84924be79bf73e4402bd4" kindref="member">channelMap</ref><sp/>=<sp/>channelMap;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/>data-&gt;<ref refid="struct_pa_mac_core_stream_info_1aab3ecc35ef267ecebc8874d399061b87" kindref="member">channelMapSize</ref><sp/>=<sp/>channelMapSize;</highlight></codeline>
<codeline lineno="108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*channelName<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channelNameSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>ensureChannelNameSize(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref><sp/>)</highlight></codeline>
<codeline lineno="112"><highlight class="normal">{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>size<sp/>&gt;=<sp/>channelNameSize<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>free(<sp/>channelName<sp/>);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channelName<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)<sp/>malloc(<sp/>(<sp/>channelNameSize<sp/>=<sp/>size<sp/>)<sp/>+<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!channelName<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channelNameSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="122"><highlight class="normal">}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/>*<sp/>Function<sp/>declared<sp/>in<sp/>pa_mac_core.h.<sp/>retrives<sp/>channel<sp/>names.</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="pa__mac__core_8c_1aa8d59756f200f1e97f651c14c961f2d6" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="pa__mac__core_8c_1aa8d59756f200f1e97f651c14c961f2d6" kindref="member">PaMacCore_GetChannelName</ref>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>device,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channelIndex,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>input<sp/>)</highlight></codeline>
<codeline lineno="127"><highlight class="normal">{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__front_8c_1a41956cda7a9cc69dd178425551a44cbe" kindref="member">PaUtil_GetHostApiRepresentation</ref>(<sp/>&amp;hostApi,<sp/><ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aeaa7295ccb885c47b70c829f8236161d1a" kindref="member">paCoreAudio</ref><sp/>);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(err<sp/>==<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*macCoreHostApi<sp/>=<sp/>(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>*)hostApi;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>hostApiDevice<sp/>=<sp/>macCoreHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[device];</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>CFStringRef<sp/>nameRef;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>First<sp/>try<sp/>with<sp/>CFString<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>size<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(nameRef);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>error<sp/>=<sp/>AudioDeviceGetProperty(<sp/>hostApiDevice,</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channelIndex<sp/>+<sp/>1,</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertyChannelNameCFString,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;nameRef<sp/>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>error<sp/>)</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>try<sp/>the<sp/>C<sp/>String<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>error<sp/>=<sp/>AudioDeviceGetPropertyInfo(<sp/>hostApiDevice,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channelIndex<sp/>+<sp/>1,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input,</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertyChannelName,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!error<sp/>)</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!ensureChannelNameSize(<sp/>size<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>error<sp/>=<sp/>AudioDeviceGetProperty(<sp/>hostApiDevice,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channelIndex<sp/>+<sp/>1,</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertyChannelName,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channelName<sp/>);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!error<sp/>)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channelName;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>as<sp/>a<sp/>last-ditch<sp/>effort,<sp/>we<sp/>use<sp/>the<sp/>device<sp/>name<sp/>and<sp/>append<sp/>the<sp/>channel<sp/>number.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nameRef<sp/>=<sp/>CFStringCreateWithFormat(<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>CFSTR(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>%d&quot;</highlight><highlight class="normal">),<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[device]-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref>,<sp/>channelIndex<sp/>+<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>CFStringGetMaximumSizeForEncoding(CFStringGetLength(nameRef),<sp/>kCFStringEncodingUTF8);;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!ensureChannelNameSize(<sp/>size<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(<sp/>nameRef<sp/>);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFStringGetCString(<sp/>nameRef,<sp/>channelName,<sp/>size+1,<sp/>kCFStringEncodingUTF8<sp/>);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(<sp/>nameRef<sp/>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>CFStringGetMaximumSizeForEncoding(CFStringGetLength(nameRef),<sp/>kCFStringEncodingUTF8);;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!ensureChannelNameSize(<sp/>size<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(<sp/>nameRef<sp/>);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFStringGetCString(<sp/>nameRef,<sp/>channelName,<sp/>size+1,<sp/>kCFStringEncodingUTF8<sp/>);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(<sp/>nameRef<sp/>);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channelName;</highlight></codeline>
<codeline lineno="200"><highlight class="normal">}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="203" refid="pa__mac__core_8c_1aa470cfe0a7a53a6bc7eab4b18f670d31" refkind="member"><highlight class="normal"><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core_8c_1aa470cfe0a7a53a6bc7eab4b18f670d31" kindref="member">PaMacCore_GetBufferSizeRange</ref>(<sp/><ref refid="portaudio_8h_1ad79317e65bde63d76c4b8e711ac5a361" kindref="member">PaDeviceIndex</ref><sp/>device,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*minBufferSizeFrames,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*maxBufferSizeFrames<sp/>)</highlight></codeline>
<codeline lineno="205"><highlight class="normal">{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__front_8c_1a41956cda7a9cc69dd178425551a44cbe" kindref="member">PaUtil_GetHostApiRepresentation</ref>(<sp/>&amp;hostApi,<sp/><ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aeaa7295ccb885c47b70c829f8236161d1a" kindref="member">paCoreAudio</ref><sp/>);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>==<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1ad79317e65bde63d76c4b8e711ac5a361" kindref="member">PaDeviceIndex</ref><sp/>hostApiDeviceIndex;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__front_8c_1a07ed030327e33935a807f671f4840936" kindref="member">PaUtil_DeviceIndexToHostApiDeviceIndex</ref>(<sp/>&amp;hostApiDeviceIndex,<sp/>device,<sp/>hostApi<sp/>);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>==<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*macCoreHostApi<sp/>=<sp/>(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>*)hostApi;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>macCoreDeviceId<sp/>=<sp/>macCoreHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[hostApiDeviceIndex];</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioValueRange<sp/>audioRange;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>audioRange<sp/>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>the<sp/>size<sp/>range<sp/>for<sp/>the<sp/>output<sp/>scope<sp/>unless<sp/>we<sp/>only<sp/>have<sp/>inputs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boolean<sp/>isInput<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>macCoreHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1abe5cf67f9992b647d350cd9fb890a081" kindref="member">inheritedHostApiRep</ref>.<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[hostApiDeviceIndex]-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isInput<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(<sp/>macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSizeRange,<sp/>&amp;propSize,<sp/>&amp;audioRange<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*minBufferSizeFrames<sp/>=<sp/>audioRange.mMinimum;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*maxBufferSizeFrames<sp/>=<sp/>audioRange.mMaximum;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="235"><highlight class="normal">}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238" refid="pa__mac__core_8c_1ad1631115a64682f8e14fadd0a75c027f" refkind="member"><highlight class="normal">AudioDeviceID<sp/><ref refid="pa__mac__core_8c_1ad1631115a64682f8e14fadd0a75c027f" kindref="member">PaMacCore_GetStreamInputDevice</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="239"><highlight class="normal">{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;PaMacCore_GetStreamInputHandle()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref><sp/>);</highlight></codeline>
<codeline lineno="244"><highlight class="normal">}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246" refid="pa__mac__core_8c_1a25379f181725095041d159e3bdc8cd8c" refkind="member"><highlight class="normal">AudioDeviceID<sp/><ref refid="pa__mac__core_8c_1a25379f181725095041d159e3bdc8cd8c" kindref="member">PaMacCore_GetStreamOutputDevice</ref>(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="247"><highlight class="normal">{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;PaMacCore_GetStreamOutputHandle()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref><sp/>);</highlight></codeline>
<codeline lineno="252"><highlight class="normal">}</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal">}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>__cplusplus<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258" refid="pa__mac__core_8c_1a341f496004a3608bb6534632b2399cf8" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>RING_BUFFER_ADVANCE_DENOMINATOR<sp/>(4)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation_1a832b3f01b9d9a84b5442e27d365f8b9f" kindref="member">Terminate</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi<sp/>);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="struct_pa_util_host_api_representation_1a54205572c891d43272de45be0994c377" kindref="member">IsFormatSupported</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="struct_pa_util_host_api_representation_1aa415b57fadf39a49d6bc5740f06089e4" kindref="member">OpenStream</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>**<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesPerBuffer,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref><sp/>streamFlags,</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>*streamCallback,</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CloseStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StartStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StopStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>AbortStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamStopped(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>);</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamActive(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>GetStreamTime(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*stream<sp/>);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>AudioIOProc(<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*inRefCon,</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnitRenderActionFlags<sp/>*ioActionFlags,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>AudioTimeStamp<sp/>*inTimeStamp,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inBusNumber,</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inNumberFrames,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioBufferList<sp/>*ioData<sp/>);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>GetStreamCpuLoad(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>GetChannelInfo(<sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo,</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>OpenAndSetupOneAudioUnit(</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inStreamParams,</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outStreamParams,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>UInt32<sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>*actualInputFramesPerBuffer,</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>*actualOutputFramesPerBuffer,</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnit<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioConverterRef<sp/>*srConverter,</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>*audioDevice,</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*refCon<sp/>);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>for<sp/>setting<sp/>errors.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309" refid="pa__mac__core_8c_1a1afb825b4c44e8bdfbb68e2ec9938577" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>PA_AUHAL_SET_LAST_HOST_ERROR(<sp/>errorCode,<sp/>errorText<sp/>)<sp/>\</highlight></codeline>
<codeline lineno="310"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>PaUtil_SetLastHostErrorInfo(<sp/>paCoreAudio,<sp/>errorCode,<sp/>errorText<sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/>*<sp/>Callback<sp/>called<sp/>when<sp/>starting<sp/>or<sp/>stopping<sp/>a<sp/>stream.</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>startStopCallback(</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inRefCon,</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/>AudioUnit<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ci,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/>AudioUnitPropertyID<sp/><sp/>inID,</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/>AudioUnitScope<sp/><sp/><sp/><sp/><sp/><sp/><sp/>inScope,</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/>AudioUnitElement<sp/><sp/><sp/><sp/><sp/>inElement<sp/>)</highlight></codeline>
<codeline lineno="321"><highlight class="normal">{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*)<sp/>inRefCon;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/>UInt32<sp/>isRunning;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>isRunning<sp/>);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/>OSStatus<sp/>err;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/>err<sp/>=<sp/>AudioUnitGetProperty(<sp/>ci,<sp/>kAudioOutputUnitProperty_IsRunning,<sp/>inScope,<sp/>inElement,<sp/>&amp;isRunning,<sp/>&amp;size<sp/>);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>!err<sp/>);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>isRunning<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//it&apos;s<sp/>very<sp/>unclear<sp/>what<sp/>to<sp/>do<sp/>in<sp/>case<sp/>of<sp/>error<sp/>here.<sp/>There&apos;s<sp/>no<sp/>real<sp/>way<sp/>to<sp/>notify<sp/>the<sp/>user,<sp/>and<sp/>crashing<sp/>seems<sp/>unreasonable.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>isRunning<sp/>)</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//We<sp/>are<sp/>only<sp/>interested<sp/>in<sp/>when<sp/>we<sp/>are<sp/>stopping</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>if<sp/>we<sp/>are<sp/>using<sp/>2<sp/>I/O<sp/>units,<sp/>we<sp/>only<sp/>need<sp/>one<sp/>notification!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>!=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>ci<sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><ref refid="portaudio_8h_1ab2530ee0cb756c67726f9074d3482ef2" kindref="member">PaStreamFinishedCallback</ref><sp/>*sfc<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a9132c3be1600907f747c38d64f4a4a3e" kindref="member">streamFinishedCallback</ref>;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>STOPPING<sp/>)</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>STOPPED<sp/>;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>sfc<sp/>)</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sfc(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a5d47c8cae02066d877bc7c670adb61ad" kindref="member">userData</ref><sp/>);</highlight></codeline>
<codeline lineno="340"><highlight class="normal">}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight><highlight class="comment">/*currently,<sp/>this<sp/>is<sp/>only<sp/>used<sp/>in<sp/>initialization,<sp/>but<sp/>it<sp/>might<sp/>be<sp/>modified</highlight></codeline>
<codeline lineno="344"><highlight class="comment"><sp/><sp/>to<sp/>be<sp/>used<sp/>when<sp/>the<sp/>list<sp/>of<sp/>devices<sp/>changes.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>gatherDeviceInfo(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi)</highlight></codeline>
<codeline lineno="346"><highlight class="normal">{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propsize;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;gatherDeviceInfo()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>free<sp/>any<sp/>previous<sp/>allocations<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>)</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1a9a53cc44b24fb0d201ee0ae9b7b6b64d" kindref="member">PaUtil_GroupFreeMemory</ref>(auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>figure<sp/>out<sp/>how<sp/>many<sp/>devices<sp/>there<sp/>are<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioHardwareGetPropertyInfo(<sp/>kAudioHardwarePropertyDevices,</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;propsize,</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref><sp/>=<sp/>propsize<sp/>/<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>AudioDeviceID<sp/>);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Found<sp/>%ld<sp/>device(s).\n&quot;</highlight><highlight class="normal">,<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>copy<sp/>the<sp/>device<sp/>IDs<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>=<sp/>(AudioDeviceID<sp/>*)<ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>propsize<sp/>);</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioHardwareGetProperty(<sp/>kAudioHardwarePropertyDevices,</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;propsize,</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>MAC_CORE_VERBOSE_DEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>;<sp/>++<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>)</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Device<sp/>%d\t:<sp/>%ld\n&quot;</highlight><highlight class="normal">,<sp/>i,<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i]<sp/>);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>size<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioDeviceID);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref><sp/><sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1ae4876213ad54aeebea056e458dff4bfd" kindref="member">defaultOut</ref><sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>determine<sp/>the<sp/>default<sp/>device.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>I<sp/>am<sp/>not<sp/>sure<sp/>how<sp/>these<sp/>calls<sp/>to<sp/>AudioHardwareGetProperty()</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>could<sp/>fail,<sp/>but<sp/>in<sp/>case<sp/>they<sp/>do,<sp/>we<sp/>use<sp/>the<sp/>first<sp/>available</highlight></codeline>
<codeline lineno="387"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>device<sp/>as<sp/>the<sp/>default.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>AudioHardwareGetProperty(kAudioHardwarePropertyDefaultInputDevice,</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref><sp/><sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>get<sp/>default<sp/>input<sp/>device<sp/>from<sp/>OS.&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((</highlight><highlight class="stringliteral">&quot;<sp/>I<sp/>will<sp/>substitute<sp/>the<sp/>first<sp/>available<sp/>input<sp/>Device.&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>;<sp/>++<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>devInfo;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>GetChannelInfo(<sp/>auhalHostApi,<sp/>&amp;devInfo,</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i],<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref><sp/>)<sp/>)</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>devInfo.<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref><sp/>=<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>];</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>AudioHardwareGetProperty(kAudioHardwarePropertyDefaultOutputDevice,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1ae4876213ad54aeebea056e458dff4bfd" kindref="member">defaultOut</ref>)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref><sp/><sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>get<sp/>default<sp/>output<sp/>device<sp/>from<sp/>OS.&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((</highlight><highlight class="stringliteral">&quot;<sp/>I<sp/>will<sp/>substitute<sp/>the<sp/>first<sp/>available<sp/>output<sp/>Device.&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>;<sp/>++<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>devInfo;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>GetChannelInfo(<sp/>auhalHostApi,<sp/>&amp;devInfo,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i],<sp/><ref refid="cext_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref><sp/>)<sp/>)</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>devInfo.<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1ae4876213ad54aeebea056e458dff4bfd" kindref="member">defaultOut</ref><sp/>=<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>];</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Default<sp/>in<sp/>:<sp/>%ld\n&quot;</highlight><highlight class="normal">,<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref><sp/><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Default<sp/>out:<sp/>%ld\n&quot;</highlight><highlight class="normal">,<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1ae4876213ad54aeebea056e458dff4bfd" kindref="member">defaultOut</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="427"><highlight class="normal">}</highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight></codeline>
<codeline lineno="434"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>ClipToDeviceBufferSize(<sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput,<sp/>UInt32<sp/>desiredSize,<sp/>UInt32<sp/>*allowedSize<sp/>)</highlight></codeline>
<codeline lineno="436"><highlight class="normal">{</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>resultSize<sp/>=<sp/>desiredSize;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioValueRange<sp/>audioRange;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>audioRange<sp/>);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(<sp/>macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSizeRange,<sp/>&amp;propSize,<sp/>&amp;audioRange<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>resultSize<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>resultSize,<sp/>audioRange.mMinimum<sp/>);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>resultSize<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(<sp/>resultSize,<sp/>audioRange.mMaximum<sp/>);</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/>*allowedSize<sp/>=<sp/>resultSize;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="445"><highlight class="normal">}</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>DumpDeviceProperties(<sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput<sp/>)</highlight></codeline>
<codeline lineno="451"><highlight class="normal">{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>deviceLatency;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>streamLatency;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>bufferFrames;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>safetyOffset;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioStreamID<sp/>streamIDs[128];</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;\n=======<sp/>latency<sp/>query<sp/>:<sp/>macCoreDeviceId<sp/>=<sp/>%d,<sp/>isInput<sp/>%d<sp/>=======\n&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)macCoreDeviceId,<sp/>isInput<sp/>);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSize,<sp/>&amp;propSize,<sp/>&amp;bufferFrames));</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;kAudioDevicePropertyBufferFrameSize:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%d,<sp/>value<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>bufferFrames<sp/>);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertySafetyOffset,<sp/>&amp;propSize,<sp/>&amp;safetyOffset));</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;kAudioDevicePropertySafetyOffset:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%d,<sp/>value<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>safetyOffset<sp/>);</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyLatency,<sp/>&amp;propSize,<sp/>&amp;deviceLatency));</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;kAudioDevicePropertyLatency:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%d,<sp/>value<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>deviceLatency<sp/>);</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioValueRange<sp/>audioRange;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>audioRange<sp/>);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(<sp/>macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSizeRange,<sp/>&amp;propSize,<sp/>&amp;audioRange<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;kAudioDevicePropertyBufferFrameSizeRange:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%u,<sp/>minimum<sp/>=<sp/>%g\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>audioRange.mMinimum);</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;kAudioDevicePropertyBufferFrameSizeRange:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%u,<sp/>maximum<sp/>=<sp/>%g\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>audioRange.mMaximum<sp/>);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>streams<sp/>from<sp/>the<sp/>device<sp/>and<sp/>query<sp/>their<sp/>latency.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(streamIDs);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/><sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyStreams,<sp/>&amp;propSize,<sp/>&amp;streamIDs[0]));</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numStreams<sp/>=<sp/>propSize<sp/>/<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioStreamID);</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i&lt;numStreams;<sp/>i++<sp/>)</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;Stream<sp/>#%d<sp/>=<sp/>%d----------------------<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>i,<sp/>streamIDs[i]<sp/>);</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/><sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioStreamGetProperty(streamIDs[i],<sp/>0,<sp/>kAudioStreamPropertyLatency,<sp/>&amp;propSize,<sp/>&amp;streamLatency));</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="octave__test_8m_1ac6d0e62c65e5715b13a5fcb381118888" kindref="member">printf</ref>(</highlight><highlight class="stringliteral">&quot;<sp/><sp/>kAudioStreamPropertyLatency:<sp/>err<sp/>=<sp/>%d,<sp/>propSize<sp/>=<sp/>%d,<sp/>value<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>err,<sp/>propSize,<sp/>streamLatency<sp/>);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="493"><highlight class="normal">}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight></codeline>
<codeline lineno="508"><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CalculateFixedDeviceLatency(<sp/>AudioDeviceID<sp/>macCoreDeviceId,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput,<sp/>UInt32<sp/>*fixedLatencyPtr<sp/>)</highlight></codeline>
<codeline lineno="509"><highlight class="normal">{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>deviceLatency;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>streamLatency;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>safetyOffset;</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioStreamID<sp/>streamIDs[1];</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>get<sp/>stream<sp/>latency<sp/>we<sp/>have<sp/>to<sp/>get<sp/>a<sp/>streamID<sp/>from<sp/>the<sp/>device.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>are<sp/>only<sp/>going<sp/>to<sp/>look<sp/>at<sp/>the<sp/>first<sp/>stream<sp/>so<sp/>only<sp/>fetch<sp/>one<sp/>stream.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(streamIDs);</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/><sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyStreams,<sp/>&amp;propSize,<sp/>&amp;streamIDs[0]));</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>propSize<sp/>==<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioStreamID)<sp/>)</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/><sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioStreamGetProperty(streamIDs[0],<sp/>0,<sp/>kAudioStreamPropertyLatency,<sp/>&amp;propSize,<sp/>&amp;streamLatency));</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertySafetyOffset,<sp/>&amp;propSize,<sp/>&amp;safetyOffset));</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyLatency,<sp/>&amp;propSize,<sp/>&amp;deviceLatency));</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/>*fixedLatencyPtr<sp/>=<sp/>deviceLatency<sp/>+<sp/>streamLatency<sp/>+<sp/>safetyOffset;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="540"><highlight class="normal">}</highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CalculateDefaultDeviceLatencies(<sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput,<sp/>UInt32<sp/>*lowLatencyFramesPtr,</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>*highLatencyFramesPtr<sp/>)</highlight></codeline>
<codeline lineno="546"><highlight class="normal">{</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>bufferFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>fixedLatency<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>clippedMinBufferSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//DumpDeviceProperties(<sp/>macCoreDeviceId,<sp/>isInput<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err<sp/>=<sp/>CalculateFixedDeviceLatency(<sp/>macCoreDeviceId,<sp/>isInput,<sp/>&amp;fixedLatency<sp/>);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>low<sp/>latency<sp/>use<sp/>a<sp/>small<sp/>fixed<sp/>size<sp/>buffer<sp/>clipped<sp/>to<sp/>the<sp/>device<sp/>range.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/>ClipToDeviceBufferSize(<sp/>macCoreDeviceId,<sp/>isInput,<sp/><ref refid="pa__mac__core_8c_1a7ab4a20ecccd368c383dcf5ed152141e" kindref="member">PA_MAC_SMALL_BUFFER_SIZE</ref>,<sp/>&amp;clippedMinBufferSize<sp/>);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>high<sp/>latency<sp/>use<sp/>the<sp/>default<sp/>device<sp/>buffer<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a1cc72d70007f55c1d5510670bc1e836f" kindref="member">WARNING</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSize,<sp/>&amp;propSize,<sp/>&amp;bufferFrames));</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>*lowLatencyFramesPtr<sp/>=<sp/>fixedLatency<sp/>+<sp/>clippedMinBufferSize;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>*highLatencyFramesPtr<sp/>=<sp/>fixedLatency<sp/>+<sp/>bufferFrames;</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="572"><highlight class="normal">}</highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>GetChannelInfo(<sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo,</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>isInput)</highlight></codeline>
<codeline lineno="580"><highlight class="normal">{</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize;</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numChannels<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioBufferList<sp/>*buflist<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;GetChannelInfo()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>number<sp/>of<sp/>channels<sp/>from<sp/>the<sp/>stream<sp/>configuration.</highlight></codeline>
<codeline lineno="590"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>get<sp/>this.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetPropertyInfo(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyStreamConfiguration,<sp/>&amp;propSize,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>));</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>buflist<sp/>=<sp/><ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(propSize);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!buflist<sp/>)</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyStreamConfiguration,<sp/>&amp;propSize,<sp/>buflist));</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>buflist-&gt;mNumberBuffers;<sp/>++<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>)</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numChannels<sp/>+=<sp/>buflist-&gt;mBuffers[i].mNumberChannels;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="winfun_8c_1ab24f32995c1d94525943b4568cce20cb" kindref="member">if</ref><sp/>(isInput)</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>=<sp/>numChannels;</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>=<sp/>numChannels;</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(numChannels<sp/>&gt;<sp/>0)<sp/></highlight><highlight class="comment">/*<sp/>do<sp/>not<sp/>try<sp/>to<sp/>retrieve<sp/>the<sp/>latency<sp/>if<sp/>there<sp/>are<sp/>no<sp/>channels.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>latency.<sp/><sp/>Don&apos;t<sp/>fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>get<sp/>this.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>default<sp/>to<sp/>something<sp/>reasonable<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1aad6629064b8c7cf043d237ea0a5cc534" kindref="member">defaultLowInputLatency</ref><sp/>=<sp/>.01;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a4214826038fcaf374beb9816024e6c9f" kindref="member">defaultHighInputLatency</ref><sp/>=<sp/>.10;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a89e60515505eea8d668ede3a26a19ac6" kindref="member">defaultLowOutputLatency</ref><sp/>=<sp/>.01;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a2a43dbc2b158806a937065bda037070e" kindref="member">defaultHighOutputLatency</ref><sp/>=<sp/>.10;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>lowLatencyFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>highLatencyFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>CalculateDefaultDeviceLatencies(<sp/>macCoreDeviceId,<sp/>isInput,<sp/>&amp;lowLatencyFrames,<sp/>&amp;highLatencyFrames<sp/>);</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lowLatencySeconds<sp/>=<sp/>lowLatencyFrames<sp/>/<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a68f435353bfe1a4c9b632203a9afcacb" kindref="member">defaultSampleRate</ref>;</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>highLatencySeconds<sp/>=<sp/>highLatencyFrames<sp/>/<sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a68f435353bfe1a4c9b632203a9afcacb" kindref="member">defaultSampleRate</ref>;</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(isInput)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1aad6629064b8c7cf043d237ea0a5cc534" kindref="member">defaultLowInputLatency</ref><sp/>=<sp/>lowLatencySeconds;</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a4214826038fcaf374beb9816024e6c9f" kindref="member">defaultHighInputLatency</ref><sp/>=<sp/>highLatencySeconds;</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a89e60515505eea8d668ede3a26a19ac6" kindref="member">defaultLowOutputLatency</ref><sp/>=<sp/>lowLatencySeconds;</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a2a43dbc2b158806a937065bda037070e" kindref="member">defaultHighOutputLatency</ref><sp/>=<sp/>highLatencySeconds;</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>buflist<sp/>);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>buflist<sp/>);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="644"><highlight class="normal">}</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>InitializeDeviceInfo(<sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfo,</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>macCoreDeviceId,</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/>hostApiIndex<sp/>)</highlight></codeline>
<codeline lineno="651"><highlight class="normal">{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/>CFStringRef<sp/>nameRef;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;InitializeDeviceInfo():<sp/>macCoreDeviceId=%ld\n&quot;</highlight><highlight class="normal">,<sp/>macCoreDeviceId));</highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(deviceInfo,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>));</highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a2d726add4cd2af78a94c052b3a7df568" kindref="member">structVersion</ref><sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1afe741e4d185069577f7e74b78fdef5a4" kindref="member">hostApi</ref><sp/>=<sp/>hostApiIndex;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>device<sp/>name<sp/>using<sp/>CFString<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(nameRef);</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>0,<sp/>kAudioDevicePropertyDeviceNameCFString,<sp/>&amp;propSize,<sp/>&amp;nameRef));</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>device<sp/>name<sp/>using<sp/>c<sp/>string.<sp/><sp/>Fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>get<sp/>it.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetPropertyInfo(macCoreDeviceId,<sp/>0,<sp/>0,<sp/>kAudioDevicePropertyDeviceName,<sp/>&amp;propSize,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>));</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/><ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,propSize+1);</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!name<sp/>)</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>0,<sp/>kAudioDevicePropertyDeviceName,<sp/>&amp;propSize,<sp/>name));</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>valid<sp/>CFString<sp/>so<sp/>we<sp/>just<sp/>allocate<sp/>a<sp/>c<sp/>string<sp/>big<sp/>enough<sp/>to<sp/>contain<sp/>the<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/>CFStringGetMaximumSizeForEncoding(CFStringGetLength(nameRef),<sp/>kCFStringEncodingUTF8);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/><ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,<sp/>propSize+1);</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!name<sp/>)</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(nameRef);</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFStringGetCString(nameRef,<sp/>name,<sp/>propSize+1,<sp/>kCFStringEncodingUTF8);</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRelease(nameRef);</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a1bc26d68f1d89472ae67eaa49a542aea" kindref="member">name</ref><sp/>=<sp/><ref refid="lib_2expat_8h_1a1b49b495b59f9e73205b69ad1a2965b0" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Try<sp/>to<sp/>get<sp/>the<sp/>default<sp/>sample<sp/>rate.<sp/><sp/>Don&apos;t<sp/>fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>get<sp/>this.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(Float64);</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(AudioDeviceGetProperty(macCoreDeviceId,<sp/>0,<sp/>0,<sp/>kAudioDevicePropertyNominalSampleRate,<sp/>&amp;propSize,<sp/>&amp;sampleRate));</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a68f435353bfe1a4c9b632203a9afcacb" kindref="member">defaultSampleRate</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfo-&gt;<ref refid="struct_pa_device_info_1a68f435353bfe1a4c9b632203a9afcacb" kindref="member">defaultSampleRate</ref><sp/>=<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>input<sp/>and<sp/>output<sp/>channels.<sp/><sp/>Fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>get<sp/>this.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/>GetChannelInfo(auhalHostApi,<sp/>deviceInfo,<sp/>macCoreDeviceId,<sp/>1);</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/>GetChannelInfo(auhalHostApi,<sp/>deviceInfo,<sp/>macCoreDeviceId,<sp/>0);</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="714"><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="716"><highlight class="normal">}</highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight></codeline>
<codeline lineno="718" refid="pa__unix__hostapis_8c_1a9d5b7af64c23abc3f0a9431bb12af330" refkind="member"><highlight class="normal"><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="pa__mac__core_8c_1a9d5b7af64c23abc3f0a9431bb12af330" kindref="member">PaMacCore_Initialize</ref>(<sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>**hostApi,<sp/><ref refid="portaudio_8h_1aeef6da084c57c70aa94be97411e19930" kindref="member">PaHostApiIndex</ref><sp/>hostApiIndex<sp/>)</highlight></codeline>
<codeline lineno="719"><highlight class="normal">{</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref><sp/>*deviceInfoArray;</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>unixErr;</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;PaMacCore_Initialize():<sp/>hostApiIndex=%d\n&quot;</highlight><highlight class="normal">,<sp/>hostApiIndex));</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/>SInt32<sp/>major;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/>SInt32<sp/>minor;</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/>Gestalt(gestaltSystemVersionMajor,<sp/>&amp;major);</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/>Gestalt(gestaltSystemVersionMinor,<sp/>&amp;minor);</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Starting<sp/>with<sp/>10.6<sp/>systems,<sp/>the<sp/>HAL<sp/>notification<sp/>thread<sp/>is<sp/>created<sp/>internally</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(major<sp/>==<sp/>10<sp/>&amp;&amp;<sp/>minor<sp/>&gt;=<sp/>6)<sp/>{</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFRunLoopRef<sp/>theRunLoop<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioObjectPropertyAddress<sp/>theAddress<sp/>=<sp/>{<sp/>kAudioHardwarePropertyRunLoop,<sp/>kAudioObjectPropertyScopeGlobal,<sp/>kAudioObjectPropertyElementMaster<sp/>};</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>AudioObjectSetPropertyData<sp/>(kAudioObjectSystemObject,<sp/>&amp;theAddress,<sp/>0,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(CFRunLoopRef),<sp/>&amp;theRunLoop);</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(osErr<sp/>!=<sp/>noErr)<sp/>{</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/>unixErr<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a9765dfc2c7118a68c7d51a3357236e9f" kindref="member">initializeXRunListenerList</ref>();</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>unixErr<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__utilities_8h_1a5525e6f6d162b77167dd938e68641ea2" kindref="member">UNIX_ERR</ref>(unixErr);</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi<sp/>=<sp/>(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>*)<ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>)<sp/>);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!auhalHostApi<sp/>)</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>=<sp/><ref refid="pa__allocation_8c_1a9cc7370b73e75f690ab0a0360e7fffee" kindref="member">PaUtil_CreateAllocationGroup</ref>();</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>)</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>get<sp/>the<sp/>info<sp/>we<sp/>need<sp/>about<sp/>the<sp/>devices<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>gatherDeviceInfo(<sp/>auhalHostApi<sp/>);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="769"><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/>*hostApi<sp/>=<sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1abe5cf67f9992b647d350cd9fb890a081" kindref="member">inheritedHostApiRep</ref>;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;<ref refid="struct_pa_util_host_api_representation_1a9c443aa6cf07d3c46167a91b274a9e94" kindref="member">info</ref>.<ref refid="struct_pa_host_api_info_1a1f3a8c465488e7af8024237256d80c14" kindref="member">structVersion</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.type<sp/>=<sp/><ref refid="portaudio_8h_1a8eaebe3d39c5ea45598da8f86dc2e5aeaa7295ccb885c47b70c829f8236161d1a" kindref="member">paCoreAudio</ref>;</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Core<sp/>Audio&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.defaultInputDevice<sp/>=<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref>;</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.defaultOutputDevice<sp/>=<sp/><ref refid="portaudio_8h_1a8c26dd5e6f28bb4cda7a1f5460282297" kindref="member">paNoDevice</ref>;</highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.deviceCount<sp/>=<sp/>0;<sp/><sp/></highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref><sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*hostApi)-&gt;deviceInfos<sp/>=<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>**)<ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>*)<sp/>*<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!(*hostApi)-&gt;deviceInfos<sp/>)</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>allocate<sp/>all<sp/>device<sp/>info<sp/>structs<sp/>in<sp/>a<sp/>contiguous<sp/>block<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceInfoArray<sp/>=<sp/>(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>*)<ref refid="pa__allocation_8c_1ace88f0110da3a26cb8d8ed00758accf3" kindref="member">PaUtil_GroupAllocateMemory</ref>(</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_device_info" kindref="compound">PaDeviceInfo</ref>)<sp/>*<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref><sp/>);</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!deviceInfoArray<sp/>)</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>i=0;<sp/>i<sp/>&lt;<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>;<sp/>++<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref><sp/>)</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>InitializeDeviceInfo(<sp/>auhalHostApi,<sp/>&amp;deviceInfoArray[i],</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i],</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostApiIndex<sp/>);</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>==<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>)</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>copy<sp/>some<sp/>info<sp/>and<sp/>set<sp/>the<sp/>defaults<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*hostApi)-&gt;deviceInfos[(*hostApi)-&gt;info.deviceCount]<sp/>=<sp/>&amp;deviceInfoArray[<ref refid="checksum_8c_1ab80e330a3bc9e38c1297fe17381e92b4" kindref="member">i</ref>];</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i]<sp/>==<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1adcadc778ee059bbbd6cbcb76ac93931b" kindref="member">defaultIn</ref>)</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.defaultInputDevice<sp/>=<sp/>(*hostApi)-&gt;info.deviceCount;</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[i]<sp/>==<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1ae4876213ad54aeebea056e458dff4bfd" kindref="member">defaultOut</ref>)</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.defaultOutputDevice<sp/>=<sp/>(*hostApi)-&gt;info.deviceCount;</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*hostApi)-&gt;info.deviceCount++;</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>there<sp/>was<sp/>an<sp/>error.<sp/>we<sp/>need<sp/>to<sp/>shift<sp/>the<sp/>devices<sp/>down,<sp/>so<sp/>we<sp/>ignore<sp/>this<sp/>one<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j;</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>--;</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<sp/>j=i;<sp/>j&lt;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a192eec8334acc33171a90d4c6dce4c90" kindref="member">devCount</ref>;<sp/>++j<sp/>)</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[j]<sp/>=<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[j+1];</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i--;</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;Terminate<sp/>=<sp/><ref refid="struct_pa_util_host_api_representation_1a832b3f01b9d9a84b5442e27d365f8b9f" kindref="member">Terminate</ref>;</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;OpenStream<sp/>=<sp/><ref refid="struct_pa_util_host_api_representation_1aa415b57fadf39a49d6bc5740f06089e4" kindref="member">OpenStream</ref>;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/>(*hostApi)-&gt;IsFormatSupported<sp/>=<sp/><ref refid="struct_pa_util_host_api_representation_1a54205572c891d43272de45be0994c377" kindref="member">IsFormatSupported</ref>;</highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a7ae912708e0bb060028f25e6f95333b7" kindref="member">PaUtil_InitializeStreamInterface</ref>(<sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a747f231b18878ff0cc7918bbd4df5e21" kindref="member">callbackStreamInterface</ref>,</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseStream,<sp/>StartStream,</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StopStream,<sp/>AbortStream,<sp/>IsStreamStopped,</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IsStreamActive,</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetStreamTime,<sp/>GetStreamCpuLoad,</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1ae7a66186864e1f27f9e274e1de562219" kindref="member">PaUtil_DummyRead</ref>,<sp/><ref refid="pa__stream_8c_1a827035da5bb7141143595519b0c0edc7" kindref="member">PaUtil_DummyWrite</ref>,</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1aa43032a8fcb0d7b271f6049e4dc69e5c" kindref="member">PaUtil_DummyGetReadAvailable</ref>,</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1aa4742249759bc11f31590db47cd19c2b" kindref="member">PaUtil_DummyGetWriteAvailable</ref><sp/>);</highlight></codeline>
<codeline lineno="837"><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a7ae912708e0bb060028f25e6f95333b7" kindref="member">PaUtil_InitializeStreamInterface</ref>(<sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1aa7c1cb635e954f37e178e7f037f6cbfb" kindref="member">blockingStreamInterface</ref>,</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseStream,<sp/>StartStream,</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StopStream,<sp/>AbortStream,<sp/>IsStreamStopped,</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IsStreamActive,</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetStreamTime,<sp/><ref refid="pa__stream_8c_1aba19e5ce44bb3621b6ca257959c30b43" kindref="member">PaUtil_DummyGetCpuLoad</ref>,</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1a9e7f111c33d1e80f40473846864e84fa" kindref="member">ReadStream</ref>,<sp/><ref refid="pa__mac__core__blocking_8c_1a0cfb7772846808945bd521d23d5626eb" kindref="member">WriteStream</ref>,</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1a82aa1e30985c7924247e8f45fc356d46" kindref="member">GetStreamReadAvailable</ref>,</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1ad7ee6bd74b3109101f1eb4ca0514c8b0" kindref="member">GetStreamWriteAvailable</ref><sp/>);</highlight></codeline>
<codeline lineno="846"><highlight class="normal"></highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="848"><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>auhalHostApi<sp/>)</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>)</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aa83a07899e8db63d415d03f68b1f8a3d" kindref="member">PaUtil_FreeAllAllocations</ref>(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aefcb1143eaa768c2b555bd203f1c9deb" kindref="member">PaUtil_DestroyAllocationGroup</ref>(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>auhalHostApi<sp/>);</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="861"><highlight class="normal">}</highlight></codeline>
<codeline lineno="862"><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation_1a832b3f01b9d9a84b5442e27d365f8b9f" kindref="member">Terminate</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi<sp/>)</highlight></codeline>
<codeline lineno="865"><highlight class="normal">{</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>unixErr;</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi<sp/>=<sp/>(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>*)hostApi;</highlight></codeline>
<codeline lineno="869"><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;Terminate()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/>unixErr<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a531c51cac91b4b9d61d16a12669cdad4" kindref="member">destroyXRunListenerList</ref>();</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>0<sp/>!=<sp/>unixErr<sp/>)</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a5525e6f6d162b77167dd938e68641ea2" kindref="member">UNIX_ERR</ref>(unixErr);</highlight></codeline>
<codeline lineno="875"><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="877"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IMPLEMENT<sp/>ME:</highlight></codeline>
<codeline lineno="878"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>clean<sp/>up<sp/>any<sp/>resources<sp/>not<sp/>handled<sp/>by<sp/>the<sp/>allocation<sp/>group</highlight></codeline>
<codeline lineno="879"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TODO:<sp/>Double<sp/>check<sp/>that<sp/>everything<sp/>is<sp/>handled<sp/>by<sp/>alloc<sp/>group</highlight></codeline>
<codeline lineno="880"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>)</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aa83a07899e8db63d415d03f68b1f8a3d" kindref="member">PaUtil_FreeAllAllocations</ref>(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__allocation_8c_1aefcb1143eaa768c2b555bd203f1c9deb" kindref="member">PaUtil_DestroyAllocationGroup</ref>(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a7fdcaf9a58f5f439ac970ca19012b41c" kindref="member">allocations</ref><sp/>);</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="887"><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>auhalHostApi<sp/>);</highlight></codeline>
<codeline lineno="889"><highlight class="normal">}</highlight></codeline>
<codeline lineno="890"><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="struct_pa_util_host_api_representation_1a54205572c891d43272de45be0994c377" kindref="member">IsFormatSupported</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref><sp/>)</highlight></codeline>
<codeline lineno="896"><highlight class="normal">{</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inputChannelCount,<sp/>outputChannelCount;</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>inputSampleFormat,<sp/>outputSampleFormat;</highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;IsFormatSupported():<sp/>in<sp/>chan=%d,<sp/>in<sp/>fmt=%ld,<sp/>out<sp/>chan=%d,<sp/>out<sp/>fmt=%ld<sp/>sampleRate=%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters<sp/><sp/>?<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters<sp/><sp/>?<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters<sp/>?<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters<sp/>?<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>sampleRate<sp/>));</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSampleFormat<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>all<sp/>standard<sp/>sample<sp/>formats<sp/>are<sp/>supported<sp/>by<sp/>the<sp/>buffer<sp/>adapter,</highlight></codeline>
<codeline lineno="915"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>implementation<sp/>doesn&apos;t<sp/>support<sp/>any<sp/>custom<sp/>sample<sp/>formats<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputSampleFormat<sp/>&amp;<sp/><ref refid="portaudio_8h_1aba595f6b645c8134a8ac3004957b9ff7" kindref="member">paCustomFormat</ref><sp/>)</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref>;</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="920"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="921"><highlight class="normal"></highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>input<sp/>device<sp/>can<sp/>support<sp/>inputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSampleFormat<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>all<sp/>standard<sp/>sample<sp/>formats<sp/>are<sp/>supported<sp/>by<sp/>the<sp/>buffer<sp/>adapter,</highlight></codeline>
<codeline lineno="940"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>implementation<sp/>doesn&apos;t<sp/>support<sp/>any<sp/>custom<sp/>sample<sp/>formats<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputSampleFormat<sp/>&amp;<sp/><ref refid="portaudio_8h_1aba595f6b645c8134a8ac3004957b9ff7" kindref="member">paCustomFormat</ref><sp/>)</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref>;</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="945"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>output<sp/>device<sp/>can<sp/>support<sp/>outputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="953"><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FEEDBACK<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>think<sp/>the<sp/>only<sp/>way<sp/>to<sp/>check<sp/>a<sp/>given<sp/>format<sp/>SR<sp/>combo<sp/>is<sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>try<sp/>opening<sp/>it.<sp/>This<sp/>could<sp/>be<sp/>disruptive,<sp/>is<sp/>that<sp/>Okay?<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>alternative<sp/>is<sp/>to<sp/>just<sp/>read<sp/>off<sp/>available<sp/>sample<sp/>rates,<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>but<sp/>this<sp/>will<sp/>not<sp/>work<sp/>%100<sp/>of<sp/>the<sp/>time<sp/>(eg,<sp/>a<sp/>device<sp/>that<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>supports<sp/>N<sp/>output<sp/>at<sp/>one<sp/>rate<sp/>but<sp/>only<sp/>N/2<sp/>at<sp/>a<sp/>higher<sp/>rate.)*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>following<sp/>code<sp/>opens<sp/>the<sp/>device<sp/>with<sp/>the<sp/>requested<sp/>parameters<sp/>to</highlight></codeline>
<codeline lineno="968"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>see<sp/>if<sp/>it<sp/>works.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>err;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="struct_pa_util_host_api_representation_1aa415b57fadf39a49d6bc5740f06089e4" kindref="member">OpenStream</ref>(<sp/>hostApi,<sp/>&amp;s,<sp/>inputParameters,<sp/>outputParameters,</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,<sp/>1024,<sp/>0,<sp/>(<ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>*)1,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>);</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>&amp;&amp;<sp/>err<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a30a98097c3b6d9789077b72c26ae7c24" kindref="member">paInvalidSampleRate</ref><sp/>)</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a27513a24b6149b50414c8b8bf0220533" kindref="member">DBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;OpenStream<sp/>@<sp/>%g<sp/>returned:<sp/>%d:<sp/>%s\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/>sampleRate,<sp/>err,<sp/><ref refid="portaudio_8h_1ae606855a611cf29c7d2d7421df5e3b5d" kindref="member">Pa_GetErrorText</ref>(<sp/>err<sp/>)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>)<sp/></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>CloseStream(<sp/>s<sp/>);</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FEEDBACK:<sp/>is<sp/>this<sp/>more<sp/>serious?<sp/>should<sp/>we<sp/>assert?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a27513a24b6149b50414c8b8bf0220533" kindref="member">DBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;WARNING:<sp/>could<sp/>not<sp/>close<sp/>Stream.<sp/>%d:<sp/>%s\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/><ref refid="portaudio_8h_1ae606855a611cf29c7d2d7421df5e3b5d" kindref="member">Pa_GetErrorText</ref>(<sp/>err<sp/>)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a400df642339bf4112333060af6a43c0f" kindref="member">paFormatIsSupported</ref>;</highlight></codeline>
<codeline lineno="988"><highlight class="normal">}</highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>=================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>InitializeDeviceProperties(<sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*deviceProperties<sp/>)</highlight></codeline>
<codeline lineno="992"><highlight class="normal">{</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(<sp/>deviceProperties,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref>)<sp/>);</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a0da4b19e2993717c1e09ab86a6930ee4" kindref="member">sampleRate</ref><sp/>=<sp/>1.0;<sp/></highlight><highlight class="comment">//<sp/>Better<sp/>than<sp/>random.<sp/>Overwritten<sp/>by<sp/>actual<sp/>values<sp/>later<sp/>on.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a4124e492be364add3280ef5574a26fde" kindref="member">samplePeriod</ref><sp/>=<sp/>1.0<sp/>/<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a0da4b19e2993717c1e09ab86a6930ee4" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="996"><highlight class="normal">}</highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Float64<sp/>CalculateSoftwareLatencyFromProperties(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,<sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*deviceProperties<sp/>)</highlight></codeline>
<codeline lineno="999"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>latencyFrames<sp/>=<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a7a0781d3b3414f23abc663b17cb06c7d" kindref="member">bufferFrameSize</ref><sp/>+<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1aaa0297847bc0987b066f0ece4ef0c532" kindref="member">deviceLatency</ref><sp/>+<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1ab303037c6a88e4b54f706f2d5d0be00c" kindref="member">safetyOffset</ref>;</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>latencyFrames<sp/>*<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a4124e492be364add3280ef5574a26fde" kindref="member">samplePeriod</ref>;<sp/></highlight><highlight class="comment">//<sp/>same<sp/>as<sp/>dividing<sp/>by<sp/>sampleRate<sp/>but<sp/>faster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Float64<sp/>CalculateHardwareLatencyFromProperties(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,<sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*deviceProperties<sp/>)</highlight></codeline>
<codeline lineno="1005"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1aaa0297847bc0987b066f0ece4ef0c532" kindref="member">deviceLatency</ref><sp/>*<sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a4124e492be364add3280ef5574a26fde" kindref="member">samplePeriod</ref>;<sp/></highlight><highlight class="comment">//<sp/>same<sp/>as<sp/>dividing<sp/>by<sp/>sampleRate<sp/>but<sp/>faster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Calculate<sp/>values<sp/>used<sp/>to<sp/>convert<sp/>Apple<sp/>timestamps<sp/>into<sp/>PA<sp/>timestamps</highlight></codeline>
<codeline lineno="1010"><highlight class="comment"><sp/>*<sp/>from<sp/>the<sp/>device<sp/>properties.<sp/>The<sp/>final<sp/>results<sp/>of<sp/>this<sp/>calculation</highlight></codeline>
<codeline lineno="1011"><highlight class="comment"><sp/>*<sp/>will<sp/>be<sp/>used<sp/>in<sp/>the<sp/>audio<sp/>callback<sp/>function.</highlight></codeline>
<codeline lineno="1012"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>UpdateTimeStampOffsets(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>)</highlight></codeline>
<codeline lineno="1014"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/>inputSoftwareLatency<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/>inputHardwareLatency<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/>outputSoftwareLatency<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/>outputHardwareLatency<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSoftwareLatency<sp/>=<sp/>CalculateSoftwareLatencyFromProperties(<sp/>stream,<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>);</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputHardwareLatency<sp/>=<sp/>CalculateHardwareLatencyFromProperties(<sp/>stream,<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>);</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSoftwareLatency<sp/>=<sp/>CalculateSoftwareLatencyFromProperties(<sp/>stream,<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref><sp/>);</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputHardwareLatency<sp/>=<sp/>CalculateHardwareLatencyFromProperties(<sp/>stream,<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref><sp/>);</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>only<sp/>need<sp/>a<sp/>mutex<sp/>around<sp/>setting<sp/>these<sp/>variables<sp/>as<sp/>a<sp/>group.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_mutex_lock(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref><sp/>);</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a169f40774042f35654987a0d5daa369d" kindref="member">timestampOffsetCombined</ref><sp/>=<sp/>inputSoftwareLatency<sp/>+<sp/>outputSoftwareLatency;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a478d46d9d93bdc6d3cdb2009236c1d9e" kindref="member">timestampOffsetInputDevice</ref><sp/>=<sp/>inputHardwareLatency;</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a81525a1ff3c1cb96a57d44c5ca70f7c4" kindref="member">timestampOffsetOutputDevice</ref><sp/>=<sp/>outputHardwareLatency;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_mutex_unlock(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref><sp/>);</highlight></codeline>
<codeline lineno="1037"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>=================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>can<sp/>be<sp/>used<sp/>to<sp/>update<sp/>from<sp/>nominal<sp/>or<sp/>actual<sp/>sample<sp/>rate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>UpdateSampleRateFromDeviceProperty(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,<sp/>AudioDeviceID<sp/>deviceID,<sp/>Boolean<sp/>isInput,<sp/>AudioDevicePropertyID<sp/>sampleRatePropertyID<sp/>)</highlight></codeline>
<codeline lineno="1043"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*<sp/>deviceProperties<sp/>=<sp/>isInput<sp/>?<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>:<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref>;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/>Float64<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(Float64);</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>AudioDeviceGetProperty(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>sampleRatePropertyID,<sp/>&amp;propSize,<sp/>&amp;sampleRate);</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(osErr<sp/>==<sp/>noErr)<sp/>&amp;&amp;<sp/>(sampleRate<sp/>&gt;<sp/>1000.0)<sp/>)<sp/></highlight><highlight class="comment">/*<sp/>avoid<sp/>divide<sp/>by<sp/>zero<sp/>if<sp/>there&apos;s<sp/>an<sp/>error<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a0da4b19e2993717c1e09ab86a6930ee4" kindref="member">sampleRate</ref><sp/>=<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a4124e492be364add3280ef5574a26fde" kindref="member">samplePeriod</ref><sp/>=<sp/>1.0<sp/>/<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1055"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>AudioDevicePropertyActualSampleRateListenerProc(<sp/>AudioDeviceID<sp/>inDevice,<sp/>UInt32<sp/>inChannel,<sp/>Boolean<sp/>isInput,<sp/>AudioDevicePropertyID<sp/>inPropertyID,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*inClientData<sp/>)</highlight></codeline>
<codeline lineno="1058"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)inClientData;</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>the<sp/>callback<sp/>is<sp/>operating<sp/>on<sp/>a<sp/>stream<sp/>that<sp/>is<sp/>still<sp/>valid!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a6f317d637618d5d4fee13c11c65b8c4a" kindref="member">magic</ref><sp/>==<sp/><ref refid="pa__stream_8h_1aa45595fe91fcc1f8ce561d053e715f62" kindref="member">PA_STREAM_MAGIC</ref><sp/>);</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>UpdateSampleRateFromDeviceProperty(<sp/>stream,<sp/>inDevice,<sp/>isInput,<sp/>kAudioDevicePropertyActualSampleRate<sp/>);</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>osErr<sp/>==<sp/>noErr<sp/>)</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateTimeStampOffsets(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1070"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>=================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>QueryUInt32DeviceProperty(<sp/>AudioDeviceID<sp/>deviceID,<sp/>Boolean<sp/>isInput,<sp/>AudioDevicePropertyID<sp/>propertyID,<sp/>UInt32<sp/>*outValue<sp/>)</highlight></codeline>
<codeline lineno="1074"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propertyValue<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>propertySize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32);</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>AudioDeviceGetProperty(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>propertyID,<sp/>&amp;propertySize,<sp/>&amp;propertyValue);</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>osErr<sp/>==<sp/>noErr<sp/>)</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*outValue<sp/>=<sp/>propertyValue;</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>AudioDevicePropertyGenericListenerProc(<sp/>AudioDeviceID<sp/>inDevice,<sp/>UInt32<sp/>inChannel,<sp/>Boolean<sp/>isInput,<sp/>AudioDevicePropertyID<sp/>inPropertyID,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*inClientData<sp/>)</highlight></codeline>
<codeline lineno="1086"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>noErr;</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)inClientData;</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>the<sp/>callback<sp/>is<sp/>operating<sp/>on<sp/>a<sp/>stream<sp/>that<sp/>is<sp/>still<sp/>valid!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a6f317d637618d5d4fee13c11c65b8c4a" kindref="member">magic</ref><sp/>==<sp/><ref refid="pa__stream_8h_1aa45595fe91fcc1f8ce561d053e715f62" kindref="member">PA_STREAM_MAGIC</ref><sp/>);</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*deviceProperties<sp/>=<sp/>isInput<sp/>?<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>:<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref>;</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>*valuePtr<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>inPropertyID<sp/>)</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>kAudioDevicePropertySafetyOffset:</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>valuePtr<sp/>=<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1ab303037c6a88e4b54f706f2d5d0be00c" kindref="member">safetyOffset</ref>;</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>kAudioDevicePropertyLatency:</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>valuePtr<sp/>=<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1aaa0297847bc0987b066f0ece4ef0c532" kindref="member">deviceLatency</ref>;</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>kAudioDevicePropertyBufferFrameSize:</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>valuePtr<sp/>=<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a7a0781d3b3414f23abc663b17cb06c7d" kindref="member">bufferFrameSize</ref>;</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>valuePtr<sp/>!=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>)</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>osErr<sp/>=<sp/>QueryUInt32DeviceProperty(<sp/>inDevice,<sp/>isInput,<sp/>inPropertyID,<sp/>valuePtr<sp/>);</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>osErr<sp/>==<sp/>noErr<sp/>)</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateTimeStampOffsets(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1118"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>=================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1122"><highlight class="comment"><sp/>*<sp/>Setup<sp/>listeners<sp/>in<sp/>case<sp/>device<sp/>properties<sp/>change<sp/>during<sp/>the<sp/>run.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>SetupDevicePropertyListeners(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,<sp/>AudioDeviceID<sp/>deviceID,<sp/>Boolean<sp/>isInput<sp/>)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>osErr<sp/>=<sp/>noErr;</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_device_properties" kindref="compound">PaMacCoreDeviceProperties</ref><sp/>*deviceProperties<sp/>=<sp/>isInput<sp/>?<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>:<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref>;</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(osErr<sp/>=<sp/>QueryUInt32DeviceProperty(<sp/>deviceID,<sp/>isInput,</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertyLatency,<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1aaa0297847bc0987b066f0ece4ef0c532" kindref="member">deviceLatency</ref><sp/>))<sp/>!=<sp/>noErr<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(osErr<sp/>=<sp/>QueryUInt32DeviceProperty(<sp/>deviceID,<sp/>isInput,</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertyBufferFrameSize,<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1a7a0781d3b3414f23abc663b17cb06c7d" kindref="member">bufferFrameSize</ref><sp/>))<sp/>!=<sp/>noErr<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(osErr<sp/>=<sp/>QueryUInt32DeviceProperty(<sp/>deviceID,<sp/>isInput,</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDevicePropertySafetyOffset,<sp/>&amp;deviceProperties-&gt;<ref refid="struct_pa_mac_core_device_properties_1ab303037c6a88e4b54f706f2d5d0be00c" kindref="member">safetyOffset</ref><sp/>))<sp/>!=<sp/>noErr<sp/>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceAddPropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyActualSampleRate,<sp/></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyActualSampleRateListenerProc,<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceAddPropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioStreamPropertyLatency,<sp/></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc,<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceAddPropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSize,<sp/></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc,<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceAddPropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertySafetyOffset,<sp/></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc,<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>osErr;</highlight></codeline>
<codeline lineno="1146"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CleanupDevicePropertyListeners(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,<sp/>AudioDeviceID<sp/>deviceID,<sp/>Boolean<sp/>isInput<sp/>)</highlight></codeline>
<codeline lineno="1149"><highlight class="normal">{<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyActualSampleRate,<sp/></highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyActualSampleRateListenerProc<sp/>);</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyLatency,<sp/></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc<sp/>);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertyBufferFrameSize,<sp/></highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc<sp/>);</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>deviceID,<sp/>0,<sp/>isInput,<sp/>kAudioDevicePropertySafetyOffset,<sp/></highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDevicePropertyGenericListenerProc<sp/>);</highlight></codeline>
<codeline lineno="1159"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"></highlight></codeline>
<codeline lineno="1161"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>=================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>OpenAndSetupOneAudioUnit(</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream,</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inStreamParams,</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outStreamParams,</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>UInt32<sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>*actualInputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>*actualOutputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnit<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioConverterRef<sp/>*srConverter,</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceID<sp/>*audioDevice,</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*refCon<sp/>)</highlight></codeline>
<codeline lineno="1175"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/>ComponentDescription<sp/><ref refid="_export_p_c_m_8cpp_1a717c8108dd6ce1ecc369d9bac2f471f2" kindref="member">desc</ref>;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/>Component<sp/>comp;</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*An<sp/>Apple<sp/>TN<sp/>suggests<sp/>using<sp/>CAStreamBasicDescription,<sp/>but<sp/>that<sp/>is<sp/>C++*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/>AudioStreamBasicDescription<sp/>desiredFormat;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>result<sp/>=<sp/>noErr;</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>paResult<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="seqread_8c_1aad9ebcdde542d8b2075615388ff15a9c" kindref="member">line</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>callbackKey;</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>AURenderCallbackStruct<sp/>rcbs;</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>macInputStreamFlags<sp/><sp/>=<sp/><ref refid="pa__mac__core_8h_1a223d2f56bd0a5964e4122c80b23e6f62" kindref="member">paMacCorePlayNice</ref>;</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>macOutputStreamFlags<sp/>=<sp/><ref refid="pa__mac__core_8h_1a223d2f56bd0a5964e4122c80b23e6f62" kindref="member">paMacCorePlayNice</ref>;</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/>SInt32<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*inChannelMap<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/>SInt32<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*outChannelMap<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>inChannelMapSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>outChannelMapSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;OpenAndSetupOneAudioUnit():<sp/>in<sp/>chan=%d,<sp/>in<sp/>fmt=%ld,<sp/>out<sp/>chan=%d,<sp/>out<sp/>fmt=%ld,<sp/>requestedFramesPerBuffer=%ld\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inStreamParams<sp/><sp/>?<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inStreamParams<sp/><sp/>?<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outStreamParams<sp/>?<sp/>outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outStreamParams<sp/>?<sp/>outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer<sp/>));</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"></highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>handle<sp/>the<sp/>degenerate<sp/>case<sp/><sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!inStreamParams<sp/>&amp;&amp;<sp/>!outStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioDevice<sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>get<sp/>the<sp/>user&apos;s<sp/>api<sp/>specific<sp/>info,<sp/>if<sp/>they<sp/>set<sp/>any<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>&amp;&amp;<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref><sp/>)</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>macInputStreamFlags=</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;flags;</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChannelMap<sp/>=<sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;channelMap;</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChannelMapSize<sp/>=<sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;channelMapSize;</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>&amp;&amp;<sp/>outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref><sp/>)</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>macOutputStreamFlags=</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;flags;</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outChannelMap<sp/>=<sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;channelMap;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outChannelMapSize<sp/>=<sp/>((<ref refid="struct_pa_mac_core_stream_info" kindref="compound">PaMacCoreStreamInfo</ref>*)outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aff01b9fa0710ad1654471e97665c06a9" kindref="member">hostApiSpecificStreamInfo</ref>)</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;channelMapSize;<sp/></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Override<sp/>user&apos;s<sp/>flags<sp/>here,<sp/>if<sp/>desired<sp/>for<sp/>testing.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"></highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1230"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>The<sp/>HAL<sp/>AU<sp/>is<sp/>a<sp/>Mac<sp/>OS<sp/>style<sp/>&quot;component&quot;.</highlight></codeline>
<codeline lineno="1231"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>first<sp/>few<sp/>steps<sp/>deal<sp/>with<sp/>that.</highlight></codeline>
<codeline lineno="1232"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Later<sp/>steps<sp/>work<sp/>on<sp/>a<sp/>combination<sp/>of<sp/>Mac<sp/>OS</highlight></codeline>
<codeline lineno="1233"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>components<sp/>and<sp/>the<sp/>slightly<sp/>lower<sp/>level</highlight></codeline>
<codeline lineno="1234"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>HAL.</highlight></codeline>
<codeline lineno="1235"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1236"><highlight class="normal"></highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>describe<sp/>the<sp/>output<sp/>type<sp/>AudioUnit<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>Note:<sp/>for<sp/>the<sp/>default<sp/>AudioUnit,<sp/>we<sp/>could<sp/>use<sp/>the</highlight></codeline>
<codeline lineno="1239"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>componentSubType<sp/>value<sp/>kAudioUnitSubType_DefaultOutput;</highlight></codeline>
<codeline lineno="1240"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>but<sp/>I<sp/>don&apos;t<sp/>think<sp/>that&apos;s<sp/>relevant<sp/>here.</highlight></codeline>
<codeline lineno="1241"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/>desc.componentType<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioUnitType_Output;</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/>desc.componentSubType<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioUnitSubType_HALOutput;</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/>desc.componentManufacturer<sp/>=<sp/>kAudioUnitManufacturer_Apple;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/>desc.componentFlags<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/>desc.componentFlagsMask<sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>find<sp/>the<sp/>component<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/>comp<sp/>=<sp/>FindNextComponent(<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>&amp;desc<sp/>);</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!comp<sp/>)</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a27513a24b6149b50414c8b8bf0220533" kindref="member">DBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;AUHAL<sp/>component<sp/>not<sp/>found.&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioDevice<sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a47726071f5dccc656d5e3ff20bbfc5a0" kindref="member">paUnanticipatedHostError</ref>;</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>open<sp/>it<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>OpenAComponent(<sp/>comp,<sp/>audioUnit<sp/>);</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>)</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a27513a24b6149b50414c8b8bf0220533" kindref="member">DBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>open<sp/>AUHAL<sp/>component.&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioDevice<sp/>=<sp/>kAudioDeviceUnknown;</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>result<sp/>);</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>prepare<sp/>a<sp/>little<sp/>error<sp/>handling<sp/>logic<sp/>/<sp/>hackery<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ERR_WRAP(mac_err)<sp/>do<sp/>{<sp/>result<sp/>=<sp/>mac_err<sp/>;<sp/>line<sp/>=<sp/>__LINE__<sp/>;<sp/>if<sp/>(<sp/>result<sp/>!=<sp/>noErr<sp/>)<sp/>goto<sp/>error<sp/>;<sp/>}<sp/>while(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>if<sp/>there<sp/>is<sp/>input,<sp/>we<sp/>have<sp/>to<sp/>explicitly<sp/>enable<sp/>input<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>enableIO<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_EnableIO,</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Input,</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;enableIO,</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(enableIO)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>if<sp/>there<sp/>is<sp/>no<sp/>output,<sp/>we<sp/>must<sp/>explicitly<sp/>disable<sp/>output<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!outStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>enableIO<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_EnableIO,</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;enableIO,</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(enableIO)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>set<sp/>the<sp/>devices<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>make<sp/>sure<sp/>input<sp/>and<sp/>output<sp/>are<sp/>the<sp/>same<sp/>device<sp/>if<sp/>we<sp/>are<sp/>doing<sp/>input<sp/>and</highlight></codeline>
<codeline lineno="1293"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>&amp;&amp;<sp/>outStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioDevice<sp/>=<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>]<sp/>;</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_CurrentDevice,</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Global,</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>audioDevice,</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioDeviceID)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>&amp;&amp;<sp/>outStreamParams<sp/>!=<sp/>inStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioDevice<sp/>=<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>]<sp/>;</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_CurrentDevice,</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Global,</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>audioDevice,</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioDeviceID)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>add<sp/>listener<sp/>for<sp/>dropouts<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>AudioDeviceAddPropertyListener(<sp/>*audioDevice,</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outStreamParams<sp/>?<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDeviceProcessorOverload,</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8c_1a6e0d12a5c5acae6fac007f5ea96f96a3" kindref="member">xrunCallback</ref>,</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8c_1adc104e6677780755cdb1c6ed7021fb45" kindref="member">addToXRunListenerList</ref>(<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)stream<sp/>)<sp/>)<sp/>;</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>==<sp/>kAudioHardwareIllegalOperationError<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>already<sp/>registered,<sp/>we&apos;re<sp/>good</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>not<sp/>already<sp/>registered,<sp/>just<sp/>check<sp/>for<sp/>errors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>result<sp/>);</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>listen<sp/>for<sp/>stream<sp/>start<sp/>and<sp/>stop<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitAddPropertyListener(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_IsRunning,</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>startStopCallback,</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)stream<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>set<sp/>format<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/>bzero(<sp/>&amp;desiredFormat,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(desiredFormat)<sp/>);</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/>desiredFormat.mFormatID<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioFormatLinearPCM<sp/>;</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/>desiredFormat.mFormatFlags<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioFormatFlagsNativeFloatPacked;</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/>desiredFormat.mFramesPerPacket<sp/><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/>desiredFormat.mBitsPerChannel<sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>float<sp/>)<sp/>*<sp/>8;</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>set<sp/>device<sp/>format<sp/>first,<sp/>but<sp/>only<sp/>touch<sp/>the<sp/>device<sp/>if<sp/>the<sp/>user<sp/>asked<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*The<sp/>callback<sp/>never<sp/>calls<sp/>back<sp/>if<sp/>we<sp/>don&apos;t<sp/>set<sp/>the<sp/>FPB<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*This<sp/>seems<sp/>wierd,<sp/>because<sp/>I<sp/>would<sp/>think<sp/>setting<sp/>anything<sp/>on<sp/>the<sp/>device</highlight></codeline>
<codeline lineno="1349"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>would<sp/>be<sp/>disruptive.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paResult<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a525354d1368777e71d58a88be42277b1" kindref="member">setBestFramesPerBuffer</ref>(<sp/>*audioDevice,<sp/><ref refid="cext_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualInputFramesPerBuffer<sp/>);</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>paResult<sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>macInputStreamFlags<sp/>&amp;<sp/><ref refid="pa__mac__core_8h_1a0a803427bdba498922276075677d0ebe" kindref="member">paMacCoreChangeDeviceParameters</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>requireExact;</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requireExact=macInputStreamFlags<sp/>&amp;<sp/><ref refid="pa__mac__core_8h_1a481969bad982aec7ba2b8503557533c7" kindref="member">paMacCoreFailIfConversionRequired</ref>;</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paResult<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a0f6bb3a8d2c8f1664a69e14240c1294a" kindref="member">setBestSampleRateForDevice</ref>(<sp/>*audioDevice,<sp/><ref refid="cext_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requireExact,<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>paResult<sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>actualInputFramesPerBuffer<sp/>&amp;&amp;<sp/>actualOutputFramesPerBuffer<sp/>)</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*actualOutputFramesPerBuffer<sp/>=<sp/>*actualInputFramesPerBuffer<sp/>;</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>&amp;&amp;<sp/>!inStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*The<sp/>callback<sp/>never<sp/>calls<sp/>back<sp/>if<sp/>we<sp/>don&apos;t<sp/>set<sp/>the<sp/>FPB<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*This<sp/>seems<sp/>wierd,<sp/>because<sp/>I<sp/>would<sp/>think<sp/>setting<sp/>anything<sp/>on<sp/>the<sp/>device</highlight></codeline>
<codeline lineno="1367"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>would<sp/>be<sp/>disruptive.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paResult<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a525354d1368777e71d58a88be42277b1" kindref="member">setBestFramesPerBuffer</ref>(<sp/>*audioDevice,<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualOutputFramesPerBuffer<sp/>);</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>paResult<sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>macOutputStreamFlags<sp/>&amp;<sp/><ref refid="pa__mac__core_8h_1a0a803427bdba498922276075677d0ebe" kindref="member">paMacCoreChangeDeviceParameters</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>requireExact;</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requireExact=macOutputStreamFlags<sp/>&amp;<sp/><ref refid="pa__mac__core_8h_1a481969bad982aec7ba2b8503557533c7" kindref="member">paMacCoreFailIfConversionRequired</ref>;</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paResult<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a0f6bb3a8d2c8f1664a69e14240c1294a" kindref="member">setBestSampleRateForDevice</ref>(<sp/>*audioDevice,<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requireExact,<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref><sp/>);</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>paResult<sp/>)<sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>set<sp/>the<sp/>quality<sp/>of<sp/>the<sp/>output<sp/>converter<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref><sp/>=<sp/>kAudioConverterQuality_Max;</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>macOutputStreamFlags<sp/>&amp;<sp/>0x0700<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0100:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityMin:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kRenderQuality_Min;</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0200:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityLow:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kRenderQuality_Low;</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0300:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityMedium:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kRenderQuality_Medium;</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0400:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityHigh:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kRenderQuality_High;</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_RenderQuality,</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Global,</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;value,</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(value)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>now<sp/>set<sp/>the<sp/>format<sp/>on<sp/>the<sp/>Audio<sp/>Units.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mSampleRate<sp/><sp/><sp/><sp/>=<ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerPacket=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(float)*outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerFrame<sp/>=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)*outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mChannelsPerFrame<sp/>=<sp/>outStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_StreamFormat,</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Input,</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;desiredFormat,</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioStreamBasicDescription)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioStreamBasicDescription<sp/>sourceFormat;</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>AudioStreamBasicDescription<sp/>);</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"></highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>keep<sp/>the<sp/>sample<sp/>rate<sp/>of<sp/>the<sp/>device,<sp/>or<sp/>we<sp/>confuse<sp/>AUHAL<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitGetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_StreamFormat,</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Input,</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;sourceFormat,</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mSampleRate<sp/>=<sp/>sourceFormat.mSampleRate;</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerPacket=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(float)*inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerFrame<sp/>=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)*inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mChannelsPerFrame<sp/>=<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_StreamFormat,</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;desiredFormat,</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(AudioStreamBasicDescription)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>the<sp/>maximumFramesPerSlice<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>not<sp/>doing<sp/>this<sp/>causes<sp/>real<sp/>problems</highlight></codeline>
<codeline lineno="1444"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(eg.<sp/>the<sp/>callback<sp/>might<sp/>not<sp/>be<sp/>called).<sp/>The<sp/>idea<sp/>of<sp/>setting<sp/>both<sp/>this</highlight></codeline>
<codeline lineno="1445"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>the<sp/>frames<sp/>per<sp/>buffer<sp/>on<sp/>the<sp/>device<sp/>is<sp/>that<sp/>we&apos;ll<sp/>be<sp/>most<sp/>likely</highlight></codeline>
<codeline lineno="1446"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>actually<sp/>get<sp/>the<sp/>frame<sp/>size<sp/>we<sp/>requested<sp/>in<sp/>the<sp/>callback<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="1447"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minimum<sp/>latency.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>*actualOutputFramesPerBuffer<sp/>);</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_MaximumFramesPerSlice,</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Input,</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualOutputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*actualOutputFramesPerBuffer)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitGetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_MaximumFramesPerSlice,</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Global,</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualOutputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*UInt32<sp/>size<sp/>=<sp/>sizeof(<sp/>*actualInputFramesPerBuffer<sp/>);*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_MaximumFramesPerSlice,</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualInputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*actualInputFramesPerBuffer)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Don&apos;t<sp/>know<sp/>why<sp/>this<sp/>causes<sp/>problems</highlight></codeline>
<codeline lineno="1472"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ERR_WRAP(<sp/>AudioUnitGetProperty(<sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1473"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_MaximumFramesPerSlice,</highlight></codeline>
<codeline lineno="1474"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Global,<sp/>//Output,</highlight></codeline>
<codeline lineno="1475"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INPUT_ELEMENT,</highlight></codeline>
<codeline lineno="1476"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actualInputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1477"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1478"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"></highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>if<sp/>we<sp/>have<sp/>input,<sp/>we<sp/>may<sp/>need<sp/>to<sp/>setup<sp/>an<sp/>SR<sp/>converter<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>even<sp/>if<sp/>we<sp/>got<sp/>the<sp/>sample<sp/>rate<sp/>we<sp/>asked<sp/>for,<sp/>we<sp/>need<sp/>to<sp/>do</highlight></codeline>
<codeline lineno="1483"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>conversion<sp/>in<sp/>case<sp/>another<sp/>program<sp/>changes<sp/>the<sp/>underlying<sp/>SR.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>I<sp/>think<sp/>we<sp/>need<sp/>to<sp/>monitor<sp/>stream<sp/>and<sp/>change<sp/>the<sp/>converter<sp/>if<sp/>the<sp/>incoming<sp/>format<sp/>changes.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioStreamBasicDescription<sp/>desiredFormat;</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioStreamBasicDescription<sp/>sourceFormat;</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>sourceSize<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>sourceFormat<sp/>);</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bzero(<sp/>&amp;desiredFormat,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(desiredFormat)<sp/>);</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mSampleRate<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mFormatID<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioFormatLinearPCM<sp/>;</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mFormatFlags<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>kAudioFormatFlagsNativeFloatPacked;</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mFramesPerPacket<sp/><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBitsPerChannel<sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>float<sp/>)<sp/>*<sp/>8;</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerPacket=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(float)*inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mBytesPerFrame<sp/>=</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)*inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desiredFormat.mChannelsPerFrame<sp/>=<sp/>inStreamParams-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>get<sp/>the<sp/>source<sp/>format<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitGetProperty(</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitProperty_StreamFormat,</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;sourceFormat,</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;sourceSize<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"></highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>desiredFormat.mSampleRate<sp/>!=<sp/>sourceFormat.mSampleRate<sp/>)</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="lib_2expat_8h_1a4a30a13b813682e68c5b689b45c65971" kindref="member">value</ref><sp/>=<sp/>kAudioConverterQuality_Max;</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>macInputStreamFlags<sp/>&amp;<sp/>0x0700<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0100:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityMin:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kAudioConverterQuality_Min;</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0200:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityLow:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kAudioConverterQuality_Low;</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0300:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityMedium:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kAudioConverterQuality_Medium;</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0x0400:<sp/></highlight><highlight class="comment">/*paMacCore_ConversionQualityHigh:*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value=kAudioConverterQuality_High;</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((<sp/></highlight><highlight class="stringliteral">&quot;Creating<sp/>sample<sp/>rate<sp/>converter<sp/>for<sp/>input&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/>to<sp/>convert<sp/>from<sp/>%g<sp/>to<sp/>%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)sourceFormat.mSampleRate,</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)desiredFormat.mSampleRate<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>create<sp/>our<sp/>converter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioConverterNew(<sp/></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;sourceFormat,</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;desiredFormat,</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>srConverter<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>quality<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioConverterSetProperty(</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*srConverter,</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioConverterSampleRateConverterQuality,</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>value<sp/>),</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;value<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>set<sp/>IOProc<sp/>(callback)<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/>callbackKey<sp/>=<sp/>outStreamParams<sp/>?<sp/>kAudioUnitProperty_SetRenderCallback</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>kAudioOutputUnitProperty_SetInputCallback<sp/>;</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/>rcbs.inputProc<sp/>=<sp/>AudioIOProc;</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/>rcbs.inputProcRefCon<sp/>=<sp/>refCon;</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>callbackKey,</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outStreamParams<sp/>?<sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref><sp/>:<sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;rcbs,</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rcbs))<sp/>);</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"></highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>&amp;&amp;<sp/>outStreamParams<sp/>&amp;&amp;<sp/>*srConverter<sp/>)</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit,</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_SetInputCallback,</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INPUT_ELEMENT,</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;rcbs,</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rcbs))<sp/>);</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"></highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>channel<sp/>mapping.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(inChannelMap)</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>mapSize<sp/>=<sp/>inChannelMapSize<sp/>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(SInt32);</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>each<sp/>channel<sp/>of<sp/>desired<sp/>input,<sp/>map<sp/>the<sp/>channel<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//the<sp/>device&apos;s<sp/>output<sp/>channel.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitSetProperty(*audioUnit,</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_ChannelMap,</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INPUT_ELEMENT,</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChannelMap,</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mapSize));</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(outChannelMap)</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>mapSize<sp/>=<sp/>outChannelMapSize<sp/>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(SInt32);</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"></highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>each<sp/>channel<sp/>of<sp/>desired<sp/>output,<sp/>map<sp/>the<sp/>channel<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//the<sp/>device&apos;s<sp/>output<sp/>channel.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(AudioUnitSetProperty(*audioUnit,</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioOutputUnitProperty_ChannelMap,</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioUnitScope_Output,</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outChannelMap,</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mapSize));</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>initialize<sp/>the<sp/>audio<sp/>unit<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitInitialize(*audioUnit)<sp/>);</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"></highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>&amp;&amp;<sp/>outStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Opened<sp/>device<sp/>%ld<sp/>for<sp/>input<sp/>and<sp/>output.\n&quot;</highlight><highlight class="normal">,<sp/>*audioDevice<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Opened<sp/>device<sp/>%ld<sp/>for<sp/>input.\n&quot;</highlight><highlight class="normal">,<sp/>*audioDevice<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outStreamParams<sp/>)</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Opened<sp/>device<sp/>%ld<sp/>for<sp/>output.\n&quot;</highlight><highlight class="normal">,<sp/>*audioDevice<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"></highlight><highlight class="preprocessor">#undef<sp/>ERR_WRAP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseComponent(<sp/>*audioUnit<sp/>);</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*audioUnit<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>)</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core__utilities_8c_1a13501102f029a53953c3f59ddc934c80" kindref="member">PaMacCore_SetError</ref>(<sp/>result,<sp/>line,<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>paResult;</highlight></codeline>
<codeline lineno="1615"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1618"><highlight class="normal"></highlight></codeline>
<codeline lineno="1619"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>UInt32<sp/>CalculateOptimalBufferSize(<sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi,</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>fixedInputLatency,</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>fixedOutputLatency,</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>requestedFramesPerBuffer<sp/>)</highlight></codeline>
<codeline lineno="1626"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>resultBufferSizeFrames<sp/>=<sp/>0;<sp/><sp/></highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>maximum<sp/>of<sp/>suggested<sp/>input<sp/>and<sp/>output<sp/>latencies.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>suggestedLatencyFrames<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aa1e80ac0551162fd091db8936ccbe9a0" kindref="member">suggestedLatency</ref><sp/>*<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>a<sp/>buffer<sp/>size<sp/>assuming<sp/>we<sp/>are<sp/>double<sp/>buffered.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SInt32<sp/>variableLatencyFrames<sp/>=<sp/>suggestedLatencyFrames<sp/>-<sp/>fixedInputLatency;</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Prevent<sp/>negative<sp/>latency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>variableLatencyFrames<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>variableLatencyFrames,<sp/>0<sp/>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultBufferSizeFrames<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>resultBufferSizeFrames,<sp/>(UInt32)<sp/>variableLatencyFrames<sp/>);</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>suggestedLatencyFrames<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aa1e80ac0551162fd091db8936ccbe9a0" kindref="member">suggestedLatency</ref><sp/>*<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SInt32<sp/>variableLatencyFrames<sp/>=<sp/>suggestedLatencyFrames<sp/>-<sp/>fixedOutputLatency;</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>variableLatencyFrames<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>variableLatencyFrames,<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultBufferSizeFrames<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>resultBufferSizeFrames,<sp/>(UInt32)<sp/>variableLatencyFrames<sp/>);</highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>can&apos;t<sp/>have<sp/>zero<sp/>frames.<sp/>code<sp/>to<sp/>round<sp/>up<sp/>to<sp/>next<sp/>user<sp/>buffer<sp/>requires<sp/>non-zero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/>resultBufferSizeFrames<sp/>=<sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(<sp/>resultBufferSizeFrames,<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>requestedFramesPerBuffer<sp/>!=<sp/><ref refid="portaudio_8h_1ac1e20b97c1858a59bc62823573c59f0b" kindref="member">paFramesPerBufferUnspecified</ref><sp/>)</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>make<sp/>host<sp/>buffer<sp/>the<sp/>next<sp/>highest<sp/>integer<sp/>multiple<sp/>of<sp/>user<sp/>frames<sp/>per<sp/>buffer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>n<sp/>=<sp/>(resultBufferSizeFrames<sp/>+<sp/>requestedFramesPerBuffer<sp/>-<sp/>1)<sp/>/<sp/>requestedFramesPerBuffer;</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultBufferSizeFrames<sp/>=<sp/>n<sp/>*<sp/>requestedFramesPerBuffer;</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FIXME:<sp/>really<sp/>we<sp/>should<sp/>be<sp/>searching<sp/>for<sp/>a<sp/>multiple<sp/>of<sp/>requestedFramesPerBuffer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>that<sp/>is<sp/>&gt;=<sp/>suggested<sp/>latency<sp/>and<sp/>also<sp/>fits<sp/>within<sp/>device<sp/>buffer<sp/>min/max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Block<sp/>Size<sp/>unspecified.<sp/>Based<sp/>on<sp/>Latency,<sp/>the<sp/>user<sp/>wants<sp/>a<sp/>Block<sp/>Size<sp/>near:<sp/>%ld.\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultBufferSizeFrames<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Clip<sp/>to<sp/>the<sp/>capabilities<sp/>of<sp/>the<sp/>device.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClipToDeviceBufferSize(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>],</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">//<sp/>In<sp/>the<sp/>old<sp/>code<sp/>isInput<sp/>was<sp/>false!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultBufferSizeFrames,<sp/>&amp;resultBufferSizeFrames<sp/>);</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClipToDeviceBufferSize(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>],</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>resultBufferSizeFrames,<sp/>&amp;resultBufferSizeFrames<sp/>);</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>((</highlight><highlight class="stringliteral">&quot;After<sp/>querying<sp/>hardware,<sp/>setting<sp/>block<sp/>size<sp/>to<sp/>%ld.\n&quot;</highlight><highlight class="normal">,<sp/>resultBufferSizeFrames));</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"></highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>resultBufferSizeFrames;</highlight></codeline>
<codeline lineno="1679"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"></highlight></codeline>
<codeline lineno="1681"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>===================================================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1682"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>see<sp/>pa_hostapi.h<sp/>for<sp/>a<sp/>list<sp/>of<sp/>validity<sp/>guarantees<sp/>made<sp/>about<sp/>OpenStream<sp/>parameters<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1683"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/><ref refid="struct_pa_util_host_api_representation_1aa415b57fadf39a49d6bc5740f06089e4" kindref="member">OpenStream</ref>(<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="struct_pa_util_host_api_representation" kindref="compound">PaUtilHostApiRepresentation</ref><sp/>*hostApi,</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>**<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref>,</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*inputParameters,</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_pa_stream_parameters" kindref="compound">PaStreamParameters</ref><sp/>*outputParameters,</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a37c7ac3ace7d2dd1430f40ecdee4ebb6" kindref="member">PaStreamFlags</ref><sp/>streamFlags,</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a8a60fb2a5ec9cbade3f54a9c978e2710" kindref="member">PaStreamCallback</ref><sp/>*streamCallback,</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="xmlparse_8c_1a4b666535c828e23ccd16510a0a1a1943" kindref="member">userData</ref><sp/>)</highlight></codeline>
<codeline lineno="1692"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref><sp/>*auhalHostApi<sp/>=<sp/>(<ref refid="struct_pa_mac_a_u_h_a_l" kindref="compound">PaMacAUHAL</ref>*)hostApi;</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inputChannelCount,<sp/>outputChannelCount;</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>inputSampleFormat,<sp/>outputSampleFormat;</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4582d93c2c2e60e12be3d74c5fe00b96" kindref="member">PaSampleFormat</ref><sp/>hostInputSampleFormat,<sp/>hostOutputSampleFormat;</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>fixedInputLatency<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>fixedOutputLatency<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Accumulate<sp/>contributions<sp/>to<sp/>latency<sp/>in<sp/>these<sp/>variables.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>inputLatencyFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>outputLatencyFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/>UInt32<sp/>suggestedLatencyFramesPerBuffer<sp/>=<sp/>requestedFramesPerBuffer;</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;OpenStream():<sp/>in<sp/>chan=%d,<sp/>in<sp/>fmt=%ld,<sp/>out<sp/>chan=%d,<sp/>out<sp/>fmt=%ld<sp/>SR=%g,<sp/>FPB=%ld\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters<sp/><sp/>?<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters<sp/><sp/>?<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters<sp/>?<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters<sp/>?<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref><sp/>:<sp/>-1,</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>,</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer<sp/>));</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Opening<sp/>Stream.\n&quot;</highlight><highlight class="normal">)<sp/>);</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>These<sp/>first<sp/>few<sp/>bits<sp/>of<sp/>code<sp/>are<sp/>from<sp/>paSkeleton<sp/>with<sp/>few<sp/>modifications.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSampleFormat<sp/>=<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"></highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>@todo<sp/>Blocking<sp/>read/write<sp/>on<sp/>Mac<sp/>is<sp/>not<sp/>yet<sp/>supported.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!streamCallback<sp/>&amp;&amp;<sp/>inputSampleFormat<sp/>&amp;<sp/><ref refid="portaudio_8h_1a1d79f0b88812cef5364b276dbbc898b5" kindref="member">paNonInterleaved</ref><sp/>)</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref>;</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="1728"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1729"><highlight class="normal"></highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>input<sp/>device<sp/>can<sp/>support<sp/>inputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1ad0baeeb2b6ceaf7fc9bb76109a7555e9" kindref="member">maxInputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Host<sp/>supports<sp/>interleaved<sp/>float32<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostInputSampleFormat<sp/>=<sp/><ref refid="portaudio_8h_1a2f16d29916725b8791eae60ab9e0b081" kindref="member">paFloat32</ref>;</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSampleFormat<sp/>=<sp/>hostInputSampleFormat<sp/>=<sp/><ref refid="portaudio_8h_1a2f16d29916725b8791eae60ab9e0b081" kindref="member">paFloat32</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Surpress<sp/>&apos;uninitialised<sp/>var&apos;<sp/>warnings.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>;</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSampleFormat<sp/>=<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>;</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>@todo<sp/>Blocking<sp/>read/write<sp/>on<sp/>Mac<sp/>is<sp/>not<sp/>yet<sp/>supported.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!streamCallback<sp/>&amp;&amp;<sp/>outputSampleFormat<sp/>&amp;<sp/><ref refid="portaudio_8h_1a1d79f0b88812cef5364b276dbbc898b5" kindref="member">paNonInterleaved</ref><sp/>)</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a69660cd762aec2672fd3393e0971e99c" kindref="member">paSampleFormatNotSupported</ref>;</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unless<sp/>alternate<sp/>device<sp/>specification<sp/>is<sp/>supported,<sp/>reject<sp/>the<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="1758"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paUseHostApiSpecificDeviceSpecification<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1759"><highlight class="normal"></highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/><ref refid="portaudio_8h_1a14795fe3377c3b037025a61e550d44b5" kindref="member">paUseHostApiSpecificDeviceSpecification</ref><sp/>)</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a3442d8018bfa4329847d87df68b564a3" kindref="member">paInvalidDevice</ref>;</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"></highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>check<sp/>that<sp/>output<sp/>device<sp/>can<sp/>support<sp/>inputChannelCount<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputChannelCount<sp/>&gt;<sp/>hostApi-&gt;<ref refid="struct_pa_util_host_api_representation_1a48dcfdf57e6d12d33314929ac213ae28" kindref="member">deviceInfos</ref>[<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>]-&gt;<ref refid="struct_pa_device_info_1a48f908b21e8a11fdf0a88132b18fe7b0" kindref="member">maxOutputChannels</ref><sp/>)</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7a46c51714378540c67c46895e726fb787" kindref="member">paInvalidChannelCount</ref>;</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Host<sp/>supports<sp/>interleaved<sp/>float32<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostOutputSampleFormat<sp/>=<sp/><ref refid="portaudio_8h_1a2f16d29916725b8791eae60ab9e0b081" kindref="member">paFloat32</ref>;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputSampleFormat<sp/>=<sp/>hostOutputSampleFormat<sp/>=<sp/><ref refid="portaudio_8h_1a2f16d29916725b8791eae60ab9e0b081" kindref="member">paFloat32</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Surpress<sp/>&apos;uninitialized<sp/>var&apos;<sp/>warnings.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"></highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>validate<sp/>platform<sp/>specific<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(streamFlags<sp/>&amp;<sp/><ref refid="portaudio_8h_1a8522957e1bf814b9782d3a0e314c8b51" kindref="member">paPlatformSpecificFlags</ref>)<sp/>!=<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aa5e7d0d9ea49ef845a93c89a3d138294" kindref="member">paInvalidFlag</ref>;<sp/></highlight><highlight class="comment">/*<sp/>unexpected<sp/>platform<sp/>specific<sp/>flag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"></highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/>stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)<ref refid="pa__util_8h_1aa614f193aff12744a6ab90a9eb3128f0" kindref="member">PaUtil_AllocateMemory</ref>(<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>)<sp/>);</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!stream<sp/>)</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>fail<sp/>after<sp/>this<sp/>point,<sp/>we<sp/>my<sp/>be<sp/>left<sp/>in<sp/>a<sp/>bad<sp/>state,<sp/>with</highlight></codeline>
<codeline lineno="1788"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>some<sp/>data<sp/>structures<sp/>setup<sp/>and<sp/>others<sp/>not.<sp/>So,<sp/>first<sp/>thing<sp/>we</highlight></codeline>
<codeline lineno="1789"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>do<sp/>is<sp/>initialize<sp/>everything<sp/>so<sp/>that<sp/>if<sp/>we<sp/>fail,<sp/>we<sp/>know<sp/>what<sp/>hasn&apos;t</highlight></codeline>
<codeline lineno="1790"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>been<sp/>touched.</highlight></codeline>
<codeline lineno="1791"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/>bzero(<sp/>stream,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1795"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.inputRingBuffer.buffer<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1796"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.outputRingBuffer.buffer<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1797"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.inputSampleFormat<sp/>=<sp/>inputParameters?inputParameters-&gt;sampleFormat:0;</highlight></codeline>
<codeline lineno="1798"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.inputSampleSize<sp/>=<sp/>computeSampleSizeFromFormat(stream-&gt;blio.inputSampleFormat);</highlight></codeline>
<codeline lineno="1799"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.outputSampleFormat=outputParameters?outputParameters-&gt;sampleFormat:0;</highlight></codeline>
<codeline lineno="1800"><highlight class="comment"><sp/><sp/><sp/><sp/>stream-&gt;blio.outputSampleSize<sp/>=<sp/>computeSampleSizeFromFormat(stream-&gt;blio.outputSampleFormat);</highlight></codeline>
<codeline lineno="1801"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"></highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>assert(<sp/>streamCallback<sp/>)<sp/>;<sp/>*/</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>only<sp/>callback<sp/>mode<sp/>is<sp/>implemented<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>streamCallback<sp/>)</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a0e3a44086f5baa62308dfd6df77396e0" kindref="member">PaUtil_InitializeStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>,</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a747f231b18878ff0cc7918bbd4df5e21" kindref="member">callbackStreamInterface</ref>,</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>streamCallback,<sp/>userData<sp/>);</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1a0e3a44086f5baa62308dfd6df77396e0" kindref="member">PaUtil_InitializeStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>,</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1aa7c1cb635e954f37e178e7f037f6cbfb" kindref="member">blockingStreamInterface</ref>,</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1af2c9d8aead26742638f8cfb73f07ca8f" kindref="member">BlioCallback</ref>,<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref><sp/>);</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"></highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a8cffac188367367b6c5c5ed8e0b1fe46" kindref="member">PaUtil_InitializeCpuLoadMeasurer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a589be1f91f8332bba6cc1b0b006f9b80" kindref="member">cpuLoadMeasurer</ref>,<sp/>sampleRate<sp/>);</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"></highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalculateFixedDeviceLatency(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>],<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>&amp;fixedInputLatency<sp/>);</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputLatencyFrames<sp/>+=<sp/>fixedInputLatency;</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)</highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalculateFixedDeviceLatency(<sp/>auhalHostApi-&gt;<ref refid="struct_pa_mac_a_u_h_a_l_1a2b9cc8201b12b88cea1acb9e2cc30c21" kindref="member">devIds</ref>[outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref>],<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>&amp;fixedOutputLatency<sp/>);</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputLatencyFrames<sp/>+=<sp/>fixedOutputLatency;</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"></highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/>suggestedLatencyFramesPerBuffer<sp/>=<sp/>CalculateOptimalBufferSize(<sp/>auhalHostApi,<sp/>inputParameters,<sp/>outputParameters,</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fixedInputLatency,<sp/>fixedOutputLatency,</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,<sp/>requestedFramesPerBuffer<sp/>);</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>requestedFramesPerBuffer<sp/>==<sp/><ref refid="portaudio_8h_1ac1e20b97c1858a59bc62823573c59f0b" kindref="member">paFramesPerBufferUnspecified</ref><sp/>)</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer<sp/>=<sp/>suggestedLatencyFramesPerBuffer;</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"></highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>Now<sp/>we<sp/>actually<sp/>open<sp/>and<sp/>setup<sp/>streams.<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>&amp;&amp;<sp/>outputParameters<sp/>&amp;&amp;<sp/>outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>==<sp/>inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1aebaf648b4d11dd1252a747b76b8da084" kindref="member">device</ref><sp/>)</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>full<sp/>duplex.<sp/>One<sp/>device.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inputFramesPerBuffer<sp/><sp/>=<sp/>(UInt32)<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>outputFramesPerBuffer<sp/>=<sp/>(UInt32)<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>OpenAndSetupOneAudioUnit(<sp/>stream,</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters,</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters,</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>suggestedLatencyFramesPerBuffer,</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;inputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;outputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi,</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>),</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref>),</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>),</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref><sp/>=<sp/>inputFramesPerBuffer;</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref><sp/>=<sp/>outputFramesPerBuffer;</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>;</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>;</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*<sp/>full<sp/>duplex,<sp/>different<sp/>devices<sp/>OR<sp/>simplex<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>outputFramesPerBuffer<sp/>=<sp/>(UInt32)<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inputFramesPerBuffer<sp/><sp/>=<sp/>(UInt32)<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>OpenAndSetupOneAudioUnit(<sp/>stream,</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters,</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>suggestedLatencyFramesPerBuffer,</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;outputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi,</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>),</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>),</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>OpenAndSetupOneAudioUnit(<sp/>stream,</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters,</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>suggestedLatencyFramesPerBuffer,</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;inputFramesPerBuffer,</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auhalHostApi,</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>),</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref>),</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>),</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref><sp/>=<sp/>inputFramesPerBuffer;</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref><sp/>=<sp/>outputFramesPerBuffer;</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/>inputLatencyFrames<sp/>+=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/>outputLatencyFrames<sp/>+=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>szfl<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(float);</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>setup<sp/>the<sp/>AudioBufferList<sp/>used<sp/>for<sp/>input<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bzero(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>AudioBufferList<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mNumberBuffers<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mNumberChannels</highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>inputChannelCount;</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mDataByteSize</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>*inputChannelCount*szfl;</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*)<sp/>calloc(</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>*inputChannelCount,</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>szfl<sp/>);</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData<sp/>)</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1923"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>If<sp/>input<sp/>and<sp/>output<sp/>devs<sp/>are<sp/>different<sp/>or<sp/>we<sp/>are<sp/>doing<sp/>SR<sp/>conversion,</highlight></codeline>
<codeline lineno="1924"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>we<sp/>also<sp/>need<sp/>a</highlight></codeline>
<codeline lineno="1925"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>ring<sp/>buffer<sp/>to<sp/>store<sp/>inpt<sp/>data<sp/>while<sp/>waiting<sp/>for<sp/>output</highlight></codeline>
<codeline lineno="1926"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data.</highlight></codeline>
<codeline lineno="1927"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>!=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>))</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>May<sp/>want<sp/>the<sp/>ringSize<sp/>ot<sp/>initial<sp/>position<sp/>in</highlight></codeline>
<codeline lineno="1932"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ring<sp/>buffer<sp/>to<sp/>depend<sp/>somewhat<sp/>on<sp/>sample<sp/>rate<sp/>change<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1933"><highlight class="normal"></highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>;</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ringSize;</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"></highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ringSize<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a61fdbb7fe209deca10dc73721c91fee4" kindref="member">computeRingBufferSize</ref>(<sp/>inputParameters,</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters,</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>,</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>,</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate<sp/>);</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*ringSize<sp/>&lt;&lt;=<sp/>4;<sp/>*/</highlight><highlight class="comment">/*16x<sp/>bigger,<sp/>for<sp/>testing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1943"><highlight class="normal"></highlight></codeline>
<codeline lineno="1944"><highlight class="normal"></highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*now,<sp/>we<sp/>need<sp/>to<sp/>allocate<sp/>memory<sp/>for<sp/>the<sp/>ring<sp/>buffer*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>calloc(<sp/>ringSize,<sp/>szfl*inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref><sp/>);</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!data<sp/>)</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7ad58986a9b5064d5a29c7ed0837bfc621" kindref="member">paInsufficientMemory</ref>;</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"></highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>now<sp/>we<sp/>can<sp/>initialize<sp/>the<sp/>ring<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1ac59abf83ad9ad72e1971ac406b0e67a8" kindref="member">PaUtil_InitializeRingBuffer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,<sp/>szfl*inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1a861ff361da71fc2572dd356c9c9878ca" kindref="member">channelCount</ref>,<sp/>ringSize,<sp/>data<sp/>)<sp/>;</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>advance<sp/>the<sp/>read<sp/>point<sp/>a<sp/>little,<sp/>so<sp/>we<sp/>are<sp/>reading<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="1956"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>middle<sp/>of<sp/>the<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1ad38033c3d1cef68a44b7ccb0cf318236" kindref="member">PaUtil_AdvanceRingBufferWriteIndex</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,<sp/>ringSize<sp/>/<sp/><ref refid="pa__mac__core_8c_1a341f496004a3608bb6534632b2399cf8" kindref="member">RING_BUFFER_ADVANCE_DENOMINATOR</ref><sp/>);</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Just<sp/>adds<sp/>to<sp/>input<sp/>latency<sp/>between<sp/>input<sp/>device<sp/>and<sp/>PA<sp/>full<sp/>duplex<sp/>callback.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputLatencyFrames<sp/>+=<sp/>ringSize;</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"></highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>initialize<sp/>Blio<sp/>Buffer<sp/>Processors<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!streamCallback<sp/>)</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ringSize;</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ringSize<sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a61fdbb7fe209deca10dc73721c91fee4" kindref="member">computeRingBufferSize</ref>(<sp/>inputParameters,</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters,</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>,</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>,</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate<sp/>);</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__mac__core__blocking_8c_1a3c33ab58f871d592bd90142fe5c0c5cd" kindref="member">initializeBlioRingBuffers</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref>,</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters?inputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>:0<sp/>,</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters?outputParameters-&gt;<ref refid="struct_pa_stream_parameters_1ad8d2d3063757b812f9e5f8709f41052b" kindref="member">sampleFormat</ref>:0<sp/>,</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libflac_2src_2lib_f_l_a_c_2include_2private_2macros_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>,stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>),</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ringSize,</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputParameters?inputChannelCount:0<sp/>,</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputParameters?outputChannelCount:0<sp/>)<sp/>;</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputLatencyFrames<sp/>+=<sp/>ringSize;</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputLatencyFrames<sp/>+=<sp/>ringSize;</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"></highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>initialize<sp/>Buffer<sp/>Processor<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>maxHostFrames<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a33e3792b0bebe4a05a5e794ec087e4c3" kindref="member">inputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref><sp/>&gt;<sp/>maxHostFrames<sp/>)</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxHostFrames<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a6ba0534d56d18552f4dd23b5922b6caa" kindref="member">outputFramesPerBuffer</ref>;</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__process_8c_1aaae7001566f528cf2d3cd453bf05c5d5" kindref="member">PaUtil_InitializeBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>,</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputChannelCount,<sp/>inputSampleFormat,</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostInputSampleFormat,</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputChannelCount,<sp/>outputSampleFormat,</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostOutputSampleFormat,</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sampleRate,</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>streamFlags,</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requestedFramesPerBuffer,</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>sample<sp/>rate<sp/>conversion<sp/>takes<sp/>place,<sp/>the<sp/>buffer<sp/>size</highlight></codeline>
<codeline lineno="2004"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>not<sp/>be<sp/>known.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxHostFrames,</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref></highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/><ref refid="pa__process_8h_1a16c84d8c0ac62944797f530bf852484fa4273c3f42fdaa887af00afa2bdb03cc0" kindref="member">paUtilUnknownHostBufferSize</ref></highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="pa__process_8h_1a16c84d8c0ac62944797f530bf852484fa2e97156fbdf5444b7bcc53b60f368d8b" kindref="member">paUtilBoundedHostBufferSize</ref>,</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>streamCallback<sp/>?<sp/>streamCallback<sp/>:<sp/><ref refid="pa__mac__core__blocking_8c_1af2c9d8aead26742638f8cfb73f07ca8f" kindref="member">BlioCallback</ref>,</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>streamCallback<sp/>?<sp/>userData<sp/>:<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref><sp/>);</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>!=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref><sp/>)</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ac6468bfef6a09086a8ba75bd1825b3f4" kindref="member">bufferProcessorIsInitialized</ref><sp/>=<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"></highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>actual<sp/>latency<sp/>from<sp/>the<sp/>sum<sp/>of<sp/>individual<sp/>latencies.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>inputParameters<sp/>)<sp/></highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputLatencyFrames<sp/>+=<sp/><ref refid="pa__process_8c_1ae5a4104d7132396436e179825e2a3847" kindref="member">PaUtil_GetBufferProcessorInputLatencyFrames</ref>(&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>);</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a1f5339e0fef75cea66d9153235698399" kindref="member">inputLatency</ref><sp/>=<sp/>inputLatencyFrames<sp/>/<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a1f5339e0fef75cea66d9153235698399" kindref="member">inputLatency</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>outputParameters<sp/>)<sp/></highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputLatencyFrames<sp/>+=<sp/><ref refid="pa__process_8c_1a853a8cd0e8d214406aa83ef3ef3d1102" kindref="member">PaUtil_GetBufferProcessorOutputLatencyFrames</ref>(&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>);</highlight></codeline>
<codeline lineno="2030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a372a81f39d90a85ae62225e9f57a7840" kindref="member">outputLatency</ref><sp/>=<sp/>outputLatencyFrames<sp/>/<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a372a81f39d90a85ae62225e9f57a7840" kindref="member">outputLatency</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref>.<ref refid="struct_pa_util_stream_representation_1a13c2b5318f73dde9a11fd9d874763d4a" kindref="member">streamInfo</ref>.<ref refid="struct_pa_stream_info_1a9200fdee790d9155bc35d03be51ee2dd" kindref="member">sampleRate</ref><sp/>=<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a3e945d299bff5c01d6e8a4f6bd8dfffb" kindref="member">sampleRate</ref><sp/>=<sp/><ref refid="namespacepatest__suggested__vs__streaminfo__latency_1a14f2ecd6f756d329f6df4096833062d0" kindref="member">sampleRate</ref>;</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a8117390b82eb0f6aa238c1c0272f96b2" kindref="member">userInChan</ref><sp/><sp/>=<sp/>inputChannelCount;</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa672c86d838eb7f11ee03e939b7a58e5" kindref="member">userOutChan</ref><sp/>=<sp/>outputChannelCount;</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Setup<sp/>property<sp/>listeners<sp/>for<sp/>timestamp<sp/>and<sp/>latency<sp/>calculations.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_mutex_init(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref>,<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>);</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a94404e181cea0bc1d2c82b2e6f541366" kindref="member">timingInformationMutexIsInitialized</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/>InitializeDeviceProperties(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a784e07f3c2e4f2e03989aab2614687b1" kindref="member">inputProperties</ref><sp/>);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>zeros<sp/>the<sp/>struct.<sp/>doesn&apos;t<sp/>actually<sp/>init<sp/>it<sp/>to<sp/>useful<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/>InitializeDeviceProperties(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a7d1be4951510dd36b84abd1cc7daf49a" kindref="member">outputProperties</ref><sp/>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>zeros<sp/>the<sp/>struct.<sp/>doesn&apos;t<sp/>actually<sp/>init<sp/>it<sp/>to<sp/>useful<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boolean<sp/>isInput<sp/>=<sp/><ref refid="cext_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>with<sp/>the<sp/>current<sp/>values<sp/>for<sp/>the<sp/>device<sp/>properties.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Init<sp/>with<sp/>nominal<sp/>sample<sp/>rate.<sp/>Use<sp/>actual<sp/>sample<sp/>rate<sp/>where<sp/>available</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>UpdateSampleRateFromDeviceProperty(<sp/></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>,<sp/>isInput,<sp/>kAudioDevicePropertyNominalSampleRate<sp/>)<sp/><sp/>);</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>)</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;<sp/></highlight><highlight class="comment">/*<sp/>fail<sp/>if<sp/>we<sp/>can&apos;t<sp/>even<sp/>get<sp/>a<sp/>nominal<sp/>device<sp/>sample<sp/>rate<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateSampleRateFromDeviceProperty(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>,<sp/>isInput,<sp/>kAudioDevicePropertyActualSampleRate<sp/>);</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetupDevicePropertyListeners(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>,<sp/>isInput<sp/>);</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boolean<sp/>isInput<sp/>=<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>as<sp/>above</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>UpdateSampleRateFromDeviceProperty(<sp/></highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>,<sp/>isInput,<sp/>kAudioDevicePropertyNominalSampleRate<sp/>)<sp/><sp/>);</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>)</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateSampleRateFromDeviceProperty(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>,<sp/>isInput,<sp/>kAudioDevicePropertyActualSampleRate<sp/>);</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetupDevicePropertyListeners(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>,<sp/>isInput<sp/>);</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/>UpdateTimeStampOffsets(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Setup<sp/>timestamp<sp/>copies<sp/>to<sp/>be<sp/>used<sp/>by<sp/>audio<sp/>callback.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a8835149b249b0d65891cb7b7104bbd53" kindref="member">timestampOffsetCombined_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a169f40774042f35654987a0d5daa369d" kindref="member">timestampOffsetCombined</ref>;</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a5214bc58179dd3ab933567bff3eb0c71" kindref="member">timestampOffsetInputDevice_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a478d46d9d93bdc6d3cdb2009236c1d9e" kindref="member">timestampOffsetInputDevice</ref>;</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a4eb660a54787d8965d59a774b21ab454" kindref="member">timestampOffsetOutputDevice_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a81525a1ff3c1cb96a57d44c5ca70f7c4" kindref="member">timestampOffsetOutputDevice</ref>;</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"></highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>STOPPED;</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"></highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>=<sp/>(<ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*)stream;</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"></highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"></highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><ref refid="sndfile__load_8m_1a3a81ee160b23b01b04b7c08b35123218" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/>CloseStream(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2095"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"></highlight></codeline>
<codeline lineno="2097"><highlight class="normal"></highlight></codeline>
<codeline lineno="2098" refid="pa__mac__core_8c_1a29bfcd9536b7a2bdb81a88e904e06098" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>HOST_TIME_TO_PA_TIME(<sp/>x<sp/>)<sp/>(<sp/>AudioConvertHostTimeToNanos(<sp/>(x)<sp/>)<sp/>*<sp/>1.0E-09)<sp/></highlight><highlight class="comment">/*<sp/>convert<sp/>to<sp/>nanoseconds<sp/>and<sp/>then<sp/>to<sp/>seconds<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2099"><highlight class="normal"></highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><ref refid="portaudio_8h_1af17a7e6d0471a23071acf8dbd7bbe4bd" kindref="member">PaTime</ref><sp/>GetStreamTime(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2101"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core_8c_1a29bfcd9536b7a2bdb81a88e904e06098" kindref="member">HOST_TIME_TO_PA_TIME</ref>(<sp/>AudioGetCurrentHostTime()<sp/>);<sp/></highlight></codeline>
<codeline lineno="2103"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"></highlight></codeline>
<codeline lineno="2105" refid="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>RING_BUFFER_EMPTY<sp/>(1000)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"></highlight></codeline>
<codeline lineno="2107"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>ringBufferIOProc(<sp/>AudioConverterRef<sp/>inAudioConverter,<sp/></highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32*ioDataSize,<sp/></highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**<sp/>outData,<sp/></highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*inUserData<sp/>)</highlight></codeline>
<codeline lineno="2111"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dummyData;</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref><sp/>dummySize;</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><ref refid="struct_pa_util_ring_buffer" kindref="compound">PaUtilRingBuffer</ref><sp/>*rb<sp/>=<sp/>(<ref refid="struct_pa_util_ring_buffer" kindref="compound">PaUtilRingBuffer</ref><sp/>*)<sp/>inUserData;</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;ringBufferIOProc()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2117"><highlight class="normal"></highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="pa__ringbuffer_8c_1a40786e9932b9f988be2accfce19d5ea4" kindref="member">PaUtil_GetRingBufferReadAvailable</ref>(<sp/>rb<sp/>)<sp/>==<sp/>0<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*outData<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*ioDataSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" kindref="member">RING_BUFFER_EMPTY</ref>;</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(UInt32)<sp/>==<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref>));</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>(<sp/>(*ioDataSize)<sp/>/<sp/>rb-&gt;<ref refid="struct_pa_util_ring_buffer_1a5a7585b4f9929cb74e2fcf6d0e0be072" kindref="member">elementSizeBytes</ref><sp/>)<sp/>*<sp/>rb-&gt;<ref refid="struct_pa_util_ring_buffer_1a5a7585b4f9929cb74e2fcf6d0e0be072" kindref="member">elementSizeBytes</ref><sp/>==<sp/>(*ioDataSize)<sp/>)<sp/>;</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/>(*ioDataSize)<sp/>/=<sp/>rb-&gt;<ref refid="struct_pa_util_ring_buffer_1a5a7585b4f9929cb74e2fcf6d0e0be072" kindref="member">elementSizeBytes</ref><sp/>;</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a0e1ef06e0ee328c9da54755cf889913d" kindref="member">PaUtil_GetRingBufferReadRegions</ref>(<sp/>rb,<sp/>*ioDataSize,</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outData,<sp/>(<ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref><sp/>*)ioDataSize,<sp/></highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;dummyData,<sp/>&amp;dummySize<sp/>);</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>*ioDataSize<sp/>);</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a7acc44292930d2911445b41f982a6a73" kindref="member">PaUtil_AdvanceRingBufferReadIndex</ref>(<sp/>rb,<sp/>*ioDataSize<sp/>);</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/>(*ioDataSize)<sp/>*=<sp/>rb-&gt;<ref refid="struct_pa_util_ring_buffer_1a5a7585b4f9929cb74e2fcf6d0e0be072" kindref="member">elementSizeBytes</ref><sp/>;</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"></highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noErr;</highlight></codeline>
<codeline lineno="2134"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"></highlight></codeline>
<codeline lineno="2136"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2137"><highlight class="comment"><sp/>*<sp/>Called<sp/>by<sp/>the<sp/>AudioUnit<sp/>API<sp/>to<sp/>process<sp/>audio<sp/>from<sp/>the<sp/>sound<sp/>card.</highlight></codeline>
<codeline lineno="2138"><highlight class="comment"><sp/>*<sp/>This<sp/>is<sp/>where<sp/>the<sp/>magic<sp/>happens.</highlight></codeline>
<codeline lineno="2139"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2140"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FEEDBACK:<sp/>there<sp/>is<sp/>a<sp/>lot<sp/>of<sp/>redundant<sp/>code<sp/>here<sp/>because<sp/>of<sp/>how<sp/>all<sp/>the<sp/>cases<sp/>differ.<sp/>This<sp/>makes<sp/>it<sp/>hard<sp/>to<sp/>maintain,<sp/>so<sp/>if<sp/>there<sp/>are<sp/>suggestinos<sp/>for<sp/>cleaning<sp/>it<sp/>up,<sp/>I&apos;m<sp/>all<sp/>ears.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2141"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>OSStatus<sp/>AudioIOProc(<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*inRefCon,</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnitRenderActionFlags<sp/>*ioActionFlags,</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>AudioTimeStamp<sp/>*inTimeStamp,</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inBusNumber,</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/>inNumberFrames,</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioBufferList<sp/>*ioData<sp/>)</highlight></codeline>
<codeline lineno="2147"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>framesProcessed<sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><ref refid="struct_pa_stream_callback_time_info" kindref="compound">PaStreamCallbackTimeInfo</ref><sp/>timeInfo<sp/>=<sp/>{0,0,0};</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)inRefCon;</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>isRender<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>inBusNumber<sp/>==<sp/><ref refid="pa__mac__core__utilities_8h_1a271521321062982ee487cc475adb7dfd" kindref="member">OUTPUT_ELEMENT</ref>;</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>callbackResult<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref><sp/>;</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>hostTimeStampInPaTime<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="pa__mac__core_8c_1a29bfcd9536b7a2bdb81a88e904e06098" kindref="member">HOST_TIME_TO_PA_TIME</ref>(inTimeStamp-&gt;mHostTime);</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2155"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;AudioIOProc()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2156"><highlight class="normal"></highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a83fdceefb7dff41725ba4f1f13a80f79" kindref="member">PaUtil_BeginCpuLoadMeasurement</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a589be1f91f8332bba6cc1b0b006f9b80" kindref="member">cpuLoadMeasurer</ref><sp/>);</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>-----------------------------------------------------------------*\</highlight></codeline>
<codeline lineno="2160"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>output<sp/>may<sp/>be<sp/>useful<sp/>for<sp/>debugging,</highlight></codeline>
<codeline lineno="2161"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>But<sp/>printing<sp/>durring<sp/>the<sp/>callback<sp/>is<sp/>a<sp/>bad<sp/>enough<sp/>idea<sp/>that</highlight></codeline>
<codeline lineno="2162"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>is<sp/>not<sp/>enabled<sp/>by<sp/>enableing<sp/>the<sp/>usual<sp/>debugging<sp/>calls.</highlight></codeline>
<codeline lineno="2163"><highlight class="comment"><sp/><sp/><sp/>\*<sp/>-----------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2165"><highlight class="comment"><sp/><sp/><sp/>static<sp/>int<sp/>renderCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2166"><highlight class="comment"><sp/><sp/><sp/>static<sp/>int<sp/>inputCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2167"><highlight class="comment"><sp/><sp/><sp/>printf(<sp/>&quot;-------------------<sp/><sp/>starting<sp/>reder/input\n&quot;<sp/>);</highlight></codeline>
<codeline lineno="2168"><highlight class="comment"><sp/><sp/><sp/>if(<sp/>isRender<sp/>)</highlight></codeline>
<codeline lineno="2169"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;Render<sp/>callback<sp/>(%d):\t&quot;,<sp/>++renderCount);</highlight></codeline>
<codeline lineno="2170"><highlight class="comment"><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="2171"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;Input<sp/>callback<sp/><sp/>(%d):\t&quot;,<sp/>++inputCount);</highlight></codeline>
<codeline lineno="2172"><highlight class="comment"><sp/><sp/><sp/>printf(<sp/>&quot;Call<sp/>totals:<sp/>%d<sp/>(input),<sp/>%d<sp/>(render)\n&quot;,<sp/>inputCount,<sp/>renderCount<sp/>);</highlight></codeline>
<codeline lineno="2173"><highlight class="comment"></highlight></codeline>
<codeline lineno="2174"><highlight class="comment"><sp/><sp/><sp/>printf(<sp/>&quot;---<sp/>inBusNumber:<sp/>%lu\n&quot;,<sp/>inBusNumber<sp/>);</highlight></codeline>
<codeline lineno="2175"><highlight class="comment"><sp/><sp/><sp/>printf(<sp/>&quot;---<sp/>inNumberFrames:<sp/>%lu\n&quot;,<sp/>inNumberFrames<sp/>);</highlight></codeline>
<codeline lineno="2176"><highlight class="comment"><sp/><sp/><sp/>printf(<sp/>&quot;---<sp/>%x<sp/>ioData\n&quot;,<sp/>(unsigned)<sp/>ioData<sp/>);</highlight></codeline>
<codeline lineno="2177"><highlight class="comment"><sp/><sp/><sp/>if(<sp/>ioData<sp/>)</highlight></codeline>
<codeline lineno="2178"><highlight class="comment"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2179"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>i=0;</highlight></codeline>
<codeline lineno="2180"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/>&quot;---<sp/>ioData.mNumBuffers<sp/>%lu:<sp/>\n&quot;,<sp/>ioData-&gt;mNumberBuffers<sp/>);</highlight></codeline>
<codeline lineno="2181"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>for(<sp/>i=0;<sp/>i&lt;ioData-&gt;mNumberBuffers;<sp/>++i<sp/>)</highlight></codeline>
<codeline lineno="2182"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/>&quot;---<sp/>ioData<sp/>buffer<sp/>%d<sp/>size:<sp/>%lu.\n&quot;,<sp/>i,<sp/>ioData-&gt;mBuffers[i].mDataByteSize<sp/>);</highlight></codeline>
<codeline lineno="2183"><highlight class="comment"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2184"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>-----------------------------------------------------------------<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2185"><highlight class="normal"></highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>compute<sp/>PaStreamCallbackTimeInfo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>pthread_mutex_trylock(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref><sp/>)<sp/>==<sp/>0<sp/>){</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>snapshot<sp/>the<sp/>ioproc<sp/>copy<sp/>of<sp/>timing<sp/>information<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a8835149b249b0d65891cb7b7104bbd53" kindref="member">timestampOffsetCombined_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a169f40774042f35654987a0d5daa369d" kindref="member">timestampOffsetCombined</ref>;</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a5214bc58179dd3ab933567bff3eb0c71" kindref="member">timestampOffsetInputDevice_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a478d46d9d93bdc6d3cdb2009236c1d9e" kindref="member">timestampOffsetInputDevice</ref>;</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a4eb660a54787d8965d59a774b21ab454" kindref="member">timestampOffsetOutputDevice_ioProcCopy</ref><sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a81525a1ff3c1cb96a57d44c5ca70f7c4" kindref="member">timestampOffsetOutputDevice</ref>;</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_mutex_unlock(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref><sp/>);</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>For<sp/>timeInfo.currentTime<sp/>we<sp/>could<sp/>calculate<sp/>current<sp/>time<sp/>backwards<sp/>from<sp/>the<sp/>HAL<sp/>audio<sp/></highlight></codeline>
<codeline lineno="2197"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>output<sp/>time<sp/>to<sp/>give<sp/>a<sp/>more<sp/>accurate<sp/>impression<sp/>of<sp/>the<sp/>current<sp/>timeslice<sp/>but<sp/>it<sp/>doesn&apos;t<sp/></highlight></codeline>
<codeline lineno="2198"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>seem<sp/>worth<sp/>it<sp/>at<sp/>the<sp/>moment<sp/>since<sp/>other<sp/>PA<sp/>host<sp/>APIs<sp/>don&apos;t<sp/>do<sp/>any<sp/>better.</highlight></codeline>
<codeline lineno="2199"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1af21eb5482cadb212dae38fdbbd9bebfb" kindref="member">currentTime</ref><sp/>=<sp/><ref refid="pa__mac__core_8c_1a29bfcd9536b7a2bdb81a88e904e06098" kindref="member">HOST_TIME_TO_PA_TIME</ref>(<sp/>AudioGetCurrentHostTime()<sp/>);</highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2203"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>For<sp/>an<sp/>input<sp/>HAL<sp/>AU,<sp/>inTimeStamp<sp/>is<sp/>the<sp/>time<sp/>the<sp/>samples<sp/>are<sp/>received<sp/>from<sp/>the<sp/>hardware,</highlight></codeline>
<codeline lineno="2204"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>for<sp/>an<sp/>output<sp/>HAL<sp/>AU<sp/>inTimeStamp<sp/>is<sp/>the<sp/>time<sp/>the<sp/>samples<sp/>are<sp/>sent<sp/>to<sp/>the<sp/>hardware.<sp/></highlight></codeline>
<codeline lineno="2205"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>PA<sp/>expresses<sp/>timestamps<sp/>in<sp/>terms<sp/>of<sp/>when<sp/>the<sp/>samples<sp/>enter<sp/>the<sp/>ADC<sp/>or<sp/>leave<sp/>the<sp/>DAC</highlight></codeline>
<codeline lineno="2206"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>so<sp/>we<sp/>add<sp/>or<sp/>subtract<sp/>kAudioDevicePropertyLatency<sp/>below.</highlight></codeline>
<codeline lineno="2207"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>not<sp/>sure<sp/>what<sp/>to<sp/>do<sp/>below<sp/>if<sp/>the<sp/>host<sp/>timestamps<sp/>aren&apos;t<sp/>valid<sp/>(kAudioTimeStampHostTimeValid<sp/>isn&apos;t<sp/>set)</highlight></codeline>
<codeline lineno="2210"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>Could<sp/>ask<sp/>on<sp/>CA<sp/>mailing<sp/>list<sp/>if<sp/>it<sp/>is<sp/>possible<sp/>for<sp/>it<sp/>not<sp/>to<sp/>be<sp/>set.<sp/>If<sp/>so,<sp/>could<sp/>probably<sp/>grab<sp/>a<sp/>now<sp/>timestamp</highlight></codeline>
<codeline lineno="2211"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>at<sp/>the<sp/>top<sp/>and<sp/>compute<sp/>from<sp/>there<sp/>(modulo<sp/>scheduling<sp/>jitter)<sp/>or<sp/>ask<sp/>on<sp/>mailing<sp/>list<sp/>for<sp/>other<sp/>options.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>isRender<sp/>)</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>full<sp/>duplex<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)<sp/></highlight><highlight class="comment">/*<sp/>full<sp/>duplex<sp/>AUHAL<sp/>IOProc<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ross<sp/>and<sp/>Phil<sp/>agreed<sp/>that<sp/>the<sp/>following<sp/>calculation<sp/>is<sp/>correct<sp/>based<sp/>on<sp/>an<sp/>email<sp/>from<sp/>Jeff<sp/>Moore:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>http://osdir.com/ml/coreaudio-api/2009-07/msg00140.html</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Basically<sp/>the<sp/>difference<sp/>between<sp/>the<sp/>Apple<sp/>output<sp/>timestamp<sp/>and<sp/>the<sp/>PA<sp/>timestamp<sp/>is<sp/>kAudioDevicePropertyLatency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1ad114a6d5e1cf2cdd75837c33c1c8bb4c" kindref="member">inputBufferAdcTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>-<sp/></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a8835149b249b0d65891cb7b7104bbd53" kindref="member">timestampOffsetCombined_ioProcCopy</ref><sp/>+<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a5214bc58179dd3ab933567bff3eb0c71" kindref="member">timestampOffsetInputDevice_ioProcCopy</ref>);</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1aa2052c42394fca748e83517fc8942609" kindref="member">outputBufferDacTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>+<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a4eb660a54787d8965d59a774b21ab454" kindref="member">timestampOffsetOutputDevice_ioProcCopy</ref>;</highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>full<sp/>duplex<sp/>with<sp/>ring-buffer<sp/>from<sp/>a<sp/>separate<sp/>input<sp/>AUHAL<sp/>ioproc<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>take<sp/>the<sp/>ring<sp/>buffer<sp/>latency<sp/>into<sp/>account<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1ad114a6d5e1cf2cdd75837c33c1c8bb4c" kindref="member">inputBufferAdcTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>-<sp/></highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a8835149b249b0d65891cb7b7104bbd53" kindref="member">timestampOffsetCombined_ioProcCopy</ref><sp/>+<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a5214bc58179dd3ab933567bff3eb0c71" kindref="member">timestampOffsetInputDevice_ioProcCopy</ref>);</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1aa2052c42394fca748e83517fc8942609" kindref="member">outputBufferDacTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>+<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a4eb660a54787d8965d59a774b21ab454" kindref="member">timestampOffsetOutputDevice_ioProcCopy</ref>;</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>output<sp/>only<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1ad114a6d5e1cf2cdd75837c33c1c8bb4c" kindref="member">inputBufferAdcTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1aa2052c42394fca748e83517fc8942609" kindref="member">outputBufferDacTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>+<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a4eb660a54787d8965d59a774b21ab454" kindref="member">timestampOffsetOutputDevice_ioProcCopy</ref>;</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*<sp/>input<sp/>only<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1ad114a6d5e1cf2cdd75837c33c1c8bb4c" kindref="member">inputBufferAdcTime</ref><sp/>=<sp/>hostTimeStampInPaTime<sp/>-<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a5214bc58179dd3ab933567bff3eb0c71" kindref="member">timestampOffsetInputDevice_ioProcCopy</ref>;<sp/></highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeInfo.<ref refid="struct_pa_stream_callback_time_info_1aa2052c42394fca748e83517fc8942609" kindref="member">outputBufferDacTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//printf(<sp/>&quot;---%g,<sp/>%g,<sp/>%g\n&quot;,<sp/>timeInfo.inputBufferAdcTime,<sp/>timeInfo.currentTime,<sp/>timeInfo.outputBufferDacTime<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2247"><highlight class="normal"></highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>isRender<sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref></highlight></codeline>
<codeline lineno="2249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>!stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>---------<sp/>Full<sp/>Duplex,<sp/>One<sp/>Device,<sp/>no<sp/>SR<sp/>Conversion<sp/>-------</highlight></codeline>
<codeline lineno="2252"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2253"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>This<sp/>is<sp/>the<sp/>lowest<sp/>latency<sp/>case,<sp/>and<sp/>also<sp/>the<sp/>simplest.</highlight></codeline>
<codeline lineno="2254"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Input<sp/>data<sp/>and<sp/>output<sp/>data<sp/>are<sp/>available<sp/>at<sp/>the<sp/>same<sp/>time.</highlight></codeline>
<codeline lineno="2255"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>we<sp/>do<sp/>not<sp/>use<sp/>the<sp/>input<sp/>SR<sp/>converter<sp/>or<sp/>the<sp/>input<sp/>ring<sp/>buffer.</highlight></codeline>
<codeline lineno="2256"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2257"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>OSStatus<sp/>err<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames;</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>bytesPerFrame<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>float<sp/>)<sp/>*<sp/>ioData-&gt;mBuffers[0].mNumberChannels;</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"></highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>start<sp/>processing<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1388263b1c5b765797abe767af6dbe80" kindref="member">PaUtil_BeginBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;timeInfo,</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>);</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">//FIXME:<sp/>this<sp/>flag<sp/>also<sp/>gets<sp/>set<sp/>outside<sp/>by<sp/>a<sp/>callback,<sp/>which<sp/>calls<sp/>the<sp/>xrunCallback<sp/>function.<sp/>It<sp/>should<sp/>be<sp/>in<sp/>the<sp/>same<sp/>thread<sp/>as<sp/>the<sp/>main<sp/>audio<sp/>callback,<sp/>but<sp/>the<sp/>apple<sp/>docs<sp/>just<sp/>use<sp/>the<sp/>word<sp/>&quot;usually&quot;<sp/>so<sp/>it<sp/>may<sp/>be<sp/>possible<sp/>to<sp/>loose<sp/>an<sp/>xrun<sp/>notification,<sp/>if<sp/>that<sp/>callback<sp/>happens<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2267"><highlight class="normal"></highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>compute<sp/>frames.<sp/>do<sp/>some<sp/>checks<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>ioData-&gt;mNumberBuffers<sp/>==<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>ioData-&gt;mBuffers[0].mNumberChannels<sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa672c86d838eb7f11ee03e939b7a58e5" kindref="member">userOutChan</ref><sp/>);</highlight></codeline>
<codeline lineno="2271"><highlight class="normal"></highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>frames<sp/>=<sp/>ioData-&gt;mBuffers[0].mDataByteSize<sp/>/<sp/>bytesPerFrame;</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>copy<sp/>and<sp/>process<sp/>input<sp/>data<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>err=<sp/>AudioUnitRender(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioActionFlags,</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inTimeStamp,</highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inNumberFrames,</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref><sp/>);</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FEEDBACK:<sp/>I&apos;m<sp/>not<sp/>sure<sp/>what<sp/>to<sp/>do<sp/>when<sp/>this<sp/>call<sp/>fails.<sp/>There&apos;s<sp/>nothing<sp/>in<sp/>the<sp/>PA<sp/>API<sp/>to</highlight></codeline>
<codeline lineno="2281"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>do<sp/>about<sp/>failures<sp/>in<sp/>the<sp/>callback<sp/>system.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>!err<sp/>);</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"></highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData,</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mNumberChannels);</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>Copy<sp/>and<sp/>process<sp/>output<sp/>data<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1dc65eb1e69dd6739e4dad4d74bf3785" kindref="member">PaUtil_SetOutputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1adba29b453fea9e5abfba02dbcb01bd09" kindref="member">PaUtil_SetInterleavedOutputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioData-&gt;mBuffers[0].mData,</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioData-&gt;mBuffers[0].mNumberChannels);</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>complete<sp/>processing<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>isRender<sp/>)</highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--------<sp/>Output<sp/>Side<sp/>of<sp/>Full<sp/>Duplex<sp/>(Separate<sp/>Devices<sp/>or<sp/>SR<sp/>Conversion)</highlight></codeline>
<codeline lineno="2303"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>--<sp/>OR<sp/>Simplex<sp/>Output</highlight></codeline>
<codeline lineno="2304"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2305"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>This<sp/>case<sp/>handles<sp/>output<sp/>data<sp/>as<sp/>in<sp/>the<sp/>full<sp/>duplex<sp/>case,</highlight></codeline>
<codeline lineno="2306"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>and,<sp/>if<sp/>there<sp/>is<sp/>input<sp/>data,<sp/>reads<sp/>it<sp/>off<sp/>the<sp/>ring<sp/>buffer<sp/></highlight></codeline>
<codeline lineno="2307"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>and<sp/>into<sp/>the<sp/>PA<sp/>buffer<sp/>processor.<sp/>If<sp/>sample<sp/>rate<sp/>conversion</highlight></codeline>
<codeline lineno="2308"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>is<sp/>required<sp/>on<sp/>input,<sp/>that<sp/>is<sp/>done<sp/>here<sp/>as<sp/>well.</highlight></codeline>
<codeline lineno="2309"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>frames;</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>bytesPerFrame<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>float<sp/>)<sp/>*<sp/>ioData-&gt;mBuffers[0].mNumberChannels;</highlight></codeline>
<codeline lineno="2312"><highlight class="normal"></highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sometimes,<sp/>when<sp/>stopping<sp/>a<sp/>duplex<sp/>stream<sp/>we<sp/>get<sp/>erroneous</highlight></codeline>
<codeline lineno="2314"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xrun<sp/>flags,<sp/>so<sp/>if<sp/>this<sp/>is<sp/>our<sp/>last<sp/>run,<sp/>clear<sp/>the<sp/>flags.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>xrunFlags<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref>;</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2317"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>xrunFlags<sp/>&amp;<sp/>paInputUnderflow<sp/>)</highlight></codeline>
<codeline lineno="2318"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/>&quot;input<sp/>underflow.\n&quot;<sp/>);</highlight></codeline>
<codeline lineno="2319"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>if(<sp/>xrunFlags<sp/>&amp;<sp/>paInputOverflow<sp/>)</highlight></codeline>
<codeline lineno="2320"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/>&quot;input<sp/>overflow.\n&quot;<sp/>);</highlight></codeline>
<codeline lineno="2321"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>STOPPING<sp/>||<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>CALLBACK_STOPPED<sp/>)</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xrunFlags<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2324"><highlight class="normal"></highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>start<sp/>processing<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1388263b1c5b765797abe767af6dbe80" kindref="member">PaUtil_BeginBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;timeInfo,</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xrunFlags<sp/>);</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>FEEDBACK:<sp/>we<sp/>only<sp/>send<sp/>flags<sp/>to<sp/>Buf<sp/>Proc<sp/>once<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2330"><highlight class="normal"></highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>Copy<sp/>and<sp/>process<sp/>output<sp/>data<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>ioData-&gt;mNumberBuffers<sp/>==<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>frames<sp/>=<sp/>ioData-&gt;mBuffers[0].mDataByteSize<sp/>/<sp/>bytesPerFrame;</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>ioData-&gt;mBuffers[0].mNumberChannels<sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa672c86d838eb7f11ee03e939b7a58e5" kindref="member">userOutChan</ref><sp/>);</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1dc65eb1e69dd6739e4dad4d74bf3785" kindref="member">PaUtil_SetOutputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1adba29b453fea9e5abfba02dbcb01bd09" kindref="member">PaUtil_SetInterleavedOutputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioData-&gt;mBuffers[0].mData,</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioData-&gt;mBuffers[0].mNumberChannels);</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"></highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>copy<sp/>and<sp/>process<sp/>input<sp/>data,<sp/>and<sp/>complete<sp/>processing<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>flsz<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>float<sp/>);</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Here,<sp/>we<sp/>read<sp/>the<sp/>data<sp/>out<sp/>of<sp/>the<sp/>ring<sp/>buffer,<sp/>through<sp/>the</highlight></codeline>
<codeline lineno="2345"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>audio<sp/>converter.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>inChan<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mNumberChannels;</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>bytesPerFrame<sp/>=<sp/>flsz<sp/>*<sp/>inChan;</highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OSStatus<sp/>err;</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>[<sp/>inChan<sp/>*<sp/>frames<sp/>];</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref><sp/>);</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>AudioConverterFillBuffer(<sp/></highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref>,</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ringBufferIOProc,</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)&amp;data<sp/>);</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>==<sp/><ref refid="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" kindref="member">RING_BUFFER_EMPTY</ref><sp/>)</highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*the<sp/>ring<sp/>buffer<sp/>callback<sp/>underflowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bzero(<sp/>((</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)data)<sp/>+<sp/>size,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(data)-size<sp/>);</highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>ring<sp/>buffer<sp/>can<sp/>underflow<sp/>normally<sp/>when<sp/>the<sp/>stream<sp/>is<sp/>stopping.</highlight></codeline>
<codeline lineno="2366"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>So<sp/>only<sp/>report<sp/>an<sp/>error<sp/>if<sp/>the<sp/>stream<sp/>is<sp/>active.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>ACTIVE<sp/>)</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>|=<sp/><ref refid="portaudio_8h_1a57d1879f52406bdedfdda8f79f458e15" kindref="member">paInputUnderflow</ref>;</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>err<sp/>);</highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>!err<sp/>);</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChan<sp/>);</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Without<sp/>the<sp/>AudioConverter<sp/>is<sp/>actually<sp/>a<sp/>bit<sp/>more<sp/>complex</highlight></codeline>
<codeline lineno="2387"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>because<sp/>we<sp/>have<sp/>to<sp/>do<sp/>a<sp/>little<sp/>buffer<sp/>processing<sp/>that<sp/>the</highlight></codeline>
<codeline lineno="2388"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioConverter<sp/>would<sp/>otherwise<sp/>handle<sp/>for<sp/>us.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data1,<sp/>*data2;</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref><sp/>size1,<sp/>size2;</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref><sp/>framesReadable<sp/>=<sp/><ref refid="pa__ringbuffer_8c_1a0e1ef06e0ee328c9da54755cf889913d" kindref="member">PaUtil_GetRingBufferReadRegions</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frames,</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;data1,<sp/>&amp;size1,</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;data2,<sp/>&amp;size2<sp/>);</highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>size1<sp/>==<sp/>frames<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>simplest<sp/>case:<sp/>all<sp/>in<sp/>first<sp/>buffer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data1,</highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChan<sp/>);</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a7acc44292930d2911445b41f982a6a73" kindref="member">PaUtil_AdvanceRingBufferReadIndex</ref>(&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,<sp/>size1<sp/>);</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>framesReadable<sp/>&lt;<sp/>frames<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>sizeBytes1<sp/>=<sp/>size1<sp/>*<sp/>bytesPerFrame;</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>sizeBytes2<sp/>=<sp/>size2<sp/>*<sp/>bytesPerFrame;</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*we<sp/>underflowed.<sp/>take<sp/>what<sp/>data<sp/>we<sp/>can,<sp/>zero<sp/>the<sp/>rest.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>[<sp/>frames<sp/>*<sp/>bytesPerFrame<sp/>];</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>size1<sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(<sp/>data,<sp/>data1,<sp/>sizeBytes1<sp/>);</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>size2<sp/>&gt;<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(<sp/>data+sizeBytes1,<sp/>data2,<sp/>sizeBytes2<sp/>);</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bzero(<sp/>data+sizeBytes1+sizeBytes2,<sp/>(frames*bytesPerFrame)<sp/>-<sp/>sizeBytes1<sp/>-<sp/>sizeBytes2<sp/>);</highlight></codeline>
<codeline lineno="2421"><highlight class="normal"></highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>frames<sp/>);</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChan<sp/>);</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a7acc44292930d2911445b41f982a6a73" kindref="member">PaUtil_AdvanceRingBufferReadIndex</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesReadable<sp/>);</highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>flag<sp/>underflow<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>|=<sp/><ref refid="portaudio_8h_1a57d1879f52406bdedfdda8f79f458e15" kindref="member">paInputUnderflow</ref>;</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*we<sp/>got<sp/>all<sp/>the<sp/>data,<sp/>but<sp/>split<sp/>between<sp/>buffers*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>size1<sp/>);</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data1,</highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChan<sp/>);</highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1af9c0de32c43ab8b683f52b60e4d36ef1" kindref="member">PaUtil_Set2ndInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>size2<sp/>);</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a4cfe24a64dfb9c59e8ca8db3e0e7453a" kindref="member">PaUtil_Set2ndInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data2,</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inChan<sp/>);</highlight></codeline>
<codeline lineno="2446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a7acc44292930d2911445b41f982a6a73" kindref="member">PaUtil_AdvanceRingBufferReadIndex</ref>(&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,<sp/>framesReadable<sp/>);</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"></highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>------------------<sp/>Input</highlight></codeline>
<codeline lineno="2462"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2463"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>First,<sp/>we<sp/>read<sp/>off<sp/>the<sp/>audio<sp/>data<sp/>and<sp/>put<sp/>it<sp/>in<sp/>the<sp/>ring<sp/>buffer.</highlight></codeline>
<codeline lineno="2464"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>if<sp/>this<sp/>is<sp/>an<sp/>input-only<sp/>stream,<sp/>we<sp/>need<sp/>to<sp/>process<sp/>it<sp/>more,</highlight></codeline>
<codeline lineno="2465"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>otherwise,<sp/>we<sp/>let<sp/>the<sp/>output<sp/>case<sp/>deal<sp/>with<sp/>it.</highlight></codeline>
<codeline lineno="2466"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>OSStatus<sp/>err<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>chan<sp/>=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mNumberChannels<sp/>;</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>looping<sp/>here<sp/>may<sp/>not<sp/>actually<sp/>be<sp/>necessary,<sp/>but<sp/>it<sp/>was<sp/>something<sp/>I<sp/>tried<sp/>in<sp/>testing.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err=<sp/>AudioUnitRender(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ioActionFlags,</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inTimeStamp,</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1af99442bf49b56a815cab1cca4fd0048f" kindref="member">INPUT_ELEMENT</ref>,</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inNumberFrames,</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref><sp/>);</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>==<sp/>-10874<sp/>)</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inNumberFrames<sp/>/=<sp/>2;</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>err<sp/>==<sp/>-10874<sp/>&amp;&amp;<sp/>inNumberFrames<sp/>&gt;<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FEEDBACK:<sp/>I&apos;m<sp/>not<sp/>sure<sp/>what<sp/>to<sp/>do<sp/>when<sp/>this<sp/>call<sp/>fails<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>err<sp/>);</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>!err<sp/>);</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>||<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>this<sp/>is<sp/>duplex<sp/>or<sp/>we<sp/>use<sp/>a<sp/>converter,<sp/>put<sp/>the<sp/>data</highlight></codeline>
<codeline lineno="2486"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>into<sp/>the<sp/>ring<sp/>buffer.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8h_1a56482b88e581ba588fe43b1568978b94" kindref="member">ring_buffer_size_t</ref><sp/>framesWritten<sp/>=<sp/><ref refid="pa__ringbuffer_8c_1a2767b217dc115e4f20db8ea206ca9520" kindref="member">PaUtil_WriteRingBuffer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData,</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inNumberFrames<sp/>);</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>framesWritten<sp/>!=<sp/>inNumberFrames<sp/>)</highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>|=<sp/><ref refid="portaudio_8h_1aea144f0edaf02d0ac8b113f41fb95c47" kindref="member">paInputOverflow</ref><sp/>;</highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>for<sp/>simplex<sp/>input<sp/>w/o<sp/>SR<sp/>conversion,</highlight></codeline>
<codeline lineno="2498"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>just<sp/>pop<sp/>the<sp/>data<sp/>into<sp/>the<sp/>buffer<sp/>processor.*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1388263b1c5b765797abe767af6dbe80" kindref="member">PaUtil_BeginBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;timeInfo,</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>);</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"></highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>inNumberFrames);</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData,</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chan<sp/>);</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>------------------<sp/>Simplex<sp/>Input<sp/>w/<sp/>SR<sp/>Conversion</highlight></codeline>
<codeline lineno="2516"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2517"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>if<sp/>this<sp/>is<sp/>a<sp/>simplex<sp/>input<sp/>stream,<sp/>we<sp/>need<sp/>to<sp/>read<sp/>off<sp/>the<sp/>buffer,</highlight></codeline>
<codeline lineno="2518"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>do<sp/>our<sp/>sample<sp/>rate<sp/>conversion<sp/>and<sp/>pass<sp/>the<sp/>results<sp/>to<sp/>the<sp/>buffer</highlight></codeline>
<codeline lineno="2519"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>processor.</highlight></codeline>
<codeline lineno="2520"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>The<sp/>logic<sp/>here<sp/>is<sp/>complicated<sp/>somewhat<sp/>by<sp/>the<sp/>fact<sp/>that<sp/>we<sp/>don&apos;t</highlight></codeline>
<codeline lineno="2521"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>know<sp/>how<sp/>much<sp/>data<sp/>is<sp/>available,<sp/>so<sp/>we<sp/>loop<sp/>on<sp/>reasonably<sp/>sized</highlight></codeline>
<codeline lineno="2522"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>chunks,<sp/>and<sp/>let<sp/>the<sp/>BufferProcessor<sp/>deal<sp/>with<sp/>the<sp/>rest.</highlight></codeline>
<codeline lineno="2523"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="2524"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*This<sp/>might<sp/>be<sp/>too<sp/>big<sp/>or<sp/>small<sp/>depending<sp/>on<sp/>SR<sp/>conversion*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref>[<sp/>chan<sp/>*<sp/>inNumberFrames<sp/>];</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OSStatus<sp/>err;</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">/*Run<sp/>the<sp/>buffer<sp/>processor<sp/>until<sp/>we<sp/>are<sp/>out<sp/>of<sp/>data*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="group__lavu__mem_1ga854352f53b148adc24983a58a1866d66" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="rfft2d_test_m_l_8m_1aacd36fb6ac9ce14cec71f2ca852524d4" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="2532"><highlight class="normal"></highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="lib_2expat_8h_1ac39e72a1de1cb50dbdc54b08d0432a24" kindref="member">data</ref><sp/>);</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>AudioConverterFillBuffer(<sp/></highlight></codeline>
<codeline lineno="2535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref>,</highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ringBufferIOProc,</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;size,</highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)data<sp/>);</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>!=<sp/><ref refid="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" kindref="member">RING_BUFFER_EMPTY</ref><sp/>)</highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>err<sp/>);</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libid3tag_2global_8h_1af576bf8ffa22a44e53018c67095ffbf0" kindref="member">assert</ref>(<sp/>err<sp/>==<sp/>0<sp/>||<sp/>err<sp/>==<sp/><ref refid="pa__mac__core_8c_1a9932947eac3bd1ebe09e88036d914852" kindref="member">RING_BUFFER_EMPTY</ref><sp/>);</highlight></codeline>
<codeline lineno="2543"><highlight class="normal"></highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>size<sp/>/<sp/>(<sp/>chan<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(float)<sp/>);</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a0f0a94dec2b29ecb9843deb00a889bea" kindref="member">PaUtil_SetInputFrameCount</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),<sp/>f<sp/>);</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>f<sp/>)</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a1388263b1c5b765797abe767af6dbe80" kindref="member">PaUtil_BeginBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;timeInfo,</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>);</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"></highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1ab3b6507f21701058bd152f0c99f3c294" kindref="member">PaUtil_SetInterleavedInputChannels</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chan<sp/>);</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesProcessed<sp/>=</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a2bce3edf65753593f4f4005e917ad9e4" kindref="member">PaUtil_EndBufferProcessing</ref>(<sp/>&amp;(stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref>),</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;callbackResult<sp/>);</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>callbackResult<sp/>==<sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref><sp/>&amp;&amp;<sp/>!err<sp/>);</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"></highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<sp/>callbackResult<sp/>)</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acba49cbf0e3bf605bb3deecef3b4fce3" kindref="member">paContinue</ref>:<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32aa01800db52ead393d8b0016f63d76650" kindref="member">paComplete</ref>:</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1ae9bfb9c4e1895326f30f80d415c66c32acaf141eb5d71420ffb4474da1dbd8de2" kindref="member">paAbort</ref>:</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>CALLBACK_STOPPED<sp/>;</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioOutputUnitStop(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>);</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioOutputUnitStop(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>);</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"></highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><sp/><sp/><sp/><ref refid="pa__cpuload_8c_1a8c29cc1cf3b6fd9bf18a2c3fc9f0ef2a" kindref="member">PaUtil_EndCpuLoadMeasurement</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a589be1f91f8332bba6cc1b0b006f9b80" kindref="member">cpuLoadMeasurer</ref>,<sp/>framesProcessed<sp/>);</highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noErr;</highlight></codeline>
<codeline lineno="2580"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"></highlight></codeline>
<codeline lineno="2582"><highlight class="normal"></highlight></codeline>
<codeline lineno="2583"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2584"><highlight class="comment"><sp/><sp/><sp/><sp/>When<sp/>CloseStream()<sp/>is<sp/>called,<sp/>the<sp/>multi-api<sp/>layer<sp/>ensures<sp/>that</highlight></codeline>
<codeline lineno="2585"><highlight class="comment"><sp/><sp/><sp/><sp/>the<sp/>stream<sp/>has<sp/>already<sp/>been<sp/>stopped<sp/>or<sp/>aborted.</highlight></codeline>
<codeline lineno="2586"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2587"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>CloseStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2588"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>may<sp/>be<sp/>called<sp/>from<sp/>a<sp/>failed<sp/>OpenStream.</highlight></codeline>
<codeline lineno="2590"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Therefore,<sp/>each<sp/>piece<sp/>of<sp/>info<sp/>is<sp/>treated<sp/>seperately.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2591"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>result<sp/>=<sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="2592"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2593"><highlight class="normal"></highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;CloseStream()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2595"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Closing<sp/>stream.\n&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2596"><highlight class="normal"></highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boolean<sp/>isInput<sp/>=<sp/><ref refid="cext_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CleanupDevicePropertyListeners(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>,<sp/>isInput<sp/>);</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Boolean<sp/>isInput<sp/>=<sp/><ref refid="cext_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CleanupDevicePropertyListeners(<sp/>stream,<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>,<sp/>isInput<sp/>);</highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cascade_8c_1afea6e77db19a2f8c91419904fe665a3a" kindref="member">count</ref><sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a632eeced2955b271af52e8731e3a49ee" kindref="member">removeFromXRunListenerList</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>count<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ae982506be4fb075f57798b322893c477" kindref="member">outputDevice</ref>,</highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDeviceProcessorOverload,</highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8c_1a6e0d12a5c5acae6fac007f5ea96f96a3" kindref="member">xrunCallback</ref><sp/>);</highlight></codeline>
<codeline lineno="2619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>!=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cascade_8c_1afea6e77db19a2f8c91419904fe665a3a" kindref="member">count</ref><sp/>=<sp/><ref refid="pa__mac__core__utilities_8c_1a632eeced2955b271af52e8731e3a49ee" kindref="member">removeFromXRunListenerList</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>count<sp/>==<sp/>0<sp/>)</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioDeviceRemovePropertyListener(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a84ab00c3940677753cbcfaa0b4497817" kindref="member">inputDevice</ref>,</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAudioDeviceProcessorOverload,</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8c_1a6e0d12a5c5acae6fac007f5ea96f96a3" kindref="member">xrunCallback</ref><sp/>);</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>!=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnitUninitialize(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>);</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseComponent(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>);</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AudioUnitUninitialize(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>);</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseComponent(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>);</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ac16a18dca2fc3becee50d159cf2074f2" kindref="member">buffer</ref><sp/>)</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ac16a18dca2fc3becee50d159cf2074f2" kindref="member">buffer</ref><sp/>);</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ac16a18dca2fc3becee50d159cf2074f2" kindref="member">buffer</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*TODO:<sp/>is<sp/>there<sp/>more<sp/>that<sp/>needs<sp/>to<sp/>be<sp/>done<sp/>on<sp/>error</highlight></codeline>
<codeline lineno="2644"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>AudioConverterDispose?*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a44da9ced8f2b0fb446b0706a8f8773f5" kindref="member">ERR</ref>(<sp/>AudioConverterDispose(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData<sp/>)</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData<sp/>);</highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa214b3f78a40dd23797a512b0892a098" kindref="member">inputAudioBufferList</ref>.mBuffers[0].mData<sp/>=<sp/><ref refid="getopt1_8c_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"></highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="pa__mac__core__blocking_8c_1a96df2ab1655f2c2d1d524c7c960f8319" kindref="member">destroyBlioRingBuffers</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref><sp/>);</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>result<sp/>)</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ac6468bfef6a09086a8ba75bd1825b3f4" kindref="member">bufferProcessorIsInitialized</ref><sp/>)</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1acf4e607f9c25ec2db5efd02ef1adb188" kindref="member">PaUtil_TerminateBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref><sp/>);</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a94404e181cea0bc1d2c82b2e6f541366" kindref="member">timingInformationMutexIsInitialized</ref><sp/>)</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_mutex_destroy(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab03af1e2679f505b0ab8ad629a0b4a34" kindref="member">timingInformationMutex</ref><sp/>);</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"></highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__stream_8c_1ac30f6c0d3138ef52c63c94fd1a53ea86" kindref="member">PaUtil_TerminateStreamRepresentation</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a37e7f3609f183162f0938ae24dd838f7" kindref="member">streamRepresentation</ref><sp/>);</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__util_8h_1a27a8f85d109600ef246e5c642c5c3cad" kindref="member">PaUtil_FreeMemory</ref>(<sp/>stream<sp/>);</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2664"><highlight class="normal"></highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2666"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StartStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2669"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>result<sp/>=<sp/>noErr;</highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;StartStream()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Starting<sp/>stream.\n&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"></highlight></codeline>
<codeline lineno="2675"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ERR_WRAP(mac_err)<sp/>do<sp/>{<sp/>result<sp/>=<sp/>mac_err<sp/>;<sp/>if<sp/>(<sp/>result<sp/>!=<sp/>noErr<sp/>)<sp/>return<sp/>ERR(result)<sp/>;<sp/>}<sp/>while(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2676"><highlight class="normal"></highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*FIXME:<sp/>maybe<sp/>want<sp/>to<sp/>do<sp/>this<sp/>on<sp/>close/abort<sp/>for<sp/>faster<sp/>start?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__process_8c_1a454635d7cd026eec37f3ab3d27afc38e" kindref="member">PaUtil_ResetBufferProcessor</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aa4c9fb315b5a2a91164f62d40e1f35a7" kindref="member">bufferProcessor</ref><sp/>);</highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioConverterReset(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1ab3d6f024b40670367b5bbbe1444cba92" kindref="member">inputSRConverter</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2681"><highlight class="normal"></highlight></codeline>
<codeline lineno="2682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>start<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>ACTIVE;</highlight></codeline>
<codeline lineno="2684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioOutputUnitStart(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>)<sp/>);</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>!=<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioOutputUnitStart(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>)<sp/>);</highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="2692"><highlight class="normal"></highlight><highlight class="preprocessor">#undef<sp/>ERR_WRAP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2693"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"></highlight></codeline>
<codeline lineno="2695"><highlight class="normal"></highlight><highlight class="comment">//<sp/>it&apos;s<sp/>not<sp/>clear<sp/>from<sp/>appl&apos;s<sp/>docs<sp/>that<sp/>this<sp/>really<sp/>waits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2696"><highlight class="normal"></highlight><highlight class="comment">//<sp/>until<sp/>all<sp/>data<sp/>is<sp/>flushed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2697"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>ComponentResult<sp/>BlockWhileAudioUnitIsRunning(<sp/>AudioUnit<sp/>audioUnit,<sp/>AudioUnitElement<sp/>element<sp/>)</highlight></codeline>
<codeline lineno="2698"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/>Boolean<sp/>isRunning<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(<sp/>isRunning<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UInt32<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/>isRunning<sp/>);</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ComponentResult<sp/>err<sp/>=<sp/>AudioUnitGetProperty(<sp/>audioUnit,<sp/>kAudioOutputUnitProperty_IsRunning,<sp/>kAudioUnitScope_Global,<sp/>element,<sp/><sp/>&amp;isRunning,<sp/>&amp;s<sp/>);</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>err<sp/>)</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a1b3c20044c9401c42add29475636e83d" kindref="member">Pa_Sleep</ref>(<sp/>100<sp/>);</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noErr;</highlight></codeline>
<codeline lineno="2708"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"></highlight></codeline>
<codeline lineno="2710"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>StopStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2711"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"><sp/><sp/><sp/><sp/>OSStatus<sp/>result<sp/>=<sp/>noErr;</highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>paErr;</highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;StopStream()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2716"><highlight class="normal"></highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(</highlight><highlight class="stringliteral">&quot;Waiting<sp/>for<sp/>BLIO.\n&quot;</highlight><highlight class="normal">)<sp/>);</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__blocking_8c_1af88e5ceb377195cb9086d88b990e4d8b" kindref="member">waitUntilBlioWriteBufferIsFlushed</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref><sp/>);</highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Stopping<sp/>stream.\n&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2720"><highlight class="normal"></highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>STOPPING;</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"></highlight></codeline>
<codeline lineno="2723"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ERR_WRAP(mac_err)<sp/>do<sp/>{<sp/>result<sp/>=<sp/>mac_err<sp/>;<sp/>if<sp/>(<sp/>result<sp/>!=<sp/>noErr<sp/>)<sp/>return<sp/>ERR(result)<sp/>;<sp/>}<sp/>while(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>--<sp/>stop<sp/>and<sp/>reset<sp/>--<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>==<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>&amp;&amp;<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioOutputUnitStop(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>)<sp/>);</highlight></codeline>
<codeline lineno="2728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>BlockWhileAudioUnitIsRunning(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,0)<sp/>);</highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>BlockWhileAudioUnitIsRunning(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,1)<sp/>);</highlight></codeline>
<codeline lineno="2730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitReset(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,<sp/>kAudioUnitScope_Global,<sp/>1)<sp/>);</highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>AudioUnitReset(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,<sp/>kAudioUnitScope_Global,<sp/>0)<sp/>);</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(AudioOutputUnitStop(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>)<sp/>);</highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>BlockWhileAudioUnitIsRunning(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,1)<sp/>);</highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(AudioUnitReset(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18489f920abd98c28ec23a08129a2a94" kindref="member">inputUnit</ref>,kAudioUnitScope_Global,1));</highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="2743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(AudioOutputUnitStop(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>));</highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(<sp/>BlockWhileAudioUnitIsRunning(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>,0)<sp/>);</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__mac__core_8c_1a653f9f4031c43c6239fa2dd01b1e7c74" kindref="member">ERR_WRAP</ref>(AudioUnitReset(stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref>,kAudioUnitScope_Global,0));</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ac16a18dca2fc3becee50d159cf2074f2" kindref="member">buffer</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1a5d0da19fd934ad23afe8bafebfdc81e7" kindref="member">PaUtil_FlushRingBuffer</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref><sp/>);</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bzero(<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*)stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ac16a18dca2fc3becee50d159cf2074f2" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ae4e41eb1cc214406adb26203d4643371" kindref="member">bufferSize</ref><sp/>);</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>advance<sp/>the<sp/>write<sp/>point<sp/>a<sp/>little,<sp/>so<sp/>we<sp/>are<sp/>reading<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="2753"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>middle<sp/>of<sp/>the<sp/>buffer.<sp/>We&apos;ll<sp/>need<sp/>extra<sp/>at<sp/>the<sp/>end<sp/>because</highlight></codeline>
<codeline lineno="2754"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>testing<sp/>has<sp/>shown<sp/>that<sp/>this<sp/>helps.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a834e659582a0b68100a0095ac6d45c7e" kindref="member">outputUnit</ref><sp/>)</highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pa__ringbuffer_8c_1ad38033c3d1cef68a44b7ccb0cf318236" kindref="member">PaUtil_AdvanceRingBufferWriteIndex</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>,</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a1c12d9d7f7f8174127c8ae35b96991dd" kindref="member">inputRingBuffer</ref>.<ref refid="struct_pa_util_ring_buffer_1ae4e41eb1cc214406adb26203d4643371" kindref="member">bufferSize</ref></highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/<sp/><ref refid="pa__mac__core_8c_1a341f496004a3608bb6534632b2399cf8" kindref="member">RING_BUFFER_ADVANCE_DENOMINATOR</ref><sp/>);</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"></highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1af65db3bdd18d4356f16fe5c2b23f7d5d" kindref="member">xrunFlags</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>=<sp/>STOPPED;</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"></highlight></codeline>
<codeline lineno="2764"><highlight class="normal"><sp/><sp/><sp/><sp/>paErr<sp/>=<sp/><ref refid="pa__mac__core__blocking_8c_1aedd64041043bb6cba5713d9a12c26ebf" kindref="member">resetBlioRingBuffers</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1aeb24427958d583443b64443a9e25cdec" kindref="member">blio</ref><sp/>);</highlight></codeline>
<codeline lineno="2765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>paErr<sp/>)</highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>paErr;</highlight></codeline>
<codeline lineno="2767"><highlight class="normal"></highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Stream<sp/>Stopped.\n&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba" kindref="member">paNoError</ref>;</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"></highlight><highlight class="preprocessor">#undef<sp/>ERR_WRAP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2771"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"></highlight></codeline>
<codeline lineno="2773"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>AbortStream(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2774"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;AbortStream()-&gt;StopStream()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a38ee16c279b096dc8f4038e634d8100b" kindref="member">VDBUG</ref>(<sp/>(<sp/></highlight><highlight class="stringliteral">&quot;Aborting<sp/>stream.\n&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>have<sp/>nothing<sp/>faster<sp/>than<sp/>StopStream.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>StopStream(s);</highlight></codeline>
<codeline lineno="2779"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"></highlight></codeline>
<codeline lineno="2781"><highlight class="normal"></highlight></codeline>
<codeline lineno="2782"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamStopped(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2783"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;IsStreamStopped()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2786"><highlight class="normal"></highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>STOPPED<sp/>?<sp/>1<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="2788"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"></highlight></codeline>
<codeline lineno="2790"><highlight class="normal"></highlight></codeline>
<codeline lineno="2791"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="portaudio_8h_1a4949e4a8ef9f9dbe8cbee414ce69841d" kindref="member">PaError</ref><sp/>IsStreamActive(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref><sp/>*<ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2792"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;IsStreamActive()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>ACTIVE<sp/>||<sp/>stream-&gt;<ref refid="struct_pa_mac_core_stream_1a18df3b14e087124f9da12f49589a4c87" kindref="member">state</ref><sp/>==<sp/>STOPPING<sp/>);</highlight></codeline>
<codeline lineno="2796"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"></highlight></codeline>
<codeline lineno="2798"><highlight class="normal"></highlight></codeline>
<codeline lineno="2799"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>GetStreamCpuLoad(<sp/><ref refid="portaudio_8h_1a19874734f89958fccf86785490d53b4c" kindref="member">PaStream</ref>*<sp/><ref refid="lib_2expat_8h_1a755339d27872b13735c2cab829e47157" kindref="member">s</ref><sp/>)</highlight></codeline>
<codeline lineno="2800"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref><sp/>*stream<sp/>=<sp/>(<ref refid="struct_pa_mac_core_stream" kindref="compound">PaMacCoreStream</ref>*)s;</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pa__mac__core__utilities_8h_1a9d46dffb96d1a89d4822fc2c38dfeb36" kindref="member">VVDBUG</ref>((</highlight><highlight class="stringliteral">&quot;GetStreamCpuLoad()\n&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2803"><highlight class="normal"></highlight></codeline>
<codeline lineno="2804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pa__cpuload_8c_1af7bff59bbfe46a388e21633bf49ea0d6" kindref="member">PaUtil_GetCpuLoad</ref>(<sp/>&amp;stream-&gt;<ref refid="struct_pa_mac_core_stream_1a589be1f91f8332bba6cc1b0b006f9b80" kindref="member">cpuLoadMeasurer</ref><sp/>);</highlight></codeline>
<codeline lineno="2805"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/_dev/OpenU/Audacity/audacity/lib-src/portaudio-v19/src/hostapi/coreaudio/pa_mac_core.c"/>
  </compounddef>
</doxygen>
