<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Audacity: Starting, Stopping and Aborting a Stream</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Audacity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Starting, Stopping and Aborting a Stream </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tut_startstop1"></a>
Starting, Stopping and Aborting a Stream</h1>
<p>PortAudio will not start playing back audio until you start the stream. After calling <a class="el" href="portaudio_8h.html#a7432aadd26c40452da12fa99fc1a047b">Pa_StartStream()</a>, PortAudio will start calling your callback function to perform the audio processing.</p>
<div class="fragment"><div class="line">err = <a class="code" href="portaudio_8h.html#a7432aadd26c40452da12fa99fc1a047b">Pa_StartStream</a>( stream );</div><div class="line"><span class="keywordflow">if</span>( err != <a class="code" href="portaudio_8h.html#a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba">paNoError</a> ) <span class="keywordflow">goto</span> <a class="code" href="sndfile__load_8m.html#a3a81ee160b23b01b04b7c08b35123218">error</a>;</div></div><!-- fragment --><p>You can communicate with your callback routine through the data structure you passed in on the open call, or through global variables, or using other interprocess communication techniques, but please be aware that your callback function may be called at interrupt time when your foreground process is least expecting it. So avoid sharing complex data structures that are easily corrupted like double linked lists, and avoid using locks such as mutexs as this may cause your callback function to block and therefore drop audio. Such techniques may even cause deadlock on some platforms.</p>
<p>PortAudio will continue to call your callback and process audio until you stop the stream. This can be done in one of several ways, but, before we do so, we'll want to see that some of our audio gets processed by sleeping for a few seconds. This is easy to do with <a class="el" href="portaudio_8h.html#a1b3c20044c9401c42add29475636e83d">Pa_Sleep()</a>, which is used by many of the examples in the patests/ directory for exactly this purpose. Note that, for a variety of reasons, you can not rely on this function for accurate scheduling, so your stream may not run for exactly the same amount of time as you expect, but it's good enough for our example.</p>
<div class="fragment"><div class="line"><span class="comment">/* Sleep for several seconds. */</span></div><div class="line"><a class="code" href="portaudio_8h.html#a1b3c20044c9401c42add29475636e83d">Pa_Sleep</a>(<a class="code" href="sine_8cxx.html#ab6b46a9cf3ce22ae2cbb6ff903b7afef">NUM_SECONDS</a>*1000);</div></div><!-- fragment --><p>Now we need to stop playback. There are several ways to do this, the simplest of which is to call <a class="el" href="portaudio_8h.html#af18dd60220251286c337631a855e38a0">Pa_StopStream()</a>:</p>
<div class="fragment"><div class="line">err = <a class="code" href="portaudio_8h.html#af18dd60220251286c337631a855e38a0">Pa_StopStream</a>( stream );</div><div class="line"><span class="keywordflow">if</span>( err != <a class="code" href="portaudio_8h.html#a2e45bf8b5145f131a91c128af2bdaec7aeb09d15a48b6c1034728a9c518cfe4ba">paNoError</a> ) <span class="keywordflow">goto</span> <a class="code" href="sndfile__load_8m.html#a3a81ee160b23b01b04b7c08b35123218">error</a>;</div></div><!-- fragment --><p><a class="el" href="portaudio_8h.html#af18dd60220251286c337631a855e38a0">Pa_StopStream()</a> is designed to make sure that the buffers you've processed in your callback are all played, which may cause some delay. Alternatively, you could call <a class="el" href="portaudio_8h.html#a138e57abde4e833c457b64895f638a25">Pa_AbortStream()</a>. On some platforms, aborting the stream is much faster and may cause some data processed by your callback not to be played.</p>
<p>Another way to stop the stream is to return either paComplete, or paAbort from your callback. paComplete ensures that the last buffer is played whereas paAbort stops the stream as soon as possible. If you stop the stream using this technique, you will need to call <a class="el" href="portaudio_8h.html#af18dd60220251286c337631a855e38a0">Pa_StopStream()</a> before starting the stream again.</p>
<p>Previous: <a class="el" href="open_default_stream.html">Opening a Stream Using Defaults</a> | Next: <a class="el" href="terminating_portaudio.html">Closing a Stream and Terminating PortAudio</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
