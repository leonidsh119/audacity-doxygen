<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Audacity: C:/_dev/OpenU/Audacity/audacity/lib-src/libsoxr/src/filter.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Audacity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ca5d775a60eb14feacb7e09cea182bb9.html">audacity</a></li><li class="navelem"><a class="el" href="dir_7eead044a7427418c190b82a89ee69fb.html">lib-src</a></li><li class="navelem"><a class="el" href="dir_3778506cc90a65e3c465af48979a8e1a.html">libsoxr</a></li><li class="navelem"><a class="el" href="dir_1a81f2dd9412cc308466d4d84dc96368.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">filter.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="filter_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* SoX Resampler Library      Copyright (c) 2007-13 robs@users.sourceforge.net</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Licence for this file: LGPL v2.1                  See LICENCE for details. */</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libsoxr_2src_2_filter_8h.html">filter.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#if !defined M_PI</span></div><div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">    8</a></span>&#160;<span class="preprocessor">#define M_PI    3.14159265358979323846</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="assert_8h.html">assert.h</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fft4g_8h.html">fft4g.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ccrw2_8h.html">ccrw2.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#if 1 || HAVE_DOUBLE_PRECISION </span><span class="comment">/* Always need this, for lsx_fir_to_phase. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#define DFT_FLOAT double</span></div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="filter_8c.html#a39a936ffbd0a44016b01a92e27356011">   19</a></span>&#160;<span class="preprocessor">#define DONE_WITH_FFT_CACHE done_with_fft_cache</span></div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="filter_8c.html#a6883d50d099fdd0e5c69cddbcb835c5b">   20</a></span>&#160;<span class="preprocessor">#define FFT_CACHE_CCRW fft_cache_ccrw</span></div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="filter_8c.html#ac979f1394ce025277fae6be925cf46a8">   21</a></span>&#160;<span class="preprocessor">#define FFT_LEN fft_len</span></div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="filter_8c.html#aa4ed0cae8f0c001ed340cdcf5bed2345">   22</a></span>&#160;<span class="preprocessor">#define LSX_CDFT lsx_cdft</span></div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="filter_8c.html#af22da1abf7c645d65048737ceaac705c">   23</a></span>&#160;<span class="preprocessor">#define LSX_CLEAR_FFT_CACHE lsx_clear_fft_cache</span></div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="filter_8c.html#a3a1338f249ca28fe6f5946b4791478af">   24</a></span>&#160;<span class="preprocessor">#define LSX_FFT_BR lsx_fft_br</span></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="filter_8c.html#ae5f1581f200f67afd5ba263099e913af">   25</a></span>&#160;<span class="preprocessor">#define LSX_FFT_SC lsx_fft_sc</span></div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="filter_8c.html#a3e3f4b0884cdb2cec35fd2b652d3ac4e">   26</a></span>&#160;<span class="preprocessor">#define LSX_INIT_FFT_CACHE lsx_init_fft_cache</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="filter_8c.html#a7c73a4a36e2afb067be8f8a67ee5f056">   27</a></span>&#160;<span class="preprocessor">#define LSX_RDFT lsx_rdft</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="filter_8c.html#a06711e3693936f31a90af171fae73d99">   28</a></span>&#160;<span class="preprocessor">#define LSX_SAFE_CDFT lsx_safe_cdft</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="filter_8c.html#ac016927606ec1a2bed434a1a773a1b20">   29</a></span>&#160;<span class="preprocessor">#define LSX_SAFE_RDFT lsx_safe_rdft</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="filter_8c.html#a4bd289731fb831f32d3794538244a27d">   30</a></span>&#160;<span class="preprocessor">#define UPDATE_FFT_CACHE update_fft_cache</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fft4g__cache_8h.html">fft4g_cache.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if HAVE_SINGLE_PRECISION &amp;&amp; !HAVE_AVFFT</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#define DFT_FLOAT float</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#define DONE_WITH_FFT_CACHE done_with_fft_cache_f</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#define FFT_CACHE_CCRW fft_cache_ccrw_f</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#define FFT_LEN fft_len_f</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#define LSX_CDFT lsx_cdft_f</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#define LSX_CLEAR_FFT_CACHE lsx_clear_fft_cache_f</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#define LSX_FFT_BR lsx_fft_br_f</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#define LSX_FFT_SC lsx_fft_sc_f</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#define LSX_INIT_FFT_CACHE lsx_init_fft_cache_f</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define LSX_RDFT lsx_rdft_f</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#define LSX_SAFE_CDFT lsx_safe_cdft_f</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#define LSX_SAFE_RDFT lsx_safe_rdft_f</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#define UPDATE_FFT_CACHE update_fft_cache_f</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fft4g__cache_8h.html">fft4g_cache.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if HAVE_DOUBLE_PRECISION || !SOXR_LIB</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="filter_8c.html#a65ac1b834fa43249302c9aece9f6aed5">   52</a></span>&#160;<span class="preprocessor">#define DFT_FLOAT double</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="filter_8c.html#a3d1baad9244a07281953b29ac37adfea">   53</a></span>&#160;<span class="preprocessor">#define ORDERED_CONVOLVE lsx_ordered_convolve</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="filter_8c.html#a46d226628aa993da1749471f0a0d4fe1">   54</a></span>&#160;<span class="preprocessor">#define ORDERED_PARTIAL_CONVOLVE lsx_ordered_partial_convolve</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rdft_8h.html">rdft.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#if HAVE_SINGLE_PRECISION</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#define DFT_FLOAT float</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#define ORDERED_CONVOLVE lsx_ordered_convolve_f</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#define ORDERED_PARTIAL_CONVOLVE lsx_ordered_partial_convolve_f</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rdft_8h.html">rdft.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="libsoxr_2src_2_filter_8h.html#a1380e44ed098c719f0b564253007ec48">   65</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="filter_8c.html#a1380e44ed098c719f0b564253007ec48">lsx_kaiser_beta</a>(<span class="keywordtype">double</span> <a class="code" href="filters_8h.html#a6cbe32dd86cefd1a8b182b3ee652e9bf">att</a>, <span class="keywordtype">double</span> tr_bw)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (att &gt;= 60) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> coefs[][4] = {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      {-6.784957e-10,1.02856e-05,0.1087556,-0.8988365+.001},</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      {-6.897885e-10,1.027433e-05,0.10876,-0.8994658+.002},</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      {-1.000683e-09,1.030092e-05,0.1087677,-0.9007898+.003},</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      {-3.654474e-10,1.040631e-05,0.1087085,-0.8977766+.006},</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      {8.106988e-09,6.983091e-06,0.1091387,-0.9172048+.015},</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      {9.519571e-09,7.272678e-06,0.1090068,-0.9140768+.025},</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      {-5.626821e-09,1.342186e-05,0.1083999,-0.9065452+.05},</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      {-9.965946e-08,5.073548e-05,0.1040967,-0.7672778+.085},</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      {1.604808e-07,-5.856462e-05,0.1185998,-1.34824+.1},</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      {-1.511964e-07,6.363034e-05,0.1064627,-0.9876665+.18},</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    };</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">double</span> realm = log(tr_bw/.0005)/log(2.);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> * c0 = coefs[<a class="code" href="libsoxr_2src_2internal_8h.html#afc09b30fa64f2d3d58591e7659428475">range_limit</a>(  (<span class="keywordtype">int</span>)realm, 0, (<span class="keywordtype">int</span>)<a class="code" href="libsoxr_2src_2internal_8h.html#a9af157c53b7f125d10e0ff736c0d7d75">array_length</a>(coefs)-1)];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> * c1 = coefs[<a class="code" href="libsoxr_2src_2internal_8h.html#afc09b30fa64f2d3d58591e7659428475">range_limit</a>(1+(<span class="keywordtype">int</span>)realm, 0, (<span class="keywordtype">int</span>)<a class="code" href="libsoxr_2src_2internal_8h.html#a9af157c53b7f125d10e0ff736c0d7d75">array_length</a>(coefs)-1)];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">double</span> b0 = ((c0[0]*att + c0[1])*att + c0[2])*att + c0[3];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> b1 = ((c1[0]*att + c1[1])*att + c1[2])*att + c1[3];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> b0 + (b1 - b0) * (realm - (<span class="keywordtype">int</span>)realm);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">if</span> (att &gt; 50   ) <span class="keywordflow">return</span> .1102 * (att - 8.7);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (att &gt; 20.96) <span class="keywordflow">return</span> .58417 * pow(att -20.96, .4) + .07886 * (att - 20.96);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="libsoxr_2src_2_filter_8h.html#a66649ae10e9f0656c1d57300b43fd532">   92</a></span>&#160;<span class="keywordtype">double</span> * <a class="code" href="filter_8c.html#a66649ae10e9f0656c1d57300b43fd532">lsx_make_lpf</a>(</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> num_taps, <span class="keywordtype">double</span> Fc, <span class="keywordtype">double</span> beta, <span class="keywordtype">double</span> rho, <span class="keywordtype">double</span> scale)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>, <a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a> = num_taps - 1;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> * h = malloc((<span class="keywordtype">size_t</span>)num_taps * <span class="keyword">sizeof</span>(*h));</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span> mult = scale / <a class="code" href="libsoxr_2src_2_filter_8h.html#a344a0d584d4a71f5e8283085323caee4">lsx_bessel_I_0</a>(beta), mult1 = 1 / (.5 * m + rho);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(Fc &gt;= 0 &amp;&amp; Fc &lt;= 1);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  lsx_debug(<span class="stringliteral">&quot;make_lpf(n=%i Fc=%.7g β=%g ρ=%g scale=%g)&quot;</span>,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      num_taps, Fc, beta, rho, scale);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (h) <span class="keywordflow">for</span> (i = 0; i &lt;= m / 2; ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">double</span> z = i - .5 * <a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a>, <a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a> = z * <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>, y = z * mult1;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    h[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = x? <a class="code" href="pffft_8c.html#a28642ecbd9d1e77ab5a140a460f47d83">sin</a>(Fc * x) / x : Fc;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    h[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] *= <a class="code" href="libsoxr_2src_2_filter_8h.html#a344a0d584d4a71f5e8283085323caee4">lsx_bessel_I_0</a>(beta * sqrt(1 - y * y)) * mult;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (m - i != i)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      h[m - <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = h[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>];</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">return</span> h;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="libsoxr_2src_2_filter_8h.html#a757d3e4ac0fdbc7ea96df65d2f8a1bb4">  112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="filter_8c.html#a757d3e4ac0fdbc7ea96df65d2f8a1bb4">lsx_kaiser_params</a>(<span class="keywordtype">double</span> <a class="code" href="filters_8h.html#a6cbe32dd86cefd1a8b182b3ee652e9bf">att</a>, <span class="keywordtype">double</span> Fc, <span class="keywordtype">double</span> tr_bw, <span class="keywordtype">double</span> * beta, <span class="keywordtype">int</span> * num_taps)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  *beta = *beta &lt; 0? <a class="code" href="filter_8c.html#a1380e44ed098c719f0b564253007ec48">lsx_kaiser_beta</a>(att, tr_bw * .5 / Fc): *beta;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  att = att &lt; 60? (att - 7.95) / (2.285 * <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * 2) :</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ((.0007528358-1.577737<a class="code" href="namespacelv2docgen.html#a4405dc5a2509537b9ff3b4de10bc28d6">e</a>-05**beta)**beta+.6248022)**beta+.06186902;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  *num_taps = !*num_taps? (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)ceil(att/tr_bw + 1) : *num_taps;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="libsoxr_2src_2_filter_8h.html#a022b42ac35e0ed161ff47a41e55c1dce">  120</a></span>&#160;<span class="keywordtype">double</span> * <a class="code" href="filter_8c.html#a022b42ac35e0ed161ff47a41e55c1dce">lsx_design_lpf</a>(</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">double</span> Fp,      <span class="comment">/* End of pass-band */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">double</span> Fs,      <span class="comment">/* Start of stop-band */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">double</span> Fn,      <span class="comment">/* Nyquist freq; e.g. 0.5, 1, PI */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="filters_8h.html#a6cbe32dd86cefd1a8b182b3ee652e9bf">att</a>,     <span class="comment">/* Stop-band attenuation in dB */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> * num_taps, <span class="comment">/* 0: value will be estimated */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="rfft2d_test_m_l_8m.html#adc468c70fb574ebd07287b38d0d0676d">k</a>,          <span class="comment">/* &gt;0: number of phases; &lt;0: num_taps ≡ 1 (mod -k) */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">double</span> beta)    <span class="comment">/* &lt;0: value will be estimated */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">int</span> n = *num_taps, <a class="code" href="test__w__saw_8c.html#a176837568a7aa31eeb3ee679d3d82428">phases</a> = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>(k, 1), modulo = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>(-k, 1);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">double</span> tr_bw, Fc, rho = phases == 1? .5 : att &lt; 120? .63 : .75;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  Fp /= fabs(Fn), Fs /= fabs(Fn);        <span class="comment">/* Normalise to Fn = 1 */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  tr_bw = .5 * (Fs - Fp); <span class="comment">/* Transition band-width: 6dB to stop points */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  tr_bw /= <a class="code" href="test__w__saw_8c.html#a176837568a7aa31eeb3ee679d3d82428">phases</a>, Fs /= <a class="code" href="test__w__saw_8c.html#a176837568a7aa31eeb3ee679d3d82428">phases</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  tr_bw = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>(tr_bw, .5 * Fs);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  Fc = Fs - tr_bw;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(Fc - tr_bw &gt;= 0);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="filter_8c.html#a757d3e4ac0fdbc7ea96df65d2f8a1bb4">lsx_kaiser_params</a>(att, Fc, tr_bw, &amp;beta, num_taps);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (!n)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    *num_taps = phases &gt; 1? *num_taps / phases * phases + phases - 1 :</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      (*num_taps + modulo - 2) / modulo * modulo + 1;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> Fn &lt; 0? 0 : <a class="code" href="filter_8c.html#a66649ae10e9f0656c1d57300b43fd532">lsx_make_lpf</a>(*num_taps, Fc, beta, rho, (<span class="keywordtype">double</span>)phases);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> safe_log(<span class="keywordtype">double</span> <a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(x &gt;= 0);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (x)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> log(x);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  lsx_debug(<span class="stringliteral">&quot;log(0)&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">return</span> -26;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="libsoxr_2src_2_filter_8h.html#a12b18812b4740de7a56476f71df796d8">  154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="filter_8c.html#a76e7cd2b243099c94f0b0d21cb6a77b8">lsx_fir_to_phase</a>(<span class="keywordtype">double</span> * * h, <span class="keywordtype">int</span> * <a class="code" href="lib_2expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a>, <span class="keywordtype">int</span> * post_len, <span class="keywordtype">double</span> phase)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">double</span> * pi_wraps, * work, phase1 = (phase &gt; 50 ? 100 - phase : phase) / 50;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>, work_len, begin, <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a>, imp_peak = 0, peak = 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">double</span> imp_sum = 0, peak_imp_sum = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">double</span> prev_angle2 = 0, cum_2pi = 0, prev_angle1 = 0, cum_1pi = 0;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">for</span> (i = *len, work_len = 2 * 2 * 8; i &gt; 1; work_len &lt;&lt;= 1, i &gt;&gt;= 1);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  work = calloc((<span class="keywordtype">size_t</span>)work_len + 2, <span class="keyword">sizeof</span>(*work)); <span class="comment">/* +2: (UN)PACK */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  pi_wraps = malloc((((<span class="keywordtype">size_t</span>)work_len + 2) / 2) * <span class="keyword">sizeof</span>(*pi_wraps));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  memcpy(work, *h, (<span class="keywordtype">size_t</span>)*len * <span class="keyword">sizeof</span>(*work));</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="libsoxr_2src_2_filter_8h.html#a9c22ba7a1ec1d6ceebe5ce0dddc3cc10">lsx_safe_rdft</a>(work_len, 1, work); <span class="comment">/* Cepstral: */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="fft4g_8h.html#a0b59f098329c9cbc6aa51afe6cc59d91">LSX_UNPACK</a>(work, work_len);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt;= work_len; i += 2) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">double</span> angle = atan2(work[i + 1], work[i]);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> detect = 2 * <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">double</span> delta = angle - prev_angle2;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">double</span> adjust = detect * ((delta &lt; -detect * .7) - (delta &gt; detect * .7));</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    prev_angle2 = angle;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    cum_2pi += adjust;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    angle += cum_2pi;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    detect = <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    delta = angle - prev_angle1;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    adjust = detect * ((delta &lt; -detect * .7) - (delta &gt; detect * .7));</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    prev_angle1 = angle;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    cum_1pi += fabs(adjust); <span class="comment">/* fabs for when 2pi and 1pi have combined */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    pi_wraps[i &gt;&gt; 1] = cum_1pi;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    work[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = safe_log(sqrt(<a class="code" href="libsoxr_2src_2internal_8h.html#a09f4b0d9da085264ffcb8d68fa045d67">sqr</a>(work[i]) + <a class="code" href="libsoxr_2src_2internal_8h.html#a09f4b0d9da085264ffcb8d68fa045d67">sqr</a>(work[i + 1])));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    work[i + 1] = 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="fft4g_8h.html#ae549d3136d6184f2c03fa7e6b6eafb46">LSX_PACK</a>(work, work_len);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="libsoxr_2src_2_filter_8h.html#a9c22ba7a1ec1d6ceebe5ce0dddc3cc10">lsx_safe_rdft</a>(work_len, -1, work);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; work_len; ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) work[i] *= 2. / work_len;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">for</span> (i = 1; i &lt; work_len / 2; ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) { <span class="comment">/* Window to reject acausal components */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    work[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] *= 2;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    work[i + work_len / 2] = 0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="libsoxr_2src_2_filter_8h.html#a9c22ba7a1ec1d6ceebe5ce0dddc3cc10">lsx_safe_rdft</a>(work_len, 1, work);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">for</span> (i = 2; i &lt; work_len; i += 2) <span class="comment">/* Interpolate between linear &amp; min phase */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    work[i + 1] = phase1 * i / work_len * pi_wraps[work_len &gt;&gt; 1] +</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        (1 - phase1) * (work[i + 1] + pi_wraps[i &gt;&gt; 1]) - pi_wraps[i &gt;&gt; 1];</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  work[0] = exp(work[0]), work[1] = exp(work[1]);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">for</span> (i = 2; i &lt; work_len; i += 2) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a> = exp(work[i]);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    work[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>    ] = x * <a class="code" href="pffft_8c.html#a57a66355e043ccefc17aca9338a2b748">cos</a>(work[i + 1]);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    work[i + 1] = x * <a class="code" href="pffft_8c.html#a28642ecbd9d1e77ab5a140a460f47d83">sin</a>(work[i + 1]);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="libsoxr_2src_2_filter_8h.html#a9c22ba7a1ec1d6ceebe5ce0dddc3cc10">lsx_safe_rdft</a>(work_len, -1, work);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; work_len; ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) work[i] *= 2. / work_len;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">/* Find peak pos. */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt;= (int)(pi_wraps[work_len &gt;&gt; 1] / <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> + .5); ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    imp_sum += work[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (fabs(imp_sum) &gt; fabs(peak_imp_sum)) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      peak_imp_sum = imp_sum;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      peak = <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (work[i] &gt; work[imp_peak]) <span class="comment">/* For debug check only */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      imp_peak = <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">while</span> (peak &amp;&amp; fabs(work[peak-1]) &gt; fabs(work[peak]) &amp;&amp; work[peak-1] * work[peak] &gt; 0)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    --peak;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (!phase1)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    begin = 0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phase1 == 1)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    begin = peak - *len / 2;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    begin = (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((.997 - (2 - phase1) * .22) * *len + .5);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    end   = (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((.997 + (0 - phase1) * .22) * *len + .5);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    begin = peak - (begin &amp; ~3);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    end   = peak + 1 + ((end + 3) &amp; ~3);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    *len = end - begin;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    *h = realloc(*h, (<span class="keywordtype">size_t</span>)*len * <span class="keyword">sizeof</span>(**h));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; *<a class="code" href="lib_2expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a>; ++<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) (*h)[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] =</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    work[(begin + (phase &gt; 50 ? *len - 1 - i : <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>) + work_len) &amp; (work_len - 1)];</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  *post_len = phase &gt; 50 ? peak - begin : begin + *len - (peak + 1);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  lsx_debug(<span class="stringliteral">&quot;nPI=%g peak-sum@%i=%g (val@%i=%g); len=%i post=%i (%g%%)&quot;</span>,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      pi_wraps[work_len &gt;&gt; 1] / <a class="code" href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>, peak, peak_imp_sum, imp_peak,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      work[imp_peak], *len, *post_len, 100 - 100. * *post_len / (*len - 1));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  free(pi_wraps), free(work);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div><div class="ttc" id="pffft_8c_html_a28642ecbd9d1e77ab5a140a460f47d83"><div class="ttname"><a href="pffft_8c.html#a28642ecbd9d1e77ab5a140a460f47d83">sin</a></div><div class="ttdeci">#define sin</div><div class="ttdef"><b>Definition:</b> <a href="pffft_8c_source.html#l00262">pffft.c:262</a></div></div>
<div class="ttc" id="rfft2d_test_m_l_8m_html_adc468c70fb574ebd07287b38d0d0676d"><div class="ttname"><a href="rfft2d_test_m_l_8m.html#adc468c70fb574ebd07287b38d0d0676d">k</a></div><div class="ttdeci">k</div><div class="ttdef"><b>Definition:</b> <a href="rfft2d_test_m_l_8m_source.html#l00032">rfft2dTestML.m:32</a></div></div>
<div class="ttc" id="libsoxr_2src_2internal_8h_html_a09f4b0d9da085264ffcb8d68fa045d67"><div class="ttname"><a href="libsoxr_2src_2internal_8h.html#a09f4b0d9da085264ffcb8d68fa045d67">sqr</a></div><div class="ttdeci">#define sqr(a)</div><div class="ttdef"><b>Definition:</b> <a href="libsoxr_2src_2internal_8h_source.html#l00019">internal.h:19</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_a14bb8924daea0b48c7803f281f66e390"><div class="ttname"><a href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a></div><div class="ttdeci">typedef int(XMLCALL *XML_NotStandaloneHandler)(void *userData)</div></div>
<div class="ttc" id="test__w__saw_8c_html_a176837568a7aa31eeb3ee679d3d82428"><div class="ttname"><a href="test__w__saw_8c.html#a176837568a7aa31eeb3ee679d3d82428">phases</a></div><div class="ttdeci">float phases[SAMPLES_PER_FRAME]</div><div class="ttdef"><b>Definition:</b> <a href="test__w__saw_8c_source.html#l00060">test_w_saw.c:60</a></div></div>
<div class="ttc" id="libsoxr_2src_2_filter_8h_html_a9c22ba7a1ec1d6ceebe5ce0dddc3cc10"><div class="ttname"><a href="libsoxr_2src_2_filter_8h.html#a9c22ba7a1ec1d6ceebe5ce0dddc3cc10">lsx_safe_rdft</a></div><div class="ttdeci">void lsx_safe_rdft(int len, int type, double *d)</div></div>
<div class="ttc" id="lib_2expat_8h_html_af86d325fecfc8f47b61fbf5a5146f582"><div class="ttname"><a href="lib_2expat_8h.html#af86d325fecfc8f47b61fbf5a5146f582">len</a></div><div class="ttdeci">const XML_Char int len</div><div class="ttdef"><b>Definition:</b> <a href="lib_2expat_8h_source.html#l00262">expat.h:262</a></div></div>
<div class="ttc" id="filter_8c_html_a757d3e4ac0fdbc7ea96df65d2f8a1bb4"><div class="ttname"><a href="filter_8c.html#a757d3e4ac0fdbc7ea96df65d2f8a1bb4">lsx_kaiser_params</a></div><div class="ttdeci">void lsx_kaiser_params(double att, double Fc, double tr_bw, double *beta, int *num_taps)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00112">filter.c:112</a></div></div>
<div class="ttc" id="libsoxr_2src_2_filter_8h_html_a344a0d584d4a71f5e8283085323caee4"><div class="ttname"><a href="libsoxr_2src_2_filter_8h.html#a344a0d584d4a71f5e8283085323caee4">lsx_bessel_I_0</a></div><div class="ttdeci">double lsx_bessel_I_0(double x)</div></div>
<div class="ttc" id="libflac_2src_2flac_2encode_8c_html_ac39d9cef6a5e030ba8d9e11121054268"><div class="ttname"><a href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a></div><div class="ttdeci">#define max(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="libflac_2src_2flac_2encode_8c_source.html#l00046">encode.c:46</a></div></div>
<div class="ttc" id="fft4g_8h_html"><div class="ttname"><a href="fft4g_8h.html">fft4g.h</a></div></div>
<div class="ttc" id="filter_8c_html_a76e7cd2b243099c94f0b0d21cb6a77b8"><div class="ttname"><a href="filter_8c.html#a76e7cd2b243099c94f0b0d21cb6a77b8">lsx_fir_to_phase</a></div><div class="ttdeci">void lsx_fir_to_phase(double **h, int *len, int *post_len, double phase)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00154">filter.c:154</a></div></div>
<div class="ttc" id="namespacewaflib_1_1_utils_html_a15fc4f04cecad81fba9772c4e43d40f7"><div class="ttname"><a href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">waflib.Utils.x</a></div><div class="ttdeci">string x</div><div class="ttdef"><b>Definition:</b> <a href="lilv_2waflib_2_utils_8py_source.html#l00176">Utils.py:176</a></div></div>
<div class="ttc" id="assert_8h_html"><div class="ttname"><a href="assert_8h.html">assert.h</a></div></div>
<div class="ttc" id="checksum_8c_html_ab80e330a3bc9e38c1297fe17381e92b4"><div class="ttname"><a href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a></div><div class="ttdeci">int i[1&lt;&lt; 15]</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00072">checksum.c:72</a></div></div>
<div class="ttc" id="namespacelv2docgen_html_a4405dc5a2509537b9ff3b4de10bc28d6"><div class="ttname"><a href="namespacelv2docgen.html#a4405dc5a2509537b9ff3b4de10bc28d6">lv2docgen.e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="lv2docgen_8py_source.html#l00129">lv2docgen.py:129</a></div></div>
<div class="ttc" id="filter_8c_html_a1380e44ed098c719f0b564253007ec48"><div class="ttname"><a href="filter_8c.html#a1380e44ed098c719f0b564253007ec48">lsx_kaiser_beta</a></div><div class="ttdeci">double lsx_kaiser_beta(double att, double tr_bw)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00065">filter.c:65</a></div></div>
<div class="ttc" id="libid3tag_2global_8h_html_af576bf8ffa22a44e53018c67095ffbf0"><div class="ttname"><a href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a></div><div class="ttdeci">#define assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="libid3tag_2global_8h_source.html#l00049">global.h:49</a></div></div>
<div class="ttc" id="_compare_audio_command_8cpp_html_abd8bbcfabb3ddef2ccaafb9928a37b95"><div class="ttname"><a href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a></div><div class="ttdeci">int min(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="_compare_audio_command_8cpp_source.html#l00080">CompareAudioCommand.cpp:80</a></div></div>
<div class="ttc" id="layer3_8c_html_a4b8bfe70f28d6faddcb10d6ecf8c1989"><div class="ttname"><a href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a></div><div class="ttdeci">unsigned char const * m</div><div class="ttdef"><b>Definition:</b> <a href="layer3_8c_source.html#l00305">layer3.c:305</a></div></div>
<div class="ttc" id="convtest_8m_html_afb358f48b1646c750fb9da6c6585be2b"><div class="ttname"><a href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a></div><div class="ttdeci">end</div><div class="ttdef"><b>Definition:</b> <a href="convtest_8m_source.html#l00025">convtest.m:25</a></div></div>
<div class="ttc" id="filter_8c_html_a66649ae10e9f0656c1d57300b43fd532"><div class="ttname"><a href="filter_8c.html#a66649ae10e9f0656c1d57300b43fd532">lsx_make_lpf</a></div><div class="ttdeci">double * lsx_make_lpf(int num_taps, double Fc, double beta, double rho, double scale)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00092">filter.c:92</a></div></div>
<div class="ttc" id="fft4g__cache_8h_html"><div class="ttname"><a href="fft4g__cache_8h.html">fft4g_cache.h</a></div></div>
<div class="ttc" id="libsoxr_2src_2internal_8h_html_afc09b30fa64f2d3d58591e7659428475"><div class="ttname"><a href="libsoxr_2src_2internal_8h.html#afc09b30fa64f2d3d58591e7659428475">range_limit</a></div><div class="ttdeci">#define range_limit(x, lower, upper)</div><div class="ttdef"><b>Definition:</b> <a href="libsoxr_2src_2internal_8h_source.html#l00014">internal.h:14</a></div></div>
<div class="ttc" id="pffft_8c_html_a57a66355e043ccefc17aca9338a2b748"><div class="ttname"><a href="pffft_8c.html#a57a66355e043ccefc17aca9338a2b748">cos</a></div><div class="ttdeci">#define cos</div><div class="ttdef"><b>Definition:</b> <a href="pffft_8c_source.html#l00263">pffft.c:263</a></div></div>
<div class="ttc" id="libsoxr_2src_2_filter_8h_html"><div class="ttname"><a href="libsoxr_2src_2_filter_8h.html">filter.h</a></div></div>
<div class="ttc" id="rdft_8h_html"><div class="ttname"><a href="rdft_8h.html">rdft.h</a></div></div>
<div class="ttc" id="filters_8h_html_a6cbe32dd86cefd1a8b182b3ee652e9bf"><div class="ttname"><a href="filters_8h.html#a6cbe32dd86cefd1a8b182b3ee652e9bf">att</a></div><div class="ttdeci">float att</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00042">filters.h:42</a></div></div>
<div class="ttc" id="fft4g_8h_html_ae549d3136d6184f2c03fa7e6b6eafb46"><div class="ttname"><a href="fft4g_8h.html#ae549d3136d6184f2c03fa7e6b6eafb46">LSX_PACK</a></div><div class="ttdeci">#define LSX_PACK(h, n)  </div><div class="ttdef"><b>Definition:</b> <a href="fft4g_8h_source.html#l00022">fft4g.h:22</a></div></div>
<div class="ttc" id="filter_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="filter_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00008">filter.c:8</a></div></div>
<div class="ttc" id="ccrw2_8h_html"><div class="ttname"><a href="ccrw2_8h.html">ccrw2.h</a></div></div>
<div class="ttc" id="libsoxr_2src_2internal_8h_html_a9af157c53b7f125d10e0ff736c0d7d75"><div class="ttname"><a href="libsoxr_2src_2internal_8h.html#a9af157c53b7f125d10e0ff736c0d7d75">array_length</a></div><div class="ttdeci">#define array_length(a)</div><div class="ttdef"><b>Definition:</b> <a href="libsoxr_2src_2internal_8h_source.html#l00016">internal.h:16</a></div></div>
<div class="ttc" id="fft4g_8h_html_a0b59f098329c9cbc6aa51afe6cc59d91"><div class="ttname"><a href="fft4g_8h.html#a0b59f098329c9cbc6aa51afe6cc59d91">LSX_UNPACK</a></div><div class="ttdeci">#define LSX_UNPACK(h, n)</div><div class="ttdef"><b>Definition:</b> <a href="fft4g_8h_source.html#l00023">fft4g.h:23</a></div></div>
<div class="ttc" id="filter_8c_html_a022b42ac35e0ed161ff47a41e55c1dce"><div class="ttname"><a href="filter_8c.html#a022b42ac35e0ed161ff47a41e55c1dce">lsx_design_lpf</a></div><div class="ttdeci">double * lsx_design_lpf(double Fp, double Fs, double Fn, double att, int *num_taps, int k, double beta)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00120">filter.c:120</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
