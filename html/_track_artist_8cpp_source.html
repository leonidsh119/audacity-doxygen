<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Audacity: C:/_dev/OpenU/Audacity/audacity/src/TrackArtist.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Audacity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ca5d775a60eb14feacb7e09cea182bb9.html">audacity</a></li><li class="navelem"><a class="el" href="dir_8da4dff9bdf76889016cee83b4759d03.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TrackArtist.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_track_artist_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**********************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  Audacity: A Digital Audio Editor</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  TrackArtist.cpp</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  Dominic Mazzoni</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*******************************************************************/</span><span class="comment">/*******************************************************************/</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_audacity_8h.html">Audacity.h</a>&quot;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_track_artist_8h.html">TrackArtist.h</a>&quot;</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_audacity_app_8h.html">AudacityApp.h</a>&quot;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="float__cast_8h.html">float_cast.h</a>&quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="float_8h.html">float.h</a>&gt;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#include &lt;wx/brush.h&gt;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#include &lt;wx/colour.h&gt;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#include &lt;wx/dc.h&gt;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#include &lt;wx/dcmemory.h&gt;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#include &lt;wx/gdicmn.h&gt;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#include &lt;wx/graphics.h&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#include &lt;wx/image.h&gt;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#include &lt;wx/pen.h&gt;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#include &lt;wx/log.h&gt;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#include &lt;wx/datetime.h&gt;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#ifdef USE_MIDI</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_note_track_8h.html">NoteTrack.h</a>&quot;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#endif // USE_MIDI</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_a_color_8h.html">AColor.h</a>&quot;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_block_file_8h.html">BlockFile.h</a>&quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="src_2_envelope_8h.html">Envelope.h</a>&quot;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_number_scale_8h.html">NumberScale.h</a>&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_wave_track_8h.html">WaveTrack.h</a>&quot;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_label_track_8h.html">LabelTrack.h</a>&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_time_track_8h.html">TimeTrack.h</a>&quot;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_prefs_8h.html">Prefs.h</a>&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_g_u_i_settings_8h.html">prefs/GUISettings.h</a>&quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_spectrogram_settings_8h.html">prefs/SpectrogramSettings.h</a>&quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_waveform_settings_8h.html">prefs/WaveformSettings.h</a>&quot;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_spectrum_8h.html">Spectrum.h</a>&quot;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_view_info_8h.html">ViewInfo.h</a>&quot;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_ruler_8h.html">widgets/Ruler.h</a>&quot;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_theme_8h.html">Theme.h</a>&quot;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_all_theme_resources_8h.html">AllThemeResources.h</a>&quot;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_experimental_8h.html">Experimental.h</a>&quot;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#undef PROFILE_WAVEFORM</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#ifdef PROFILE_WAVEFORM</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">   #ifdef __WXMSW__</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">      #include &lt;time.h&gt;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">   #else</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">      #include &lt;<a class="code" href="win_2_projects_2libsndfile_2sys_2time_8h.html">sys/time.h</a>&gt;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">double</span> gWaveformTimeTotal = 0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordtype">int</span> gWaveformTimeCount = 0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keyword">struct </span><a class="code" href="class_profiler.html">Profiler</a> {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="class_profiler.html#a675ebc9207b9aeace1d967c085abeacf">Profiler</a>()</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#   ifdef __WXMSW__</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         _time64(&amp;tv0);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#   else</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         gettimeofday(&amp;tv0, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="class_profiler.html#a1e6dd8f6cfb15cd5237b971d8f49c749">~Profiler</a>()</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#   ifdef __WXMSW__</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;         _time64(&amp;tv1);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;         <span class="keywordtype">double</span> elapsed = _difftime64(tv1, tv0);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#   else</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         gettimeofday(&amp;tv1, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;         <span class="keywordtype">double</span> elapsed =</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            (tv1.tv_sec + tv1.tv_usec*0.000001) -</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            (tv0.tv_sec + tv0.tv_usec*0.000001);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         gWaveformTimeTotal += elapsed;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         gWaveformTimeCount++;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         wxPrintf(wxT(<span class="stringliteral">&quot;Avg waveform drawing time: %f\n&quot;</span>),</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            gWaveformTimeTotal / gWaveformTimeCount);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#   ifdef __WXMSW__</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      __time64_t tv0, tv1;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keyword">struct </span>timeval tv0, tv1;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   };</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef USE_MIDI</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">const int octaveHeight = 62;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">const int blackPos[5] = { 6, 16, 32, 42, 52 };</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">const int whitePos[7] = { 0, 9, 17, 26, 35, 44, 53 };</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">const int notePos[12] = { 1, 6, 11, 16, 21, 27,</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">                        32, 37, 42, 47, 52, 57 };</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">// map pitch number to window coordinate of the *top* of the note</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">// Note the &quot;free&quot; variable bottom, which is assumed to be a local</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">// variable set to the offset of pitch 0 relative to the window</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">#define IPITCH_TO_Y(t, p) (bottom - ((p) / 12) * octaveHeight - \</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">                          notePos[(p) % 12] - (t)-&gt;GetPitchHeight())</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">// GetBottom is called from a couple of places to compute the hypothetical</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// coordinate of the bottom of pitch 0 in window coordinates. See</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// IPITCH_TO_Y above, which computes coordinates relative to GetBottom()</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">// Note the -NOTE_MARGIN, which leaves a little margin to draw notes that</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">// are out of bounds. I&#39;m not sure why the -2 is necessary.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">int TrackArtist::GetBottom(NoteTrack *t, const wxRect &amp;rect)</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">   int bottomNote = t-&gt;GetBottomNote();</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">   int bottom = rect.y + rect.height - 2 - t-&gt;GetNoteMargin() +</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">          ((bottomNote / 12) * octaveHeight + notePos[bottomNote % 12]);</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">   return bottom;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#endif // USE_MIDI</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="class_track_artist.html#a1523a85e9f5d5400bde1cd3e3fbf3413">  265</a></span>&#160;<a class="code" href="class_track_artist.html#a1523a85e9f5d5400bde1cd3e3fbf3413">TrackArtist::TrackArtist</a>()</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   mInsetLeft   = 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   mInsetTop    = 0;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   mInsetRight  = 0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   mInsetBottom = 0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   mdBrange = <a class="code" href="_g_u_i_settings_8h.html#aa2147fdb6d75c564f0569bc513b022af">ENV_DB_RANGE</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   mShowClipping = <span class="keyword">false</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   UpdatePrefs();</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   SetColours();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   vruler = <span class="keyword">new</span> <a class="code" href="class_ruler.html">Ruler</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="class_track_artist.html#a5e33cdb8a68a1cd9a7381c6b93f4422f">  280</a></span>&#160;<a class="code" href="class_track_artist.html#a5e33cdb8a68a1cd9a7381c6b93f4422f">TrackArtist::~TrackArtist</a>()</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="keyword">delete</span> vruler;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="class_track_artist.html#add49089e256d22507061e90e71841d0c">  285</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#add49089e256d22507061e90e71841d0c">TrackArtist::SetColours</a>()</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( blankBrush,      clrBlank );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( unselectedBrush, clrUnselected);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( selectedBrush,   clrSelected);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( sampleBrush,     clrSample);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( selsampleBrush,  clrSelSample);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( dragsampleBrush, clrDragSample);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">SetBrushColour</a>( blankSelectedBrush, clrBlankSelected);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   blankPen,        clrBlank);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   unselectedPen,   clrUnselected);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   selectedPen,     clrSelected);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   samplePen,       clrSample);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   selsamplePen,    clrSelSample);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   muteSamplePen,   clrMuteSample);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   odProgressDonePen, clrProgressDone);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   odProgressNotYetPen, clrProgressNotYet);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   rmsPen,          clrRms);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   muteRmsPen,      clrMuteRms);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   shadowPen,       clrShadow);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   clippedPen,      clrClipped);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   muteClippedPen,  clrMuteClipped);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">SetPenColour</a>(   blankSelectedPen,clrBlankSelected);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="class_track_artist.html#a7f6b12455815aebb388d9731a85f5740">  311</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#a7f6b12455815aebb388d9731a85f5740">TrackArtist::SetInset</a>(<span class="keywordtype">int</span> left, <span class="keywordtype">int</span> top, <span class="keywordtype">int</span> right, <span class="keywordtype">int</span> bottom)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;{</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   mInsetLeft   = left;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   mInsetTop    = top;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   mInsetRight  = right;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   mInsetBottom = bottom;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="class_track_artist.html#aecb43569c2de2e9e2cae4584ffd80a5f">  319</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#aecb43569c2de2e9e2cae4584ffd80a5f">TrackArtist::DrawTracks</a>(<a class="code" href="class_track_list.html">TrackList</a> * tracks,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                             <a class="code" href="class_track.html">Track</a> * <a class="code" href="seqread_8c.html#ac503262ae470564980711da4f78b1181">start</a>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                             wxDC &amp; dc,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                             wxRegion &amp; reg,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                             wxRect &amp; rect,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                             wxRect &amp; clip,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                             <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                             <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                             <span class="keywordtype">bool</span> drawEnvelope,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                             <span class="keywordtype">bool</span> bigPoints,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                             <span class="keywordtype">bool</span> drawSliders)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   wxRect trackRect = rect;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   wxRect stereoTrackRect;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <a class="code" href="class_track_list_iterator.html">TrackListIterator</a> iter(tracks);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <a class="code" href="class_track.html">Track</a> *<a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordtype">bool</span> hasSolo = <span class="keyword">false</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keywordflow">for</span> (t = iter.<a class="code" href="class_track_list_iterator.html#a81e19731fba5e1b83552aaf36c6f227c">First</a>(); <a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>; t = iter.<a class="code" href="class_track_list_iterator.html#a2f22c9a396a8803881ca6d9784039706">Next</a>()) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#acd2518a3c8c5b82f2a5bd45ce074d781">GetSolo</a>()) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         hasSolo = <span class="keyword">true</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#if defined(DEBUG_CLIENT_AREA)</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="comment">// Change the +0 to +1 or +2 to see the bounding box</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   mInsetLeft = 1+0; mInsetTop = 5+0; mInsetRight = 6+0; mInsetBottom = 2+0;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">// This just shows what the passed in rectangles enclose</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   dc.SetPen(wxColour(*wxGREEN));</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   dc.SetBrush(*wxTRANSPARENT_BRUSH);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   dc.DrawRectangle(rect);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   dc.SetPen(wxColour(*wxBLUE));</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   dc.SetBrush(*wxTRANSPARENT_BRUSH);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   dc.DrawRectangle(clip);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <a class="code" href="_prefs_8cpp.html#a605d9511ac8da26b177c7362d7f8dc82">gPrefs</a>-&gt;Read(wxT(<span class="stringliteral">&quot;/GUI/ShowTrackNameInWaveform&quot;</span>), &amp;mbShowTrackNameInWaveform, <span class="keyword">false</span>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   t = iter.<a class="code" href="class_track_list_iterator.html#a4eea44fac9add00ff978213df1652441">StartWith</a>(start);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="keywordflow">while</span> (t) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      trackRect.y = t-&gt;<a class="code" href="class_track.html#adefbd93c6cbde70d082a64729cfc74d8">GetY</a>() - zoomInfo.<a class="code" href="class_zoom_info.html#ae96b54cadf85fe96e933a6af9edbd660">vpos</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      trackRect.height = t-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">if</span> (trackRect.y &gt; clip.GetBottom() &amp;&amp; !t-&gt;<a class="code" href="class_track.html#abe5a26d73a2beddbacd19a39f4286fb2">GetLinked</a>()) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#if defined(DEBUG_CLIENT_AREA)</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">// Filled rectangle to show the interior of the client area</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      wxRect zr = trackRect;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      zr.x+=1; zr.y+=5; zr.width-=7; zr.height-=7;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      dc.SetPen(*wxCYAN_PEN);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      dc.SetBrush(*wxRED_BRUSH);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      dc.DrawRectangle(zr);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      stereoTrackRect = trackRect;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// For various reasons, the code will break if we display one</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="comment">// of a stereo pair of tracks but not the other - for example,</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// if you try to edit the envelope of one track when its linked</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">// pair is off the screen, then it won&#39;t be able to edit the</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">// offscreen envelope.  So we compute the rect of the track and</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="comment">// its linked partner, and see if any part of that rect is on-screen.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">// If so, we draw both.  Otherwise, we can safely draw neither.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="class_track.html">Track</a> *link = t-&gt;<a class="code" href="class_track.html#afafc93348a2d442bf956fa072d3d769b">GetLink</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">if</span> (link) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;         <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#abe5a26d73a2beddbacd19a39f4286fb2">GetLinked</a>()) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="comment">// If we&#39;re the first track</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            stereoTrackRect.height += link-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;         }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">// We&#39;re the second of two</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            stereoTrackRect.y -= link-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            stereoTrackRect.height += link-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span>(MONO_WAVE_PAN(t)){</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         stereoTrackRect.height += t-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         t-&gt;SetVirtualStereo(<span class="keyword">false</span>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">if</span> (stereoTrackRect.Intersects(clip) &amp;&amp; reg.Contains(stereoTrackRect)) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;         wxRect rr = trackRect;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         rr.x += mInsetLeft;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;         rr.y += mInsetTop;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         rr.width -= (mInsetLeft + mInsetRight);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         rr.height -= (mInsetTop + mInsetBottom);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         DrawTrack(t, dc, rr,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                   selectedRegion, zoomInfo,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                   drawEnvelope, bigPoints, drawSliders, hasSolo);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">if</span>(MONO_WAVE_PAN(t)){</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;         trackRect.y = t-&gt;<a class="code" href="class_track.html#adefbd93c6cbde70d082a64729cfc74d8">GetY</a>(<span class="keyword">true</span>) - zoomInfo.<a class="code" href="class_zoom_info.html#ae96b54cadf85fe96e933a6af9edbd660">vpos</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         trackRect.height = t-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         stereoTrackRect = trackRect;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;         stereoTrackRect.y -= t-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         stereoTrackRect.height += t-&gt;<a class="code" href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">GetHeight</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;         t-&gt;SetVirtualStereo(<span class="keyword">true</span>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         <span class="keywordflow">if</span> (stereoTrackRect.Intersects(clip) &amp;&amp; reg.Contains(stereoTrackRect)) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            wxRect rr = trackRect;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            rr.x += mInsetLeft;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            rr.y += mInsetTop;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            rr.width -= (mInsetLeft + mInsetRight);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            rr.height -= (mInsetTop + mInsetBottom);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            DrawTrack(t, dc, rr, zoomInfo,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                      drawEnvelope, bigPoints, drawSliders, hasSolo);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      t = iter.<a class="code" href="class_track_list_iterator.html#a2f22c9a396a8803881ca6d9784039706">Next</a>();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="class_track_artist.html#a2dc63db7d889371b5f00be926b05c387">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#a2dc63db7d889371b5f00be926b05c387">TrackArtist::DrawTrack</a>(<span class="keyword">const</span> <a class="code" href="class_track.html">Track</a> * <a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                            wxDC &amp; dc,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                            <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                            <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                            <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                            <span class="keywordtype">bool</span> drawEnvelope,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                            <span class="keywordtype">bool</span> bigPoints,</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                            <span class="keywordtype">bool</span> drawSliders,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                            <span class="keywordtype">bool</span> hasSolo)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordflow">switch</span> (t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>()) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efab39033be088537a007532668cb6d16a8">Track::Wave</a>:</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="class_wave_track.html">WaveTrack</a>* wt = (<a class="code" href="class_wave_track.html">WaveTrack</a>*)t;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">for</span> (WaveClipList::compatibility_iterator <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>=wt-&gt;<a class="code" href="class_wave_track.html#a40a351c828128e85e2ba993107b96ef3">GetClipIterator</a>(); <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>; <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>=<a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetNext()) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetData()-&gt;ClearDisplayRect();</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordtype">bool</span> muted = (hasSolo || t-&gt;<a class="code" href="class_track.html#aebabe796d0b3222ef7d23ae13a62769b">GetMute</a>()) &amp;&amp; !t-&gt;<a class="code" href="class_track.html#acd2518a3c8c5b82f2a5bd45ce074d781">GetSolo</a>();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#if defined(__WXMAC__)</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      wxAntialiasMode aamode = dc.GetGraphicsContext()-&gt;GetAntialiasMode();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      dc.GetGraphicsContext()-&gt;SetAntialiasMode(wxANTIALIAS_NONE);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">switch</span> (wt-&gt;<a class="code" href="class_wave_track.html#a93e8da76e3495f28b5e17518016f9c9f">GetDisplay</a>()) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5aeef9a24216b729762bfd38161b5b2a83">WaveTrack::Waveform</a>:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         DrawWaveform(wt, dc, rect, selectedRegion, zoomInfo,</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                      drawEnvelope,  bigPoints, drawSliders, muted);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5ac0941a4c239c9e4a1d487f31786fbbc9">WaveTrack::Spectrum</a>:</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         DrawSpectrum(wt, dc, rect, selectedRegion, zoomInfo);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         wxASSERT(<span class="keyword">false</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#if defined(__WXMAC__)</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      dc.GetGraphicsContext()-&gt;SetAntialiasMode(aamode);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">if</span> (mbShowTrackNameInWaveform &amp;&amp;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;          <span class="comment">// Exclude right channel of stereo track </span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          !(!wt-&gt;<a class="code" href="class_track.html#abe5a26d73a2beddbacd19a39f4286fb2">GetLinked</a>() &amp;&amp; wt-&gt;<a class="code" href="class_track.html#afafc93348a2d442bf956fa072d3d769b">GetLink</a>())) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;         wxFont labelFont(12, wxSWISS, wxNORMAL, wxNORMAL);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;         dc.SetFont(labelFont);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         dc.SetTextForeground(wxColour(255, 255, 0));</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         dc.DrawText (wt-&gt;<a class="code" href="class_track.html#a670b88686f99e151d6a305a709f130b1">GetName</a>(), rect.x+10, rect.y);  <span class="comment">// move right 10 pixels to avoid overwriting &lt;- symbol</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">break</span>;              <span class="comment">// case Wave</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">   #ifdef USE_MIDI</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keywordflow">case</span> Track::Note:</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordtype">bool</span> muted = (hasSolo || t-&gt;<a class="code" href="class_track.html#aebabe796d0b3222ef7d23ae13a62769b">GetMute</a>()) &amp;&amp; !t-&gt;<a class="code" href="class_track.html#acd2518a3c8c5b82f2a5bd45ce074d781">GetSolo</a>();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      DrawNoteTrack((<a class="code" href="class_note_track.html">NoteTrack</a> *)t, dc, rect, selectedRegion, zoomInfo, muted);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">   #endif // USE_MIDI</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efaaa103f3467e47ffcb1aa408d53f7bf6e">Track::Label</a>:</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      DrawLabelTrack((<a class="code" href="class_label_track.html">LabelTrack</a> *)t, dc, rect, selectedRegion, zoomInfo);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efa2348e03ba06177fe4dbcf87e27d82e33">Track::Time</a>:</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      DrawTimeTrack((<a class="code" href="class_time_track.html">TimeTrack</a> *)t, dc, rect, zoomInfo);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="class_track_artist.html#aa5b19d1f05fa5297ed4a97c179a3b658">  509</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#aa5b19d1f05fa5297ed4a97c179a3b658">TrackArtist::DrawVRuler</a>(<span class="keyword">const</span> <a class="code" href="class_track.html">Track</a> *<a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>, wxDC * dc, wxRect &amp; rect)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;{</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keywordtype">int</span> kind = t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">// Label and Time tracks do not have a vruler</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">// But give it a beveled area</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordflow">if</span> (kind == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efaaa103f3467e47ffcb1aa408d53f7bf6e">Track::Label</a>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      wxRect bev = rect;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      bev.Inflate(-1, 0);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      bev.width += 1;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="class_a_color.html#a9113deb34fdd4021fefe975070b6d2e1">AColor::BevelTrackInfo</a>(*dc, <span class="keyword">true</span>, bev);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="comment">// Time tracks</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keywordflow">if</span> (kind == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efa2348e03ba06177fe4dbcf87e27d82e33">Track::Time</a>) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      wxRect bev = rect;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      bev.Inflate(-1, 0);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      bev.width += 1;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <a class="code" href="class_a_color.html#a9113deb34fdd4021fefe975070b6d2e1">AColor::BevelTrackInfo</a>(*dc, <span class="keyword">true</span>, bev);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">// Right align the ruler</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      wxRect rr = rect;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      rr.width--;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.GetWidth() &lt; rect.GetWidth()) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <span class="keywordtype">int</span> adj = rr.GetWidth() - t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.GetWidth();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         rr.x += adj;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;         rr.width -= adj;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      UpdateVRuler(t, rr);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      vruler-&gt;Draw(*dc);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">// All waves have a ruler in the info panel</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="comment">// The ruler needs a bevelled surround.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">if</span> (kind == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efab39033be088537a007532668cb6d16a8">Track::Wave</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      wxRect bev = rect;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      bev.Inflate(-1, 0);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      bev.width += 1;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <a class="code" href="class_a_color.html#a9113deb34fdd4021fefe975070b6d2e1">AColor::BevelTrackInfo</a>(*dc, <span class="keyword">true</span>, bev);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="comment">// Right align the ruler</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      wxRect rr = rect;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      rr.width--;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.GetWidth() &lt; rect.GetWidth()) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         <span class="keywordtype">int</span> adj = rr.GetWidth() - t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.GetWidth();</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;         rr.x += adj;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         rr.width -= adj;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      UpdateVRuler(t, rr);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      vruler-&gt;Draw(*dc);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#ifdef USE_MIDI</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="comment">// The note track draws a vertical keyboard to label pitches</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keywordflow">if</span> (kind == Track::Note) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      UpdateVRuler(t, rect);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      dc-&gt;SetPen(*wxTRANSPARENT_PEN);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      dc-&gt;SetBrush(*wxWHITE_BRUSH);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      wxRect bev = rect;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      bev.x++;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      bev.width--;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      dc-&gt;DrawRectangle(bev);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      rect.y += 1;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      rect.height -= 1;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="comment">//int bottom = GetBottom((NoteTrack *) t, rect);</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_note_track.html">NoteTrack</a> *track = (<a class="code" href="class_note_track.html">NoteTrack</a> *) t;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      track-&gt;PrepareIPitchToY(rect);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      wxPen hilitePen;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      hilitePen.SetColour(120, 120, 120);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      wxBrush blackKeyBrush;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      blackKeyBrush.SetColour(70, 70, 70);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      dc-&gt;SetBrush(blackKeyBrush);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordtype">int</span> fontSize = 10;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#ifdef __WXMSW__</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      fontSize = 8;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      wxFont labelFont(fontSize, wxSWISS, wxNORMAL, wxNORMAL);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      dc-&gt;SetFont(labelFont);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordtype">int</span> octave = 0;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">int</span> obottom = track-&gt;GetOctaveBottom(octave);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordtype">int</span> marg = track-&gt;GetNoteMargin();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">//IPITCH_TO_Y(octave * 12) + PITCH_HEIGHT + 1;</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">while</span> (obottom &gt;= rect.y) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         dc-&gt;SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> white = 0; white &lt; 7; white++) {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordtype">int</span> pos = track-&gt;GetWhitePos(white);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">if</span> (obottom - pos &gt; rect.y + marg + 1 &amp;&amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="comment">// don&#39;t draw too close to margin line -- it&#39;s annoying</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                obottom - pos &lt; rect.y + rect.height - marg - 3)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;               <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(*dc, rect.x, obottom - pos,</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            rect.x + rect.width, obottom - pos);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;         }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;         wxRect br = rect;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;         br.height = track-&gt;GetPitchHeight();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;         br.x++;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;         br.width = 17;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> black = 0; black &lt; 5; black++) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            br.y = obottom - track-&gt;GetBlackPos(black);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordflow">if</span> (br.y &gt; rect.y + marg - 2 &amp;&amp; br.y + br.height &lt; rect.y + rect.height - marg) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;               dc-&gt;SetPen(hilitePen);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;               dc-&gt;DrawRectangle(br);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;               dc-&gt;SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;               <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(*dc,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                            br.x + 1, br.y + br.height - 1,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            br.x + br.width - 1, br.y + br.height - 1);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;               <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(*dc,</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                            br.x + br.width - 1, br.y + 1,</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                            br.x + br.width - 1, br.y + br.height - 1);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         <span class="keywordflow">if</span> (octave &gt;= 1 &amp;&amp; octave &lt;= 10) {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            wxString <a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="comment">// ISO standard: A440 is in the 4th octave, denoted</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">// A4 &lt;- the &quot;4&quot; should be a subscript.</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            s.Printf(wxT(<span class="stringliteral">&quot;C%d&quot;</span>), octave - 1);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            wxCoord width, height;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            dc-&gt;GetTextExtent(s, &amp;width, &amp;height);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">if</span> (obottom - height + 4 &gt; rect.y &amp;&amp;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                obottom + 4 &lt; rect.y + rect.height) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;               dc-&gt;SetTextForeground(wxColour(60, 60, 255));</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;               dc-&gt;DrawText(s, rect.x + rect.width - width,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                            obottom - height + 2);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;         }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         obottom = track-&gt;GetOctaveBottom(++octave);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">// draw lines delineating the out-of-bounds margins</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      dc-&gt;SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="comment">// you would think the -1 offset here should be -2 to match the</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">// adjustment to rect.y (see above), but -1 produces correct output</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(*dc, rect.x, rect.y + marg - 1, rect.x + rect.width, rect.y + marg - 1);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">// since the margin gives us the bottom of the line,</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// the extra -1 gets us to the top</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(*dc, rect.x, rect.y + rect.height - marg - 1,</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        rect.x + rect.width, rect.y + rect.height - marg - 1);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#endif // USE_MIDI</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="class_track_artist.html#a12b902fc290c08e21ce0646f21dae146">  669</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#a12b902fc290c08e21ce0646f21dae146">TrackArtist::UpdateVRuler</a>(<span class="keyword">const</span> <a class="code" href="class_track.html">Track</a> *<a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>, wxRect &amp; rect)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;{</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <span class="comment">// Label tracks do not have a vruler</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>() == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efaaa103f3467e47ffcb1aa408d53f7bf6e">Track::Label</a>) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="comment">// Time tracks</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>() == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efa2348e03ba06177fe4dbcf87e27d82e33">Track::Time</a>) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_time_track.html">TimeTrack</a> *tt = (<a class="code" href="class_time_track.html">TimeTrack</a> *)t;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">float</span> <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>, <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      min = tt-&gt;<a class="code" href="class_time_track.html#a4b1f56611ba90a95691a0b47107e4d22">GetRangeLower</a>() * 100.0;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      max = tt-&gt;<a class="code" href="class_time_track.html#a8d16c30d6a49657b1e3125ba16a3fae8">GetRangeUpper</a>() * 100.0;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      vruler-&gt;SetBounds(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height-1);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      vruler-&gt;SetRange(max, min);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      vruler-&gt;SetFormat((tt-&gt;<a class="code" href="class_time_track.html#abae5d14db9f5a3f3ffc6c6c99278ed3a">GetDisplayLog</a>()) ? <a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198ae827b2a3942fcd4e249908e9661e40c7">Ruler::RealLogFormat</a> : <a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aad1375df5e28b7c8146f9f6cfb1c25c6">Ruler::RealFormat</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      vruler-&gt;SetLabelEdges(<span class="keyword">false</span>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      vruler-&gt;SetLog(tt-&gt;<a class="code" href="class_time_track.html#abae5d14db9f5a3f3ffc6c6c99278ed3a">GetDisplayLog</a>());</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="comment">// All waves have a ruler in the info panel</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <span class="comment">// The ruler needs a bevelled surround.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>() == <a class="code" href="class_track.html#a4a6604845139575dfc25be299aeb60efab39033be088537a007532668cb6d16a8">Track::Wave</a>) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *wt = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_wave_track.html">WaveTrack</a>*<span class="keyword">&gt;</span>(<a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span> dBRange =</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;         wt-&gt;<a class="code" href="class_wave_track.html#a10c50123dc26cba66469b011c1852047">GetWaveformSettings</a>().<a class="code" href="class_waveform_settings.html#a97217e305f6eb7ead4452924fec4029d">dBRange</a>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> display = wt-&gt;<a class="code" href="class_wave_track.html#a93e8da76e3495f28b5e17518016f9c9f">GetDisplay</a>();</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">if</span> (display == <a class="code" href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5aeef9a24216b729762bfd38161b5b2a83">WaveTrack::Waveform</a>) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;         <a class="code" href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4">WaveformSettings::ScaleType</a> scaleType =</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            wt-&gt;<a class="code" href="class_wave_track.html#a10c50123dc26cba66469b011c1852047">GetWaveformSettings</a>().<a class="code" href="class_waveform_settings.html#a6866a0a302099ef5fcd4fb60cba946cd">scaleType</a>;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;         <span class="keywordflow">if</span> (scaleType == <a class="code" href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4a54fba21bb1212c84ffd56a4f510bc8dc">WaveformSettings::stLinear</a>) {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="comment">// Waveform</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordtype">float</span> <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>, <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            wt-&gt;<a class="code" href="class_wave_track.html#aebb4cac69620ce02b4f396fb37d23f82">GetDisplayBounds</a>(&amp;min, &amp;max);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">if</span> (wt-&gt;<a class="code" href="class_wave_track.html#ab82fb513c3fba956467adc8a8d55b4b8">GetLastScaleType</a>() != scaleType &amp;&amp;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                wt-&gt;<a class="code" href="class_wave_track.html#ab82fb513c3fba956467adc8a8d55b4b8">GetLastScaleType</a>() != -1)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;               <span class="comment">// do a translation into the linear space</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#a0692506243ea687501faddd0e767124e">SetLastScaleType</a>();</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#a9223604210ecf46c9238f43a715ab5f3">SetLastdBRange</a>();</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;               <span class="keywordtype">float</span> sign = (min &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;               <span class="keywordflow">if</span> (min != 0.) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                  min = <a class="code" href="_audacity_8h.html#ae65fedb390ed942548ca02213e6a2813">DB_TO_LINEAR</a>(fabs(min) * dBRange - dBRange);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                  <span class="keywordflow">if</span> (min &lt; 0.0)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                     min = 0.0;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                  min *= sign;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;               }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;               sign = (max &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;               <span class="keywordflow">if</span> (max != 0.) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  max = <a class="code" href="_audacity_8h.html#ae65fedb390ed942548ca02213e6a2813">DB_TO_LINEAR</a>(fabs(max) * dBRange - dBRange);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  <span class="keywordflow">if</span> (max &lt; 0.0)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                     max = 0.0;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                  max *= sign;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;               }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#aaf6f597255538feaf1017d046993445c">SetDisplayBounds</a>(min, max);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            vruler-&gt;SetBounds(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height - 1);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            vruler-&gt;SetRange(max, min);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            vruler-&gt;SetFormat(<a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aad1375df5e28b7c8146f9f6cfb1c25c6">Ruler::RealFormat</a>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            vruler-&gt;SetLabelEdges(<span class="keyword">false</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            vruler-&gt;SetLog(<span class="keyword">false</span>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;         }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            wxASSERT(scaleType == <a class="code" href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4a2e6fe9dffc2c1d6bbcfaaee36df90f68">WaveformSettings::stLogarithmic</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            scaleType = <a class="code" href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4a2e6fe9dffc2c1d6bbcfaaee36df90f68">WaveformSettings::stLogarithmic</a>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordtype">float</span> <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>, <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            wt-&gt;<a class="code" href="class_wave_track.html#aebb4cac69620ce02b4f396fb37d23f82">GetDisplayBounds</a>(&amp;min, &amp;max);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keywordtype">float</span> lastdBRange;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">if</span> (wt-&gt;<a class="code" href="class_wave_track.html#ab82fb513c3fba956467adc8a8d55b4b8">GetLastScaleType</a>() != scaleType &amp;&amp;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                wt-&gt;<a class="code" href="class_wave_track.html#ab82fb513c3fba956467adc8a8d55b4b8">GetLastScaleType</a>() != -1)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;               <span class="comment">// do a translation into the dB space</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#a0692506243ea687501faddd0e767124e">SetLastScaleType</a>();</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#a9223604210ecf46c9238f43a715ab5f3">SetLastdBRange</a>();</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;               <span class="keywordtype">float</span> sign = (min &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;               <span class="keywordflow">if</span> (min != 0.) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                  min = (<a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(fabs(min)) + dBRange) / dBRange;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                  <span class="keywordflow">if</span> (min &lt; 0.0)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                     min = 0.0;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                  min *= sign;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;               }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;               sign = (max &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;               <span class="keywordflow">if</span> (max != 0.) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                  max = (<a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(fabs(max)) + dBRange) / dBRange;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                  <span class="keywordflow">if</span> (max &lt; 0.0)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                     max = 0.0;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                  max *= sign;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;               }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#aaf6f597255538feaf1017d046993445c">SetDisplayBounds</a>(min, max);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dBRange != (lastdBRange = wt-&gt;<a class="code" href="class_wave_track.html#a3b73b4b1c0c422cc1b3363757f4ecb07">GetLastdBRange</a>())) {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#a9223604210ecf46c9238f43a715ab5f3">SetLastdBRange</a>();</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;               <span class="comment">// Remap the max of the scale</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">float</span> sign = (max &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;               <span class="keywordtype">float</span> newMax = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;               <span class="keywordflow">if</span> (max != 0.) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">// Ugh, duplicating from TrackPanel.cpp</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">#define ZOOMLIMIT 0.001f</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">float</span> extreme = <a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(2);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                  <span class="comment">// recover dB value of max</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">float</span> dB = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(extreme, (<span class="keywordtype">float</span>(fabs(max)) * lastdBRange - lastdBRange));</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  <span class="comment">// find NEW scale position, but old max may get trimmed if the db limit rises</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  <span class="comment">// Don&#39;t trim it to zero though, but leave max and limit distinct</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  newMax = sign * <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(<a class="code" href="_track_artist_8cpp.html#a0535b2c11fb2d31bddd10dd8f33ed2e8">ZOOMLIMIT</a>, (dBRange + dB) / dBRange);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                  <span class="comment">// Adjust the min of the scale if we can,</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                  <span class="comment">// so the db Limit remains where it was on screen, but don&#39;t violate extremes</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                  <span class="keywordflow">if</span> (min != 0.)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                     min = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(-extreme, newMax * min / max);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;               }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;               wt-&gt;<a class="code" href="class_wave_track.html#aaf6f597255538feaf1017d046993445c">SetDisplayBounds</a>(min, newMax);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> (max &gt; 0) {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;               <span class="keywordtype">int</span> top = 0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               <span class="keywordtype">float</span> topval = 0;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;               <span class="keywordtype">int</span> bot = rect.height;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;               <span class="keywordtype">float</span> botval = -dBRange;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;               <span class="keywordflow">if</span> (min &lt; 0) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                  bot = top + (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((max / (max - min))*(bot - top));</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                  min = 0;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;               }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;               <span class="keywordflow">if</span> (max &gt; 1) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                  top += (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((max - 1) / (max - <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>) * (bot - top));</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                  max = 1;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;               }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;               <span class="keywordflow">if</span> (max &lt; 1 &amp;&amp; max &gt; 0)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                  topval = -((1 - <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>) * dBRange);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;               <span class="keywordflow">if</span> (min &gt; 0) {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                  botval = -((1 - <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>) * dBRange);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;               }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;               vruler-&gt;SetBounds(rect.x, rect.y + top, rect.x + rect.width, rect.y + bot - 1);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;               vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;               vruler-&gt;SetRange(topval, botval);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;               vruler-&gt;SetBounds(0.0, 0.0, 0.0, 0.0); <span class="comment">// A.C.H I couldn&#39;t find a way to just disable it?</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            vruler-&gt;SetFormat(<a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198ae827b2a3942fcd4e249908e9661e40c7">Ruler::RealLogFormat</a>);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            vruler-&gt;SetLabelEdges(<span class="keyword">true</span>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            vruler-&gt;SetLog(<span class="keyword">false</span>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;         }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;         wxASSERT(display == <a class="code" href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5ac0941a4c239c9e4a1d487f31786fbbc9">WaveTrack::Spectrum</a>);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;         <span class="keyword">const</span> <a class="code" href="class_spectrogram_settings.html">SpectrogramSettings</a> &amp;settings = wt-&gt;<a class="code" href="class_wave_track.html#a54f8ed0c9c1d1fae0241867565b33512">GetSpectrogramSettings</a>();</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         <span class="keywordtype">float</span> minFreq, maxFreq;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;         wt-&gt;<a class="code" href="class_wave_track.html#a6c31cef06f382857502ce036b2dc795b">GetSpectrumBounds</a>(&amp;minFreq, &amp;maxFreq);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         <span class="keywordflow">switch</span> (settings.<a class="code" href="class_spectrogram_settings.html#a8c6871ffc9d2f3f645e9d14c24920e04">scaleType</a>) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            wxASSERT(<span class="keyword">false</span>);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca409b06214bb9e020d4252d6981947acf">SpectrogramSettings::stLinear</a>:</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;         {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="comment">// Spectrum</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span> (rect.height &lt; 60)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;               <span class="keywordflow">return</span>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">            draw the ruler</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">            we will use Hz if maxFreq is &lt; 2000, otherwise we represent kHz,</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">            and append to the numbers a &quot;k&quot;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            vruler-&gt;SetBounds(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height - 1);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            vruler-&gt;SetFormat(<a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aad1375df5e28b7c8146f9f6cfb1c25c6">Ruler::RealFormat</a>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            vruler-&gt;SetLabelEdges(<span class="keyword">true</span>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="comment">// use kHz in scale, if appropriate</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">if</span> (maxFreq &gt;= 2000) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;               vruler-&gt;SetRange((maxFreq / 1000.), (minFreq / 1000.));</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;               vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;k&quot;</span>));</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;               <span class="comment">// use Hz</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;               vruler-&gt;SetRange(<span class="keywordtype">int</span>(maxFreq), <span class="keywordtype">int</span>(minFreq));</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            vruler-&gt;SetLog(<span class="keyword">false</span>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;         }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca5c62f4c050d024a9d5651292713dc49d">SpectrogramSettings::stLogarithmic</a>:</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca5a24e86be9af1c36d900f07be7a14354">SpectrogramSettings::stMel</a>:</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca05863539deaa0612d40abbca4f3c4cc6">SpectrogramSettings::stBark</a>:</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca413649f9f64d50a2b56f44743d22f8cc">SpectrogramSettings::stErb</a>:</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fcaee4c3c5d4de31bbe5faa2a7b62d73260">SpectrogramSettings::stPeriod</a>:</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;         {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="comment">// SpectrumLog</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> (rect.height &lt; 10)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;               <span class="keywordflow">return</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">            draw the ruler</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">            we will use Hz if maxFreq is &lt; 2000, otherwise we represent kHz,</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">            and append to the numbers a &quot;k&quot;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            vruler-&gt;SetBounds(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height - 1);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            vruler-&gt;SetFormat(<a class="code" href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aba68a1adce860f0e30519cfc2b280272">Ruler::IntFormat</a>);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            vruler-&gt;SetLabelEdges(<span class="keyword">true</span>);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            vruler-&gt;SetRange(maxFreq, minFreq);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            vruler-&gt;SetUnits(wxT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            vruler-&gt;SetLog(<span class="keyword">true</span>);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="class_number_scale.html">NumberScale</a> <a class="code" href="seqread_8c.html#aa2a8c6fbe5ed24f9523eb4e01368e4bc">scale</a></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;               (wt-&gt;<a class="code" href="class_wave_track.html#a54f8ed0c9c1d1fae0241867565b33512">GetSpectrogramSettings</a>().<a class="code" href="class_spectrogram_settings.html#aa0c8fbbe53db1ede59a834438a3ee375">GetScale</a></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                  (minFreq, maxFreq, wt-&gt;<a class="code" href="class_wave_track.html#a18bbe6e1bb4b1016c3a3de835c33b8fa">GetRate</a>(), <span class="keyword">false</span>).Reversal());</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            vruler-&gt;SetNumberScale(&amp;<a class="code" href="seqread_8c.html#aa2a8c6fbe5ed24f9523eb4e01368e4bc">scale</a>);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor">#ifdef USE_MIDI</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   <span class="comment">// The note track isn&#39;t drawing a ruler at all!</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="comment">// But it needs to!</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t-&gt;<a class="code" href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">GetKind</a>() == Track::Note) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      vruler-&gt;SetBounds(rect.x, rect.y, rect.x + 1, rect.y + rect.height-1);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      vruler-&gt;SetOrientation(wxVERTICAL);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#endif // USE_MIDI</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   vruler-&gt;GetMaxSize(&amp;t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.x, &amp;t-&gt;<a class="code" href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">vrulerSize</a>.y);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;}</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="_track_artist_8h.html#a00fc87b63f1436536d3090852d57f810">  922</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(<span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>, <span class="keywordtype">float</span> <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>, <span class="keywordtype">float</span> <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>,</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <span class="keywordtype">int</span> height, <span class="keywordtype">bool</span> dB, <span class="keywordtype">bool</span> outer,</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="keywordtype">float</span> dBr, <span class="keywordtype">bool</span> clip)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;{</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <span class="keywordflow">if</span> (dB) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (height == 0) {</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordtype">float</span> sign = (value &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordflow">if</span> (value != 0.) {</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <span class="keywordtype">float</span> db = <a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(fabs(value));</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         value = (db + dBr) / dBr;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         <span class="keywordflow">if</span> (!outer) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            value -= 0.5;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         <span class="keywordflow">if</span> (value &lt; 0.0) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            value = 0.0;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;         }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;         value *= sign;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">if</span> (!outer) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;         <span class="keywordflow">if</span> (value &gt;= 0.0) {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            value -= 0.5;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;         }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            value += 0.5;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;         }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordflow">if</span> (clip) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">if</span> (value &lt; min) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         value = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordflow">if</span> (value &gt; max) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         value = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   value = (max - <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>) / (max - min);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) (value * (height - 1) + 0.5);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="_track_artist_8h.html#a0d34e48dcb47d4a36c7bca106d510fd7">  969</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_track_artist_8cpp.html#a0d34e48dcb47d4a36c7bca106d510fd7">FromDB</a>(<span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>, <span class="keywordtype">double</span> dBRange)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;{</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <span class="keywordflow">if</span> (value == 0)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <span class="keywordtype">double</span> sign = (value &gt;= 0 ? 1 : -1);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="_audacity_8h.html#ae65fedb390ed942548ca02213e6a2813">DB_TO_LINEAR</a>((fabs(value) * dBRange) - dBRange) * sign;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno"><a class="line" href="_track_artist_8h.html#ae9fe7afff0bfbea92663e8a2c0ecf0cb">  978</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_track_artist_8cpp.html#ae9fe7afff0bfbea92663e8a2c0ecf0cb">ValueOfPixel</a>(<span class="keywordtype">int</span> yy, <span class="keywordtype">int</span> height, <span class="keywordtype">bool</span> <a class="code" href="layer12_8c.html#a33d71f23ba2052d17f0b754dc35265b0">offset</a>,</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordtype">bool</span> dB, <span class="keywordtype">double</span> dBRange, <span class="keywordtype">float</span> zoomMin, <span class="keywordtype">float</span> zoomMax)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;{</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   wxASSERT(height &gt; 0);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="comment">// Map 0 to max and height - 1 (not height) to min</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   <span class="keywordtype">float</span> v =</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      height == 1 ? (zoomMin + zoomMax) / 2 :</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      zoomMax - (yy / (<span class="keywordtype">float</span>)(height - 1)) * (zoomMax - zoomMin);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <span class="keywordflow">if</span> (offset) {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span> (v &gt; 0.0)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         v += .5;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         v -= .5;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <span class="keywordflow">if</span> (dB)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      v = <a class="code" href="_track_artist_8cpp.html#a0d34e48dcb47d4a36c7bca106d510fd7">FromDB</a>(v, dBRange);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <span class="keywordflow">return</span> v;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawNegativeOffsetTrackArrows(wxDC &amp;dc, <span class="keyword">const</span> wxRect &amp;rect)</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;{</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="comment">// Draws two black arrows on the left side of the track to</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   <span class="comment">// indicate the user that the track has been time-shifted</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   <span class="comment">// to the left beyond t=0.0.</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                rect.x + 2, rect.y + 6,</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                rect.x + 8, rect.y + 6);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                rect.x + 2, rect.y + 6,</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                rect.x + 6, rect.y + 2);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                rect.x + 2, rect.y + 6,</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                rect.x + 6, rect.y + 10);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                rect.x + 2, rect.y + rect.height - 8,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                rect.x + 8, rect.y + rect.height - 8);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                rect.x + 2, rect.y + rect.height - 8,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                rect.x + 6, rect.y + rect.height - 4);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                rect.x + 2, rect.y + rect.height - 8,</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                rect.x + 6, rect.y + rect.height - 12);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawWaveformBackground(wxDC &amp;dc, <span class="keywordtype">int</span> leftOffset, <span class="keyword">const</span> wxRect &amp;rect,</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">double</span> env[],</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                         <span class="keywordtype">float</span> zoomMin, <span class="keywordtype">float</span> zoomMax,</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                         <span class="keywordtype">bool</span> dB, <span class="keywordtype">float</span> dBRange,</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                         <span class="keywordtype">double</span> t0, <span class="keywordtype">double</span> t1,</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                         <span class="keywordtype">bool</span> drawEnvelope, <span class="keywordtype">bool</span> bIsSyncLockSelected)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;{</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   <span class="comment">// Visually (one vertical slice of the waveform background, on its side;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="comment">// the &quot;*&quot; is the actual waveform background we&#39;re drawing</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   <span class="comment">//1.0                              0.0                             -1.0</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="comment">// |--------------------------------|--------------------------------|</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="comment">//      ***************                           ***************</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="comment">//      |             |                           |             |</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="comment">//    maxtop        maxbot                      mintop        minbot</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordtype">int</span> h = rect.height;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <span class="keywordtype">int</span> halfHeight = wxMax(h / 2, 1);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <span class="keywordtype">int</span> maxtop, lmaxtop = 0;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;   <span class="keywordtype">int</span> mintop, lmintop = 0;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <span class="keywordtype">int</span> maxbot, lmaxbot = 0;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   <span class="keywordtype">int</span> minbot, lminbot = 0;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="keywordtype">bool</span> sel, lsel = <span class="keyword">false</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <span class="keywordtype">int</span> xx, lx = 0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="layer3_8c.html#a741dbb4d8e78c3cb69915db7282fcec0">l</a>, w;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   dc.SetPen(*wxTRANSPARENT_PEN);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   dc.SetBrush(blankBrush);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   dc.DrawRectangle(rect);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespacepyportmidi_1_1midi.html#ad2426758f88d23d7208984d5c99ec050">time</a> = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(0, -leftOffset), nextTime;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   <span class="keywordflow">for</span> (xx = 0; xx &lt; rect.width; ++xx, time = nextTime) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      nextTime = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(xx + 1, -leftOffset);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="comment">// First we compute the truncated shape of the waveform background.</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="comment">// If drawEnvelope is true, then we compute the lower border of the</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">// envelope.</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      maxtop = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(env[xx], zoomMin, zoomMax,</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                               h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      maxbot = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(env[xx], zoomMin, zoomMax,</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                               h, dB, <span class="keyword">false</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      mintop = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-env[xx], zoomMin, zoomMax,</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                               h, dB, <span class="keyword">false</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      minbot = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-env[xx], zoomMin, zoomMax,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                               h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">// Make sure it&#39;s odd so that a that max and min mirror each other</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      mintop +=1;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      minbot +=1;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="keywordflow">if</span> (!drawEnvelope || maxbot &gt; mintop) {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;         maxbot = halfHeight;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         mintop = halfHeight;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="comment">// We don&#39;t draw selection color for sync-lock selected tracks.</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      sel = (t0 &lt;= time &amp;&amp; nextTime &lt; t1) &amp;&amp; !bIsSyncLockSelected;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">if</span> (lmaxtop == maxtop &amp;&amp;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          lmintop == mintop &amp;&amp;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;          lmaxbot == maxbot &amp;&amp;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          lminbot == minbot &amp;&amp;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;          lsel == sel) {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      dc.SetBrush(lsel ? selectedBrush : unselectedBrush);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      l = rect.x + lx;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      w = xx - lx;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <span class="keywordflow">if</span> (lmaxbot &lt; lmintop - 1) {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;         dc.DrawRectangle(l, rect.y + lmaxtop, w, lmaxbot - lmaxtop);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         dc.DrawRectangle(l, rect.y + lmintop, w, lminbot - lmintop);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         dc.DrawRectangle(l, rect.y + lmaxtop, w, lminbot - lmaxtop);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      lmaxtop = maxtop;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      lmintop = mintop;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      lmaxbot = maxbot;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      lminbot = minbot;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      lsel = sel;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      lx = xx;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   dc.SetBrush(lsel ? selectedBrush : unselectedBrush);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   l = rect.x + lx;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   w = xx - lx;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <span class="keywordflow">if</span> (lmaxbot &lt; lmintop - 1) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      dc.DrawRectangle(l, rect.y + lmaxtop, w, lmaxbot - lmaxtop);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      dc.DrawRectangle(l, rect.y + lmintop, w, lminbot - lmintop);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      dc.DrawRectangle(l, rect.y + lmaxtop, w, lminbot - lmaxtop);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;   <span class="comment">// If sync-lock selected, draw in linked graphics.</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;   <span class="keywordflow">if</span> (bIsSyncLockSelected &amp;&amp; t0 &lt; t1) {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> begin = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(rect.width, <span class="keywordtype">int</span>(zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(t0, -leftOffset))));</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a> = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(rect.width, <span class="keywordtype">int</span>(zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(t1, -leftOffset))));</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      DrawSyncLockTiles(&amp;dc, wxRect(rect.x + begin, rect.y, end - 1 - begin, rect.height));</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;   }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;   <span class="comment">//OK, the display bounds are between min and max, which</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <span class="comment">//is spread across rect.height.  Draw the line at the proper place.</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   <span class="keywordflow">if</span> (zoomMin &lt; 0 &amp;&amp; zoomMax &gt; 0) {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordtype">int</span> half = (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((zoomMax / (zoomMax - zoomMin)) * h);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, rect.x, rect.y + half, rect.x + rect.width, rect.y + half);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;}</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawMinMaxRMS(wxDC &amp;dc, <span class="keyword">const</span> wxRect &amp; rect, <span class="keyword">const</span> <span class="keywordtype">double</span> env[],</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   <span class="keywordtype">float</span> zoomMin, <span class="keywordtype">float</span> zoomMax,</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   <span class="keywordtype">bool</span> dB, <span class="keywordtype">float</span> dBRange,</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">float</span> *<a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a>, <span class="keyword">const</span> <span class="keywordtype">float</span> *<a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>, <span class="keyword">const</span> <span class="keywordtype">float</span> *rms, <span class="keyword">const</span> <span class="keywordtype">int</span> *bl,</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <span class="keywordtype">bool</span> <span class="comment">/* showProgress */</span>, <span class="keywordtype">bool</span> muted</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   , <span class="keyword">const</span> <span class="keywordtype">float</span> gain</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;#<a class="code" href="sndfile__play_8m.html#a74c64864f5283ae06d4a981642a59af9">endif</a></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;{</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   <span class="comment">// Display a line representing the</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   <span class="comment">// min and max of the samples in this region</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <span class="keywordtype">int</span> lasth1 = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::numeric_limits&lt;int&gt;::max</a>();</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   <span class="keywordtype">int</span> lasth2 = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::numeric_limits&lt;int&gt;::min</a>();</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <span class="keywordtype">int</span> h1;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   <span class="keywordtype">int</span> h2;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="keywordtype">int</span> *<a class="code" href="namespacewaflib_1_1fixpy2.html#a721a8f58a4734bba827b4f6d985f98ff">r1</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[rect.width];</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <span class="keywordtype">int</span> *r2 = <span class="keyword">new</span> <span class="keywordtype">int</span>[rect.width];</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   <span class="keywordtype">int</span> *clipped = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   <span class="keywordtype">int</span> clipcnt = 0;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <span class="keywordflow">if</span> (mShowClipping) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      clipped = <span class="keyword">new</span> <span class="keywordtype">int</span>[rect.width];</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   <span class="keywordtype">long</span> pixAnimOffset = (long)fabs((<span class="keywordtype">double</span>)(wxDateTime::Now().GetTicks() * -10)) +</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      wxDateTime::Now().GetMillisecond() / 100; <span class="comment">//10 pixels a second</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   <span class="keywordtype">bool</span> drawStripes = <span class="keyword">true</span>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   <span class="keywordtype">bool</span> drawWaveform = <span class="keyword">true</span>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;   dc.SetPen(muted ? muteSamplePen : samplePen);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x0 = 0; x0 &lt; rect.width; ++x0) {</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordtype">int</span> xx = rect.x + x0;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordtype">double</span> v;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;     <span class="comment">//JWA: &quot;gain&quot; variable passed to function includes the pan value and is used below 4/14/13</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      v = min[x0] * env[x0] * gain;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      v = min[x0] * env[x0];</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">if</span> (clipped &amp;&amp; mShowClipping &amp;&amp; (v &lt;= -<a class="code" href="_audacity_app_8h.html#a0e6f61adcdaa4d07f59bf2fccafe233c">MAX_AUDIO</a>))</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         <span class="keywordflow">if</span> (clipcnt == 0 || clipped[clipcnt - 1] != xx) {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            clipped[clipcnt++] = xx;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      h1 = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(v, zoomMin, zoomMax,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                       rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      v = max[x0] * env[x0] * gain;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      v = max[x0] * env[x0];</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">if</span> (clipped &amp;&amp; mShowClipping &amp;&amp; (v &gt;= <a class="code" href="_audacity_app_8h.html#a0e6f61adcdaa4d07f59bf2fccafe233c">MAX_AUDIO</a>))</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         <span class="keywordflow">if</span> (clipcnt == 0 || clipped[clipcnt - 1] != xx) {</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            clipped[clipcnt++] = xx;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;         }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      h2 = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(v, zoomMin, zoomMax,</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                       rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="comment">// JKC: This adjustment to h1 and h2 ensures that the drawn</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">// waveform is continuous.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">if</span> (x0 &gt; 0) {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;         <span class="keywordflow">if</span> (h1 &lt; lasth2) {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            h1 = lasth2 - 1;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         <span class="keywordflow">if</span> (h2 &gt; lasth1) {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            h2 = lasth1 + 1;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      lasth1 = h1;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      lasth2 = h2;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      r1[x0] = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-rms[x0] * env[x0]*gain, zoomMin, zoomMax,</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                          rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      r2[x0] = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(rms[xx0 * env[x0]*gain, zoomMin, zoomMax,</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                          rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      r1[x0] = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-rms[x0] * env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                          rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      r2[x0] = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(rms[x0] * env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                          rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="comment">// Make sure the rms isn&#39;t larger than the waveform min/max</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">if</span> (r1[x0] &gt; h1 - 1) {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         r1[x0] = h1 - 1;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">if</span> (r2[x0] &lt; h2 + 1) {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         r2[x0] = h2 + 1;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      }</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="keywordflow">if</span> (r2[x0] &gt; r1[x0]) {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;         r2[x0] = r1[x0];</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span> (bl[x0] &lt;= -1) {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         <span class="keywordflow">if</span> (drawStripes) {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="comment">// TODO:unify with buffer drawing.</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            dc.SetPen((bl[x0] % 2) ? muteSamplePen : samplePen);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = 0; yy &lt; rect.height / 25 + 1; ++yy) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;               <span class="comment">// we are drawing over the buffer, but I think DrawLine takes care of this.</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;               <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                            xx,</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                            rect.y + 25 * yy + (x0 <span class="comment">/*+pixAnimOffset*/</span>) % 25,</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                            xx,</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                            rect.y + 25 * yy + (x0 <span class="comment">/*+pixAnimOffset*/</span>) % 25 + 6); <span class="comment">//take the min so we don&#39;t draw past the edge</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;         }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         <span class="comment">// draw a dummy waveform - some kind of sinusoid.  We want to animate it so the user knows it&#39;s a dummy.  Use the second&#39;s unit of a get time function.</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         <span class="comment">// Lets use a triangle wave for now since it&#39;s easier - I don&#39;t want to use sin() or make a wavetable just for this.</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         <span class="keywordflow">if</span> (drawWaveform) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keywordtype">int</span> triX;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            dc.SetPen(samplePen);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            triX = fabs((<span class="keywordtype">double</span>)((x0 + pixAnimOffset) % (2 * rect.height)) - rect.height) + rect.height;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = 0; yy &lt; rect.height; ++yy) {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;               <span class="keywordflow">if</span> ((yy + triX) % rect.height == 0) {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                  dc.DrawPoint(xx, rect.y + yy);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;               }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;         }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;         <span class="comment">// Restore the pen for remaining pixel columns!</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;         dc.SetPen(muted ? muteSamplePen : samplePen);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, rect.y + h2, xx, rect.y + h1);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   }</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <span class="comment">// Stroke rms over the min-max</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   dc.SetPen(muted ? muteRmsPen : rmsPen);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x0 = 0; x0 &lt; rect.width; ++x0) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keywordtype">int</span> xx = rect.x + x0;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordflow">if</span> (bl[x0] &lt;= -1) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r1[x0] != r2[x0]) {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, rect.y + r2[x0], xx, rect.y + r1[x0]);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <span class="comment">// Draw the clipping lines</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <span class="keywordflow">if</span> (clipcnt) {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      dc.SetPen(muted ? muteClippedPen : clippedPen);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">while</span> (--clipcnt &gt;= 0) {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;         <span class="keywordtype">int</span> xx = clipped[clipcnt];</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, rect.y, xx, rect.y + rect.height);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   <span class="keywordflow">if</span> (mShowClipping) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keyword">delete</span>[] clipped;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="namespacewaflib_1_1fixpy2.html#a721a8f58a4734bba827b4f6d985f98ff">r1</a>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   <span class="keyword">delete</span> [] r2;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;}</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawIndividualSamples(wxDC &amp;dc, <span class="keywordtype">int</span> leftOffset, <span class="keyword">const</span> wxRect &amp;rect,</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                        <span class="keywordtype">float</span> zoomMin, <span class="keywordtype">float</span> zoomMax,</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                        <span class="keywordtype">bool</span> dB, <span class="keywordtype">float</span> dBRange,</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="class_wave_clip.html">WaveClip</a> *clip,</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                        <span class="keywordtype">bool</span> bigPoints, <span class="keywordtype">bool</span> showPoints, <span class="keywordtype">bool</span> muted)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;{</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> toffset = clip-&gt;<a class="code" href="class_wave_clip.html#a070d7b2328a78c6ddaecc2f60ad4567f">GetOffset</a>();</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> = clip-&gt;<a class="code" href="class_wave_clip.html#a04d1806de89e39538576880a8dd43c11">GetRate</a>();</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0, zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(0, -leftOffset) - toffset);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;   <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> s0 = <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(floor(t0 * rate));</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> snSamples = clip-&gt;<a class="code" href="class_wave_clip.html#a6cd003778b510cad742feaa5763c6ac2">GetNumSamples</a>();</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   <span class="keywordflow">if</span> (s0 &gt; snSamples)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(rect.width - 1, -leftOffset) - toffset;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> s1 = <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(ceil(t1 * rate));</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> slen = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(snSamples - s0, s1 - s0 + 1);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   <span class="keywordflow">if</span> (slen &lt;= 0)</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   <span class="keywordtype">float</span> *<a class="code" href="structbuffer.html">buffer</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[slen];</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   clip-&gt;<a class="code" href="class_wave_clip.html#a7909b8a8e1bac5eea9e4bc422b021a59">GetSamples</a>((<a class="code" href="include_2audacity_2_types_8h.html#aaafb46d1caf7c79262fec96b577215fe">samplePtr</a>)buffer, <a class="code" href="include_2audacity_2_types_8h.html#a9938d2e2f6adef23e745cd80ef379792aba7300a3d7158e88f04d5f81e613dde2">floatSample</a>, s0, slen);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   <span class="keywordtype">int</span> *xpos = <span class="keyword">new</span> <span class="keywordtype">int</span>[slen];</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   <span class="keywordtype">int</span> *ypos = <span class="keyword">new</span> <span class="keywordtype">int</span>[slen];</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;   <span class="keywordtype">int</span> *clipped = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;   <span class="keywordtype">int</span> clipcnt = 0;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> <a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;   <span class="keywordflow">if</span> (mShowClipping)</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      clipped = <span class="keyword">new</span> <span class="keywordtype">int</span>[slen];</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;   dc.SetPen(muted ? muteSamplePen : samplePen);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <span class="keywordflow">for</span> (s = 0; s &lt; slen; s++) {</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacepyportmidi_1_1midi.html#ad2426758f88d23d7208984d5c99ec050">time</a> = toffset + (s + s0) / rate;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> xx = <span class="comment">// An offset into the rectangle rect</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;         <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(-10000, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(10000,</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordtype">int</span>(zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(time, -leftOffset))));</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      xpos[<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>] = xx;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> tt = buffer[<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>] * clip-&gt;<a class="code" href="class_wave_clip.html#a89df7eef9147be5868fe247c6239e5c8">GetEnvelope</a>()-&gt;<a class="code" href="class_envelope.html#ac5729053c923e47b43f0f063845c2ce9">GetValue</a>(time);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keywordflow">if</span> (clipped &amp;&amp; mShowClipping &amp;&amp; ((tt &lt;= -<a class="code" href="_audacity_app_8h.html#a0e6f61adcdaa4d07f59bf2fccafe233c">MAX_AUDIO</a>) || (tt &gt;= <a class="code" href="_audacity_app_8h.html#a0e6f61adcdaa4d07f59bf2fccafe233c">MAX_AUDIO</a>)))</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;         clipped[clipcnt++] = xx;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      ypos[<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>] =</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;         <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(-1,</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(rect.height,</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;               <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(tt, zoomMin, zoomMax,</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                  rect.height, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">false</span>)));</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;   }</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   <span class="comment">// Draw lines</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   <span class="keywordflow">for</span> (s = 0; s &lt; slen - 1; s++) {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                   rect.x + xpos[s], rect.y + ypos[s],</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                   rect.x + xpos[s + 1], rect.y + ypos[s + 1]);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   }</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <span class="keywordflow">if</span> (showPoints)</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// Draw points where spacing is enough</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> tickSize = bigPoints ? 4 : 3;<span class="comment">// Bigger ellipses when draggable.</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      wxRect pr;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      pr.width = tickSize;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      pr.height = tickSize;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">//different colour when draggable.</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      dc.SetBrush( bigPoints ? dragsampleBrush : sampleBrush);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">for</span> (s = 0; s &lt; slen; s++) {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         <span class="keywordflow">if</span> (ypos[s] &gt;= 0 &amp;&amp; ypos[s] &lt; rect.height) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            pr.x = rect.x + xpos[<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>] - tickSize/2;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            pr.y = rect.y + ypos[<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a>] - tickSize/2;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            dc.DrawEllipse(pr);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;         }</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   <span class="comment">// Draw clipping</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;   <span class="keywordflow">if</span> (clipcnt) {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      dc.SetPen(muted ? muteClippedPen : clippedPen);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">while</span> (--clipcnt &gt;= 0) {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;         s = clipped[clipcnt];</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, rect.x + s, rect.y, rect.x + s, rect.y + rect.height);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   }</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   <span class="keywordflow">if</span> (mShowClipping) {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keyword">delete</span> [] clipped;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   <span class="keyword">delete</span>[]<a class="code" href="recplay_8c.html#adbbab5cb2248179d231690a1a02ff977">buffer</a>;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   <span class="keyword">delete</span>[]xpos;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <span class="keyword">delete</span>[]ypos;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawEnvelope(wxDC &amp;dc, <span class="keyword">const</span> wxRect &amp;rect, <span class="keyword">const</span> <span class="keywordtype">double</span> env[],</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                               <span class="keywordtype">float</span> zoomMin, <span class="keywordtype">float</span> zoomMax,</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                               <span class="keywordtype">bool</span> dB, <span class="keywordtype">float</span> dBRange)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <span class="keywordtype">int</span> h = rect.height;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;   dc.SetPen(<a class="code" href="class_a_color.html#a9706bc519ec6f6b7f93ddc6371331f07">AColor::envelopePen</a>);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x0 = 0; x0 &lt; rect.width; ++x0) {</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keywordtype">int</span> cenvTop = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordtype">int</span> cenvBot = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                                h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordtype">int</span> envTop = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                               h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">false</span>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordtype">int</span> envBot = <a class="code" href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a>(-env[x0], zoomMin, zoomMax,</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                               h, dB, <span class="keyword">true</span>, dBRange, <span class="keyword">false</span>);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="comment">// Make the collision at zero actually look solid</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordflow">if</span> (cenvBot - cenvTop &lt; 9) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)((zoomMax / (zoomMax - zoomMin)) * h);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;         cenvTop = value - 4;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;         cenvBot = value + 4;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      DrawEnvLine(dc, rect, x0, envTop, cenvTop, <span class="keyword">true</span>);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      DrawEnvLine(dc, rect, x0, envBot, cenvBot, <span class="keyword">false</span>);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;}</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawEnvLine(wxDC &amp;dc, <span class="keyword">const</span> wxRect &amp;rect, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> cy, <span class="keywordtype">bool</span> top)</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;{</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   <span class="keywordtype">int</span> xx = rect.x + x0;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   <span class="keywordtype">int</span> yy = rect.y + cy;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;   <span class="keywordflow">if</span> (y0 &lt; 0) {</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keywordflow">if</span> (x0 % 4 != 3) {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, yy, xx, yy + 3);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      }</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   }</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y0 &gt; rect.height) {</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">if</span> (x0 % 4 != 3) {</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, yy - 3, xx, yy);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      }</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">if</span> (top) {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, yy, xx, yy + 3);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      }</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, yy - 3, xx, yy);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;   }</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;}</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawWaveform(<span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *track,</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                               wxDC &amp; dc,</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                               <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                               <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                               <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                               <span class="keywordtype">bool</span> drawEnvelope,</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                               <span class="keywordtype">bool</span> bigPoints,</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                               <span class="keywordtype">bool</span> drawSliders,</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                               <span class="keywordtype">bool</span> muted)</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;{</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> dB = !track-&gt;<a class="code" href="class_wave_track.html#a10c50123dc26cba66469b011c1852047">GetWaveformSettings</a>().<a class="code" href="class_waveform_settings.html#ae4f07aa847f89f72a127ba5e357f1e78">isLinear</a>();</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;   DrawBackgroundWithSelection(&amp;dc, rect, track, blankSelectedBrush, blankBrush,</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         selectedRegion, zoomInfo);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   <span class="keywordflow">for</span> (WaveClipList::compatibility_iterator <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> =</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      const_cast&lt;WaveTrack*&gt;(track)-&gt;GetClipIterator(); <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>; <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> = <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetNext())</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      DrawClipWaveform(track, <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetData(), dc, rect, selectedRegion, zoomInfo,</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                       drawEnvelope, bigPoints,</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                       dB, muted);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;   <span class="comment">// Update cache for locations, e.g. cutlines and merge points</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;   track-&gt;<a class="code" href="class_wave_track.html#a00b8ff13124c65a9b937e546cbcff466">UpdateLocationsCache</a>();</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;   <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> loc : track-&gt;<a class="code" href="class_wave_track.html#aed472b80250f8a6a759d8c43970c6b99">GetCachedLocations</a>()) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> xx = zoomInfo.TimeToPosition(loc.pos);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keywordflow">if</span> (xx &gt;= 0 &amp;&amp; xx &lt; rect.width) {</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;         dc.SetPen(*wxGREY_PEN);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, (<span class="keywordtype">int</span>) (rect.x + xx - 1), rect.y, (<span class="keywordtype">int</span>) (rect.x + xx - 1), rect.y + rect.height);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;         <span class="keywordflow">if</span> (loc.typ == <a class="code" href="struct_wave_track_location.html#a0a54a8fbcc73dfe63879bcff10a75c6da399879306fdea1e62201b1045d682e78">WaveTrackLocation::locationCutLine</a>) {</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            dc.SetPen(*wxRED_PEN);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;         }</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;         }</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, (<span class="keywordtype">int</span>) (rect.x + xx), rect.y, (<span class="keywordtype">int</span>) (rect.x + xx), rect.y + rect.height);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;         dc.SetPen(*wxGREY_PEN);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, (<span class="keywordtype">int</span>) (rect.x + xx + 1), rect.y, (<span class="keywordtype">int</span>) (rect.x + xx + 1), rect.y + rect.height);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   <span class="keywordflow">if</span> (drawSliders) {</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      DrawTimeSlider(dc, rect, <span class="keyword">true</span>);  <span class="comment">// directed right</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      DrawTimeSlider(dc, rect, <span class="keyword">false</span>); <span class="comment">// directed left</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   }</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;}</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="keyword">struct </span>ClipParameters</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;{</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;   <span class="comment">// Do a bunch of calculations common to waveform and spectrum drawing.</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   ClipParameters</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      (<span class="keywordtype">bool</span> spectrum, <span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *track, <span class="keyword">const</span> <a class="code" href="class_wave_clip.html">WaveClip</a> *clip, <span class="keyword">const</span> wxRect &amp;rect,</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion, <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      tOffset = clip-&gt;<a class="code" href="class_wave_clip.html#a070d7b2328a78c6ddaecc2f60ad4567f">GetOffset</a>();</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> = clip-&gt;<a class="code" href="class_wave_clip.html#a04d1806de89e39538576880a8dd43c11">GetRate</a>();</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      h = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(0, 0</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;         , <span class="keyword">true</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      );</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      h1 = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(rect.width, 0</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         , <span class="keyword">true</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      );</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="keywordtype">double</span> sel0 = selectedRegion.<a class="code" href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">t0</a>();    <span class="comment">//left selection bound</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="keywordtype">double</span> sel1 = selectedRegion.<a class="code" href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">t1</a>();    <span class="comment">//right selection bound</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="comment">//If the track isn&#39;t selected, make the selection empty</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">if</span> (!track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>() &amp;&amp;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;         (spectrum || !track-&gt;<a class="code" href="class_track.html#a4b9d8ec8baa8ce94f9b9b999e324a59f">IsSyncLockSelected</a>())) { <span class="comment">// PRL: why was there a difference for spectrum?</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;         sel0 = sel1 = 0.0;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> trackLen = clip-&gt;<a class="code" href="class_wave_clip.html#a7c878143bdd7641be183325944d02f39">GetEndTime</a>() - clip-&gt;<a class="code" href="class_wave_clip.html#a839a293df9246f7a9bb6fcf4d8be7b40">GetStartTime</a>();</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      tpre = h - tOffset;                 <span class="comment">// offset corrected time of</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="comment">//  left edge of display</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      tpost = h1 - tOffset;               <span class="comment">// offset corrected time of</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="comment">//  right edge of display</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> sps = 1. / <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;            <span class="comment">//seconds-per-sample</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">// Determine whether we should show individual samples</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">// or draw circular points as well</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      averagePixelsPerSample = rect.width / (<a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> * (h1 - h));</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      showIndividualSamples = averagePixelsPerSample &gt; 0.5;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="comment">// Calculate actual selection bounds so that t0 &gt; 0 and t1 &lt; the</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <span class="comment">// end of the track</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      t0 = (tpre &gt;= 0.0 ? tpre : 0.0);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      t1 = (tpost &lt; trackLen - sps * .99 ? tpost : trackLen - sps * .99);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="keywordflow">if</span> (showIndividualSamples) {</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;         <span class="comment">// adjustment so that the last circular point doesn&#39;t appear</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;         <span class="comment">// to be hanging off the end</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;         t1 += 2. / (averagePixelsPerSample * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="comment">// Make sure t1 (the right bound) is greater than 0</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="keywordflow">if</span> (t1 &lt; 0.0) {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;         t1 = 0.0;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="comment">// Make sure t1 is greater than t0</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordflow">if</span> (t0 &gt; t1) {</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;         t0 = t1;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      }</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">// Use the WaveTrack method to show what is selected and &#39;should&#39; be copied, pasted etc.</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      ssel0 = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(<a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(0), spectrum</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;         ? <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>((sel0 - tOffset) * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> + .99) <span class="comment">// PRL: why?</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;         : track-&gt;<a class="code" href="class_wave_track.html#afe621ba06a0396725da44e937143972f">TimeToLongSamples</a>(sel0 - tOffset)</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      );</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      ssel1 = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(<a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(0), spectrum</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;         ? <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>((sel1 - tOffset) * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> + .99) <span class="comment">// PRL: why?</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;         : track-&gt;<a class="code" href="class_wave_track.html#afe621ba06a0396725da44e937143972f">TimeToLongSamples</a>(sel1 - tOffset)</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      );</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">//trim selection so that it only contains the actual samples</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">if</span> (ssel0 != ssel1 &amp;&amp; ssel1 &gt; (<a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>)(0.5 + trackLen * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>)) {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;         ssel1 = (<a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>)(0.5 + trackLen * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="comment">// The variable &quot;hiddenMid&quot; will be the rectangle containing the</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="comment">// actual waveform, as opposed to any blank area before</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="comment">// or after the track, as it would appear without the fisheye.</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      hiddenMid = rect;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">// If the left edge of the track is to the right of the left</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="comment">// edge of the display, then there&#39;s some unused area to the</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="comment">// left of the track.  Reduce the &quot;hiddenMid&quot;</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      hiddenLeftOffset = 0;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">if</span> (tpre &lt; 0) {</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;         <span class="comment">// Fix Bug #1296 caused by premature conversion to (int).</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;         wxInt64 time64 = zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(tOffset, 0 , <span class="keyword">true</span>);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;         <span class="keywordflow">if</span>( time64 &lt; 0 )</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            time64 = 0;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;         hiddenLeftOffset = (time64 &lt; rect.width) ? (<span class="keywordtype">int</span>)time64 : rect.width;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;         hiddenMid.x += hiddenLeftOffset;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;         hiddenMid.width -= hiddenLeftOffset;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      }</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="comment">// If the right edge of the track is to the left of the the right</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="comment">// edge of the display, then there&#39;s some unused area to the right</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="comment">// of the track.  Reduce the &quot;hiddenMid&quot; rect by the</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="comment">// size of the blank area.</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">if</span> (tpost &gt; t1) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;         wxInt64 time64 = zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(tOffset+t1, 0 , <span class="keyword">true</span>);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;         <span class="keywordflow">if</span>( time64 &lt; 0 )</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            time64 = 0;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> hiddenRightOffset = (time64 &lt; rect.width) ? (<span class="keywordtype">int</span>)time64 : rect.width;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;         hiddenMid.width = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, hiddenRightOffset - hiddenLeftOffset);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="comment">// The variable &quot;mid&quot; will be the rectangle containing the</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="comment">// actual waveform, as distorted by the fisheye,</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="comment">// as opposed to any blank area before or after the track.</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      mid = rect;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <span class="comment">// If the left edge of the track is to the right of the left</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="comment">// edge of the display, then there&#39;s some unused area to the</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="comment">// left of the track.  Reduce the &quot;mid&quot;</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      leftOffset = 0;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keywordflow">if</span> (tpre &lt; 0) {</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;         wxInt64 time64 = zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(tOffset, 0 , <span class="keyword">false</span>);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;         <span class="keywordflow">if</span>( time64 &lt; 0 )</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            time64 = 0;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;         leftOffset = (time64 &lt; rect.width) ? (<span class="keywordtype">int</span>)time64 : rect.width;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;         mid.x += leftOffset;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;         mid.width -= leftOffset;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="comment">// If the right edge of the track is to the left of the the right</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="comment">// edge of the display, then there&#39;s some unused area to the right</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <span class="comment">// of the track.  Reduce the &quot;mid&quot; rect by the</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="comment">// size of the blank area.</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="keywordflow">if</span> (tpost &gt; t1) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;         wxInt64 time64 = zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(tOffset+t1, 0 , <span class="keyword">false</span>);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;         <span class="keywordflow">if</span>( time64 &lt; 0 )</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            time64 = 0;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> distortedRightOffset = (time64 &lt; rect.width) ? (<span class="keywordtype">int</span>)time64 : rect.width;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;         mid.width = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, distortedRightOffset - leftOffset);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;   <span class="keywordtype">double</span> tOffset;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;   <span class="keywordtype">double</span> h; <span class="comment">// absolute time of left edge of display</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;   <span class="keywordtype">double</span> tpre; <span class="comment">// offset corrected time of left edge of display</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;   <span class="keywordtype">double</span> h1;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;   <span class="keywordtype">double</span> tpost; <span class="comment">// offset corrected time of right edge of display</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;   <span class="comment">// Calculate actual selection bounds so that t0 &gt; 0 and t1 &lt; the</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   <span class="comment">// end of the track</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   <span class="keywordtype">double</span> t0;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;   <span class="keywordtype">double</span> t1;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;   <span class="keywordtype">double</span> averagePixelsPerSample;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;   <span class="keywordtype">bool</span> showIndividualSamples;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;   <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> ssel0;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;   <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> ssel1;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;   wxRect hiddenMid;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   <span class="keywordtype">int</span> hiddenLeftOffset;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   wxRect mid;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   <span class="keywordtype">int</span> leftOffset;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;};</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">#ifdef __GNUC__</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor">#define CONST</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="_track_artist_8cpp.html#a0c33b494a68ce28497e7ce8e5e95feff"> 1678</a></span>&#160;<span class="preprocessor">#define CONST const</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="keyword">struct </span>WavePortion {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   wxRect rect;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;   <a class="code" href="_track_artist_8cpp.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <span class="keywordtype">double</span> averageZoom;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;   <a class="code" href="_track_artist_8cpp.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <span class="keywordtype">bool</span> inFisheye;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   WavePortion(<span class="keywordtype">int</span> <a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a>, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h, <span class="keywordtype">double</span> zoom, <span class="keywordtype">bool</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>)</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      : rect(x, y, w, h), averageZoom(zoom), inFisheye(i)</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   {}</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;};</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="keywordtype">void</span> FindWavePortions</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   (std::vector&lt;WavePortion&gt; &amp;portions, <span class="keyword">const</span> wxRect &amp;rect, <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keyword">const</span> ClipParameters &amp;<a class="code" href="_reverb_8cpp.html#aacc5617877d2aa4d17c729c1c8ba4eec">params</a>)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;{</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   <span class="comment">// If there is no fisheye, then only one rectangle has nonzero width.</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   <span class="comment">// If there is a fisheye, make rectangles for before and after</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   <span class="comment">// (except when they are squeezed to zero width), and at least one for inside</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;   <span class="comment">// the fisheye.</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   <a class="code" href="class_zoom_info.html#a68d0856b5e64abd74f91ebeedac395d3">ZoomInfo::Intervals</a> intervals;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;   zoomInfo.<a class="code" href="class_zoom_info.html#aff75f3d72f5fef0e3472ac4c415e63f3">FindIntervals</a>(params.rate, intervals, rect.width, rect.x);</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   ZoomInfo::Intervals::const_iterator <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> = intervals.begin(), <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a> = intervals.end(), prev;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;   wxASSERT(it != <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a> &amp;&amp; it-&gt;position == rect.x);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> rightmost = rect.x + rect.width;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> left = rect.x; left &lt; rightmost;) {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keywordflow">while</span> (it != <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a> &amp;&amp; it-&gt;position &lt;= left)</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;         prev = it++;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordflow">if</span> (it == <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a>)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> right = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(left, <span class="keywordtype">int</span>(it-&gt;position));</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> width = right - left;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">if</span> (width &gt; 0)</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;         portions.push_back(</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            WavePortion(left, rect.y, width, rect.height,</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                        prev-&gt;averageZoom, prev-&gt;inFisheye)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;         );</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      left = right;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;   }</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;}</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawClipWaveform(<span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *track,</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_wave_clip.html">WaveClip</a> *clip,</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                   wxDC &amp; dc,</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                   <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                   <span class="keywordtype">bool</span> drawEnvelope,</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                   <span class="keywordtype">bool</span> bigPoints,</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                   <span class="keywordtype">bool</span> dB,</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                   <span class="keywordtype">bool</span> muted)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;{</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="preprocessor">#ifdef PROFILE_WAVEFORM</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;   <a class="code" href="class_profiler.html">Profiler</a> profiler;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;   <span class="keyword">const</span> ClipParameters <a class="code" href="_reverb_8cpp.html#aacc5617877d2aa4d17c729c1c8ba4eec">params</a>(<span class="keyword">false</span>, track, clip, rect, selectedRegion, zoomInfo);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <span class="keyword">const</span> wxRect &amp;hiddenMid = params.hiddenMid;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;   <span class="comment">// The &quot;hiddenMid&quot; rect contains the part of the display actually</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;   <span class="comment">// containing the waveform, as it appears without the fisheye.  If it&#39;s empty, we&#39;re done.</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <span class="keywordflow">if</span> (hiddenMid.width &lt;= 0) {</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;t0 = params.t0;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;tOffset = params.tOffset;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;h = params.h;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;tpre = params.tpre;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;tpost = params.tpost;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;t1 = params.t1;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;averagePixelsPerSample = params.averagePixelsPerSample;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> = params.rate;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <span class="keywordtype">double</span> leftOffset = params.leftOffset;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <span class="keyword">const</span> wxRect &amp;mid = params.mid;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">float</span> dBRange = track-&gt;<a class="code" href="class_wave_track.html#a10c50123dc26cba66469b011c1852047">GetWaveformSettings</a>().<a class="code" href="class_waveform_settings.html#a97217e305f6eb7ead4452924fec4029d">dBRange</a>;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   dc.SetPen(*wxTRANSPARENT_PEN);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <span class="comment">// If we get to this point, the clip is actually visible on the</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   <span class="comment">// screen, so remember the display rectangle.</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;   clip-&gt;<a class="code" href="class_wave_clip.html#ac42da9000a368776ef8beb582723fb29">SetDisplayRect</a>(hiddenMid);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   <span class="comment">// The bounds (controlled by vertical zooming; -1.0...1.0</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;   <span class="comment">// by default)</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;   <span class="keywordtype">float</span> zoomMin, zoomMax;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;   track-&gt;<a class="code" href="class_wave_track.html#aebb4cac69620ce02b4f396fb37d23f82">GetDisplayBounds</a>(&amp;zoomMin, &amp;zoomMax);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;   std::vector&lt;double&gt; vEnv(mid.width);</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;   <span class="keywordtype">double</span> *<span class="keyword">const</span> env = &amp;vEnv[0];</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;   clip-&gt;<a class="code" href="class_wave_clip.html#a89df7eef9147be5868fe247c6239e5c8">GetEnvelope</a>()-&gt;<a class="code" href="class_envelope.html#a5daec75b3aa3b0da7919fc986014e1db">GetValues</a>(env, mid.width, leftOffset, zoomInfo);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;   <span class="comment">// Draw the background of the track, outlining the shape of</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;   <span class="comment">// the envelope and using a colored pen for the selected</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   <span class="comment">// part of the waveform</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;   {</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordtype">double</span> t0, t1;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">if</span> (track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>() || track-&gt;<a class="code" href="class_track.html#a4b9d8ec8baa8ce94f9b9b999e324a59f">IsSyncLockSelected</a>()) {</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;         t0 = track-&gt;<a class="code" href="class_wave_track.html#a16171cfb9bd446a6d16e0e5ac1695318">LongSamplesToTime</a>(track-&gt;<a class="code" href="class_wave_track.html#afe621ba06a0396725da44e937143972f">TimeToLongSamples</a>(selectedRegion.<a class="code" href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">t0</a>())),</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            t1 = track-&gt;<a class="code" href="class_wave_track.html#a16171cfb9bd446a6d16e0e5ac1695318">LongSamplesToTime</a>(track-&gt;<a class="code" href="class_wave_track.html#afe621ba06a0396725da44e937143972f">TimeToLongSamples</a>(selectedRegion.<a class="code" href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">t1</a>()));</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;         t0 = t1 = 0.0;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      DrawWaveformBackground(dc, leftOffset, mid,</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         env,</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;         zoomMin, zoomMax,</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         dB, dBRange,</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;         t0, t1, zoomInfo, drawEnvelope,</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;         !track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>());</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   }</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   <a class="code" href="class_wave_display.html">WaveDisplay</a> display(hiddenMid.width);</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;   <span class="keywordtype">bool</span> isLoadingOD = <span class="keyword">false</span>;<span class="comment">//true if loading on demand block in sequence.</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> pps =</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      averagePixelsPerSample * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   <span class="comment">// For each portion separately, we will decide to draw</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   <span class="comment">// it as min/max/rms or as individual samples.</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;   std::vector&lt;WavePortion&gt; portions;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   FindWavePortions(portions, rect, zoomInfo, params);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nPortions = portions.size();</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <span class="comment">// Require at least 1/2 pixel per sample for drawing individual samples.</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> threshold1 = 0.5 * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;   <span class="comment">// Require at least 3 pixels per sample for drawing the draggable points.</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> threshold2 = 3 * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordtype">bool</span> showIndividualSamples = <span class="keyword">false</span>;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; !showIndividualSamples &amp;&amp; ii &lt; nPortions; ++ii) {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;         <span class="keyword">const</span> WavePortion &amp;portion = portions[ii];</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         showIndividualSamples =</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            !portion.inFisheye &amp;&amp; portion.averageZoom &gt; threshold1;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">if</span> (!showIndividualSamples) {</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;         <span class="comment">// The WaveClip class handles the details of computing the shape</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;         <span class="comment">// of the waveform.  The only way GetWaveDisplay will fail is if</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         <span class="comment">// there&#39;s a serious error, like some of the waveform data can&#39;t</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;         <span class="comment">// be loaded.  So if the function returns false, we can just exit.</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;         <span class="comment">// Note that we compute the full width display even if there is a</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;         <span class="comment">// fisheye hiding part of it, because of the caching.  If the</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;         <span class="comment">// fisheye moves over the background, there is then less to do when</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;         <span class="comment">// redrawing.</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;         <span class="keywordflow">if</span> (!clip-&gt;<a class="code" href="class_wave_clip.html#ac28044d7d312e53024f7b4fbe38e711f">GetWaveDisplay</a>(display,</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            t0, pps, isLoadingOD))</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      }</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   }</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; nPortions; ++ii) {</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      WavePortion &amp;portion = portions[ii];</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> showIndividualSamples = portion.averageZoom &gt; threshold1;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> showPoints = portion.averageZoom &gt; threshold2;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      wxRect&amp; rect = portion.rect;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      rect.Intersect(mid);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      wxASSERT(rect.width &gt;= 0);</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordtype">float</span> *useMin = 0, *useMax = 0, *useRms = 0;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keywordtype">int</span> *useBl = 0;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <a class="code" href="class_wave_display.html">WaveDisplay</a> fisheyeDisplay(rect.width);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespacewaflib_1_1_tools_1_1c__preproc.html#a631381b6890985ef083f6544eedbd3e1">skipped</a> = 0, skippedLeft = 0, skippedRight = 0;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">if</span> (portion.inFisheye) {</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;         <span class="keywordflow">if</span> (!showIndividualSamples) {</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            fisheyeDisplay.<a class="code" href="class_wave_display.html#ab8b228309a2699299e591641ccfebcb7">Allocate</a>();</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> numSamples = clip-&gt;<a class="code" href="class_wave_clip.html#a6cd003778b510cad742feaa5763c6ac2">GetNumSamples</a>();</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="comment">// Get wave display data for different magnification</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            <span class="keywordtype">int</span> jj = 0;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <span class="keywordflow">for</span> (; jj &lt; rect.width; ++jj) {</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacepyportmidi_1_1midi.html#ad2426758f88d23d7208984d5c99ec050">time</a> =</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                  zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(jj, -leftOffset) - tOffset;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;               <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> sample = (<a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>)floor(time * rate + 0.5);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;               <span class="keywordflow">if</span> (sample &lt; 0) {</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                  ++rect.x;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                  ++skippedLeft;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;               }</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;               <span class="keywordflow">if</span> (sample &gt;= numSamples)</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;               fisheyeDisplay.<a class="code" href="class_wave_display.html#a7e072e884092ea939899822b0d92b8be">where</a>[jj - skippedLeft] = sample;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            }</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            skippedRight = rect.width - jj;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            skipped = skippedRight + skippedLeft;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            rect.width -= <a class="code" href="namespacewaflib_1_1_tools_1_1c__preproc.html#a631381b6890985ef083f6544eedbd3e1">skipped</a>;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            <span class="comment">// where needs a sentinel</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            <span class="keywordflow">if</span> (jj &gt; 0)</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;               fisheyeDisplay.<a class="code" href="class_wave_display.html#a7e072e884092ea939899822b0d92b8be">where</a>[jj - skippedLeft] =</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;               1 + fisheyeDisplay.<a class="code" href="class_wave_display.html#a7e072e884092ea939899822b0d92b8be">where</a>[jj - skippedLeft - 1];</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            fisheyeDisplay.<a class="code" href="class_wave_display.html#aab0a13074ebb8ed5ba1da2bceaddd407">width</a> -= <a class="code" href="namespacewaflib_1_1_tools_1_1c__preproc.html#a631381b6890985ef083f6544eedbd3e1">skipped</a>;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <span class="comment">// Get a wave display for the fisheye, uncached.</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            <span class="keywordflow">if</span> (rect.width &gt; 0)</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;               <span class="keywordflow">if</span> (!clip-&gt;<a class="code" href="class_wave_clip.html#ac28044d7d312e53024f7b4fbe38e711f">GetWaveDisplay</a>(</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                     fisheyeDisplay, t0, -1.0, <span class="comment">// ignored</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                     isLoadingOD))</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                  <span class="keywordflow">continue</span>; <span class="comment">// serious error.  just don&#39;t draw??</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            useMin = fisheyeDisplay.<a class="code" href="class_wave_display.html#a9ff4ca6d4c9be28c6f3cb3f806c41913">min</a>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            useMax = fisheyeDisplay.<a class="code" href="class_wave_display.html#ab2a1f71c47f052041fbcbdac889be828">max</a>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            useRms = fisheyeDisplay.<a class="code" href="class_wave_display.html#a75d667998a5aa1ec03d1ec86b80f1392">rms</a>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            useBl = fisheyeDisplay.<a class="code" href="class_wave_display.html#a607b91b920b3688ea7eeb01bf302debf">bl</a>;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;         }</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      }</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> pos = leftOffset - params.hiddenLeftOffset;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;         useMin = display.min + pos;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;         useMax = display.max + pos;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;         useRms = display.rms + pos;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;         useBl = display.bl + pos;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      }</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      leftOffset += skippedLeft;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">if</span> (rect.width &gt; 0) {</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;         <span class="keywordflow">if</span> (!showIndividualSamples) {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            std::vector&lt;double&gt; vEnv2(rect.width);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <span class="keywordtype">double</span> *<span class="keyword">const</span> env2 = &amp;vEnv2[0];</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            clip-&gt;<a class="code" href="class_wave_clip.html#a89df7eef9147be5868fe247c6239e5c8">GetEnvelope</a>()-&gt;<a class="code" href="class_envelope.html#a5daec75b3aa3b0da7919fc986014e1db">GetValues</a>(env2, rect.width, leftOffset, zoomInfo);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            DrawMinMaxRMS(dc, rect, env2,</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;               zoomMin, zoomMax,</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;               dB, dBRange,</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;               useMin, useMax, useRms, useBl,</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;               isLoadingOD, muted</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;#ifdef EXPERIMENTAL_OUTPUT_DISPLAY</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;               , track-&gt;<a class="code" href="class_wave_track.html#a93d35f717c7120f01d93ccb0e1d18db4">GetChannelGain</a>(track-&gt;<a class="code" href="class_track.html#a9c988f7695a546bf52ee2dc859db0345">GetChannel</a>())</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;#endif</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            );</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;         }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            DrawIndividualSamples(dc, leftOffset, rect, zoomMin, zoomMax,</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;               dB, dBRange,</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;               clip, zoomInfo,</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;               bigPoints, showPoints, muted);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      leftOffset += rect.width + skippedRight;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   }</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   <span class="keywordflow">if</span> (drawEnvelope) {</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      DrawEnvelope(dc, mid, env, zoomMin, zoomMax, dB, dBRange);</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#a89df7eef9147be5868fe247c6239e5c8">GetEnvelope</a>()-&gt;<a class="code" href="class_envelope.html#a4463f20563902ef78367735ea25440f4">DrawPoints</a>(dc, rect, zoomInfo, dB, dBRange, zoomMin, zoomMax);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   }</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <span class="comment">// Draw arrows on the left side if the track extends to the left of the</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="comment">// beginning of time.  :)</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <span class="keywordflow">if</span> (h == 0.0 &amp;&amp; tOffset &lt; 0.0) {</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      DrawNegativeOffsetTrackArrows(dc, rect);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="comment">// Draw clip edges</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;   dc.SetPen(*wxGREY_PEN);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;   <span class="keywordflow">if</span> (tpre &lt; 0) {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                   mid.x - 1, mid.y,</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                   mid.x - 1, mid.y + rect.height);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   }</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;   <span class="keywordflow">if</span> (tpost &gt; t1) {</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc,</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                   mid.x + mid.width, mid.y,</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                   mid.x + mid.width, mid.y + rect.height);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;}</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawTimeSlider(wxDC &amp; dc,</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                 <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                 <span class="keywordtype">bool</span> rightwards)</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;{</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> border = 3; <span class="comment">// 3 pixels all round.</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> width = 6; <span class="comment">// width of the drag box.</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> taper = 6; <span class="comment">// how much the box tapers by.</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> barSpacing = 4; <span class="comment">// how far apart the bars are.</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> barWidth = 3;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> xFlat = 3;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;   <span class="comment">//Enough space to draw in?</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;   <span class="keywordflow">if</span> (rect.height &lt;= ((taper+border + barSpacing) * 2)) {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   }</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;   <span class="keywordflow">if</span> (rect.width &lt;= (width * 2 + border * 3)) {</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   }</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   <span class="comment">// The draggable box is tapered towards the direction you drag it.</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   <span class="keywordtype">int</span> leftTaper  = rightwards ? 0 : 6;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   <span class="keywordtype">int</span> rightTaper = rightwards ? 6 : 0;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   <span class="keywordtype">int</span> xLeft = rightwards ? (rect.x + border - 2)</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                          : (rect.x + rect.width + 1 - (border + width));</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   <span class="keywordtype">int</span> yTop  = rect.y + border;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;   <span class="keywordtype">int</span> yBot  = rect.y + rect.height - border - 1;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   <a class="code" href="class_a_color.html#a3d6f7afabbb757c3630619df34761e1b">AColor::Light</a>(&amp;dc, <span class="keyword">false</span>);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft,         yBot - leftTaper, xLeft,         yTop + leftTaper);</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft,         yTop + leftTaper, xLeft + xFlat, yTop);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft + xFlat, yTop,             xLeft + width, yTop + rightTaper);</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;   <a class="code" href="class_a_color.html#a34d81236a6bff41ebf8cf2b1183c847a">AColor::Dark</a>(&amp;dc, <span class="keyword">false</span>);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft + width,         yTop + rightTaper, xLeft + width,       yBot - rightTaper);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft + width,         yBot - rightTaper, xLeft + width-xFlat, yBot);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft + width - xFlat, yBot,              xLeft,               yBot - leftTaper);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <span class="keywordtype">int</span> firstBar = yTop + taper + taper / 2;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   <span class="keywordtype">int</span> nBars    = (yBot - yTop - taper * 3) / barSpacing + 1;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   xLeft += (width - barWidth + 1) / 2;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   <span class="keywordtype">int</span> yy;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;   <a class="code" href="class_a_color.html#a3d6f7afabbb757c3630619df34761e1b">AColor::Light</a>(&amp;dc, <span class="keyword">false</span>);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   <span class="keywordflow">for</span> (i = 0;i &lt; nBars; i++) {</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      yy = firstBar + barSpacing * <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft, yy, xLeft + barWidth, yy);</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;   }</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   <a class="code" href="class_a_color.html#a34d81236a6bff41ebf8cf2b1183c847a">AColor::Dark</a>(&amp;dc, <span class="keyword">false</span>);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   <span class="keywordflow">for</span>(i = 0;i &lt; nBars; i++){</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      yy = firstBar + barSpacing * i + 1;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xLeft, yy, xLeft + barWidth, yy);</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   }</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;}</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawSpectrum(<span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *track,</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                               wxDC &amp; dc,</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                               <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                               <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                               <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;{</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   DrawBackgroundWithSelection(&amp;dc, rect, track, blankSelectedBrush, blankBrush,</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;         selectedRegion, zoomInfo);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;   <a class="code" href="class_wave_track_cache.html">WaveTrackCache</a> cache(track);</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;   <span class="keywordflow">for</span> (WaveClipList::compatibility_iterator <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> =</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      const_cast&lt;WaveTrack*&gt;(track)-&gt;GetClipIterator(); <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>; <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> = <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetNext()) {</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      DrawClipSpectrum(cache, <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>-&gt;GetData(), dc, rect, selectedRegion, zoomInfo);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;   }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;}</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">float</span> findValue</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;(<span class="keyword">const</span> <span class="keywordtype">float</span> *spectrum, <span class="keywordtype">float</span> bin0, <span class="keywordtype">float</span> bin1, <span class="keywordtype">int</span> half,</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; <span class="keywordtype">bool</span> autocorrelation, <span class="keywordtype">int</span> gain, <span class="keywordtype">int</span> range)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;{</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   <span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   <span class="comment">// Averaging method</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(bin1) == <span class="keywordtype">int</span>(bin0)) {</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      value = spectrum[<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(bin0)];</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="keywordtype">float</span> binwidth= bin1 - bin0;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      value = spectrum[<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(bin0)] * (1.f - bin0 + (<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>)bin0);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      bin0 = 1 + <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a> (bin0);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">while</span> (bin0 &lt; <span class="keywordtype">int</span>(bin1)) {</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;         value += spectrum[<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(bin0)];</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;         bin0 += 1.0;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      }</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="comment">// Do not reference past end of freq array.</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(bin1) &gt;= half) {</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;         bin1 -= 1.0;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      }</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      value += spectrum[<a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(bin1)] * (bin1 - <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(bin1));</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      value /= binwidth;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   }</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   wxUnusedVar(half);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   <span class="comment">// Maximum method, and no apportionment of any single bins over multiple pixel rows</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   <span class="comment">// See Bug971</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   <span class="keywordtype">int</span> index, limitIndex;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   <span class="keywordflow">if</span> (autocorrelation) {</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="comment">// bin = 2 * half / (half - 1 - array_index);</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="comment">// Solve for index</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      index = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1),</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;         (half - 1) - (2 * half) / (<a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(1.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, bin0))</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      ));</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      limitIndex = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1),</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;         (half - 1) - (2 * half) / (<a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(1.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, bin1))</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      ));</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      index = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(half - 1, <span class="keywordtype">int</span>(floor(0.5 + bin0)));</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      limitIndex = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(half, <span class="keywordtype">int</span>(floor(0.5 + bin1)));</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;   value = spectrum[index];</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;   <span class="keywordflow">while</span> (++index &lt; limitIndex)</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      value = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(value, spectrum[index]);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;   <span class="keywordflow">if</span> (!autocorrelation) {</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">// Last step converts dB to a 0.0-1.0 range</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      value = (value + range + gain) / (<span class="keywordtype">double</span>)range;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   }</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   value = <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(1.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, value));</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;}</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">// Helper function to decide on which color set to use.</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">// dashCount counts both dashes and the spaces between them. </span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="keyword">inline</span></div><div class="line"><a name="l02084"></a><span class="lineno"><a class="line" href="_track_artist_8cpp.html#a9061a778a820c92e76932a871a267877"> 2084</a></span>&#160;<a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfe">AColor::ColorGradientChoice</a> <a class="code" href="_track_artist_8cpp.html#a9061a778a820c92e76932a871a267877">ChooseColorSet</a>( <span class="keywordtype">float</span> bin0, <span class="keywordtype">float</span> bin1, <span class="keywordtype">float</span> selBinLo, </div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   <span class="keywordtype">float</span> selBinCenter, <span class="keywordtype">float</span> selBinHi, <span class="keywordtype">int</span> dashCount, <span class="keywordtype">bool</span> isSpectral )</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;{</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <span class="keywordflow">if</span> (!isSpectral)</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      <span class="keywordflow">return</span>  <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeaf8b5b6cc1c291340c167ed73787e70e2">AColor::ColorGradientTimeSelected</a>;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <span class="keywordflow">if</span> ((selBinCenter &gt;= 0) &amp;&amp; (bin0 &lt;= selBinCenter) &amp;&amp;</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;       (selBinCenter &lt; bin1))</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeabdd31fd590dccaefd1f2ab6df45f85aa">AColor::ColorGradientEdge</a>;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   <span class="keywordflow">if</span> ((0 == dashCount % 2) &amp;&amp;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;       (((selBinLo &gt;= 0) &amp;&amp; (bin0 &lt;= selBinLo) &amp;&amp; ( selBinLo &lt; bin1))  ||</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        ((selBinHi &gt;= 0) &amp;&amp; (bin0 &lt;= selBinHi) &amp;&amp; ( selBinHi &lt; bin1))))</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeabdd31fd590dccaefd1f2ab6df45f85aa">AColor::ColorGradientEdge</a>;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;   <span class="keywordflow">if</span> ((selBinLo &lt; 0 || selBinLo &lt; bin1) &amp;&amp; (selBinHi &lt; 0 || selBinHi &gt; bin0))</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="keywordflow">return</span>  <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfea994bbd5ca3c5a1e50383f71482576ca9">AColor::ColorGradientTimeAndFrequencySelected</a>;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      <span class="keywordflow">return</span>  <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeaf8b5b6cc1c291340c167ed73787e70e2">AColor::ColorGradientTimeSelected</a>;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;}</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawClipSpectrum(<a class="code" href="class_wave_track_cache.html">WaveTrackCache</a> &amp;waveTrackCache,</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_wave_clip.html">WaveClip</a> *clip,</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                                   wxDC &amp; dc,</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                                   <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;{</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="preprocessor">#ifdef PROFILE_WAVEFORM</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;   <a class="code" href="class_profiler.html">Profiler</a> profiler;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_wave_track.html">WaveTrack</a> *<span class="keyword">const</span> track = waveTrackCache.<a class="code" href="class_wave_track_cache.html#a7f431e21835e425e61bfd52f5f310a1f">GetTrack</a>();</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_spectrogram_settings.html">SpectrogramSettings</a> &amp;settings = track-&gt;<a class="code" href="class_wave_track.html#a54f8ed0c9c1d1fae0241867565b33512">GetSpectrogramSettings</a>();</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> autocorrelation = (settings.<a class="code" href="class_spectrogram_settings.html#a9e426ccf5b4ab8210e05c0ead16f4dd0">algorithm</a> == <a class="code" href="class_spectrogram_settings.html#a6b0d17f8056ff543b9e57060a6c6aabaaab944000f92a5f63a9ff5468ef4b5dc2">SpectrogramSettings::algPitchEAC</a>);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;   <span class="keyword">enum</span> { DASH_LENGTH = 10 <span class="comment">/* pixels */</span> };</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   <span class="keyword">const</span> ClipParameters <a class="code" href="_reverb_8cpp.html#aacc5617877d2aa4d17c729c1c8ba4eec">params</a>(<span class="keyword">true</span>, track, clip, rect, selectedRegion, zoomInfo);</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;   <span class="keyword">const</span> wxRect &amp;hiddenMid = params.hiddenMid;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   <span class="comment">// The &quot;hiddenMid&quot; rect contains the part of the display actually</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;   <span class="comment">// containing the waveform, as it appears without the fisheye.  If it&#39;s empty, we&#39;re done.</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="keywordflow">if</span> (hiddenMid.width &lt;= 0) {</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   }</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;t0 = params.t0;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;tOffset = params.tOffset;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ssel0 = params.ssel0;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ssel1 = params.ssel1;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;averagePixelsPerSample = params.averagePixelsPerSample;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a> = params.rate;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;hiddenLeftOffset = params.hiddenLeftOffset;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;leftOffset = params.leftOffset;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;   <span class="keyword">const</span> wxRect &amp;mid = params.mid;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;   <span class="comment">// If we get to this point, the clip is actually visible on the</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;   <span class="comment">// screen, so remember the display rectangle.</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;   clip-&gt;<a class="code" href="class_wave_clip.html#ac42da9000a368776ef8beb582723fb29">SetDisplayRect</a>(hiddenMid);</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keywordtype">double</span> freqLo = <a class="code" href="class_selected_region.html#aeb44ed227fd0a3396dc40f57efe3d432">SelectedRegion::UndefinedFrequency</a>;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;   <span class="keywordtype">double</span> freqHi = <a class="code" href="class_selected_region.html#aeb44ed227fd0a3396dc40f57efe3d432">SelectedRegion::UndefinedFrequency</a>;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_SPECTRAL_EDITING</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;   freqLo = selectedRegion.<a class="code" href="class_selected_region.html#a04b91be00d5df7ef6fd08161dd6f1ec4">f0</a>();</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;   freqHi = selectedRegion.<a class="code" href="class_selected_region.html#a821c5a808c950dc3a4db33297c9e088c">f1</a>();</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;isGrayscale = settings.<a class="code" href="class_spectrogram_settings.html#a0d9fbcfd817862e3b021dfba3ff13ea0">isGrayscale</a>;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;range = settings.<a class="code" href="class_spectrogram_settings.html#ab3c3d2f1f144d6751dacbb7b573726ef">range</a>;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;gain = settings.<a class="code" href="class_spectrogram_settings.html#a7b3f6f14d24664c63cb888625c251f70">gain</a>;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;fftFindNotes = settings.fftFindNotes;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;findNotesMinA = settings.findNotesMinA;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;numberOfMaxima = settings.numberOfMaxima;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;findNotesQuantize = settings.findNotesQuantize;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;fftYGrid = settings.fftYGrid;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;   dc.SetPen(*wxTRANSPARENT_PEN);</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;   <span class="comment">// We draw directly to a bit image in memory,</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   <span class="comment">// and then paint this directly to our offscreen</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;   <span class="comment">// bitmap.  Note that this could be optimized even</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;   <span class="comment">// more, but for now this is not bad.  -dmazzoni</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;   wxImage image((<span class="keywordtype">int</span>)mid.width, (<span class="keywordtype">int</span>)mid.height);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;   <span class="keywordflow">if</span> (!image.IsOk())</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="lib_2expat_8h.html#ac39e72a1de1cb50dbdc54b08d0432a24">data</a> = image.GetData();</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> half = settings.<a class="code" href="class_spectrogram_settings.html#a35321029bb4e809eedb8721db80c448e">GetFFTLength</a>() / 2;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> binUnit = rate / (2 * half);</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">float</span> *freq = 0;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   <span class="keyword">const</span> <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> *where = 0;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;   <span class="keywordtype">bool</span> updated;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   {</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> pps = averagePixelsPerSample * <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      updated = clip-&gt;<a class="code" href="class_wave_clip.html#ad59c0a252dbb49e98f74155b99777ad8">GetSpectrogram</a>(waveTrackCache, freq, where, hiddenMid.width,</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;         t0, pps);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;   }</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;   <span class="keywordtype">float</span> minFreq, maxFreq;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;   track-&gt;<a class="code" href="class_wave_track.html#a6c31cef06f382857502ce036b2dc795b">GetSpectrumBounds</a>(&amp;minFreq, &amp;maxFreq);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fc">SpectrogramSettings::ScaleType</a> scaleType = settings.<a class="code" href="class_spectrogram_settings.html#a8c6871ffc9d2f3f645e9d14c24920e04">scaleType</a>;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_number_scale.html">NumberScale</a> numberScale(settings.<a class="code" href="class_spectrogram_settings.html#aa0c8fbbe53db1ede59a834438a3ee375">GetScale</a>(minFreq, maxFreq, rate, <span class="keyword">true</span>));</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">float</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      log2 = logf(2.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>),</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      scale2 = (lmax - lmin) / log2,</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      lmin2 = lmin / log2;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <span class="keywordtype">bool</span> *yGrid;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   yGrid = <span class="keyword">new</span> <span class="keywordtype">bool</span>[mid.height];</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = 0; yy &lt; mid.height; ++yy) {</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordtype">float</span> n = (float(yy) / mid.height*scale2 - lmin2) * 12;</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keywordtype">float</span> n2 = (float(yy + 1) / mid.height*scale2 - lmin2) * 12;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      <span class="keywordtype">float</span> <a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a> = float(minFreq) / (fftSkipPoints + 1)*powf(2.0f, n / 12.0f + lmin2);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      <span class="keywordtype">float</span> f2 = float(minFreq) / (fftSkipPoints + 1)*powf(2.0f, n2 / 12.0f + lmin2);</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      n = logf(f / 440) / log2 * 12;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      n2 = logf(f2 / 440) / log2 * 12;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="keywordflow">if</span> (floor(n) &lt; floor(n2))</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;         yGrid[yy] = <span class="keyword">true</span>;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;         yGrid[yy] = <span class="keyword">false</span>;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   }</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;   <span class="keywordflow">if</span> (!updated &amp;&amp; clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a31c71c0f3307a1a81f44aa35d16ec042">valid</a> &amp;&amp;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      (clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a35dfc2e3b2a17e94fb4c77847a5356ce">len</a> == hiddenMid.height * hiddenMid.width)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      &amp;&amp; scaleType == clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a796e0079edd616e1651edd8a4b9aa212">scaleType</a></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      &amp;&amp; gain == clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a544e859e9069386b5558b24dd2a23c9d">gain</a></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      &amp;&amp; range == clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a96de1d4e8b6d77973de29c4b3584cfc4">range</a></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      &amp;&amp; minFreq == clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a7a9ac3b5030ffe0f6dc83821126108aa">minFreq</a></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      &amp;&amp; maxFreq == clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a2a248bbe2e6090efba5eee5678849a38">maxFreq</a></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;#ifdef EXPERIMENTAL_FFT_Y_GRID</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   &amp;&amp; fftYGrid==fftYGridOld</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;#endif <span class="comment">//EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;#ifdef EXPERIMENTAL_FIND_NOTES</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;   &amp;&amp; fftFindNotes==fftFindNotesOld</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;   &amp;&amp; findNotesMinA==findNotesMinAOld</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;   &amp;&amp; numberOfMaxima==findNotesNOld</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;   &amp;&amp; findNotesQuantize==findNotesQuantizeOld</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;#endif</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;   ) {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="comment">// Wave clip&#39;s spectrum cache is up to date,</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="comment">// and so is the spectrum pixel cache</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;   }</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="comment">// Update the spectrum pixel cache</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keyword">delete</span> clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a> = <span class="keyword">new</span> <a class="code" href="class_spec_px_cache.html">SpecPxCache</a>(hiddenMid.width * hiddenMid.height);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a31c71c0f3307a1a81f44aa35d16ec042">valid</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a796e0079edd616e1651edd8a4b9aa212">scaleType</a> = scaleType;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a544e859e9069386b5558b24dd2a23c9d">gain</a> = gain;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a96de1d4e8b6d77973de29c4b3584cfc4">range</a> = range;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a7a9ac3b5030ffe0f6dc83821126108aa">minFreq</a> = minFreq;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a2a248bbe2e6090efba5eee5678849a38">maxFreq</a> = maxFreq;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      fftFindNotesOld = fftFindNotes;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      findNotesMinAOld = findNotesMinA;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      findNotesNOld = numberOfMaxima;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      findNotesQuantizeOld = findNotesQuantize;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;         lmins = lmin,</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;         lmaxs = lmax</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;         ;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keywordtype">int</span> maxima[128];</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="keywordtype">float</span> maxima0[128], maxima1[128];</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;         f2bin = half / (rate / 2.0f),</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;         bin2f = 1.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a> / f2bin,</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;         minDistance = powf(2.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, 2.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a> / 12.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>),</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;         i0 = expf(lmin) / binUnit,</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;         <a class="code" href="convtest_8m.html#aec25a56c89da9b37e346ecc7a8fc68e5">i1</a> = expf(<a class="code" href="seqread_8c.html#aa2a8c6fbe5ed24f9523eb4e01368e4bc">scale</a> + lmin) / binUnit,</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;         minColor = 0.0f;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> maxTableSize = 1024;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="keywordtype">int</span> *indexes = <span class="keyword">new</span> <span class="keywordtype">int</span>[maxTableSize];</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xx = 0; xx &lt; hiddenMid.width; ++xx) {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;         <a class="code" href="class_number_scale_1_1_iterator.html">NumberScale::Iterator</a> <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> = numberScale.begin(mid.height);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;         <span class="keywordtype">float</span> nextBin = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1), *it));</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = 0; yy &lt; hiddenMid.height; ++yy) {</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> bin = nextBin;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            nextBin = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1), *++it));</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            <span class="keywordflow">if</span> (settings.<a class="code" href="class_spectrogram_settings.html#a8c6871ffc9d2f3f645e9d14c24920e04">scaleType</a> != <a class="code" href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca5c62f4c050d024a9d5651292713dc49d">SpectrogramSettings::stLogarithmic</a>) {</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = findValue</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                  (freq + half * xx, bin, nextBin, half, autocorrelation, gain, range);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;               clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a0c3a4884f54b874887d4051c1917a8e8">values</a>[xx * hiddenMid.height + yy] = <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            }</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;               <span class="comment">// Do we need this legacy experiment still?</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;               <span class="keywordtype">int</span> maximas = 0;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> x0 = half * <a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a>;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;               <span class="keywordflow">if</span> (fftFindNotes) {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> = maxTableSize - 1; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> &gt;= 0; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>--)</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                     indexes[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = -1;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                  <span class="comment">// Build a table of (most) values, put the index in it.</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> = <span class="keywordtype">int</span>(i0); <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> &lt; <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(i1); <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>++) {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                     <span class="keywordtype">float</span> freqi = freq[x0 + <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>)];</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                     <span class="keywordtype">int</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>((freqi + gain + range) / range*(maxTableSize - 1));</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                     <span class="keywordflow">if</span> (value &lt; 0)</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                        value = 0;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                     <span class="keywordflow">if</span> (value &gt;= maxTableSize)</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                        value = maxTableSize - 1;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                     indexes[<a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>] = <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                  }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                  <span class="comment">// Build from the indices an array of maxima.</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> = maxTableSize - 1; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> &gt;= 0; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>--) {</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                     <span class="keywordtype">int</span> index = indexes[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>];</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                     <span class="keywordflow">if</span> (index &gt;= 0) {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                        <span class="keywordtype">float</span> freqi = freq[x0 + index];</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                        <span class="keywordflow">if</span> (freqi &lt; findNotesMinA)</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                           <span class="keywordflow">break</span>;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                        <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a> = 0; <a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a> &lt; maximas; <a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a>++) {</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                           <span class="comment">// Avoid to store very close maxima.</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                           <span class="keywordtype">float</span> maxm = maxima[<a class="code" href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a>];</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                           <span class="keywordflow">if</span> (maxm / index &lt; minDistance &amp;&amp; index / maxm &lt; minDistance) {</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                              ok = <span class="keyword">false</span>;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                           }</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                        }</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                        <span class="keywordflow">if</span> (ok) {</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                           maxima[maximas++] = index;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                           <span class="keywordflow">if</span> (maximas &gt;= numberOfMaxima)</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                        }</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                     }</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                  }</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">// The f2pix helper macro converts a frequency into a pixel coordinate.</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="preprocessor">#define f2pix(f) (logf(f)-lmins)/(lmaxs-lmins)*hiddenMid.height</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                  <span class="comment">// Possibly quantize the maxima frequencies and create the pixel block limits.</span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> = 0; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> &lt; maximas; <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>++) {</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                     <span class="keywordtype">int</span> index = maxima[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>];</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                     <span class="keywordtype">float</span> <a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a> = float(index)*bin2f;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                     <span class="keywordflow">if</span> (findNotesQuantize)</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                     {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                        f = expf(<span class="keywordtype">int</span>(log(f / 440) / log2 * 12 - 0.5) / 12.0f*log2) * 440;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                        maxima[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = f*f2bin;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                     }</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                     <span class="keywordtype">float</span> f0 = expf((log(f / 440) / log2 * 24 - 1) / 24.0f*log2) * 440;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                     maxima0[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = f2pix(f0);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                     <span class="keywordtype">float</span> f1 = expf((log(f / 440) / log2 * 24 + 1) / 24.0f*log2) * 440;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                     maxima1[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>] = f2pix(f1);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                  }</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;               }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;               <span class="keywordtype">int</span> it = 0;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;               <span class="keywordtype">int</span> oldBin0 = -1;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;               <span class="keywordtype">bool</span> inMaximum = <span class="keyword">false</span>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;               <span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;               <span class="keywordflow">if</span> (fftFindNotes) {</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                  <span class="keywordflow">if</span> (it &lt; maximas) {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                     <span class="keywordtype">float</span> i0 = maxima0[<a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>];</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                     <span class="keywordflow">if</span> (yy &gt;= i0)</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                        inMaximum = <span class="keyword">true</span>;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                     <span class="keywordflow">if</span> (inMaximum) {</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                        <span class="keywordtype">float</span> i1 = maxima1[<a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a>];</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                        <span class="keywordflow">if</span> (yy + 1 &lt;= i1) {</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                           value = findValue(freq + x0, bin, nextBin, half, autocorrelation, gain, range);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                           <span class="keywordflow">if</span> (value &lt; findNotesMinA)</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                              value = minColor;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                        }</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                           it++;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                           inMaximum = <span class="keyword">false</span>;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                           value = minColor;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                        }</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                     }</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                     <span class="keywordflow">else</span> {</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                        value = minColor;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                     }</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                  }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                     value = minColor;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;               }</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FIND_NOTES</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;               {</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                  value = findValue</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                     (freq + half * xx, bin, nextBin, half, autocorrelation, gain, range);</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;               }</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;               clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a0c3a4884f54b874887d4051c1917a8e8">values</a>[xx * hiddenMid.height + yy] = <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a>;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            } <span class="comment">// logF</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;         } <span class="comment">// each yy</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      } <span class="comment">// each xx</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;   } <span class="comment">// updating cache</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;   <span class="keywordtype">float</span> selBinLo = freqLo / binUnit;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   <span class="keywordtype">float</span> selBinHi = freqHi / binUnit;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;   <span class="keywordtype">float</span> selBinCenter =</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      ((freqLo &lt; 0 || freqHi &lt; 0) ? -1 : sqrt(freqLo * freqHi)) / binUnit;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> w1(0.5 + rate *</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      (zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(0, -leftOffset) - tOffset)</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;   );</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> isSpectral = settings.<a class="code" href="class_spectrogram_settings.html#a3da0925d9ef43e50e04df908923ae48b">SpectralSelectionEnabled</a>();</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> hidden = (<a class="code" href="class_zoom_info.html#a21e3cd944a2c0241db3c32b2416ba7b6aac88e9f498c9306c26caffbeaa349a8e">ZoomInfo::HIDDEN</a> == zoomInfo.<a class="code" href="class_zoom_info.html#a342ed72b12a2ff5663d22e93d9a3c44c">GetFisheyeState</a>());</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> begin = hidden</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      ? 0</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      : <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, <span class="keywordtype">int</span>(zoomInfo.<a class="code" href="class_zoom_info.html#aa762137abb7f349ee3ac25dfce0c3635">GetFisheyeLeftBoundary</a>(-leftOffset)));</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a> = hidden</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      ? 0</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      : <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(mid.width, <span class="keywordtype">int</span>(zoomInfo.<a class="code" href="class_zoom_info.html#ab565b4ba0354aa8b409f2e3096e55143">GetFisheyeRightBoundary</a>(-leftOffset)));</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> numPixels = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0, end - begin);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> zeroPaddingFactor = autocorrelation ? 1 : settings.<a class="code" href="class_spectrogram_settings.html#ae627610702531c18a358f3df459027e8">zeroPaddingFactor</a>;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   <a class="code" href="class_spec_cache.html">SpecCache</a> specCache</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      (numPixels, settings.<a class="code" href="class_spectrogram_settings.html#a9e426ccf5b4ab8210e05c0ead16f4dd0">algorithm</a>, -1,</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;       t0, settings.<a class="code" href="class_spectrogram_settings.html#a7fbea69cb9478dd7d894d9399561c736">windowType</a>,</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;       settings.<a class="code" href="class_spectrogram_settings.html#afbb300bf82421e6d50cb81b7032f7529">windowSize</a>, zeroPaddingFactor, settings.<a class="code" href="class_spectrogram_settings.html#a14b8af717362fd3d5e176a5e9a81783d">frequencyGain</a>);</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   <span class="keywordflow">if</span> (numPixels &gt; 0) {</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = begin; ii &lt; <a class="code" href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a>; ++ii) {</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacepyportmidi_1_1midi.html#ad2426758f88d23d7208984d5c99ec050">time</a> = zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(ii, -leftOffset) - tOffset;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;         specCache.<a class="code" href="class_spec_cache.html#ae2c827b1ffd882effd31281fe1d67fc0">where</a>[ii - begin] = <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(0.5 + rate * time);</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      }</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      specCache.<a class="code" href="class_spec_cache.html#a77eeba6191fe84d47a8a3053ece7ec0e">Populate</a></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;         (settings, waveTrackCache,</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;          0, 0, numPixels,</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;          clip-&gt;<a class="code" href="class_wave_clip.html#a6cd003778b510cad742feaa5763c6ac2">GetNumSamples</a>(),</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;          tOffset, <a class="code" href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a>,</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;          0 <span class="comment">//FIXME -- make reassignment work with fisheye</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;       );</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;   }</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   <span class="keywordtype">int</span> correctedX = leftOffset - hiddenLeftOffset;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <span class="keywordtype">int</span> fisheyeColumn = 0;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xx = 0; xx &lt; mid.width; ++xx, ++correctedX)</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   {</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> inFisheye = zoomInfo.<a class="code" href="class_zoom_info.html#a58a0384edf7d035b5be58f6b0b25bdb5">InFisheye</a>(xx, -leftOffset);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keywordtype">float</span> *<span class="keyword">const</span> uncached =</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;         inFisheye ? &amp;specCache.<a class="code" href="class_spec_cache.html#ad51fc14ddf41540e51b9c4f458218bfc">freq</a>[(fisheyeColumn++) * half] : 0;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a> w0 = w1;</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      w1 = <a class="code" href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a>(0.5 + rate *</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;         (zoomInfo.<a class="code" href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">PositionToTime</a>(xx + 1, -leftOffset) - tOffset)</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      );</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <a class="code" href="class_number_scale_1_1_iterator.html">NumberScale::Iterator</a> <a class="code" href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a> = numberScale.begin(mid.height);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      <span class="keywordtype">float</span> nextBin = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1), *it));</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = 0; yy &lt; hiddenMid.height; ++yy) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">float</span> bin = nextBin;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;         nextBin = <a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(0.0<a class="code" href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a>, <a class="code" href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">std::min</a>(<span class="keywordtype">float</span>(half - 1), *++it));</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;         <span class="comment">// For spectral selection, determine what colour</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;         <span class="comment">// set to use.  We use a darker selection if</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;         <span class="comment">// in both spectral range and time range.</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;         <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfe">AColor::ColorGradientChoice</a> selected = <a class="code" href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfea341b5b9c96dc41728b34bd4cb7ecaf29">AColor::ColorGradientUnselected</a>;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;         <span class="comment">// If we are in the time selected range, then we may use a different color set.</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;         <span class="keywordflow">if</span> (ssel0 &lt;= w0 &amp;&amp; w1 &lt; ssel1)</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            selected =</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;               <a class="code" href="_track_artist_8cpp.html#a9061a778a820c92e76932a871a267877">ChooseColorSet</a>(bin, nextBin, selBinLo, selBinCenter, selBinHi,</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                  (xx + leftOffset - hiddenLeftOffset) / DASH_LENGTH, isSpectral);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a> = uncached</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            ? findValue(uncached, bin, nextBin, half, autocorrelation, gain, range)</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            : clip-&gt;<a class="code" href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">mSpecPxCache</a>-&gt;<a class="code" href="class_spec_px_cache.html#a0c3a4884f54b874887d4051c1917a8e8">values</a>[correctedX * hiddenMid.height + yy];</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> rv, gv, bv;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;         <a class="code" href="_a_color_8h.html#a0fe4b1a08d7994dfe1c28e972a3b2e2a">GetColorGradient</a>(value, selected, isGrayscale, &amp;rv, &amp;gv, &amp;bv);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;         <span class="keywordflow">if</span> (fftYGrid &amp;&amp; yGrid[yy]) {</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            rv /= 1.1f;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            gv /= 1.1f;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            bv /= 1.1f;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;         }</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         <span class="keywordtype">int</span> px = ((mid.height - 1 - yy) * mid.width + xx) * 3;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         data[px++] = rv;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         data[px++] = gv;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         data[px] = bv;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      } <span class="comment">// each yy</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;   } <span class="comment">// each xx</span></div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;   wxBitmap converted = wxBitmap(image);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   wxMemoryDC memDC;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   memDC.SelectObject(converted);</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   dc.Blit(mid.x, mid.y, mid.width, mid.height, &amp;memDC, 0, 0, wxCOPY, <a class="code" href="cext_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#ifdef EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;   <span class="keyword">delete</span>[] yGrid;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="preprocessor">#endif //EXPERIMENTAL_FFT_Y_GRID</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;}</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="preprocessor">#ifdef USE_MIDI</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">Note: recall that Allegro attributes end in a type identifying letter.</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">In addition to standard notes, an Allegro_Note can denote a graphic.</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">A graphic is a note with a loud of zero (for quick testing) and an</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">attribute named &quot;shapea&quot; set to one of the following atoms:</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">    line</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">        from (time, pitch) to (time+dur, y1r), where y1r is an</span></div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">          attribute</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">    rectangle</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment">        from (time, pitch) to (time+dur, y1r), where y1r is an</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment">          attribute</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">    triangle</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">        coordinates are (time, pitch), (x1r, y1r), (x2r, y2r)</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">        dur must be the max of x1r-time, x2r-time</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">    polygon</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">        coordinates are (time, pitch), (x1r, y1r), (x2r, y2r),</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">          (x3r, y3r), ... are coordinates (since we cannot represent</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">          arrays as attribute values, we just generate as many</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">          attribute names as we need)</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">        dur must be the max of xNr-time for all N</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">    oval</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">        similar to rectangle</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">        Note: this oval has horizontal and vertical axes only</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">    text</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">        drawn at (time, pitch)</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">        duration should be zero (text is clipped based on time and duration,</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment">          NOT based on actual coordinates)</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment">and optional attributes as follows:</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">    linecolori is 0x00rrggbb format color for line or text foreground</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">    fillcolori is 0x00rrggbb format color for fill or text background</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">    linethicki is line thickness in pixels, 0 for no line</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">    filll is true to fill rectangle or draw text background (default is false)</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment">    fonta is one of [&#39;roman&#39;, &#39;swiss&#39;, &#39;modern&#39;] (font, otherwise use default)</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">    weighta may be &#39;bold&#39; (font) (default is normal)</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">    sizei is font size (default is 8)</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">    justifys is a string containing two letters, a horizontal code and a</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">      vertical code. The horizontal code is as follows:</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">        l: the coordinate is to the left of the string (default)</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">        c: the coordinate is at the center of the string</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">        r: the coordinate is at the right of the string</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment">      The vertical code is as follows:</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment">        t: the coordinate is at the top of the string</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">        c: the coordinate is at the center of the string</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">        b: the coordinate is at the bottom of the string</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment">        d: the coordinate is at the baseline of the string (default)</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="comment">      Thus, -justifys:&quot;lt&quot; places the left top of the string at the point</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">        given by (pitch, time). The default value is &quot;ld&quot;.</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">/* Declare Static functions */</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *IsShape(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> <a class="code" href="handlers_8c.html#a82c195c0687005edfeb733c7b5887c33">note</a>);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> LookupRealAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">double</span> def);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="keyword">static</span> <span class="keywordtype">long</span> LookupIntAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">long</span> def);</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> LookupLogicalAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">bool</span> def);</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *LookupStringAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keyword">const</span> <span class="keywordtype">char</span> *def);</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *LookupAtomAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">char</span> *def);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">//static int PITCH_TO_Y(double p, int bottom);</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">// returns NULL if note is not a shape,</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">// returns atom (string) value of note if note is a shape</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *IsShape(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note)</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;{</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">if</span> (strcmp(parameters-&gt;parm.attr_name(), <span class="stringliteral">&quot;shapea&quot;</span>) == 0) {</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.a;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    }</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  }</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;}</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment">// returns value of attr, or default if not found</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="keywordtype">double</span> LookupRealAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">double</span> def)</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;{</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keywordflow">if</span> (parameters-&gt;parm.attr_name() == attr + 1 &amp;&amp;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        parameters-&gt;parm.attr_type() == <span class="charliteral">&#39;r&#39;</span>) {</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.r;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    }</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  }</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="keywordflow">return</span> def;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;}</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">// returns value of attr, or default if not found</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="keywordtype">long</span> LookupIntAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">long</span> def)</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;{</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">if</span> (parameters-&gt;parm.attr_name() == attr + 1 &amp;&amp;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        parameters-&gt;parm.attr_type() == <span class="charliteral">&#39;i&#39;</span>) {</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.i;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    }</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  }</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="keywordflow">return</span> def;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;}</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">// returns value of attr, or default if not found</span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="keywordtype">bool</span> LookupLogicalAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">bool</span> def)</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;{</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">if</span> (parameters-&gt;parm.attr_name() == attr + 1 &amp;&amp;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        parameters-&gt;parm.attr_type() == <span class="charliteral">&#39;l&#39;</span>) {</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.l;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    }</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  }</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="keywordflow">return</span> def;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;}</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">// returns value of attr, or default if not found</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *LookupStringAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keyword">const</span> <span class="keywordtype">char</span> *def)</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;{</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="keywordflow">if</span> (parameters-&gt;parm.attr_name() == attr + 1 &amp;&amp;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        parameters-&gt;parm.attr_type() == <span class="charliteral">&#39;s&#39;</span>) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.s;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordflow">return</span> def;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;}</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="comment">// returns value of attr, or default if not found</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *LookupAtomAttribute(<a class="code" href="class_alg__note.html">Alg_note_ptr</a> note, <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr, <span class="keywordtype">char</span> *def)</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;{</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  <a class="code" href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a> parameters = note-&gt;<a class="code" href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">parameters</a>;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;  <span class="keywordflow">while</span> (parameters) {</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="keywordflow">if</span> (parameters-&gt;parm.attr_name() == attr + 1 &amp;&amp;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        parameters-&gt;parm.attr_type() == <span class="charliteral">&#39;a&#39;</span>) {</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      <span class="keywordflow">return</span> parameters-&gt;parm.s;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    }</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    parameters = parameters-&gt;next;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  }</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="keywordflow">return</span> def;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;}</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="preprocessor">#define TIME_TO_X(t) (zoomInfo.TimeToPosition((t), rect.x))</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="preprocessor">#define X_TO_TIME(xx) (zoomInfo.PositionToTime((xx), rect.x))</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">// CLIP(x) changes x to lie between +/- CLIP_MAX due to graphics display problems</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">//  with very large coordinate values (this happens when you zoom in very far)</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">//  This will cause incorrect things to be displayed, but at these levels of zoom</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">//  you will only see a small fraction of the overall shape. Note that rectangles</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">//  and lines are clipped in a way that preserves correct graphics, so in</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">//  particular, line plots will be correct at any zoom (limited by floating point</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">//  precision).</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="preprocessor">#define CLIP_MAX 16000</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="preprocessor">#define CLIP(xx) { long c = (xx); if (c &lt; -CLIP_MAX) c = -CLIP_MAX; \</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="preprocessor">                  if (c &gt; CLIP_MAX) c = CLIP_MAX; (xx) = c; }</span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="preprocessor">#define RED(i) ( unsigned char )( (((i) &gt;&gt; 16) &amp; 0xff) )</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="preprocessor">#define GREEN(i) ( unsigned char )( (((i) &gt;&gt; 8) &amp; 0xff) )</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="preprocessor">#define BLUE(i) ( unsigned char )( ((i) &amp; 0xff) )</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment">//#define PITCH_TO_Y(p) (rect.y + rect.height - int(pitchht * ((p) + 0.5 - pitch0) + 0.5))</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">int PitchToY(double p, int bottom)</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">   int octave = (((int) (p + 0.5)) / 12);</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">   int n = ((int) (p + 0.5)) % 12;</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">   return IPITCH_TO_Y((int) (p + 0.5));</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">   // was: bottom - octave * octaveHeight - notePos[n] - 4;</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">/* DrawNoteBackground is called by DrawNoteTrack twice: once to draw</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">   the unselected background, and once to draw the selected background.</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">   The selected background is the same except for the horizontal range</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">   and the colors. The background rectangle region is given by rect; the</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">   selected region is given by sel. The first time this is called,</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">   sel is equal to rect, and the entire region is drawn with unselected</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">   background colors.</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawNoteBackground(<span class="keyword">const</span> <a class="code" href="class_note_track.html">NoteTrack</a> *track, wxDC &amp;dc,</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                                     <span class="keyword">const</span> wxRect &amp;rect, <span class="keyword">const</span> wxRect &amp;sel,</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                                     <span class="keyword">const</span> wxBrush &amp;wb, <span class="keyword">const</span> wxPen &amp;wp,</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                                     <span class="keyword">const</span> wxBrush &amp;bb, <span class="keyword">const</span> wxPen &amp;bp,</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                                     <span class="keyword">const</span> wxPen &amp;mp)</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;{</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;   dc.SetBrush(wb);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;   dc.SetPen(wp);</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   dc.DrawRectangle(sel); <span class="comment">// fill rectangle with white keys background</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;   <span class="keywordtype">int</span> left = TIME_TO_X(track-&gt;GetOffset());</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;   <span class="keywordflow">if</span> (left &lt; sel.x) left = sel.x; <span class="comment">// clip on left</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   <span class="keywordtype">int</span> right = TIME_TO_X(track-&gt;GetOffset() + track-&gt;mSeq-&gt;get_real_dur());</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;   <span class="keywordflow">if</span> (right &gt; sel.x + sel.width) right = sel.x + sel.width; <span class="comment">// clip on right</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;   <span class="comment">// need overlap between MIDI data and the background region</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;   <span class="keywordflow">if</span> (left &gt;= right) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;   dc.SetBrush(bb);</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;   <span class="keywordtype">int</span> octave = 0;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;   <span class="comment">// obottom is the window coordinate of octave divider line</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;   <span class="keywordtype">int</span> obottom = track-&gt;GetOctaveBottom(octave);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   <span class="comment">// eOffset is for the line between E and F; there&#39;s another line</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;   <span class="comment">// between B and C, hence the offset of 2 for two line thicknesses</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;   <span class="keywordtype">int</span> eOffset = track-&gt;GetPitchHeight() * 5 + 2;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;   <span class="keywordflow">while</span> (obottom &gt; rect.y + track-&gt;GetNoteMargin() + 3) {</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <span class="comment">// draw a black line separating octaves if this octave botton is visible</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <span class="keywordflow">if</span> (obottom &lt; rect.y + rect.height - track-&gt;GetNoteMargin()) {</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;         dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;         <span class="comment">// obottom - 1 because obottom is at the bottom of the line</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, left, obottom - 1, right, obottom - 1);</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      }</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      dc.SetPen(bp);</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="comment">// draw a black-key stripe colored line separating E and F if visible</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keywordflow">if</span> (obottom - eOffset &gt; rect.y &amp;&amp; obottom - eOffset &lt; rect.y + rect.height) {</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;         <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, left, obottom - eOffset,</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                          right, obottom - eOffset);</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      }</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      <span class="comment">// draw visible black key lines</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      wxRect br;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      br.x = left;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      br.width = right - left;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      br.height = track-&gt;GetPitchHeight();</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> black = 0; black &lt; 5; black++) {</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;         br.y = obottom - track-&gt;GetBlackPos(black);</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;         <span class="keywordflow">if</span> (br.y &gt; rect.y &amp;&amp; br.y + br.height &lt; rect.y + rect.height) {</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            dc.DrawRectangle(br); <span class="comment">// draw each black key background stripe</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;         }</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      }</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      obottom = track-&gt;GetOctaveBottom(++octave);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   }</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;   <span class="comment">// draw bar lines</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;   <a class="code" href="allegro_8h.html#aad5a663237745add3ab7fec40d5f2c87">Alg_seq_ptr</a> seq = track-&gt;mSeq;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;   <span class="comment">// We assume that sliding a NoteTrack around slides the barlines</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;   <span class="comment">// along with the notes. This means that when we write out a track</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;   <span class="comment">// as Allegro or MIDI without the offset, we&#39;ll need to insert an</span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;   <span class="comment">// integer number of measures of silence, using tempo change to</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   <span class="comment">// match the duration to the offset.</span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   <span class="comment">// Iterate over all time signatures to generate beat positions of</span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   <span class="comment">// bar lines, map the beats to times, map the times to position,</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;   <span class="comment">// and draw the bar lines that fall within the region of interest (sel)</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;   <span class="comment">// seq-&gt;convert_to_beats();</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   dc.SetPen(mp);</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;   <a class="code" href="class_alg__time__sigs.html">Alg_time_sigs</a> &amp;sigs = seq-&gt;time_sig;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a> = 0; <span class="comment">// index into ts[]</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <span class="keywordtype">double</span> next_bar_beat = 0.0;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   <span class="keywordtype">double</span> beats_per_measure = 4.0;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <span class="keywordflow">if</span> (i &lt; sigs.<a class="code" href="class_alg__time__sigs.html#ab4caa20f4b1dc6f3c9d72d30a72ea1fa">length</a>() &amp;&amp; sigs[<a class="code" href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a>].beat &lt; next_bar_beat + <a class="code" href="allegro_8h.html#ad0b977172262373d5dc58a536e52f4b5">ALG_EPS</a>) {</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;         <span class="comment">// NEW time signature takes effect</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;         <a class="code" href="class_alg__time__sig.html">Alg_time_sig</a> &amp;sig = sigs[i++];</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;         next_bar_beat = sig.<a class="code" href="class_alg__time__sig.html#a6934cb96babb7728fb421236186d7fc1">beat</a>;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;         beats_per_measure = (sig.<a class="code" href="class_alg__time__sig.html#a79476aacf5e3138f24ee80f56d6fc580">num</a> * 4.0) / sig.<a class="code" href="class_alg__time__sig.html#aff9848a9e6b557a01048ca0cffb9edef">den</a>;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      }</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <span class="comment">// map beat to time</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a> = seq-&gt;get_time_map()-&gt;beat_to_time(next_bar_beat);</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      <span class="comment">// map time to position</span></div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <span class="keywordtype">int</span> xx = TIME_TO_X(t + track-&gt;GetOffset());</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      <span class="keywordflow">if</span> (xx &gt; right) <span class="keywordflow">break</span>;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, xx, sel.y, xx, sel.y + sel.height);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      next_bar_beat += beats_per_measure;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   }</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;}</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">/* DrawNoteTrack:</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">Draws a piano-roll style display of sequence data with added</span></div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">graphics. Since there may be notes outside of the display region,</span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">reserve a half-note-height margin at the top and bottom of the</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">window and draw out-of-bounds notes here instead.</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawNoteTrack(<span class="keyword">const</span> <a class="code" href="class_note_track.html">NoteTrack</a> *track,</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                                wxDC &amp; dc,</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                                <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo,</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                                <span class="keywordtype">bool</span> muted)</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;{</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;   <a class="code" href="_note_track_8h.html#a7af15a91cee17af51fbff3cdf6bafdee">SonifyBeginNoteBackground</a>();</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;   <span class="keywordtype">double</span> sel0 = selectedRegion.<a class="code" href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">t0</a>();</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;   <span class="keywordtype">double</span> sel1 = selectedRegion.<a class="code" href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">t1</a>();</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> h = X_TO_TIME(rect.x);</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> h1 = X_TO_TIME(rect.x + rect.width);</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;   <a class="code" href="allegro_8h.html#aad5a663237745add3ab7fec40d5f2c87">Alg_seq_ptr</a> seq = track-&gt;mSeq;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;   <span class="keywordflow">if</span> (!seq) {</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(track-&gt;mSerializationBuffer);</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      <span class="comment">// JKC: Previously this indirected via seq-&gt;, a NULL pointer.</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <span class="comment">// This was actually OK, since unserialize is a static function.</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="comment">// Alg_seq:: is clearer.</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="class_alg__track.html">Alg_track_ptr</a> alg_track = <a class="code" href="class_alg__track.html#a2917672177e913ffff409624792e52d4">Alg_seq::unserialize</a>(track-&gt;mSerializationBuffer,</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;            track-&gt;mSerializationLength);</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(alg_track-&gt;<a class="code" href="class_alg__event__list.html#aed21c54de575437ce6a60625ac6a8cc2">get_type</a>() == <span class="charliteral">&#39;s&#39;</span>);</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="keyword">const_cast&lt;</span><a class="code" href="class_note_track.html">NoteTrack</a>*<span class="keyword">&gt;</span>(track)-&gt;mSeq = seq = (<a class="code" href="allegro_8h.html#aad5a663237745add3ab7fec40d5f2c87">Alg_seq_ptr</a>) alg_track;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      free(track-&gt;mSerializationBuffer);</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      track-&gt;mSerializationBuffer = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;   }</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   <a class="code" href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(seq);</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   <span class="keywordtype">int</span> visibleChannels = track-&gt;mVisibleChannels;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;   <span class="keywordflow">if</span> (!track-&gt;GetSelected())</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      sel0 = sel1 = 0.0;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   <span class="comment">// reserve 1/2 note height at top and bottom of track for</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   <span class="comment">// out-of-bounds notes</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;   <span class="keywordtype">int</span> numPitches = (rect.height) / track-&gt;GetPitchHeight();</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   <span class="keywordflow">if</span> (numPitches &lt; 0) numPitches = 0; <span class="comment">// cannot be negative</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;   <span class="comment">// bottom is the hypothetical location of the bottom of pitch 0 relative to</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   <span class="comment">// the top of the clipping region rect: rect.height - PITCH_HEIGHT/2 is where the</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   <span class="comment">// bottomNote is displayed, and to that</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   <span class="comment">// we add the height of bottomNote from the position of pitch 0</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   track-&gt;PrepareIPitchToY(rect);</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   <span class="comment">// Background comes in 6 colors:</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;   <span class="comment">//   214, 214,214 -- unselected white keys</span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;   <span class="comment">//   192,192,192 -- unselected black keys</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   <span class="comment">//   170,170,170 -- unselected bar lines</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;   <span class="comment">//   165,165,190 -- selected white keys</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;   <span class="comment">//   148,148,170 -- selected black keys</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;   <span class="comment">//   131,131,150 -- selected bar lines</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;   wxPen blackStripePen;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   blackStripePen.SetColour(192, 192, 192);</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   wxBrush blackStripeBrush;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   blackStripeBrush.SetColour(192, 192, 192);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   wxPen barLinePen;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   barLinePen.SetColour(170, 170, 170);</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;   DrawNoteBackground(track, dc, rect, rect, zoomInfo, blankBrush, blankPen,</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                      blackStripeBrush, blackStripePen, barLinePen);</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   dc.SetClippingRegion(rect);</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   <span class="comment">// Draw the selection background</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   <span class="comment">// First, the white keys, as a single rectangle</span></div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   <span class="comment">// In other words fill the selection area with selectedWhiteKeyPen</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;   wxRect selBG;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;   selBG.y = rect.y;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;   selBG.height = rect.height;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;   selBG.x = TIME_TO_X(sel0);</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;   selBG.width = TIME_TO_X(sel1) - TIME_TO_X(sel0);</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;   wxPen selectedWhiteKeyPen;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;   selectedWhiteKeyPen.SetColour(165, 165, 190);</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;   dc.SetPen(selectedWhiteKeyPen);</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   wxBrush selectedWhiteKeyBrush;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;   selectedWhiteKeyBrush.SetColour(165, 165, 190);</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;   <span class="comment">// Then, the black keys and octave stripes, as smaller rectangles</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;   wxPen selectedBlackKeyPen;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;   selectedBlackKeyPen.SetColour(148, 148, 170);</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   wxBrush selectedBlackKeyBrush;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   selectedBlackKeyBrush.SetColour(148, 148, 170);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   wxPen selectedBarLinePen;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   selectedBarLinePen.SetColour(131, 131, 150);</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;   DrawNoteBackground(track, dc, rect, selBG, zoomInfo,</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                      selectedWhiteKeyBrush, selectedWhiteKeyPen,</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                      selectedBlackKeyBrush, selectedBlackKeyPen,</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                      selectedBarLinePen);</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;   <a class="code" href="_note_track_8h.html#a9786c3ef2b94eedc6fe66b64a5681f74">SonifyEndNoteBackground</a>();</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;   <a class="code" href="_note_track_8h.html#aa89494ee94299dead423eae180285079">SonifyBeginNoteForeground</a>();</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;   <span class="keywordtype">int</span> marg = track-&gt;GetNoteMargin();</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   <span class="comment">// NOTE: it would be better to put this in some global initialization</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;   <span class="comment">// function rather than do lookups every time.</span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> <a class="code" href="seqread_8c.html#aad9ebcdde542d8b2075615388ff15a9c">line</a> = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;line&quot;</span>);</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> rectangle = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;rectangle&quot;</span>);</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> triangle = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;triangle&quot;</span>);</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> polygon = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;polygon&quot;</span>);</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> oval = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;oval&quot;</span>);</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> text = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;text&quot;</span>);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> texts = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;texts&quot;</span>);</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> x1r = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;x1r&quot;</span>);</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> x2r = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;x2r&quot;</span>);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> y1r = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;y1r&quot;</span>);</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> y2r = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;y2r&quot;</span>);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> linecolori = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;linecolori&quot;</span>);</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> fillcolori = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;fillcolori&quot;</span>);</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> linethicki = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;linethicki&quot;</span>);</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> filll = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;filll&quot;</span>);</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> fonta = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;fonta&quot;</span>);</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> roman = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;roman&quot;</span>);</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> swiss = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;swiss&quot;</span>);</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> modern = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;modern&quot;</span>);</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> weighta = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;weighta&quot;</span>);</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> bold = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;bold&quot;</span>);</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> sizei = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;sizei&quot;</span>);</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;   <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> justifys = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(<span class="stringliteral">&quot;justifys&quot;</span>);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;   <span class="comment">// We want to draw in seconds, so we need to convert to seconds</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   seq-&gt;convert_to_seconds();</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;   <a class="code" href="class_alg__iterator.html">Alg_iterator</a> iterator(seq, <span class="keyword">false</span>);</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;   iterator.<a class="code" href="class_alg__iterator.html#a59c05da591cc008ff1be195335646046">begin</a>();</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;   <span class="comment">//for every event</span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;   <a class="code" href="allegro_8h.html#aeb8db009b4ffadef2e7ca0e4936f0307">Alg_event_ptr</a> evt;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;   <span class="keywordflow">while</span> (0 != (evt = iterator.<a class="code" href="class_alg__iterator.html#af175a74563cdefc967e4b568763fa818">next</a>())) {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;      <span class="keywordflow">if</span> (evt-&gt;get_type() == <span class="charliteral">&#39;n&#39;</span>) { <span class="comment">// &#39;n&#39; means a note</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;         <a class="code" href="class_alg__note.html">Alg_note_ptr</a> note = (<a class="code" href="allegro_8h.html#a49bc03b187e4468a764d73df4c860206">Alg_note_ptr</a>) evt;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;         <span class="comment">// if the note&#39;s channel is visible</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;         <span class="keywordflow">if</span> (visibleChannels &amp; (1 &lt;&lt; (evt-&gt;chan &amp; 15))) {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <span class="keywordtype">double</span> xx = note-&gt;<a class="code" href="class_alg__event.html#a7d31289f03b355f25e0ddd4657783a13">time</a> + track-&gt;GetOffset();</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            <span class="keywordtype">double</span> x1 = xx + note-&gt;<a class="code" href="class_alg__note.html#ae15463f6b0deca3ac1a179683dd8e6ee">dur</a>;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            <span class="keywordflow">if</span> (xx &lt; h1 &amp;&amp; x1 &gt; h) { <span class="comment">// omit if outside box</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *shape = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;               <span class="keywordflow">if</span> (note-&gt;<a class="code" href="class_alg__note.html#aefa0a5b76a5747b0e95f96bc8046e199">loud</a> &gt; 0.0 || 0 == (shape = IsShape(note))) {</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                  wxRect nr; <span class="comment">// &quot;note rectangle&quot;</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                  nr.y = track-&gt;PitchToY(note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>);</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                  nr.height = track-&gt;GetPitchHeight();</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                  nr.x = TIME_TO_X(xx);</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                  nr.width = TIME_TO_X(x1) - nr.x;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                  <span class="keywordflow">if</span> (nr.x + nr.width &gt;= rect.x &amp;&amp; nr.x &lt; rect.x + rect.width) {</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                     <span class="keywordflow">if</span> (nr.x &lt; rect.x) {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                        nr.width -= (rect.x - nr.x);</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                        nr.x = rect.x;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                     }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                     <span class="keywordflow">if</span> (nr.x + nr.width &gt; rect.x + rect.width) <span class="comment">// clip on right</span></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                        nr.width = rect.x + rect.width - nr.x;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                     <span class="keywordflow">if</span> (nr.y + nr.height &lt; rect.y + marg + 3) {</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                         <span class="comment">// too high for window</span></div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                         nr.y = rect.y;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                         nr.height = marg;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                         dc.SetBrush(*wxBLACK_BRUSH);</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                         dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                         dc.DrawRectangle(nr);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nr.y &gt;= rect.y + rect.height - marg - 1) {</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                         <span class="comment">// too low for window</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                         nr.y = rect.y + rect.height - marg;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                         nr.height = marg;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                         dc.SetBrush(*wxBLACK_BRUSH);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                         dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                         dc.DrawRectangle(nr);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                        <span class="keywordflow">if</span> (nr.y + nr.height &gt; rect.y + rect.height - marg)</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                           nr.height = rect.y + rect.height - nr.y;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                        <span class="keywordflow">if</span> (nr.y &lt; rect.y + marg) {</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                           <span class="keywordtype">int</span> <a class="code" href="layer12_8c.html#a33d71f23ba2052d17f0b754dc35265b0">offset</a> = rect.y + marg - nr.y;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                           nr.height -= <a class="code" href="layer12_8c.html#a33d71f23ba2052d17f0b754dc35265b0">offset</a>;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                           nr.y += <a class="code" href="layer12_8c.html#a33d71f23ba2052d17f0b754dc35265b0">offset</a>;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                        }</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                        <span class="comment">// nr.y += rect.y;</span></div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                        <span class="keywordflow">if</span> (muted)</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                           <a class="code" href="class_a_color.html#a5cb93580edc1c0b99f1664d270695e96">AColor::LightMIDIChannel</a>(&amp;dc, note-&gt;<a class="code" href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">chan</a> + 1);</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                           <a class="code" href="class_a_color.html#a9d1ba34941443e99c15a240b5aed4343">AColor::MIDIChannel</a>(&amp;dc, note-&gt;<a class="code" href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">chan</a> + 1);</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                        dc.DrawRectangle(nr);</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                        <span class="keywordflow">if</span> (track-&gt;GetPitchHeight() &gt; 2) {</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                           <a class="code" href="class_a_color.html#a5cb93580edc1c0b99f1664d270695e96">AColor::LightMIDIChannel</a>(&amp;dc, note-&gt;<a class="code" href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">chan</a> + 1);</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                           <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, nr.x, nr.y, nr.x + nr.width-2, nr.y);</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                           <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, nr.x, nr.y, nr.x, nr.y + nr.height-2);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                           <a class="code" href="class_a_color.html#ae549f98f5f729285ccb884367fbb7e24">AColor::DarkMIDIChannel</a>(&amp;dc, note-&gt;<a class="code" href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">chan</a> + 1);</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                           <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, nr.x+nr.width-1, nr.y,</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                                 nr.x+nr.width-1, nr.y+nr.height-1);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                           <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, nr.x, nr.y+nr.height-1,</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                                 nr.x+nr.width-1, nr.y+nr.height-1);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                        }</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                     }</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                  }</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                  <span class="comment">// draw a shape according to attributes</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                  <span class="comment">// add 0.5 to pitch because pitches are plotted with</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                  <span class="comment">// height = PITCH_HEIGHT; thus, the center is raised</span></div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                  <span class="comment">// by PITCH_HEIGHT * 0.5</span></div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                  <span class="keywordtype">int</span> yy = track-&gt;PitchToY(note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>);</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                  <span class="keywordtype">long</span> linecolor = LookupIntAttribute(note, linecolori, -1);</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                  <span class="keywordtype">long</span> linethick = LookupIntAttribute(note, linethicki, 1);</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;                  <span class="keywordtype">long</span> fillcolor = -1;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                  <span class="keywordtype">long</span> fillflag = 0;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                  <span class="comment">// set default color to be that of channel</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                  <a class="code" href="class_a_color.html#a9d1ba34941443e99c15a240b5aed4343">AColor::MIDIChannel</a>(&amp;dc, note-&gt;<a class="code" href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">chan</a>+1);</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                  <span class="keywordflow">if</span> (shape != text) {</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                     <span class="keywordflow">if</span> (linecolor != -1)</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                        dc.SetPen(wxPen(wxColour(RED(linecolor),</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                              GREEN(linecolor),</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                              BLUE(linecolor)),</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                              linethick, wxSOLID));</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                  }</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                  <span class="keywordflow">if</span> (shape != line) {</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                     fillcolor = LookupIntAttribute(note, fillcolori, -1);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                     fillflag = LookupLogicalAttribute(note, filll, <span class="keyword">false</span>);</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                     <span class="keywordflow">if</span> (fillcolor != -1)</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                        dc.SetBrush(wxBrush(wxColour(RED(fillcolor),</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                              GREEN(fillcolor),</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                              BLUE(fillcolor)),</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                              wxSOLID));</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                     <span class="keywordflow">if</span> (!fillflag) dc.SetBrush(*wxTRANSPARENT_BRUSH);</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                  }</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                  <span class="keywordtype">int</span> y1 = track-&gt;PitchToY(LookupRealAttribute(note, y1r, note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>));</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                  <span class="keywordflow">if</span> (shape == line) {</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                     <span class="comment">// extreme zooms caues problems under windows, so we have to do some</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                     <span class="comment">// clipping before calling display routine</span></div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                     <span class="keywordflow">if</span> (xx &lt; h) { <span class="comment">// clip line on left</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                        yy = <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>((yy + (y1 - yy) * (h - xx) / (x1 - xx)) + 0.5);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                        xx = h;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                     }</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                     <span class="keywordflow">if</span> (x1 &gt; h1) { <span class="comment">// clip line on right</span></div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                        y1 = <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>((yy + (y1 - yy) * (h1 - xx) / (x1 - xx)) + 0.5);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                        x1 = h1;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                     }</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                     <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, TIME_TO_X(xx), yy, TIME_TO_X(x1), y1);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape == rectangle) {</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                     <span class="keywordflow">if</span> (xx &lt; h) { <span class="comment">// clip on left, leave 10 pixels to spare</span></div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                        xx = X_TO_TIME(rect.x - (linethick + 10));</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                     }</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                     <span class="keywordflow">if</span> (x1 &gt; h1) { <span class="comment">// clip on right, leave 10 pixels to spare</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                        xx = X_TO_TIME(rect.x + rect.width + linethick + 10);</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                     }</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;                     dc.DrawRectangle(TIME_TO_X(xx), yy, TIME_TO_X(x1) - TIME_TO_X(xx), y1 - yy + 1);</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape == triangle) {</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                     wxPoint points[3];</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                     points[0].x = TIME_TO_X(xx);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                     CLIP(points[0].<a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a>);</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                     points[0].y = yy;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                     points[1].x = TIME_TO_X(LookupRealAttribute(note, x1r, note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>));</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                     CLIP(points[1].x);</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                     points[1].y = y1;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                     points[2].x = TIME_TO_X(LookupRealAttribute(note, x2r, xx));</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                     CLIP(points[2].x);</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                     points[2].y = track-&gt;PitchToY(LookupRealAttribute(note, y2r, note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>));</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                     dc.DrawPolygon(3, points);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape == polygon) {</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                     wxPoint points[20]; <span class="comment">// upper bound of 20 sides</span></div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                     points[0].x = TIME_TO_X(xx);</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                     CLIP(points[0].<a class="code" href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">x</a>);</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                     points[0].y = yy;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                     points[1].x = TIME_TO_X(LookupRealAttribute(note, x1r, xx));</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                     CLIP(points[1].x);</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                     points[1].y = y1;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                     points[2].x = TIME_TO_X(LookupRealAttribute(note, x2r, xx));</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                     CLIP(points[2].x);</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                     points[2].y = track-&gt;PitchToY(LookupRealAttribute(note, y2r, note-&gt;<a class="code" href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">pitch</a>));</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                     <span class="keywordtype">int</span> n = 3;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                     <span class="keywordflow">while</span> (n &lt; 20) {</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                        <span class="keywordtype">char</span> <a class="code" href="lib_2expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a>[8];</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                        sprintf(name, <span class="stringliteral">&quot;x%dr&quot;</span>, n);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                        <a class="code" href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a> attr = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(name);</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                        <span class="keywordtype">double</span> xn = LookupRealAttribute(note, attr, -1000000.0);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                        <span class="keywordflow">if</span> (xn == -1000000.0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                        points[n].x = TIME_TO_X(xn);</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;                        CLIP(points[n].x);</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;                        sprintf(name, <span class="stringliteral">&quot;y%dr&quot;</span>, n - 1);</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                        attr = <a class="code" href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a>.<a class="code" href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">insert_string</a>(name);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                        <span class="keywordtype">double</span> yn = LookupRealAttribute(note, attr, -1000000.0);</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                        <span class="keywordflow">if</span> (yn == -1000000.0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                        points[n].y = track-&gt;PitchToY(yn);</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                        n++;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                     }</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                     dc.DrawPolygon(n, points);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape == oval) {</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                     <span class="keywordtype">int</span> ix = TIME_TO_X(xx);</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                     CLIP(ix);</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                     <span class="keywordtype">int</span> ix1 = TIME_TO_X(x1) - TIME_TO_X(xx);</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;                     <span class="keywordflow">if</span> (ix1 &gt; CLIP_MAX * 2) ix1 = CLIP_MAX * 2; <span class="comment">// CLIP a width</span></div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;                     dc.DrawEllipse(ix, yy, ix1, y1 - yy + 1);</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape == text) {</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                     <span class="keywordflow">if</span> (linecolor != -1)</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                        dc.SetTextForeground(wxColour(RED(linecolor),</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                              GREEN(linecolor),</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                              BLUE(linecolor)));</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                     <span class="comment">// if no color specified, copy color from brush</span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                     <span class="keywordflow">else</span> dc.SetTextForeground(dc.GetBrush().GetColour());</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                     <span class="comment">// This seems to have no effect, so I commented it out. -RBD</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                     <span class="comment">//if (fillcolor != -1)</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                     <span class="comment">//  dc.SetTextBackground(wxColour(RED(fillcolor),</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                     <span class="comment">//                                GREEN(fillcolor),</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                     <span class="comment">//                                BLUE(fillcolor)));</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment"></span>                     <span class="comment">//else dc.SetTextBackground(dc.GetPen().GetColour());</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *font = LookupAtomAttribute(note, fonta, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="lspdata_8c.html#a188f5f4011d6169f76ee43763c198076">weight</a> = LookupAtomAttribute(note, weighta, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                     <span class="keywordtype">int</span> <a class="code" href="group__lavu__mem.html#ga854352f53b148adc24983a58a1866d66">size</a> = LookupIntAttribute(note, sizei, 8);</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *justify = LookupStringAttribute(note, justifys, <span class="stringliteral">&quot;ld&quot;</span>);</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                     wxFont wxfont;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                     wxfont.SetFamily(font == roman ? wxROMAN :</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                        (font == swiss ? wxSWISS :</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                           (font == modern ? wxMODERN : wxDEFAULT)));</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                     wxfont.SetStyle(wxNORMAL);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                     wxfont.SetWeight(weight == bold ? wxBOLD : wxNORMAL);</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                     wxfont.SetPointSize(size);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                     dc.SetFont(wxfont);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                     <span class="comment">// now do justification</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a> = LookupStringAttribute(note, texts, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                     wxCoord textWidth, textHeight;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                     dc.GetTextExtent(wxString::FromUTF8(s), &amp;textWidth, &amp;textHeight);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                     <span class="keywordtype">long</span> hoffset = 0;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                     <span class="keywordtype">long</span> voffset = -textHeight; <span class="comment">// default should be baseline of text</span></div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                     <span class="keywordflow">if</span> (strlen(justify) != 2) justify = <span class="stringliteral">&quot;ld&quot;</span>;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                     <span class="keywordflow">if</span> (justify[0] == <span class="charliteral">&#39;c&#39;</span>) hoffset = -(textWidth/2);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (justify[0] == <span class="charliteral">&#39;r&#39;</span>) hoffset = -textWidth;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                     <span class="keywordflow">if</span> (justify[1] == <span class="charliteral">&#39;t&#39;</span>) voffset = 0;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (justify[1] == <span class="charliteral">&#39;c&#39;</span>) voffset = -(textHeight/2);</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (justify[1] == <span class="charliteral">&#39;b&#39;</span>) voffset = -textHeight;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                     <span class="keywordflow">if</span> (fillflag) {</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                        <span class="comment">// It should be possible to do this with background color,</span></div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                        <span class="comment">// but maybe because of the transfer mode, no background is</span></div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                        <span class="comment">// drawn. To fix this, just draw a rectangle:</span></div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                        dc.SetPen(wxPen(wxColour(RED(fillcolor),</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                              GREEN(fillcolor),</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                              BLUE(fillcolor)),</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                              1, wxSOLID));</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                        dc.DrawRectangle(TIME_TO_X(xx) + hoffset, yy + voffset,</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                              textWidth, textHeight);</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                     }</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                     dc.DrawText(<a class="code" href="_internat_8h.html#a5ed4c8747b1c367321f0494f01dd61fa">LAT1CTOWX</a>(s), TIME_TO_X(xx) + hoffset, yy + voffset);</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                  }</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;               }</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            }</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;         }</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      }</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;   }</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;   iterator.<a class="code" href="class_alg__iterator.html#a92b44e65fa07d97f7f41494b06201543">end</a>();</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;   <span class="comment">// draw black line between top/bottom margins and the track</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;   dc.SetPen(*wxBLACK_PEN);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, rect.x, rect.y + marg, rect.x + rect.width, rect.y + marg);</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;   <a class="code" href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a>(dc, rect.x, rect.y + rect.height - marg - 1, <span class="comment">// subtract 1 to get</span></div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                rect.x + rect.width, rect.y + rect.height - marg - 1); <span class="comment">// top of line</span></div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   <span class="keywordflow">if</span> (h == 0.0 &amp;&amp; track-&gt;GetOffset() &lt; 0.0) {</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      DrawNegativeOffsetTrackArrows(dc, rect);</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;   }</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;   dc.DestroyClippingRegion();</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   <a class="code" href="_note_track_8h.html#adc24f51826c5389d0d9f0a09bf904ed6">SonifyEndNoteForeground</a>();</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;}</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="preprocessor">#endif // USE_MIDI</span></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawLabelTrack(<span class="keyword">const</span> <a class="code" href="class_label_track.html">LabelTrack</a> *track,</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                                 wxDC &amp; dc,</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                                 <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion,</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;{</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="keywordtype">double</span> sel0 = selectedRegion.<a class="code" href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">t0</a>();</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="keywordtype">double</span> sel1 = selectedRegion.<a class="code" href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">t1</a>();</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;   <span class="keywordflow">if</span> (!track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>() &amp;&amp; !track-&gt;<a class="code" href="class_track.html#a4b9d8ec8baa8ce94f9b9b999e324a59f">IsSyncLockSelected</a>())</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      sel0 = sel1 = 0.0;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   track-&gt;<a class="code" href="class_label_track.html#a8ea914e523a578a392a99373bc803797">Draw</a>(dc, rect, <a class="code" href="class_selected_region.html">SelectedRegion</a>(sel0, sel1), zoomInfo);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;}</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="keywordtype">void</span> TrackArtist::DrawTimeTrack(<span class="keyword">const</span> <a class="code" href="class_time_track.html">TimeTrack</a> *track,</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                                wxDC &amp; dc,</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                                <span class="keyword">const</span> wxRect &amp; rect,</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                                <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;{</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;   track-&gt;<a class="code" href="class_time_track.html#ac15664abc03b775de3581c9b52aa8f89">Draw</a>(dc, rect, zoomInfo);</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   wxRect envRect = rect;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   envRect.height -= 2;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;   <span class="keywordtype">double</span> lower = track-&gt;<a class="code" href="class_time_track.html#a4b1f56611ba90a95691a0b47107e4d22">GetRangeLower</a>(), upper = track-&gt;<a class="code" href="class_time_track.html#a8d16c30d6a49657b1e3125ba16a3fae8">GetRangeUpper</a>();</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <span class="keywordflow">if</span>(track-&gt;<a class="code" href="class_time_track.html#abae5d14db9f5a3f3ffc6c6c99278ed3a">GetDisplayLog</a>()) {</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="comment">// MB: silly way to undo the work of GetWaveYPos while still getting a logarithmic scale</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      lower = <a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(<a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(1.0<a class="code" href="namespacelv2docgen.html#a4405dc5a2509537b9ff3b4de10bc28d6">e</a>-7, lower)) / mdBrange + 1.0;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      upper = <a class="code" href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a>(<a class="code" href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">std::max</a>(1.0<a class="code" href="namespacelv2docgen.html#a4405dc5a2509537b9ff3b4de10bc28d6">e</a>-7, upper)) / mdBrange + 1.0;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   }</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   track-&gt;<a class="code" href="class_time_track.html#abacec6fca980b03f0bf7a4f96310704a">GetEnvelope</a>()-&gt;<a class="code" href="class_envelope.html#a4463f20563902ef78367735ea25440f4">DrawPoints</a>(dc, envRect, zoomInfo,</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;               track-&gt;<a class="code" href="class_time_track.html#abae5d14db9f5a3f3ffc6c6c99278ed3a">GetDisplayLog</a>(), mdBrange, lower, upper);</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;}</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;</div><div class="line"><a name="l03171"></a><span class="lineno"><a class="line" href="class_track_artist.html#a933ebde770fbf92ac754ea68b01c55b5"> 3171</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#a933ebde770fbf92ac754ea68b01c55b5">TrackArtist::UpdatePrefs</a>()</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;{</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   mdBrange = <a class="code" href="_prefs_8cpp.html#a605d9511ac8da26b177c7362d7f8dc82">gPrefs</a>-&gt;Read(<a class="code" href="_g_u_i_settings_8h.html#a0b5338253ee8f40401844a51c4b81a1e">ENV_DB_KEY</a>, mdBrange);</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   mShowClipping = <a class="code" href="_prefs_8cpp.html#a605d9511ac8da26b177c7362d7f8dc82">gPrefs</a>-&gt;Read(wxT(<span class="stringliteral">&quot;/GUI/ShowClipping&quot;</span>), mShowClipping);</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;}</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">// Draws the sync-lock bitmap, tiled; always draws stationary relative to the DC</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">// AWD: now that the tiles don&#39;t link together, we&#39;re drawing a tilted grid, at</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">// two steps down for every one across. This creates a pattern that repeats in</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">// 5-step by 5-step boxes. Because we&#39;re only drawing in 5/25 possible positions</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">// we have a grid spacing somewhat smaller than the image dimensions. Thus we</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">// acheive lower density than with a square grid and eliminate edge cases where</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">// no tiles are displayed.</span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">// The pattern draws in tiles at (0,0), (2,1), (4,2), (1,3), and (3,4) in each</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment">// 5x5 box.</span></div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">// There may be a better way to do this, or a more appealing pattern.</span></div><div class="line"><a name="l03190"></a><span class="lineno"><a class="line" href="class_track_artist.html#ac1ed1e63b3e8682855f002a6696324bd"> 3190</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#ac1ed1e63b3e8682855f002a6696324bd">TrackArtist::DrawSyncLockTiles</a>(wxDC *dc, wxRect rect)</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;{</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;   wxBitmap syncLockBitmap(<a class="code" href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a>.<a class="code" href="class_theme_base.html#a2243773f651603c2855bd3562801d680">Image</a>(bmpSyncLockSelTile));</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;   <span class="comment">// Grid spacing is a bit smaller than actual image size</span></div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;   <span class="keywordtype">int</span> gridW = syncLockBitmap.GetWidth() - 6;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;   <span class="keywordtype">int</span> gridH = syncLockBitmap.GetHeight() - 8;</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;   <span class="comment">// Horizontal position within the grid, modulo its period</span></div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;   <span class="keywordtype">int</span> blockX = (rect.x / gridW) % 5;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;   <span class="comment">// Amount to offset drawing of first column</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   <span class="keywordtype">int</span> xOffset = rect.x % gridW;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;   <span class="keywordflow">if</span> (xOffset &lt; 0) xOffset += gridW;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;   <span class="comment">// Check if we&#39;re missing an extra column to the left (this can happen</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   <span class="comment">// because the tiles are bigger than the grid spacing)</span></div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;   <span class="keywordtype">bool</span> extraCol = <span class="keyword">false</span>;</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   <span class="keywordflow">if</span> (syncLockBitmap.GetWidth() - gridW &gt; xOffset) {</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      extraCol = <span class="keyword">true</span>;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      xOffset += gridW;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      blockX = (blockX - 1) % 5;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   }</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;   <span class="comment">// Make sure blockX is non-negative</span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;   <span class="keywordflow">if</span> (blockX &lt; 0) blockX += 5;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;   <span class="keywordtype">int</span> xx = 0;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;   <span class="keywordflow">while</span> (xx &lt; rect.width) {</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <span class="keywordtype">int</span> width = syncLockBitmap.GetWidth() - xOffset;</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">if</span> (xx + width &gt; rect.width)</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;         width = rect.width - xx;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="comment">// Draw each row in this column</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <span class="comment">// Vertical position in the grid, modulo its period</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      <span class="keywordtype">int</span> blockY = (rect.y / gridH) % 5;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <span class="comment">// Amount to offset drawing of first row</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      <span class="keywordtype">int</span> yOffset = rect.y % gridH;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <span class="keywordflow">if</span> (yOffset &lt; 0) yOffset += gridH;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="comment">// Check if we&#39;re missing an extra row on top (this can happen because</span></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="comment">// the tiles are bigger than the grid spacing)</span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <span class="keywordtype">bool</span> extraRow = <span class="keyword">false</span>;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      <span class="keywordflow">if</span> (syncLockBitmap.GetHeight() - gridH &gt; yOffset) {</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;         extraRow = <span class="keyword">true</span>;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;         yOffset += gridH;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;         blockY = (blockY - 1) % 5;</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      }</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="comment">// Make sure blockY is non-negative</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      <span class="keywordflow">if</span> (blockY &lt; 0) blockY += 5;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <span class="keywordtype">int</span> yy = 0;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keywordflow">while</span> (yy &lt; rect.height)</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      {</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;         <span class="keywordtype">int</span> height = syncLockBitmap.GetHeight() - yOffset;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;         <span class="keywordflow">if</span> (yy + height &gt; rect.height)</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            height = rect.height - yy;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;         <span class="comment">// AWD: draw blocks according to our pattern</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;         <span class="keywordflow">if</span> ((blockX == 0 &amp;&amp; blockY == 0) || (blockX == 2 &amp;&amp; blockY == 1) ||</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;             (blockX == 4 &amp;&amp; blockY == 2) || (blockX == 1 &amp;&amp; blockY == 3) ||</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;             (blockX == 3 &amp;&amp; blockY == 4))</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;         {</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            <span class="comment">// Do we need to get a sub-bitmap?</span></div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;            <span class="keywordflow">if</span> (width != syncLockBitmap.GetWidth() || height != syncLockBitmap.GetHeight()) {</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;               wxBitmap subSyncLockBitmap =</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                  syncLockBitmap.GetSubBitmap(wxRect(xOffset, yOffset, width, height));</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;               dc-&gt;DrawBitmap(subSyncLockBitmap, rect.x + xx, rect.y + yy, <span class="keyword">true</span>);</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;            }</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;               dc-&gt;DrawBitmap(syncLockBitmap, rect.x + xx, rect.y + yy, <span class="keyword">true</span>);</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;            }</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;         }</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;         <span class="comment">// Updates for next row</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;         <span class="keywordflow">if</span> (extraRow) {</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;            <span class="comment">// Second offset row, still at y = 0; no more extra rows</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            yOffset -= gridH;</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;            extraRow = <span class="keyword">false</span>;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;         }</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;            <span class="comment">// Move on in y, no more offset rows</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            yy += gridH - yOffset;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            yOffset = 0;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;         }</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;         blockY = (blockY + 1) % 5;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      }</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      <span class="comment">// Updates for next column</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keywordflow">if</span> (extraCol) {</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;         <span class="comment">// Second offset column, still at x = 0; no more extra columns</span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;         xOffset -= gridW;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;         extraCol = <span class="keyword">false</span>;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      }</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;         <span class="comment">// Move on in x, no more offset rows</span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;         xx += gridW - xOffset;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;         xOffset = 0;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      }</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      blockX = (blockX + 1) % 5;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;   }</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;}</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;</div><div class="line"><a name="l03297"></a><span class="lineno"><a class="line" href="class_track_artist.html#aa39e383c6894d3a72cd1783399288a19"> 3297</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_track_artist.html#aa39e383c6894d3a72cd1783399288a19">TrackArtist::DrawBackgroundWithSelection</a>(wxDC *dc, <span class="keyword">const</span> wxRect &amp;rect,</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_track.html">Track</a> *track, wxBrush &amp;selBrush, wxBrush &amp;unselBrush,</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;   <span class="keyword">const</span> <a class="code" href="class_selected_region.html">SelectedRegion</a> &amp;selectedRegion, <span class="keyword">const</span> <a class="code" href="class_zoom_info.html">ZoomInfo</a> &amp;zoomInfo)</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;{</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;   <span class="comment">//MM: Draw background. We should optimize that a bit more.</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;   <span class="comment">//AWD: &quot;+ 1.5&quot; and &quot;+ 2.5&quot; throughout match code in</span></div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;   <span class="comment">//AdornedRulerPanel::DoDrawSelection() and make selection line up with ruler.</span></div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;   <span class="comment">//I don&#39;t know if/why this is correct.</span></div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> sel0 = selectedRegion.<a class="code" href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">t0</a>();</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> sel1 = selectedRegion.<a class="code" href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">t1</a>();</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;   dc-&gt;SetPen(*wxTRANSPARENT_PEN);</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;   <span class="keywordflow">if</span> (track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>() || track-&gt;<a class="code" href="class_track.html#a4b9d8ec8baa8ce94f9b9b999e324a59f">IsSyncLockSelected</a>())</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;   {</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="comment">// Rectangles before, within, after the selction</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      wxRect before = rect;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      wxRect <a class="code" href="allegro_8cpp.html#ab5852cb274ff88cc258958579ab1bd71">within</a> = rect;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      wxRect after = rect;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      before.width = <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(sel0) + 2);</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      <span class="keywordflow">if</span> (before.GetRight() &gt; rect.GetRight()) {</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;         before.width = rect.width;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      }</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="keywordflow">if</span> (before.width &gt; 0) {</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;         dc-&gt;SetBrush(unselBrush);</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;         dc-&gt;DrawRectangle(before);</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;         within.x = 1 + before.GetRight();</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      }</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      within.width = rect.x + <a class="code" href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a>(zoomInfo.<a class="code" href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">TimeToPosition</a>(sel1) + 2) - within.x;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="winfun_8c.html#ab24f32995c1d94525943b4568cce20cb">if</a> (within.GetRight() &gt; rect.GetRight()) {</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;         within.width = 1 + rect.GetRight() - within.x;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      }</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="keywordflow">if</span> (within.width &gt; 0) {</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;         <span class="keywordflow">if</span> (track-&gt;<a class="code" href="class_track.html#ac01a2b30ea7a2574d724bae023427905">GetSelected</a>()) {</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            dc-&gt;SetBrush(selBrush);</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;            dc-&gt;DrawRectangle(within);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;         }</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;         <span class="keywordflow">else</span> {</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;            <span class="comment">// Per condition above, track must be sync-lock selected</span></div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;            dc-&gt;SetBrush(unselBrush);</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            dc-&gt;DrawRectangle(within);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;            DrawSyncLockTiles(dc, within);</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;         }</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;         after.x = 1 + within.GetRight();</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      }</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;         <span class="comment">// `within` not drawn; start where it would have gone</span></div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         after.x = within.x;</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      }</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;      after.width = 1 + rect.GetRight() - after.x;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;      <span class="keywordflow">if</span> (after.width &gt; 0) {</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;         dc-&gt;SetBrush(unselBrush);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;         dc-&gt;DrawRectangle(after);</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      }</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;   }</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;   {</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="comment">// Track not selected; just draw background</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      dc-&gt;SetBrush(unselBrush);</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      dc-&gt;DrawRectangle(rect);</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;   }</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;}</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div><div class="ttc" id="_track_artist_8cpp_html_a0d34e48dcb47d4a36c7bca106d510fd7"><div class="ttname"><a href="_track_artist_8cpp.html#a0d34e48dcb47d4a36c7bca106d510fd7">FromDB</a></div><div class="ttdeci">float FromDB(float value, double dBRange)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00969">TrackArtist.cpp:969</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a96de1d4e8b6d77973de29c4b3584cfc4"><div class="ttname"><a href="class_spec_px_cache.html#a96de1d4e8b6d77973de29c4b3584cfc4">SpecPxCache::range</a></div><div class="ttdeci">int range</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00146">WaveClip.h:146</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a7a9ac3b5030ffe0f6dc83821126108aa"><div class="ttname"><a href="class_spec_px_cache.html#a7a9ac3b5030ffe0f6dc83821126108aa">SpecPxCache::minFreq</a></div><div class="ttdeci">int minFreq</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00148">WaveClip.h:148</a></div></div>
<div class="ttc" id="class_alg__iterator_html"><div class="ttname"><a href="class_alg__iterator.html">Alg_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00932">allegro.h:932</a></div></div>
<div class="ttc" id="class_a_color_html_a3a1a5b4ab4055f09810d58a166f61bfeaf8b5b6cc1c291340c167ed73787e70e2"><div class="ttname"><a href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeaf8b5b6cc1c291340c167ed73787e70e2">AColor::ColorGradientTimeSelected</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00028">AColor.h:28</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ae627610702531c18a358f3df459027e8"><div class="ttname"><a href="class_spectrogram_settings.html#ae627610702531c18a358f3df459027e8">SpectrogramSettings::zeroPaddingFactor</a></div><div class="ttdeci">int zeroPaddingFactor</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00105">SpectrogramSettings.h:105</a></div></div>
<div class="ttc" id="class_time_track_html_abae5d14db9f5a3f3ffc6c6c99278ed3a"><div class="ttname"><a href="class_time_track.html#abae5d14db9f5a3f3ffc6c6c99278ed3a">TimeTrack::GetDisplayLog</a></div><div class="ttdeci">bool GetDisplayLog() const </div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8h_source.html#l00113">TimeTrack.h:113</a></div></div>
<div class="ttc" id="class_wave_track_html_aed472b80250f8a6a759d8c43970c6b99"><div class="ttname"><a href="class_wave_track.html#aed472b80250f8a6a759d8c43970c6b99">WaveTrack::GetCachedLocations</a></div><div class="ttdeci">const std::vector&lt; Location &gt; &amp; GetCachedLocations() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00380">WaveTrack.h:380</a></div></div>
<div class="ttc" id="class_track_html_a4a6604845139575dfc25be299aeb60efab39033be088537a007532668cb6d16a8"><div class="ttname"><a href="class_track.html#a4a6604845139575dfc25be299aeb60efab39033be088537a007532668cb6d16a8">Track::Wave</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00153">Track.h:153</a></div></div>
<div class="ttc" id="class_wave_track_html_a084eba52413a5cc74d2634b36e2f85b5aeef9a24216b729762bfd38161b5b2a83"><div class="ttname"><a href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5aeef9a24216b729762bfd38161b5b2a83">WaveTrack::Waveform</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00412">WaveTrack.h:412</a></div></div>
<div class="ttc" id="class_track_list_html"><div class="ttname"><a href="class_track_list.html">TrackList</a></div><div class="ttdoc">A list of TrackListNode items. </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00393">Track.h:393</a></div></div>
<div class="ttc" id="seqread_8c_html_aa2a8c6fbe5ed24f9523eb4e01368e4bc"><div class="ttname"><a href="seqread_8c.html#aa2a8c6fbe5ed24f9523eb4e01368e4bc">scale</a></div><div class="ttdeci">public time_type scale(ulong x, ulong n, ulong d)</div><div class="ttdef"><b>Definition:</b> <a href="seqread_8c_source.html#l01697">seqread.c:1697</a></div></div>
<div class="ttc" id="_theme_8cpp_html_a778dd1fa4ed7e54e48ec7b65aba2363e"><div class="ttname"><a href="_theme_8cpp.html#a778dd1fa4ed7e54e48ec7b65aba2363e">theTheme</a></div><div class="ttdeci">AUDACITY_DLL_API Theme theTheme</div><div class="ttdef"><b>Definition:</b> <a href="_theme_8cpp_source.html#l00195">Theme.cpp:195</a></div></div>
<div class="ttc" id="class_track_html_a4a6604845139575dfc25be299aeb60efa2348e03ba06177fe4dbcf87e27d82e33"><div class="ttname"><a href="class_track.html#a4a6604845139575dfc25be299aeb60efa2348e03ba06177fe4dbcf87e27d82e33">Track::Time</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00158">Track.h:158</a></div></div>
<div class="ttc" id="class_waveform_settings_html_ae4f07aa847f89f72a127ba5e357f1e78"><div class="ttname"><a href="class_waveform_settings.html#ae4f07aa847f89f72a127ba5e357f1e78">WaveformSettings::isLinear</a></div><div class="ttdeci">bool isLinear() const </div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00066">WaveformSettings.h:66</a></div></div>
<div class="ttc" id="class_alg__time__sig_html_a79476aacf5e3138f24ee80f56d6fc580"><div class="ttname"><a href="class_alg__time__sig.html#a79476aacf5e3138f24ee80f56d6fc580">Alg_time_sig::num</a></div><div class="ttdeci">double num</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00825">allegro.h:825</a></div></div>
<div class="ttc" id="class_alg__time__sigs_html_ab4caa20f4b1dc6f3c9d72d30a72ea1fa"><div class="ttname"><a href="class_alg__time__sigs.html#ab4caa20f4b1dc6f3c9d72d30a72ea1fa">Alg_time_sigs::length</a></div><div class="ttdeci">long length()</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00869">allegro.h:869</a></div></div>
<div class="ttc" id="_wave_track_8h_html"><div class="ttname"><a href="_wave_track_8h.html">WaveTrack.h</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_a14bb8924daea0b48c7803f281f66e390"><div class="ttname"><a href="lib_2expat_8h.html#a14bb8924daea0b48c7803f281f66e390">int</a></div><div class="ttdeci">typedef int(XMLCALL *XML_NotStandaloneHandler)(void *userData)</div></div>
<div class="ttc" id="_audacity_app_8h_html"><div class="ttname"><a href="_audacity_app_8h.html">AudacityApp.h</a></div></div>
<div class="ttc" id="class_a_color_html_a3a1a5b4ab4055f09810d58a166f61bfea994bbd5ca3c5a1e50383f71482576ca9"><div class="ttname"><a href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfea994bbd5ca3c5a1e50383f71482576ca9">AColor::ColorGradientTimeAndFrequencySelected</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00029">AColor.h:29</a></div></div>
<div class="ttc" id="class_selected_region_html_a699851ec9e5a209be86f552f0826687d"><div class="ttname"><a href="class_selected_region.html#a699851ec9e5a209be86f552f0826687d">SelectedRegion::t0</a></div><div class="ttdeci">double t0() const </div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00093">SelectedRegion.h:93</a></div></div>
<div class="ttc" id="class_wave_display_html_a7e072e884092ea939899822b0d92b8be"><div class="ttname"><a href="class_wave_display.html#a7e072e884092ea939899822b0d92b8be">WaveDisplay::where</a></div><div class="ttdeci">sampleCount * where</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00163">WaveClip.h:163</a></div></div>
<div class="ttc" id="class_ruler_html_af58442bc79afc26e7b9f7735e1f6e198aba68a1adce860f0e30519cfc2b280272"><div class="ttname"><a href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aba68a1adce860f0e30519cfc2b280272">Ruler::IntFormat</a></div><div class="ttdef"><b>Definition:</b> <a href="_ruler_8h_source.html#l00035">Ruler.h:35</a></div></div>
<div class="ttc" id="class_a_color_html_a3a1a5b4ab4055f09810d58a166f61bfe"><div class="ttname"><a href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfe">AColor::ColorGradientChoice</a></div><div class="ttdeci">ColorGradientChoice</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00026">AColor.h:26</a></div></div>
<div class="ttc" id="class_track_html_aebabe796d0b3222ef7d23ae13a62769b"><div class="ttname"><a href="class_track.html#aebabe796d0b3222ef7d23ae13a62769b">Track::GetMute</a></div><div class="ttdeci">bool GetMute() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00180">Track.h:180</a></div></div>
<div class="ttc" id="class_track_artist_html_a1523a85e9f5d5400bde1cd3e3fbf3413"><div class="ttname"><a href="class_track_artist.html#a1523a85e9f5d5400bde1cd3e3fbf3413">TrackArtist::TrackArtist</a></div><div class="ttdeci">TrackArtist()</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00265">TrackArtist.cpp:265</a></div></div>
<div class="ttc" id="test__lib_f_l_a_c_2format_8c_html_a960ad82c3ba394a46f17f5f6146c93ea"><div class="ttname"><a href="test__lib_f_l_a_c_2format_8c.html#a960ad82c3ba394a46f17f5f6146c93ea">rate</a></div><div class="ttdeci">unsigned rate</div><div class="ttdef"><b>Definition:</b> <a href="test__lib_f_l_a_c_2format_8c_source.html#l00032">format.c:32</a></div></div>
<div class="ttc" id="class_track_artist_html_a933ebde770fbf92ac754ea68b01c55b5"><div class="ttname"><a href="class_track_artist.html#a933ebde770fbf92ac754ea68b01c55b5">TrackArtist::UpdatePrefs</a></div><div class="ttdeci">void UpdatePrefs()</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l03171">TrackArtist.cpp:3171</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html"><div class="ttname"><a href="class_spectrogram_settings.html">SpectrogramSettings</a></div><div class="ttdoc">Spectrogram settings, either for one track or as defaults. </div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00023">SpectrogramSettings.h:23</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a7fbea69cb9478dd7d894d9399561c736"><div class="ttname"><a href="class_spectrogram_settings.html#a7fbea69cb9478dd7d894d9399561c736">SpectrogramSettings::windowType</a></div><div class="ttdeci">int windowType</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00102">SpectrogramSettings.h:102</a></div></div>
<div class="ttc" id="class_wave_clip_html_a6cd003778b510cad742feaa5763c6ac2"><div class="ttname"><a href="class_wave_clip.html#a6cd003778b510cad742feaa5763c6ac2">WaveClip::GetNumSamples</a></div><div class="ttdeci">sampleCount GetNumSamples() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00399">WaveClip.cpp:399</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_a1b49b495b59f9e73205b69ad1a2965b0"><div class="ttname"><a href="lib_2expat_8h.html#a1b49b495b59f9e73205b69ad1a2965b0">name</a></div><div class="ttdeci">const XML_Char * name</div><div class="ttdef"><b>Definition:</b> <a href="lib_2expat_8h_source.html#l00151">expat.h:151</a></div></div>
<div class="ttc" id="_g_u_i_settings_8h_html_a0b5338253ee8f40401844a51c4b81a1e"><div class="ttname"><a href="_g_u_i_settings_8h.html#a0b5338253ee8f40401844a51c4b81a1e">ENV_DB_KEY</a></div><div class="ttdeci">#define ENV_DB_KEY</div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_settings_8h_source.html#l00015">GUISettings.h:15</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a7b3f6f14d24664c63cb888625c251f70"><div class="ttname"><a href="class_spectrogram_settings.html#a7b3f6f14d24664c63cb888625c251f70">SpectrogramSettings::gain</a></div><div class="ttdeci">int gain</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00099">SpectrogramSettings.h:99</a></div></div>
<div class="ttc" id="class_a_color_html_ae549f98f5f729285ccb884367fbb7e24"><div class="ttname"><a href="class_a_color.html#ae549f98f5f729285ccb884367fbb7e24">AColor::DarkMIDIChannel</a></div><div class="ttdeci">static void DarkMIDIChannel(wxDC *dc, int channel)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00559">AColor.cpp:559</a></div></div>
<div class="ttc" id="class_wave_track_html_a084eba52413a5cc74d2634b36e2f85b5ac0941a4c239c9e4a1d487f31786fbbc9"><div class="ttname"><a href="class_wave_track.html#a084eba52413a5cc74d2634b36e2f85b5ac0941a4c239c9e4a1d487f31786fbbc9">WaveTrack::Spectrum</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00417">WaveTrack.h:417</a></div></div>
<div class="ttc" id="class_wave_clip_html_a839a293df9246f7a9bb6fcf4d8be7b40"><div class="ttname"><a href="class_wave_clip.html#a839a293df9246f7a9bb6fcf4d8be7b40">WaveClip::GetStartTime</a></div><div class="ttdeci">double GetStartTime() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00372">WaveClip.cpp:372</a></div></div>
<div class="ttc" id="class_track_html_ac01a2b30ea7a2574d724bae023427905"><div class="ttname"><a href="class_track.html#ac01a2b30ea7a2574d724bae023427905">Track::GetSelected</a></div><div class="ttdeci">bool GetSelected() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00179">Track.h:179</a></div></div>
<div class="ttc" id="class_wave_display_html_ab2a1f71c47f052041fbcbdac889be828"><div class="ttname"><a href="class_wave_display.html#ab2a1f71c47f052041fbcbdac889be828">WaveDisplay::max</a></div><div class="ttdeci">float * max</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00164">WaveClip.h:164</a></div></div>
<div class="ttc" id="_all_theme_resources_8h_html"><div class="ttname"><a href="_all_theme_resources_8h.html">AllThemeResources.h</a></div></div>
<div class="ttc" id="class_wave_track_html_a10c50123dc26cba66469b011c1852047"><div class="ttname"><a href="class_wave_track.html#a10c50123dc26cba66469b011c1852047">WaveTrack::GetWaveformSettings</a></div><div class="ttdeci">const WaveformSettings &amp; GetWaveformSettings() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00763">WaveTrack.cpp:763</a></div></div>
<div class="ttc" id="_view_info_8h_html"><div class="ttname"><a href="_view_info_8h.html">ViewInfo.h</a></div></div>
<div class="ttc" id="class_wave_display_html_a9ff4ca6d4c9be28c6f3cb3f806c41913"><div class="ttname"><a href="class_wave_display.html#a9ff4ca6d4c9be28c6f3cb3f806c41913">WaveDisplay::min</a></div><div class="ttdeci">float * min</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00164">WaveClip.h:164</a></div></div>
<div class="ttc" id="class_alg__note_html_ae70e47b4c5fb53e7f90a4fdc0f132d0e"><div class="ttname"><a href="class_alg__note.html#ae70e47b4c5fb53e7f90a4fdc0f132d0e">Alg_note::parameters</a></div><div class="ttdeci">Alg_parameters_ptr parameters</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00300">allegro.h:300</a></div></div>
<div class="ttc" id="class_profiler_html"><div class="ttname"><a href="class_profiler.html">Profiler</a></div><div class="ttdoc">A simple profiler to measure the average time lengths that a particular task/function takes...</div><div class="ttdef"><b>Definition:</b> <a href="_profiler_8h_source.html#l00038">Profiler.h:38</a></div></div>
<div class="ttc" id="class_wave_track_html_a6c31cef06f382857502ce036b2dc795b"><div class="ttname"><a href="class_wave_track.html#a6c31cef06f382857502ce036b2dc795b">WaveTrack::GetSpectrumBounds</a></div><div class="ttdeci">void GetSpectrumBounds(float *min, float *max) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00308">WaveTrack.cpp:308</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a0c3a4884f54b874887d4051c1917a8e8"><div class="ttname"><a href="class_spec_px_cache.html#a0c3a4884f54b874887d4051c1917a8e8">SpecPxCache::values</a></div><div class="ttdeci">float * values</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00142">WaveClip.h:142</a></div></div>
<div class="ttc" id="class_zoom_info_html_aa762137abb7f349ee3ac25dfce0c3635"><div class="ttname"><a href="class_zoom_info.html#aa762137abb7f349ee3ac25dfce0c3635">ZoomInfo::GetFisheyeLeftBoundary</a></div><div class="ttdeci">wxInt64 GetFisheyeLeftBoundary(wxInt64 WXUNUSED(origin=0)) const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00129">ViewInfo.h:129</a></div></div>
<div class="ttc" id="class_track_html_a4b9d8ec8baa8ce94f9b9b999e324a59f"><div class="ttname"><a href="class_track.html#a4b9d8ec8baa8ce94f9b9b999e324a59f">Track::IsSyncLockSelected</a></div><div class="ttdeci">bool IsSyncLockSelected() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00278">Track.cpp:278</a></div></div>
<div class="ttc" id="octave__test_8m_html_aaccc9105df5383111407fd5b41255e23"><div class="ttname"><a href="octave__test_8m.html#aaccc9105df5383111407fd5b41255e23">t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> <a href="octave__test_8m_source.html#l00026">octave_test.m:26</a></div></div>
<div class="ttc" id="struct_wave_track_location_html_a0a54a8fbcc73dfe63879bcff10a75c6da399879306fdea1e62201b1045d682e78"><div class="ttname"><a href="struct_wave_track_location.html#a0a54a8fbcc73dfe63879bcff10a75c6da399879306fdea1e62201b1045d682e78">WaveTrackLocation::locationCutLine</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_location_8h_source.html#l00017">WaveTrackLocation.h:17</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a3da0925d9ef43e50e04df908923ae48b"><div class="ttname"><a href="class_spectrogram_settings.html#a3da0925d9ef43e50e04df908923ae48b">SpectrogramSettings::SpectralSelectionEnabled</a></div><div class="ttdeci">bool SpectralSelectionEnabled() const </div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8cpp_source.html#l00520">SpectrogramSettings.cpp:520</a></div></div>
<div class="ttc" id="class_time_track_html_a4b1f56611ba90a95691a0b47107e4d22"><div class="ttname"><a href="class_time_track.html#a4b1f56611ba90a95691a0b47107e4d22">TimeTrack::GetRangeLower</a></div><div class="ttdeci">double GetRangeLower() const </div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8h_source.html#l00107">TimeTrack.h:107</a></div></div>
<div class="ttc" id="_a_color_8h_html_a0fe4b1a08d7994dfe1c28e972a3b2e2a"><div class="ttname"><a href="_a_color_8h.html#a0fe4b1a08d7994dfe1c28e972a3b2e2a">GetColorGradient</a></div><div class="ttdeci">void GetColorGradient(float value, AColor::ColorGradientChoice selected, bool grayscale, unsigned char *red, unsigned char *green, unsigned char *blue)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00120">AColor.h:120</a></div></div>
<div class="ttc" id="class_alg__time__sig_html_a6934cb96babb7728fb421236186d7fc1"><div class="ttname"><a href="class_alg__time__sig.html#a6934cb96babb7728fb421236186d7fc1">Alg_time_sig::beat</a></div><div class="ttdeci">double beat</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00824">allegro.h:824</a></div></div>
<div class="ttc" id="_spectrum_8h_html"><div class="ttname"><a href="_spectrum_8h.html">Spectrum.h</a></div></div>
<div class="ttc" id="getopt1_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="getopt1_8c_source.html#l00079">getopt1.c:79</a></div></div>
<div class="ttc" id="libflac_2src_2flac_2encode_8c_html_ac39d9cef6a5e030ba8d9e11121054268"><div class="ttname"><a href="libflac_2src_2flac_2encode_8c.html#ac39d9cef6a5e030ba8d9e11121054268">max</a></div><div class="ttdeci">#define max(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="libflac_2src_2flac_2encode_8c_source.html#l00046">encode.c:46</a></div></div>
<div class="ttc" id="class_wave_track_html_aaf6f597255538feaf1017d046993445c"><div class="ttname"><a href="class_wave_track.html#aaf6f597255538feaf1017d046993445c">WaveTrack::SetDisplayBounds</a></div><div class="ttdeci">void SetDisplayBounds(float min, float max) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00302">WaveTrack.cpp:302</a></div></div>
<div class="ttc" id="class_zoom_info_html_aa7e0fefa3365826150c253c1ba6e4339"><div class="ttname"><a href="class_zoom_info.html#aa7e0fefa3365826150c253c1ba6e4339">ZoomInfo::PositionToTime</a></div><div class="ttdeci">double PositionToTime(wxInt64 position, wxInt64 origin=0, bool ignoreFisheye=false) const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8cpp_source.html#l00046">ViewInfo.cpp:46</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fca05863539deaa0612d40abbca4f3c4cc6"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca05863539deaa0612d40abbca4f3c4cc6">SpectrogramSettings::stBark</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00058">SpectrogramSettings.h:58</a></div></div>
<div class="ttc" id="class_alg__iterator_html_a92b44e65fa07d97f7f41494b06201543"><div class="ttname"><a href="class_alg__iterator.html#a92b44e65fa07d97f7f41494b06201543">Alg_iterator::end</a></div><div class="ttdeci">void end()</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l03484">allegro.cpp:3484</a></div></div>
<div class="ttc" id="_number_scale_8h_html"><div class="ttname"><a href="_number_scale_8h.html">NumberScale.h</a></div></div>
<div class="ttc" id="class_alg__time__sigs_html"><div class="ttname"><a href="class_alg__time__sigs.html">Alg_time_sigs</a></div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00850">allegro.h:850</a></div></div>
<div class="ttc" id="class_track_html_abe5a26d73a2beddbacd19a39f4286fb2"><div class="ttname"><a href="class_track.html#abe5a26d73a2beddbacd19a39f4286fb2">Track::GetLinked</a></div><div class="ttdeci">bool GetLinked() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00181">Track.h:181</a></div></div>
<div class="ttc" id="cext_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="cext_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="cext_8h_source.html#l00081">cext.h:81</a></div></div>
<div class="ttc" id="class_track_artist_html_a5e33cdb8a68a1cd9a7381c6b93f4422f"><div class="ttname"><a href="class_track_artist.html#a5e33cdb8a68a1cd9a7381c6b93f4422f">TrackArtist::~TrackArtist</a></div><div class="ttdeci">~TrackArtist()</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00280">TrackArtist.cpp:280</a></div></div>
<div class="ttc" id="class_alg__time__sig_html"><div class="ttname"><a href="class_alg__time__sig.html">Alg_time_sig</a></div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00822">allegro.h:822</a></div></div>
<div class="ttc" id="class_envelope_html_ac5729053c923e47b43f0f063845c2ce9"><div class="ttname"><a href="class_envelope.html#ac5729053c923e47b43f0f063845c2ce9">Envelope::GetValue</a></div><div class="ttdeci">double GetValue(double t) const </div><div class="ttdoc">Get envelope value at time t. </div><div class="ttdef"><b>Definition:</b> <a href="src_2_envelope_8cpp_source.html#l00994">Envelope.cpp:994</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a796e0079edd616e1651edd8a4b9aa212"><div class="ttname"><a href="class_spec_px_cache.html#a796e0079edd616e1651edd8a4b9aa212">SpecPxCache::scaleType</a></div><div class="ttdeci">int scaleType</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00145">WaveClip.h:145</a></div></div>
<div class="ttc" id="class_alg__iterator_html_a59c05da591cc008ff1be195335646046"><div class="ttname"><a href="class_alg__iterator.html#a59c05da591cc008ff1be195335646046">Alg_iterator::begin</a></div><div class="ttdeci">void begin(void *cookie=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00975">allegro.h:975</a></div></div>
<div class="ttc" id="class_wave_clip_html_a070d7b2328a78c6ddaecc2f60ad4567f"><div class="ttname"><a href="class_wave_clip.html#a070d7b2328a78c6ddaecc2f60ad4567f">WaveClip::GetOffset</a></div><div class="ttdeci">double GetOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00247">WaveClip.h:247</a></div></div>
<div class="ttc" id="class_wave_track_html_a93d35f717c7120f01d93ccb0e1d18db4"><div class="ttname"><a href="class_wave_track.html#a93d35f717c7120f01d93ccb0e1d18db4">WaveTrack::GetChannelGain</a></div><div class="ttdeci">float GetChannelGain(int channel) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00479">WaveTrack.cpp:479</a></div></div>
<div class="ttc" id="class_wave_track_html_a3b73b4b1c0c422cc1b3363757f4ecb07"><div class="ttname"><a href="class_wave_track.html#a3b73b4b1c0c422cc1b3363757f4ecb07">WaveTrack::GetLastdBRange</a></div><div class="ttdeci">int GetLastdBRange() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00443">WaveTrack.h:443</a></div></div>
<div class="ttc" id="_prefs_8h_html"><div class="ttname"><a href="_prefs_8h.html">Prefs.h</a></div></div>
<div class="ttc" id="_note_track_8h_html"><div class="ttname"><a href="_note_track_8h.html">NoteTrack.h</a></div></div>
<div class="ttc" id="_waveform_settings_8h_html"><div class="ttname"><a href="_waveform_settings_8h.html">WaveformSettings.h</a></div></div>
<div class="ttc" id="float_8h_html"><div class="ttname"><a href="float_8h.html">float.h</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a35321029bb4e809eedb8721db80c448e"><div class="ttname"><a href="class_spectrogram_settings.html#a35321029bb4e809eedb8721db80c448e">SpectrogramSettings::GetFFTLength</a></div><div class="ttdeci">int GetFFTLength() const </div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8cpp_source.html#l00482">SpectrogramSettings.cpp:482</a></div></div>
<div class="ttc" id="class_wave_track_html_a54f8ed0c9c1d1fae0241867565b33512"><div class="ttname"><a href="class_wave_track.html#a54f8ed0c9c1d1fae0241867565b33512">WaveTrack::GetSpectrogramSettings</a></div><div class="ttdeci">const SpectrogramSettings &amp; GetSpectrogramSettings() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00731">WaveTrack.cpp:731</a></div></div>
<div class="ttc" id="class_zoom_info_html_a58a0384edf7d035b5be58f6b0b25bdb5"><div class="ttname"><a href="class_zoom_info.html#a58a0384edf7d035b5be58f6b0b25bdb5">ZoomInfo::InFisheye</a></div><div class="ttdeci">bool InFisheye(wxInt64, wxInt64 WXUNUSED(origin=0)) const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00124">ViewInfo.h:124</a></div></div>
<div class="ttc" id="include_2audacity_2_types_8h_html_a9938d2e2f6adef23e745cd80ef379792aba7300a3d7158e88f04d5f81e613dde2"><div class="ttname"><a href="include_2audacity_2_types_8h.html#a9938d2e2f6adef23e745cd80ef379792aba7300a3d7158e88f04d5f81e613dde2">floatSample</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2audacity_2_types_8h_source.html#l00070">Types.h:70</a></div></div>
<div class="ttc" id="class_selected_region_html_aec8e1688714de8fb218d0cf0188360d6"><div class="ttname"><a href="class_selected_region.html#aec8e1688714de8fb218d0cf0188360d6">SelectedRegion::t1</a></div><div class="ttdeci">double t1() const </div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00094">SelectedRegion.h:94</a></div></div>
<div class="ttc" id="allegro_8h_html_ad0b977172262373d5dc58a536e52f4b5"><div class="ttname"><a href="allegro_8h.html#ad0b977172262373d5dc58a536e52f4b5">ALG_EPS</a></div><div class="ttdeci">#define ALG_EPS</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00055">allegro.h:55</a></div></div>
<div class="ttc" id="class_zoom_info_html_aff75f3d72f5fef0e3472ac4c415e63f3"><div class="ttname"><a href="class_zoom_info.html#aff75f3d72f5fef0e3472ac4c415e63f3">ZoomInfo::FindIntervals</a></div><div class="ttdeci">void FindIntervals(double rate, Intervals &amp;results, wxInt64 width, wxInt64 origin=0) const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8cpp_source.html#l00098">ViewInfo.cpp:98</a></div></div>
<div class="ttc" id="_note_track_8h_html_aa89494ee94299dead423eae180285079"><div class="ttname"><a href="_note_track_8h.html#aa89494ee94299dead423eae180285079">SonifyBeginNoteForeground</a></div><div class="ttdeci">#define SonifyBeginNoteForeground()</div><div class="ttdef"><b>Definition:</b> <a href="_note_track_8h_source.html#l00227">NoteTrack.h:227</a></div></div>
<div class="ttc" id="_time_track_8h_html"><div class="ttname"><a href="_time_track_8h.html">TimeTrack.h</a></div></div>
<div class="ttc" id="class_ruler_html_af58442bc79afc26e7b9f7735e1f6e198aad1375df5e28b7c8146f9f6cfb1c25c6"><div class="ttname"><a href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198aad1375df5e28b7c8146f9f6cfb1c25c6">Ruler::RealFormat</a></div><div class="ttdef"><b>Definition:</b> <a href="_ruler_8h_source.html#l00036">Ruler.h:36</a></div></div>
<div class="ttc" id="_track_artist_8cpp_html_ae9fe7afff0bfbea92663e8a2c0ecf0cb"><div class="ttname"><a href="_track_artist_8cpp.html#ae9fe7afff0bfbea92663e8a2c0ecf0cb">ValueOfPixel</a></div><div class="ttdeci">float ValueOfPixel(int yy, int height, bool offset, bool dB, double dBRange, float zoomMin, float zoomMax)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00978">TrackArtist.cpp:978</a></div></div>
<div class="ttc" id="class_wave_track_html_a00b8ff13124c65a9b937e546cbcff466"><div class="ttname"><a href="class_wave_track.html#a00b8ff13124c65a9b937e546cbcff466">WaveTrack::UpdateLocationsCache</a></div><div class="ttdeci">void UpdateLocationsCache() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l02431">WaveTrack.cpp:2431</a></div></div>
<div class="ttc" id="class_alg__event_html_aad79cff0b92503c9ad4f6fc7a6425d74"><div class="ttname"><a href="class_alg__event.html#aad79cff0b92503c9ad4f6fc7a6425d74">Alg_event::chan</a></div><div class="ttdeci">long chan</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00197">allegro.h:197</a></div></div>
<div class="ttc" id="class_number_scale_html"><div class="ttname"><a href="class_number_scale.html">NumberScale</a></div><div class="ttdef"><b>Definition:</b> <a href="_number_scale_8h_source.html#l00031">NumberScale.h:31</a></div></div>
<div class="ttc" id="win_2_projects_2libsndfile_2sys_2time_8h_html"><div class="ttname"><a href="win_2_projects_2libsndfile_2sys_2time_8h.html">time.h</a></div></div>
<div class="ttc" id="class_zoom_info_html_a68d0856b5e64abd74f91ebeedac395d3"><div class="ttname"><a href="class_zoom_info.html#a68d0856b5e64abd74f91ebeedac395d3">ZoomInfo::Intervals</a></div><div class="ttdeci">std::vector&lt; Interval &gt; Intervals</div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00101">ViewInfo.h:101</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_afbb300bf82421e6d50cb81b7032f7529"><div class="ttname"><a href="class_spectrogram_settings.html#afbb300bf82421e6d50cb81b7032f7529">SpectrogramSettings::windowSize</a></div><div class="ttdeci">int windowSize</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00103">SpectrogramSettings.h:103</a></div></div>
<div class="ttc" id="class_zoom_info_html"><div class="ttname"><a href="class_zoom_info.html">ZoomInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00029">ViewInfo.h:29</a></div></div>
<div class="ttc" id="class_a_color_html_a9113deb34fdd4021fefe975070b6d2e1"><div class="ttname"><a href="class_a_color.html#a9113deb34fdd4021fefe975070b6d2e1">AColor::BevelTrackInfo</a></div><div class="ttdeci">static void BevelTrackInfo(wxDC &amp;dc, bool up, wxRect &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00214">AColor.cpp:214</a></div></div>
<div class="ttc" id="allegro_8h_html_a7367c3f1b2c307bcda6aed01bf8511fa"><div class="ttname"><a href="allegro_8h.html#a7367c3f1b2c307bcda6aed01bf8511fa">Alg_parameters_ptr</a></div><div class="ttdeci">class Alg_parameters * Alg_parameters_ptr</div></div>
<div class="ttc" id="class_wave_clip_html_abf840b95c4ee482e9077f274e329a0d2"><div class="ttname"><a href="class_wave_clip.html#abf840b95c4ee482e9077f274e329a0d2">WaveClip::mSpecPxCache</a></div><div class="ttdeci">SpecPxCache * mSpecPxCache</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00377">WaveClip.h:377</a></div></div>
<div class="ttc" id="class_alg__track_html"><div class="ttname"><a href="class_alg__track.html">Alg_track</a></div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00639">allegro.h:639</a></div></div>
<div class="ttc" id="class_wave_clip_html_a89df7eef9147be5868fe247c6239e5c8"><div class="ttname"><a href="class_wave_clip.html#a89df7eef9147be5868fe247c6239e5c8">WaveClip::GetEnvelope</a></div><div class="ttdeci">Envelope * GetEnvelope()</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00267">WaveClip.h:267</a></div></div>
<div class="ttc" id="winfun_8c_html_ab24f32995c1d94525943b4568cce20cb"><div class="ttname"><a href="winfun_8c.html#ab24f32995c1d94525943b4568cce20cb">if</a></div><div class="ttdeci">if(verbose)</div><div class="ttdef"><b>Definition:</b> <a href="winfun_8c_source.html#l00036">winfun.c:36</a></div></div>
<div class="ttc" id="class_track_html_ad71d0460cf42bcde59dcf600af7ef6b7"><div class="ttname"><a href="class_track.html#ad71d0460cf42bcde59dcf600af7ef6b7">Track::GetKind</a></div><div class="ttdeci">virtual int GetKind() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00215">Track.h:215</a></div></div>
<div class="ttc" id="namespacewaflib_1_1_utils_html_a15fc4f04cecad81fba9772c4e43d40f7"><div class="ttname"><a href="namespacewaflib_1_1_utils.html#a15fc4f04cecad81fba9772c4e43d40f7">waflib.Utils.x</a></div><div class="ttdeci">string x</div><div class="ttdef"><b>Definition:</b> <a href="lilv_2waflib_2_utils_8py_source.html#l00176">Utils.py:176</a></div></div>
<div class="ttc" id="class_wave_display_html_aab0a13074ebb8ed5ba1da2bceaddd407"><div class="ttname"><a href="class_wave_display.html#aab0a13074ebb8ed5ba1da2bceaddd407">WaveDisplay::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00162">WaveClip.h:162</a></div></div>
<div class="ttc" id="class_label_track_html"><div class="ttname"><a href="class_label_track.html">LabelTrack</a></div><div class="ttdoc">A LabelTrack is a Track that holds labels (LabelStruct). </div><div class="ttdef"><b>Definition:</b> <a href="_label_track_8h_source.html#l00111">LabelTrack.h:111</a></div></div>
<div class="ttc" id="class_wave_track_html_aebb4cac69620ce02b4f396fb37d23f82"><div class="ttname"><a href="class_wave_track.html#aebb4cac69620ce02b4f396fb37d23f82">WaveTrack::GetDisplayBounds</a></div><div class="ttdeci">void GetDisplayBounds(float *min, float *max) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00296">WaveTrack.cpp:296</a></div></div>
<div class="ttc" id="class_wave_display_html"><div class="ttname"><a href="class_wave_display.html">WaveDisplay</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00159">WaveClip.h:159</a></div></div>
<div class="ttc" id="class_selected_region_html_a04b91be00d5df7ef6fd08161dd6f1ec4"><div class="ttname"><a href="class_selected_region.html#a04b91be00d5df7ef6fd08161dd6f1ec4">SelectedRegion::f0</a></div><div class="ttdeci">double f0() const </div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00099">SelectedRegion.h:99</a></div></div>
<div class="ttc" id="class_track_artist_html_aa39e383c6894d3a72cd1783399288a19"><div class="ttname"><a href="class_track_artist.html#aa39e383c6894d3a72cd1783399288a19">TrackArtist::DrawBackgroundWithSelection</a></div><div class="ttdeci">static void DrawBackgroundWithSelection(wxDC *dc, const wxRect &amp;rect, const Track *track, wxBrush &amp;selBrush, wxBrush &amp;unselBrush, const SelectedRegion &amp;selectedRegion, const ZoomInfo &amp;zoomInfo)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l03297">TrackArtist.cpp:3297</a></div></div>
<div class="ttc" id="_theme_8h_html"><div class="ttname"><a href="_theme_8h.html">Theme.h</a></div></div>
<div class="ttc" id="allegro_8h_html_aeb8db009b4ffadef2e7ca0e4936f0307"><div class="ttname"><a href="allegro_8h.html#aeb8db009b4ffadef2e7ca0e4936f0307">Alg_event_ptr</a></div><div class="ttdeci">class Alg_event * Alg_event_ptr</div></div>
<div class="ttc" id="class_a_color_html_a9706bc519ec6f6b7f93ddc6371331f07"><div class="ttname"><a href="class_a_color.html#a9706bc519ec6f6b7f93ddc6371331f07">AColor::envelopePen</a></div><div class="ttdeci">static wxPen envelopePen</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00089">AColor.h:89</a></div></div>
<div class="ttc" id="class_profiler_html_a1e6dd8f6cfb15cd5237b971d8f49c749"><div class="ttname"><a href="class_profiler.html#a1e6dd8f6cfb15cd5237b971d8f49c749">Profiler::~Profiler</a></div><div class="ttdeci">virtual ~Profiler()</div><div class="ttdoc">write to a profile at the end of the test. </div><div class="ttdef"><b>Definition:</b> <a href="_profiler_8cpp_source.html#l00028">Profiler.cpp:28</a></div></div>
<div class="ttc" id="class_waveform_settings_html_a62e3323b180e270201c4bd5bcf52b4e4"><div class="ttname"><a href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4">WaveformSettings::ScaleType</a></div><div class="ttdeci">ScaleType</div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00053">WaveformSettings.h:53</a></div></div>
<div class="ttc" id="_g_u_i_settings_8h_html_aa2147fdb6d75c564f0569bc513b022af"><div class="ttname"><a href="_g_u_i_settings_8h.html#aa2147fdb6d75c564f0569bc513b022af">ENV_DB_RANGE</a></div><div class="ttdeci">#define ENV_DB_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_settings_8h_source.html#l00016">GUISettings.h:16</a></div></div>
<div class="ttc" id="class_a_color_html_a3a1a5b4ab4055f09810d58a166f61bfeabdd31fd590dccaefd1f2ab6df45f85aa"><div class="ttname"><a href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfeabdd31fd590dccaefd1f2ab6df45f85aa">AColor::ColorGradientEdge</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00030">AColor.h:30</a></div></div>
<div class="ttc" id="_note_track_8h_html_adc24f51826c5389d0d9f0a09bf904ed6"><div class="ttname"><a href="_note_track_8h.html#adc24f51826c5389d0d9f0a09bf904ed6">SonifyEndNoteForeground</a></div><div class="ttdeci">#define SonifyEndNoteForeground()</div><div class="ttdef"><b>Definition:</b> <a href="_note_track_8h_source.html#l00228">NoteTrack.h:228</a></div></div>
<div class="ttc" id="class_wave_clip_html_ac28044d7d312e53024f7b4fbe38e711f"><div class="ttname"><a href="class_wave_clip.html#ac28044d7d312e53024f7b4fbe38e711f">WaveClip::GetWaveDisplay</a></div><div class="ttdeci">bool GetWaveDisplay(WaveDisplay &amp;display, double t0, double pixelsPerSecond, bool &amp;isLoadingOD) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00504">WaveClip.cpp:504</a></div></div>
<div class="ttc" id="class_alg__note_html"><div class="ttname"><a href="class_alg__note.html">Alg_note</a></div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00293">allegro.h:293</a></div></div>
<div class="ttc" id="class_time_track_html"><div class="ttname"><a href="class_time_track.html">TimeTrack</a></div><div class="ttdoc">A kind of Track used to &amp;#39;warp time&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8h_source.html#l00026">TimeTrack.h:26</a></div></div>
<div class="ttc" id="class_zoom_info_html_a21e3cd944a2c0241db3c32b2416ba7b6aac88e9f498c9306c26caffbeaa349a8e"><div class="ttname"><a href="class_zoom_info.html#a21e3cd944a2c0241db3c32b2416ba7b6aac88e9f498c9306c26caffbeaa349a8e">ZoomInfo::HIDDEN</a></div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00114">ViewInfo.h:114</a></div></div>
<div class="ttc" id="_prefs_8cpp_html_a605d9511ac8da26b177c7362d7f8dc82"><div class="ttname"><a href="_prefs_8cpp.html#a605d9511ac8da26b177c7362d7f8dc82">gPrefs</a></div><div class="ttdeci">wxFileConfig * gPrefs</div><div class="ttdef"><b>Definition:</b> <a href="_prefs_8cpp_source.html#l00070">Prefs.cpp:70</a></div></div>
<div class="ttc" id="class_time_track_html_a8d16c30d6a49657b1e3125ba16a3fae8"><div class="ttname"><a href="class_time_track.html#a8d16c30d6a49657b1e3125ba16a3fae8">TimeTrack::GetRangeUpper</a></div><div class="ttdeci">double GetRangeUpper() const </div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8h_source.html#l00108">TimeTrack.h:108</a></div></div>
<div class="ttc" id="checksum_8c_html_ab80e330a3bc9e38c1297fe17381e92b4"><div class="ttname"><a href="checksum_8c.html#ab80e330a3bc9e38c1297fe17381e92b4">i</a></div><div class="ttdeci">int i[1&lt;&lt; 15]</div><div class="ttdef"><b>Definition:</b> <a href="checksum_8c_source.html#l00072">checksum.c:72</a></div></div>
<div class="ttc" id="class_a_color_html_a5cb93580edc1c0b99f1664d270695e96"><div class="ttname"><a href="class_a_color.html#a5cb93580edc1c0b99f1664d270695e96">AColor::LightMIDIChannel</a></div><div class="ttdeci">static void LightMIDIChannel(wxDC *dc, int channel)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00541">AColor.cpp:541</a></div></div>
<div class="ttc" id="group__lavu__mem_html_ga854352f53b148adc24983a58a1866d66"><div class="ttname"><a href="group__lavu__mem.html#ga854352f53b148adc24983a58a1866d66">size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="ffmpeg_2libavutil_2mem_8h_source.html#l00094">mem.h:94</a></div></div>
<div class="ttc" id="_track_artist_8h_html"><div class="ttname"><a href="_track_artist_8h.html">TrackArtist.h</a></div></div>
<div class="ttc" id="_label_track_8h_html"><div class="ttname"><a href="_label_track_8h.html">LabelTrack.h</a></div></div>
<div class="ttc" id="class_alg__time__sig_html_aff9848a9e6b557a01048ca0cffb9edef"><div class="ttname"><a href="class_alg__time__sig.html#aff9848a9e6b557a01048ca0cffb9edef">Alg_time_sig::den</a></div><div class="ttdeci">double den</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00826">allegro.h:826</a></div></div>
<div class="ttc" id="class_track_artist_html_a2dc63db7d889371b5f00be926b05c387"><div class="ttname"><a href="class_track_artist.html#a2dc63db7d889371b5f00be926b05c387">TrackArtist::DrawTrack</a></div><div class="ttdeci">void DrawTrack(const Track *t, wxDC &amp;dc, const wxRect &amp;rect, const SelectedRegion &amp;selectedRegion, const ZoomInfo &amp;zoomInfo, bool drawEnvelope, bool bigPoints, bool drawSliders, bool hasSolo)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00441">TrackArtist.cpp:441</a></div></div>
<div class="ttc" id="class_selected_region_html"><div class="ttname"><a href="class_selected_region.html">SelectedRegion</a></div><div class="ttdoc">Defines a selected portion of a project. </div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00037">SelectedRegion.h:37</a></div></div>
<div class="ttc" id="class_theme_base_html_a16e679bc4836ef0ecde4edc6bbd4c7c0"><div class="ttname"><a href="class_theme_base.html#a16e679bc4836ef0ecde4edc6bbd4c7c0">ThemeBase::SetBrushColour</a></div><div class="ttdeci">void SetBrushColour(wxBrush &amp;Brush, int iIndex)</div><div class="ttdef"><b>Definition:</b> <a href="_theme_8cpp_source.html#l01015">Theme.cpp:1015</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ab3c3d2f1f144d6751dacbb7b573726ef"><div class="ttname"><a href="class_spectrogram_settings.html#ab3c3d2f1f144d6751dacbb7b573726ef">SpectrogramSettings::range</a></div><div class="ttdeci">int range</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00098">SpectrogramSettings.h:98</a></div></div>
<div class="ttc" id="rfft2d_test_m_l_8m_html_aacd36fb6ac9ce14cec71f2ca852524d4"><div class="ttname"><a href="rfft2d_test_m_l_8m.html#aacd36fb6ac9ce14cec71f2ca852524d4">f</a></div><div class="ttdeci">f</div><div class="ttdef"><b>Definition:</b> <a href="rfft2d_test_m_l_8m_source.html#l00027">rfft2dTestML.m:27</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a31c71c0f3307a1a81f44aa35d16ec042"><div class="ttname"><a href="class_spec_px_cache.html#a31c71c0f3307a1a81f44aa35d16ec042">SpecPxCache::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00143">WaveClip.h:143</a></div></div>
<div class="ttc" id="namespacelv2docgen_html_a4405dc5a2509537b9ff3b4de10bc28d6"><div class="ttname"><a href="namespacelv2docgen.html#a4405dc5a2509537b9ff3b4de10bc28d6">lv2docgen.e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="lv2docgen_8py_source.html#l00129">lv2docgen.py:129</a></div></div>
<div class="ttc" id="class_spec_px_cache_html"><div class="ttname"><a href="class_spec_px_cache.html">SpecPxCache</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00124">WaveClip.h:124</a></div></div>
<div class="ttc" id="allegro_8h_html_aad5a663237745add3ab7fec40d5f2c87"><div class="ttname"><a href="allegro_8h.html#aad5a663237745add3ab7fec40d5f2c87">Alg_seq_ptr</a></div><div class="ttdeci">class Alg_seq * Alg_seq_ptr</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00637">allegro.h:637</a></div></div>
<div class="ttc" id="sndfile__play_8m_html_a74c64864f5283ae06d4a981642a59af9"><div class="ttname"><a href="sndfile__play_8m.html#a74c64864f5283ae06d4a981642a59af9">endif</a></div><div class="ttdeci">endif[nr nc]</div><div class="ttdef"><b>Definition:</b> <a href="sndfile__play_8m_source.html#l00036">sndfile_play.m:36</a></div></div>
<div class="ttc" id="class_label_track_html_a8ea914e523a578a392a99373bc803797"><div class="ttname"><a href="class_label_track.html#a8ea914e523a578a392a99373bc803797">LabelTrack::Draw</a></div><div class="ttdeci">void Draw(wxDC &amp;dc, const wxRect &amp;r, const SelectedRegion &amp;selectedRegion, const ZoomInfo &amp;zoomInfo) const </div><div class="ttdef"><b>Definition:</b> <a href="_label_track_8cpp_source.html#l00745">LabelTrack.cpp:745</a></div></div>
<div class="ttc" id="class_spec_cache_html_a77eeba6191fe84d47a8a3053ece7ec0e"><div class="ttname"><a href="class_spec_cache.html#a77eeba6191fe84d47a8a3053ece7ec0e">SpecCache::Populate</a></div><div class="ttdeci">void Populate(const SpectrogramSettings &amp;settings, WaveTrackCache &amp;waveTrackCache, int copyBegin, int copyEnd, int numPixels, sampleCount numSamples, double offset, double rate, double pixelsPerSecond)</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00972">WaveClip.cpp:972</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_aa0c8fbbe53db1ede59a834438a3ee375"><div class="ttname"><a href="class_spectrogram_settings.html#aa0c8fbbe53db1ede59a834438a3ee375">SpectrogramSettings::GetScale</a></div><div class="ttdeci">NumberScale GetScale(float minFreq, float maxFreq, double rate, bool bins) const </div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8cpp_source.html#l00492">SpectrogramSettings.cpp:492</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a9e426ccf5b4ab8210e05c0ead16f4dd0"><div class="ttname"><a href="class_spectrogram_settings.html#a9e426ccf5b4ab8210e05c0ead16f4dd0">SpectrogramSettings::algorithm</a></div><div class="ttdeci">Algorithm algorithm</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00125">SpectrogramSettings.h:125</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fca409b06214bb9e020d4252d6981947acf"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca409b06214bb9e020d4252d6981947acf">SpectrogramSettings::stLinear</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00055">SpectrogramSettings.h:55</a></div></div>
<div class="ttc" id="_track_artist_8cpp_html_a0c33b494a68ce28497e7ce8e5e95feff"><div class="ttname"><a href="_track_artist_8cpp.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a></div><div class="ttdeci">#define CONST</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l01678">TrackArtist.cpp:1678</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_a755339d27872b13735c2cab829e47157"><div class="ttname"><a href="lib_2expat_8h.html#a755339d27872b13735c2cab829e47157">s</a></div><div class="ttdeci">const XML_Char * s</div><div class="ttdef"><b>Definition:</b> <a href="lib_2expat_8h_source.html#l00262">expat.h:262</a></div></div>
<div class="ttc" id="class_waveform_settings_html_a97217e305f6eb7ead4452924fec4029d"><div class="ttname"><a href="class_waveform_settings.html#a97217e305f6eb7ead4452924fec4029d">WaveformSettings::dBRange</a></div><div class="ttdeci">int dBRange</div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00063">WaveformSettings.h:63</a></div></div>
<div class="ttc" id="class_wave_clip_html"><div class="ttname"><a href="class_wave_clip.html">WaveClip</a></div><div class="ttdoc">This allows multiple clips to be a part of one WaveTrack. </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00204">WaveClip.h:204</a></div></div>
<div class="ttc" id="convtest_8m_html_aec25a56c89da9b37e346ecc7a8fc68e5"><div class="ttname"><a href="convtest_8m.html#aec25a56c89da9b37e346ecc7a8fc68e5">i1</a></div><div class="ttdeci">for i1</div><div class="ttdef"><b>Definition:</b> <a href="convtest_8m_source.html#l00023">convtest.m:23</a></div></div>
<div class="ttc" id="class_alg__note_html_ae15463f6b0deca3ac1a179683dd8e6ee"><div class="ttname"><a href="class_alg__note.html#ae15463f6b0deca3ac1a179683dd8e6ee">Alg_note::dur</a></div><div class="ttdeci">double dur</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00299">allegro.h:299</a></div></div>
<div class="ttc" id="class_zoom_info_html_a342ed72b12a2ff5663d22e93d9a3c44c"><div class="ttname"><a href="class_zoom_info.html#a342ed72b12a2ff5663d22e93d9a3c44c">ZoomInfo::GetFisheyeState</a></div><div class="ttdeci">FisheyeState GetFisheyeState() const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00119">ViewInfo.h:119</a></div></div>
<div class="ttc" id="_audacity_8h_html"><div class="ttname"><a href="_audacity_8h.html">Audacity.h</a></div></div>
<div class="ttc" id="class_wave_clip_html_a7909b8a8e1bac5eea9e4bc422b021a59"><div class="ttname"><a href="class_wave_clip.html#a7909b8a8e1bac5eea9e4bc422b021a59">WaveClip::GetSamples</a></div><div class="ttdeci">bool GetSamples(samplePtr buffer, sampleFormat format, sampleCount start, sampleCount len) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00353">WaveClip.cpp:353</a></div></div>
<div class="ttc" id="class_wave_track_html"><div class="ttname"><a href="class_wave_track.html">WaveTrack</a></div><div class="ttdoc">A Track that contains audio waveform data. </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00062">WaveTrack.h:62</a></div></div>
<div class="ttc" id="allegro_8h_html_a49bc03b187e4468a764d73df4c860206"><div class="ttname"><a href="allegro_8h.html#a49bc03b187e4468a764d73df4c860206">Alg_note_ptr</a></div><div class="ttdeci">Alg_note * Alg_note_ptr</div></div>
<div class="ttc" id="class_a_color_html_a9d1ba34941443e99c15a240b5aed4343"><div class="ttname"><a href="class_a_color.html#a9d1ba34941443e99c15a240b5aed4343">AColor::MIDIChannel</a></div><div class="ttdeci">static void MIDIChannel(wxDC *dc, int channel)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00525">AColor.cpp:525</a></div></div>
<div class="ttc" id="libid3tag_2global_8h_html_af576bf8ffa22a44e53018c67095ffbf0"><div class="ttname"><a href="libid3tag_2global_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a></div><div class="ttdeci">#define assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="libid3tag_2global_8h_source.html#l00049">global.h:49</a></div></div>
<div class="ttc" id="class_alg__track_html_a2917672177e913ffff409624792e52d4"><div class="ttname"><a href="class_alg__track.html#a2917672177e913ffff409624792e52d4">Alg_track::unserialize</a></div><div class="ttdeci">static Alg_track * unserialize(void *buffer, long len)</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l01523">allegro.cpp:1523</a></div></div>
<div class="ttc" id="class_track_html"><div class="ttname"><a href="class_track.html">Track</a></div><div class="ttdoc">Fundamental data object of Audacity, placed in the TrackPanel. Classes derived form it include the Wa...</div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00070">Track.h:70</a></div></div>
<div class="ttc" id="_experimental_8h_html"><div class="ttname"><a href="_experimental_8h.html">Experimental.h</a></div></div>
<div class="ttc" id="class_wave_clip_html_ad59c0a252dbb49e98f74155b99777ad8"><div class="ttname"><a href="class_wave_clip.html#ad59c0a252dbb49e98f74155b99777ad8">WaveClip::GetSpectrogram</a></div><div class="ttdeci">bool GetSpectrogram(WaveTrackCache &amp;cache, const float *&amp;spectrogram, const sampleCount *&amp;where, int numPixels, double t0, double pixelsPerSecond) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l01072">WaveClip.cpp:1072</a></div></div>
<div class="ttc" id="class_track_artist_html_ac1ed1e63b3e8682855f002a6696324bd"><div class="ttname"><a href="class_track_artist.html#ac1ed1e63b3e8682855f002a6696324bd">TrackArtist::DrawSyncLockTiles</a></div><div class="ttdeci">static void DrawSyncLockTiles(wxDC *dc, wxRect rect)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l03190">TrackArtist.cpp:3190</a></div></div>
<div class="ttc" id="_g_u_i_settings_8h_html"><div class="ttname"><a href="_g_u_i_settings_8h.html">GUISettings.h</a></div></div>
<div class="ttc" id="class_wave_display_html_ab8b228309a2699299e591641ccfebcb7"><div class="ttname"><a href="class_wave_display.html#ab8b228309a2699299e591641ccfebcb7">WaveDisplay::Allocate</a></div><div class="ttdeci">void Allocate()</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00178">WaveClip.h:178</a></div></div>
<div class="ttc" id="class_theme_base_html_a2243773f651603c2855bd3562801d680"><div class="ttname"><a href="class_theme_base.html#a2243773f651603c2855bd3562801d680">ThemeBase::Image</a></div><div class="ttdeci">wxImage &amp; Image(int iIndex)</div><div class="ttdef"><b>Definition:</b> <a href="_theme_8cpp_source.html#l01034">Theme.cpp:1034</a></div></div>
<div class="ttc" id="class_waveform_settings_html_a62e3323b180e270201c4bd5bcf52b4e4a54fba21bb1212c84ffd56a4f510bc8dc"><div class="ttname"><a href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4a54fba21bb1212c84ffd56a4f510bc8dc">WaveformSettings::stLinear</a></div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00054">WaveformSettings.h:54</a></div></div>
<div class="ttc" id="class_zoom_info_html_af5b3ea2d31e53b203a06d13d4afd7f90"><div class="ttname"><a href="class_zoom_info.html#af5b3ea2d31e53b203a06d13d4afd7f90">ZoomInfo::TimeToPosition</a></div><div class="ttdeci">wxInt64 TimeToPosition(double time, wxInt64 origin=0, bool ignoreFisheye=false) const </div><div class="ttdoc">STM: Converts a project time to screen x position. </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8cpp_source.html#l00056">ViewInfo.cpp:56</a></div></div>
<div class="ttc" id="lspdata_8c_html_a188f5f4011d6169f76ee43763c198076"><div class="ttname"><a href="lspdata_8c.html#a188f5f4011d6169f76ee43763c198076">weight</a></div><div class="ttdeci">float * weight</div><div class="ttdef"><b>Definition:</b> <a href="lspdata_8c_source.html#l00078">lspdata.c:78</a></div></div>
<div class="ttc" id="_compare_audio_command_8cpp_html_abd8bbcfabb3ddef2ccaafb9928a37b95"><div class="ttname"><a href="_compare_audio_command_8cpp.html#abd8bbcfabb3ddef2ccaafb9928a37b95">min</a></div><div class="ttdeci">int min(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="_compare_audio_command_8cpp_source.html#l00080">CompareAudioCommand.cpp:80</a></div></div>
<div class="ttc" id="class_track_html_a670b88686f99e151d6a305a709f130b1"><div class="ttname"><a href="class_track.html#a670b88686f99e151d6a305a709f130b1">Track::GetName</a></div><div class="ttdeci">wxString GetName() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00174">Track.h:174</a></div></div>
<div class="ttc" id="_internat_8h_html_a5ed4c8747b1c367321f0494f01dd61fa"><div class="ttname"><a href="_internat_8h.html#a5ed4c8747b1c367321f0494f01dd61fa">LAT1CTOWX</a></div><div class="ttdeci">#define LAT1CTOWX(X)</div><div class="ttdef"><b>Definition:</b> <a href="_internat_8h_source.html#l00108">Internat.h:108</a></div></div>
<div class="ttc" id="class_wave_display_html_a607b91b920b3688ea7eeb01bf302debf"><div class="ttname"><a href="class_wave_display.html#a607b91b920b3688ea7eeb01bf302debf">WaveDisplay::bl</a></div><div class="ttdeci">int * bl</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00165">WaveClip.h:165</a></div></div>
<div class="ttc" id="class_alg__iterator_html_af175a74563cdefc967e4b568763fa818"><div class="ttname"><a href="class_alg__iterator.html#af175a74563cdefc967e4b568763fa818">Alg_iterator::next</a></div><div class="ttdeci">Alg_event_ptr next(bool *note_on=NULL, void **cookie_ptr=NULL, double *offset_ptr=NULL, double end_time=0)</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l03444">allegro.cpp:3444</a></div></div>
<div class="ttc" id="class_number_scale_1_1_iterator_html"><div class="ttname"><a href="class_number_scale_1_1_iterator.html">NumberScale::Iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="_number_scale_8h_source.html#l00184">NumberScale.h:184</a></div></div>
<div class="ttc" id="class_track_html_a9c988f7695a546bf52ee2dc859db0345"><div class="ttname"><a href="class_track.html#a9c988f7695a546bf52ee2dc859db0345">Track::GetChannel</a></div><div class="ttdeci">int GetChannel() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00189">Track.h:189</a></div></div>
<div class="ttc" id="class_alg__note_html_aefa0a5b76a5747b0e95f96bc8046e199"><div class="ttname"><a href="class_alg__note.html#aefa0a5b76a5747b0e95f96bc8046e199">Alg_note::loud</a></div><div class="ttdeci">float loud</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00298">allegro.h:298</a></div></div>
<div class="ttc" id="class_a_color_html_a37c16741ff103f9bc70a0c4591ddde05"><div class="ttname"><a href="class_a_color.html#a37c16741ff103f9bc70a0c4591ddde05">AColor::Line</a></div><div class="ttdeci">static void Line(wxDC &amp;dc, wxCoord x1, wxCoord y1, wxCoord x2, wxCoord y2)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00102">AColor.cpp:102</a></div></div>
<div class="ttc" id="layer12_8c_html_a33d71f23ba2052d17f0b754dc35265b0"><div class="ttname"><a href="layer12_8c.html#a33d71f23ba2052d17f0b754dc35265b0">offset</a></div><div class="ttdeci">unsigned short offset</div><div class="ttdef"><b>Definition:</b> <a href="layer12_8c_source.html#l00241">layer12.c:241</a></div></div>
<div class="ttc" id="class_waveform_settings_html_a6866a0a302099ef5fcd4fb60cba946cd"><div class="ttname"><a href="class_waveform_settings.html#a6866a0a302099ef5fcd4fb60cba946cd">WaveformSettings::scaleType</a></div><div class="ttdeci">ScaleType scaleType</div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00062">WaveformSettings.h:62</a></div></div>
<div class="ttc" id="class_wave_track_html_a40a351c828128e85e2ba993107b96ef3"><div class="ttname"><a href="class_wave_track.html#a40a351c828128e85e2ba993107b96ef3">WaveTrack::GetClipIterator</a></div><div class="ttdeci">WaveClipList::compatibility_iterator GetClipIterator()</div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00313">WaveTrack.h:313</a></div></div>
<div class="ttc" id="layer3_8c_html_a4b8bfe70f28d6faddcb10d6ecf8c1989"><div class="ttname"><a href="layer3_8c.html#a4b8bfe70f28d6faddcb10d6ecf8c1989">m</a></div><div class="ttdeci">unsigned char const * m</div><div class="ttdef"><b>Definition:</b> <a href="layer3_8c_source.html#l00305">layer3.c:305</a></div></div>
<div class="ttc" id="float__cast_8h_html"><div class="ttname"><a href="float__cast_8h.html">float_cast.h</a></div></div>
<div class="ttc" id="class_zoom_info_html_ae96b54cadf85fe96e933a6af9edbd660"><div class="ttname"><a href="class_zoom_info.html#ae96b54cadf85fe96e933a6af9edbd660">ZoomInfo::vpos</a></div><div class="ttdeci">int vpos</div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00043">ViewInfo.h:43</a></div></div>
<div class="ttc" id="seqread_8c_html_ac503262ae470564980711da4f78b1181"><div class="ttname"><a href="seqread_8c.html#ac503262ae470564980711da4f78b1181">start</a></div><div class="ttdeci">private time_type start</div><div class="ttdef"><b>Definition:</b> <a href="seqread_8c_source.html#l00289">seqread.c:289</a></div></div>
<div class="ttc" id="class_track_list_iterator_html"><div class="ttname"><a href="class_track_list_iterator.html">TrackListIterator</a></div><div class="ttdoc">An iterator for a TrackList. </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00238">Track.h:238</a></div></div>
<div class="ttc" id="convtest_8m_html_afb358f48b1646c750fb9da6c6585be2b"><div class="ttname"><a href="convtest_8m.html#afb358f48b1646c750fb9da6c6585be2b">end</a></div><div class="ttdeci">end</div><div class="ttdef"><b>Definition:</b> <a href="convtest_8m_source.html#l00025">convtest.m:25</a></div></div>
<div class="ttc" id="class_profiler_html_a675ebc9207b9aeace1d967c085abeacf"><div class="ttname"><a href="class_profiler.html#a675ebc9207b9aeace1d967c085abeacf">Profiler::Profiler</a></div><div class="ttdeci">Profiler()</div><div class="ttdoc">private constructor - Singleton. </div><div class="ttdef"><b>Definition:</b> <a href="_profiler_8h_source.html#l00055">Profiler.h:55</a></div></div>
<div class="ttc" id="class_ruler_html_af58442bc79afc26e7b9f7735e1f6e198ae827b2a3942fcd4e249908e9661e40c7"><div class="ttname"><a href="class_ruler.html#af58442bc79afc26e7b9f7735e1f6e198ae827b2a3942fcd4e249908e9661e40c7">Ruler::RealLogFormat</a></div><div class="ttdef"><b>Definition:</b> <a href="_ruler_8h_source.html#l00037">Ruler.h:37</a></div></div>
<div class="ttc" id="class_wave_track_cache_html"><div class="ttname"><a href="class_wave_track_cache.html">WaveTrackCache</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00505">WaveTrack.h:505</a></div></div>
<div class="ttc" id="class_wave_track_html_ab82fb513c3fba956467adc8a8d55b4b8"><div class="ttname"><a href="class_wave_track.html#ab82fb513c3fba956467adc8a8d55b4b8">WaveTrack::GetLastScaleType</a></div><div class="ttdeci">int GetLastScaleType() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00440">WaveTrack.h:440</a></div></div>
<div class="ttc" id="_note_track_8h_html_a7af15a91cee17af51fbff3cdf6bafdee"><div class="ttname"><a href="_note_track_8h.html#a7af15a91cee17af51fbff3cdf6bafdee">SonifyBeginNoteBackground</a></div><div class="ttdeci">#define SonifyBeginNoteBackground()</div><div class="ttdef"><b>Definition:</b> <a href="_note_track_8h_source.html#l00225">NoteTrack.h:225</a></div></div>
<div class="ttc" id="_block_file_8h_html"><div class="ttname"><a href="_block_file_8h.html">BlockFile.h</a></div></div>
<div class="ttc" id="class_wave_clip_html_a04d1806de89e39538576880a8dd43c11"><div class="ttname"><a href="class_wave_clip.html#a04d1806de89e39538576880a8dd43c11">WaveClip::GetRate</a></div><div class="ttdeci">int GetRate() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00237">WaveClip.h:237</a></div></div>
<div class="ttc" id="_audacity_8h_html_a6dfdc8f6b4fa2e8f244f18cedb607b8e"><div class="ttname"><a href="_audacity_8h.html#a6dfdc8f6b4fa2e8f244f18cedb607b8e">LINEAR_TO_DB</a></div><div class="ttdeci">#define LINEAR_TO_DB(x)</div><div class="ttdef"><b>Definition:</b> <a href="_audacity_8h_source.html#l00168">Audacity.h:168</a></div></div>
<div class="ttc" id="_ruler_8h_html"><div class="ttname"><a href="_ruler_8h.html">Ruler.h</a></div></div>
<div class="ttc" id="class_zoom_info_html_ab565b4ba0354aa8b409f2e3096e55143"><div class="ttname"><a href="class_zoom_info.html#ab565b4ba0354aa8b409f2e3096e55143">ZoomInfo::GetFisheyeRightBoundary</a></div><div class="ttdeci">wxInt64 GetFisheyeRightBoundary(wxInt64 WXUNUSED(origin=0)) const </div><div class="ttdef"><b>Definition:</b> <a href="_view_info_8h_source.html#l00132">ViewInfo.h:132</a></div></div>
<div class="ttc" id="class_alg__event__list_html_aed21c54de575437ce6a60625ac6a8cc2"><div class="ttname"><a href="class_alg__event__list.html#aed21c54de575437ce6a60625ac6a8cc2">Alg_event_list::get_type</a></div><div class="ttdeci">char get_type()</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00399">allegro.h:399</a></div></div>
<div class="ttc" id="_track_artist_8cpp_html_a0535b2c11fb2d31bddd10dd8f33ed2e8"><div class="ttname"><a href="_track_artist_8cpp.html#a0535b2c11fb2d31bddd10dd8f33ed2e8">ZOOMLIMIT</a></div><div class="ttdeci">#define ZOOMLIMIT</div></div>
<div class="ttc" id="include_2audacity_2_types_8h_html_aaafb46d1caf7c79262fec96b577215fe"><div class="ttname"><a href="include_2audacity_2_types_8h.html#aaafb46d1caf7c79262fec96b577215fe">samplePtr</a></div><div class="ttdeci">char * samplePtr</div><div class="ttdef"><b>Definition:</b> <a href="include_2audacity_2_types_8h_source.html#l00081">Types.h:81</a></div></div>
<div class="ttc" id="class_spec_cache_html"><div class="ttname"><a href="class_spec_cache.html">SpecCache</a></div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00041">WaveClip.h:41</a></div></div>
<div class="ttc" id="class_track_html_acd2518a3c8c5b82f2a5bd45ce074d781"><div class="ttname"><a href="class_track.html#acd2518a3c8c5b82f2a5bd45ce074d781">Track::GetSolo</a></div><div class="ttdeci">bool GetSolo() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00182">Track.h:182</a></div></div>
<div class="ttc" id="class_ruler_html"><div class="ttname"><a href="class_ruler.html">Ruler</a></div><div class="ttdoc">Used to display a Ruler. </div><div class="ttdef"><b>Definition:</b> <a href="_ruler_8h_source.html#l00031">Ruler.h:31</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a35dfc2e3b2a17e94fb4c77847a5356ce"><div class="ttname"><a href="class_spec_px_cache.html#a35dfc2e3b2a17e94fb4c77847a5356ce">SpecPxCache::len</a></div><div class="ttdeci">sampleCount len</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00141">WaveClip.h:141</a></div></div>
<div class="ttc" id="handlers_8c_html_a82c195c0687005edfeb733c7b5887c33"><div class="ttname"><a href="handlers_8c.html#a82c195c0687005edfeb733c7b5887c33">note</a></div><div class="ttdeci">void note(pitch, dur)</div><div class="ttdef"><b>Definition:</b> <a href="handlers_8c_source.html#l00009">handlers.c:9</a></div></div>
<div class="ttc" id="class_track_html_afafc93348a2d442bf956fa072d3d769b"><div class="ttname"><a href="class_track.html#afafc93348a2d442bf956fa072d3d769b">Track::GetLink</a></div><div class="ttdeci">Track * GetLink() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00254">Track.cpp:254</a></div></div>
<div class="ttc" id="class_wave_clip_html_ac42da9000a368776ef8beb582723fb29"><div class="ttname"><a href="class_wave_clip.html#ac42da9000a368776ef8beb582723fb29">WaveClip::SetDisplayRect</a></div><div class="ttdeci">void SetDisplayRect(const wxRect &amp;r) const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l01238">WaveClip.cpp:1238</a></div></div>
<div class="ttc" id="class_time_track_html_ac15664abc03b775de3581c9b52aa8f89"><div class="ttname"><a href="class_time_track.html#ac15664abc03b775de3581c9b52aa8f89">TimeTrack::Draw</a></div><div class="ttdeci">void Draw(wxDC &amp;dc, const wxRect &amp;r, const ZoomInfo &amp;zoomInfo) const </div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8cpp_source.html#l00232">TimeTrack.cpp:232</a></div></div>
<div class="ttc" id="class_wave_track_html_afe621ba06a0396725da44e937143972f"><div class="ttname"><a href="class_wave_track.html#afe621ba06a0396725da44e937143972f">WaveTrack::TimeToLongSamples</a></div><div class="ttdeci">sampleCount TimeToLongSamples(double t0) const </div><div class="ttdoc">Convert correctly between an (absolute) time in seconds and a number of samples. </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l01865">WaveTrack.cpp:1865</a></div></div>
<div class="ttc" id="class_track_list_iterator_html_a2f22c9a396a8803881ca6d9784039706"><div class="ttname"><a href="class_track_list_iterator.html#a2f22c9a396a8803881ca6d9784039706">TrackListIterator::Next</a></div><div class="ttdeci">virtual Track * Next(bool skiplinked=false)</div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00397">Track.cpp:397</a></div></div>
<div class="ttc" id="seqread_8c_html_aad9ebcdde542d8b2075615388ff15a9c"><div class="ttname"><a href="seqread_8c.html#aad9ebcdde542d8b2075615388ff15a9c">line</a></div><div class="ttdeci">private char line[linesize]</div><div class="ttdef"><b>Definition:</b> <a href="seqread_8c_source.html#l00212">seqread.c:212</a></div></div>
<div class="ttc" id="structbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="minimad_8c_source.html#l00070">minimad.c:70</a></div></div>
<div class="ttc" id="_track_artist_8cpp_html_a9061a778a820c92e76932a871a267877"><div class="ttname"><a href="_track_artist_8cpp.html#a9061a778a820c92e76932a871a267877">ChooseColorSet</a></div><div class="ttdeci">AColor::ColorGradientChoice ChooseColorSet(float bin0, float bin1, float selBinLo, float selBinCenter, float selBinHi, int dashCount, bool isSpectral)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l02084">TrackArtist.cpp:2084</a></div></div>
<div class="ttc" id="class_track_html_adefbd93c6cbde70d082a64729cfc74d8"><div class="ttname"><a href="class_track.html#adefbd93c6cbde70d082a64729cfc74d8">Track::GetY</a></div><div class="ttdeci">int GetY() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00208">Track.cpp:208</a></div></div>
<div class="ttc" id="allegro_8cpp_html_ab525402b4ddb5625f242bd7583667ea0"><div class="ttname"><a href="allegro_8cpp.html#ab525402b4ddb5625f242bd7583667ea0">symbol_table</a></div><div class="ttdeci">Alg_atoms symbol_table</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l00039">allegro.cpp:39</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a6b0d17f8056ff543b9e57060a6c6aabaaab944000f92a5f63a9ff5468ef4b5dc2"><div class="ttname"><a href="class_spectrogram_settings.html#a6b0d17f8056ff543b9e57060a6c6aabaaab944000f92a5f63a9ff5468ef4b5dc2">SpectrogramSettings::algPitchEAC</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00121">SpectrogramSettings.h:121</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fc"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fc">SpectrogramSettings::ScaleType</a></div><div class="ttdeci">ScaleType</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00054">SpectrogramSettings.h:54</a></div></div>
<div class="ttc" id="_reverb_8cpp_html_aacc5617877d2aa4d17c729c1c8ba4eec"><div class="ttname"><a href="_reverb_8cpp.html#aacc5617877d2aa4d17c729c1c8ba4eec">params</a></div><div class="ttdeci">EffectReverb::Params params</div><div class="ttdef"><b>Definition:</b> <a href="_reverb_8cpp_source.html#l00061">Reverb.cpp:61</a></div></div>
<div class="ttc" id="class_a_color_html_a3a1a5b4ab4055f09810d58a166f61bfea341b5b9c96dc41728b34bd4cb7ecaf29"><div class="ttname"><a href="class_a_color.html#a3a1a5b4ab4055f09810d58a166f61bfea341b5b9c96dc41728b34bd4cb7ecaf29">AColor::ColorGradientUnselected</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8h_source.html#l00027">AColor.h:27</a></div></div>
<div class="ttc" id="src_2_envelope_8h_html"><div class="ttname"><a href="src_2_envelope_8h.html">Envelope.h</a></div></div>
<div class="ttc" id="class_wave_clip_html_a7c878143bdd7641be183325944d02f39"><div class="ttname"><a href="class_wave_clip.html#a7c878143bdd7641be183325944d02f39">WaveClip::GetEndTime</a></div><div class="ttdeci">double GetEndTime() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8cpp_source.html#l00378">WaveClip.cpp:378</a></div></div>
<div class="ttc" id="recplay_8c_html_adbbab5cb2248179d231690a1a02ff977"><div class="ttname"><a href="recplay_8c.html#adbbab5cb2248179d231690a1a02ff977">buffer</a></div><div class="ttdeci">char buffer[NUM_BYTES]</div><div class="ttdef"><b>Definition:</b> <a href="recplay_8c_source.html#l00026">recplay.c:26</a></div></div>
<div class="ttc" id="_a_color_8h_html"><div class="ttname"><a href="_a_color_8h.html">AColor.h</a></div></div>
<div class="ttc" id="class_selected_region_html_a821c5a808c950dc3a4db33297c9e088c"><div class="ttname"><a href="class_selected_region.html#a821c5a808c950dc3a4db33297c9e088c">SelectedRegion::f1</a></div><div class="ttdeci">double f1() const </div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00100">SelectedRegion.h:100</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_ac39e72a1de1cb50dbdc54b08d0432a24"><div class="ttname"><a href="lib_2expat_8h.html#ac39e72a1de1cb50dbdc54b08d0432a24">data</a></div><div class="ttdeci">const XML_Char const XML_Char * data</div><div class="ttdef"><b>Definition:</b> <a href="lib_2expat_8h_source.html#l00268">expat.h:268</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a2a248bbe2e6090efba5eee5678849a38"><div class="ttname"><a href="class_spec_px_cache.html#a2a248bbe2e6090efba5eee5678849a38">SpecPxCache::maxFreq</a></div><div class="ttdeci">int maxFreq</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00149">WaveClip.h:149</a></div></div>
<div class="ttc" id="class_waveform_settings_html_a62e3323b180e270201c4bd5bcf52b4e4a2e6fe9dffc2c1d6bbcfaaee36df90f68"><div class="ttname"><a href="class_waveform_settings.html#a62e3323b180e270201c4bd5bcf52b4e4a2e6fe9dffc2c1d6bbcfaaee36df90f68">WaveformSettings::stLogarithmic</a></div><div class="ttdef"><b>Definition:</b> <a href="_waveform_settings_8h_source.html#l00055">WaveformSettings.h:55</a></div></div>
<div class="ttc" id="_spectrogram_settings_8h_html"><div class="ttname"><a href="_spectrogram_settings_8h.html">SpectrogramSettings.h</a></div></div>
<div class="ttc" id="class_wave_track_cache_html_a7f431e21835e425e61bfd52f5f310a1f"><div class="ttname"><a href="class_wave_track_cache.html#a7f431e21835e425e61bfd52f5f310a1f">WaveTrackCache::GetTrack</a></div><div class="ttdeci">const WaveTrack * GetTrack() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00517">WaveTrack.h:517</a></div></div>
<div class="ttc" id="class_track_list_iterator_html_a4eea44fac9add00ff978213df1652441"><div class="ttname"><a href="class_track_list_iterator.html#a4eea44fac9add00ff978213df1652441">TrackListIterator::StartWith</a></div><div class="ttdeci">virtual Track * StartWith(Track *val)</div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00338">Track.cpp:338</a></div></div>
<div class="ttc" id="class_spec_px_cache_html_a544e859e9069386b5558b24dd2a23c9d"><div class="ttname"><a href="class_spec_px_cache.html#a544e859e9069386b5558b24dd2a23c9d">SpecPxCache::gain</a></div><div class="ttdeci">int gain</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00147">WaveClip.h:147</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a8c6871ffc9d2f3f645e9d14c24920e04"><div class="ttname"><a href="class_spectrogram_settings.html#a8c6871ffc9d2f3f645e9d14c24920e04">SpectrogramSettings::scaleType</a></div><div class="ttdeci">ScaleType scaleType</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00112">SpectrogramSettings.h:112</a></div></div>
<div class="ttc" id="class_time_track_html_abacec6fca980b03f0bf7a4f96310704a"><div class="ttname"><a href="class_time_track.html#abacec6fca980b03f0bf7a4f96310704a">TimeTrack::GetEnvelope</a></div><div class="ttdeci">Envelope * GetEnvelope()</div><div class="ttdef"><b>Definition:</b> <a href="_time_track_8h_source.html#l00070">TimeTrack.h:70</a></div></div>
<div class="ttc" id="class_envelope_html_a5daec75b3aa3b0da7919fc986014e1db"><div class="ttname"><a href="class_envelope.html#a5daec75b3aa3b0da7919fc986014e1db">Envelope::GetValues</a></div><div class="ttdeci">void GetValues(double *buffer, int len, double t0, double tstep) const </div><div class="ttdoc">Get many envelope points at once. </div><div class="ttdef"><b>Definition:</b> <a href="src_2_envelope_8cpp_source.html#l01061">Envelope.cpp:1061</a></div></div>
<div class="ttc" id="class_wave_track_html_a18bbe6e1bb4b1016c3a3de835c33b8fa"><div class="ttname"><a href="class_wave_track.html#a18bbe6e1bb4b1016c3a3de835c33b8fa">WaveTrack::GetRate</a></div><div class="ttdeci">double GetRate() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00363">WaveTrack.cpp:363</a></div></div>
<div class="ttc" id="class_track_artist_html_add49089e256d22507061e90e71841d0c"><div class="ttname"><a href="class_track_artist.html#add49089e256d22507061e90e71841d0c">TrackArtist::SetColours</a></div><div class="ttdeci">void SetColours()</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00285">TrackArtist.cpp:285</a></div></div>
<div class="ttc" id="class_alg__note_html_a01dc46324d580898c16fe09d2e85c424"><div class="ttname"><a href="class_alg__note.html#a01dc46324d580898c16fe09d2e85c424">Alg_note::pitch</a></div><div class="ttdeci">float pitch</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00297">allegro.h:297</a></div></div>
<div class="ttc" id="class_wave_track_html_a0692506243ea687501faddd0e767124e"><div class="ttname"><a href="class_wave_track.html#a0692506243ea687501faddd0e767124e">WaveTrack::SetLastScaleType</a></div><div class="ttdeci">void SetLastScaleType() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00286">WaveTrack.cpp:286</a></div></div>
<div class="ttc" id="class_track_html_a4a6604845139575dfc25be299aeb60efaaa103f3467e47ffcb1aa408d53f7bf6e"><div class="ttname"><a href="class_track.html#a4a6604845139575dfc25be299aeb60efaaa103f3467e47ffcb1aa408d53f7bf6e">Track::Label</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00157">Track.h:157</a></div></div>
<div class="ttc" id="class_wave_track_html_a93e8da76e3495f28b5e17518016f9c9f"><div class="ttname"><a href="class_wave_track.html#a93e8da76e3495f28b5e17518016f9c9f">WaveTrack::GetDisplay</a></div><div class="ttdeci">WaveTrackDisplay GetDisplay() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8h_source.html#l00446">WaveTrack.h:446</a></div></div>
<div class="ttc" id="class_wave_track_html_a16171cfb9bd446a6d16e0e5ac1695318"><div class="ttname"><a href="class_wave_track.html#a16171cfb9bd446a6d16e0e5ac1695318">WaveTrack::LongSamplesToTime</a></div><div class="ttdeci">double LongSamplesToTime(sampleCount pos) const </div><div class="ttdoc">Convert correctly between an number of samples and an (absolute) time in seconds. ...</div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l01870">WaveTrack.cpp:1870</a></div></div>
<div class="ttc" id="namespacewaflib_1_1fixpy2_html_a721a8f58a4734bba827b4f6d985f98ff"><div class="ttname"><a href="namespacewaflib_1_1fixpy2.html#a721a8f58a4734bba827b4f6d985f98ff">waflib.fixpy2.r1</a></div><div class="ttdeci">def r1(code)</div><div class="ttdef"><b>Definition:</b> <a href="lilv_2waflib_2fixpy2_8py_source.html#l00045">fixpy2.py:45</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a0d9fbcfd817862e3b021dfba3ff13ea0"><div class="ttname"><a href="class_spectrogram_settings.html#a0d9fbcfd817862e3b021dfba3ff13ea0">SpectrogramSettings::isGrayscale</a></div><div class="ttdeci">bool isGrayscale</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00110">SpectrogramSettings.h:110</a></div></div>
<div class="ttc" id="allegro_8cpp_html_ab5852cb274ff88cc258958579ab1bd71"><div class="ttname"><a href="allegro_8cpp.html#ab5852cb274ff88cc258958579ab1bd71">within</a></div><div class="ttdeci">bool within(double d1, double d2, double epsilon)</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l00043">allegro.cpp:43</a></div></div>
<div class="ttc" id="class_track_artist_html_a7f6b12455815aebb388d9731a85f5740"><div class="ttname"><a href="class_track_artist.html#a7f6b12455815aebb388d9731a85f5740">TrackArtist::SetInset</a></div><div class="ttdeci">void SetInset(int left, int top, int right, int bottom)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00311">TrackArtist.cpp:311</a></div></div>
<div class="ttc" id="class_track_artist_html_aa5b19d1f05fa5297ed4a97c179a3b658"><div class="ttname"><a href="class_track_artist.html#aa5b19d1f05fa5297ed4a97c179a3b658">TrackArtist::DrawVRuler</a></div><div class="ttdeci">void DrawVRuler(const Track *t, wxDC *dc, wxRect &amp;rect)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00509">TrackArtist.cpp:509</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_a14b8af717362fd3d5e176a5e9a81783d"><div class="ttname"><a href="class_spectrogram_settings.html#a14b8af717362fd3d5e176a5e9a81783d">SpectrogramSettings::frequencyGain</a></div><div class="ttdeci">int frequencyGain</div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00100">SpectrogramSettings.h:100</a></div></div>
<div class="ttc" id="_track_artist_8cpp_html_a00fc87b63f1436536d3090852d57f810"><div class="ttname"><a href="_track_artist_8cpp.html#a00fc87b63f1436536d3090852d57f810">GetWaveYPos</a></div><div class="ttdeci">int GetWaveYPos(float value, float min, float max, int height, bool dB, bool outer, float dBr, bool clip)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00922">TrackArtist.cpp:922</a></div></div>
<div class="ttc" id="class_wave_display_html_a75d667998a5aa1ec03d1ec86b80f1392"><div class="ttname"><a href="class_wave_display.html#a75d667998a5aa1ec03d1ec86b80f1392">WaveDisplay::rms</a></div><div class="ttdeci">float * rms</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00164">WaveClip.h:164</a></div></div>
<div class="ttc" id="class_track_list_iterator_html_a81e19731fba5e1b83552aaf36c6f227c"><div class="ttname"><a href="class_track_list_iterator.html#a81e19731fba5e1b83552aaf36c6f227c">TrackListIterator::First</a></div><div class="ttdeci">virtual Track * First(TrackList *val=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00357">Track.cpp:357</a></div></div>
<div class="ttc" id="_audacity_app_8h_html_a0e6f61adcdaa4d07f59bf2fccafe233c"><div class="ttname"><a href="_audacity_app_8h.html#a0e6f61adcdaa4d07f59bf2fccafe233c">MAX_AUDIO</a></div><div class="ttdeci">#define MAX_AUDIO</div><div class="ttdef"><b>Definition:</b> <a href="_audacity_app_8h_source.html#l00237">AudacityApp.h:237</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fca5c62f4c050d024a9d5651292713dc49d"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca5c62f4c050d024a9d5651292713dc49d">SpectrogramSettings::stLogarithmic</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00056">SpectrogramSettings.h:56</a></div></div>
<div class="ttc" id="class_alg__event_html_a7d31289f03b355f25e0ddd4657783a13"><div class="ttname"><a href="class_alg__event.html#a7d31289f03b355f25e0ddd4657783a13">Alg_event::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00196">allegro.h:196</a></div></div>
<div class="ttc" id="class_alg__atoms_html_a8a6735a654aff877740b8fd1abab47cb"><div class="ttname"><a href="class_alg__atoms.html#a8a6735a654aff877740b8fd1abab47cb">Alg_atoms::insert_string</a></div><div class="ttdeci">Alg_attribute insert_string(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8cpp_source.html#l00099">allegro.cpp:99</a></div></div>
<div class="ttc" id="class_selected_region_html_aeb44ed227fd0a3396dc40f57efe3d432"><div class="ttname"><a href="class_selected_region.html#aeb44ed227fd0a3396dc40f57efe3d432">SelectedRegion::UndefinedFrequency</a></div><div class="ttdeci">static const int UndefinedFrequency</div><div class="ttdef"><b>Definition:</b> <a href="_selected_region_8h_source.html#l00043">SelectedRegion.h:43</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fcaee4c3c5d4de31bbe5faa2a7b62d73260"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fcaee4c3c5d4de31bbe5faa2a7b62d73260">SpectrogramSettings::stPeriod</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00060">SpectrogramSettings.h:60</a></div></div>
<div class="ttc" id="class_track_html_a798c2a7bb95cde4d9873f09aa08645bd"><div class="ttname"><a href="class_track.html#a798c2a7bb95cde4d9873f09aa08645bd">Track::vrulerSize</a></div><div class="ttdeci">wxSize vrulerSize</div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8h_source.html#l00095">Track.h:95</a></div></div>
<div class="ttc" id="layer3_8c_html_a741dbb4d8e78c3cb69915db7282fcec0"><div class="ttname"><a href="layer3_8c.html#a741dbb4d8e78c3cb69915db7282fcec0">l</a></div><div class="ttdeci">unsigned char const * l</div><div class="ttdef"><b>Definition:</b> <a href="layer3_8c_source.html#l00303">layer3.c:303</a></div></div>
<div class="ttc" id="class_track_artist_html_a12b902fc290c08e21ce0646f21dae146"><div class="ttname"><a href="class_track_artist.html#a12b902fc290c08e21ce0646f21dae146">TrackArtist::UpdateVRuler</a></div><div class="ttdeci">void UpdateVRuler(const Track *t, wxRect &amp;rect)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00669">TrackArtist.cpp:669</a></div></div>
<div class="ttc" id="include_2audacity_2_types_8h_html_afa427e1f521ea5ec12d054e8bd4d0f71"><div class="ttname"><a href="include_2audacity_2_types_8h.html#afa427e1f521ea5ec12d054e8bd4d0f71">sampleCount</a></div><div class="ttdeci">long long sampleCount</div><div class="ttdef"><b>Definition:</b> <a href="include_2audacity_2_types_8h_source.html#l00060">Types.h:60</a></div></div>
<div class="ttc" id="class_wave_track_html_a9223604210ecf46c9238f43a715ab5f3"><div class="ttname"><a href="class_wave_track.html#a9223604210ecf46c9238f43a715ab5f3">WaveTrack::SetLastdBRange</a></div><div class="ttdeci">void SetLastdBRange() const </div><div class="ttdef"><b>Definition:</b> <a href="_wave_track_8cpp_source.html#l00291">WaveTrack.cpp:291</a></div></div>
<div class="ttc" id="namespacewaflib_1_1_tools_1_1c__preproc_html_a631381b6890985ef083f6544eedbd3e1"><div class="ttname"><a href="namespacewaflib_1_1_tools_1_1c__preproc.html#a631381b6890985ef083f6544eedbd3e1">waflib.Tools.c_preproc.skipped</a></div><div class="ttdeci">string skipped</div><div class="ttdef"><b>Definition:</b> <a href="lilv_2waflib_2_tools_2c__preproc_8py_source.html#l00038">c_preproc.py:38</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fca5a24e86be9af1c36d900f07be7a14354"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca5a24e86be9af1c36d900f07be7a14354">SpectrogramSettings::stMel</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00057">SpectrogramSettings.h:57</a></div></div>
<div class="ttc" id="class_a_color_html_a3d6f7afabbb757c3630619df34761e1b"><div class="ttname"><a href="class_a_color.html#a3d6f7afabbb757c3630619df34761e1b">AColor::Light</a></div><div class="ttdeci">static void Light(wxDC *dc, bool selected)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00249">AColor.cpp:249</a></div></div>
<div class="ttc" id="class_spec_cache_html_ad51fc14ddf41540e51b9c4f458218bfc"><div class="ttname"><a href="class_spec_cache.html#ad51fc14ddf41540e51b9c4f458218bfc">SpecCache::freq</a></div><div class="ttdeci">std::vector&lt; float &gt; freq</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00118">WaveClip.h:118</a></div></div>
<div class="ttc" id="class_spectrogram_settings_html_ad80cc088bcf7afb4176fd7195d4691fca413649f9f64d50a2b56f44743d22f8cc"><div class="ttname"><a href="class_spectrogram_settings.html#ad80cc088bcf7afb4176fd7195d4691fca413649f9f64d50a2b56f44743d22f8cc">SpectrogramSettings::stErb</a></div><div class="ttdef"><b>Definition:</b> <a href="_spectrogram_settings_8h_source.html#l00059">SpectrogramSettings.h:59</a></div></div>
<div class="ttc" id="_audacity_8h_html_ae65fedb390ed942548ca02213e6a2813"><div class="ttname"><a href="_audacity_8h.html#ae65fedb390ed942548ca02213e6a2813">DB_TO_LINEAR</a></div><div class="ttdeci">#define DB_TO_LINEAR(x)</div><div class="ttdef"><b>Definition:</b> <a href="_audacity_8h_source.html#l00167">Audacity.h:167</a></div></div>
<div class="ttc" id="class_a_color_html_a34d81236a6bff41ebf8cf2b1183c847a"><div class="ttname"><a href="class_a_color.html#a34d81236a6bff41ebf8cf2b1183c847a">AColor::Dark</a></div><div class="ttdeci">static void Dark(wxDC *dc, bool selected)</div><div class="ttdef"><b>Definition:</b> <a href="_a_color_8cpp_source.html#l00286">AColor.cpp:286</a></div></div>
<div class="ttc" id="class_track_html_aa88d6a8dabe0be72aa34bdebdc41d07b"><div class="ttname"><a href="class_track.html#aa88d6a8dabe0be72aa34bdebdc41d07b">Track::GetHeight</a></div><div class="ttdeci">int GetHeight() const </div><div class="ttdef"><b>Definition:</b> <a href="src_2track_8cpp_source.html#l00218">Track.cpp:218</a></div></div>
<div class="ttc" id="namespacepyportmidi_1_1midi_html_ad2426758f88d23d7208984d5c99ec050"><div class="ttname"><a href="namespacepyportmidi_1_1midi.html#ad2426758f88d23d7208984d5c99ec050">pyportmidi.midi.time</a></div><div class="ttdeci">def time()</div><div class="ttdef"><b>Definition:</b> <a href="midi_8py_source.html#l00542">midi.py:542</a></div></div>
<div class="ttc" id="_note_track_8h_html_a9786c3ef2b94eedc6fe66b64a5681f74"><div class="ttname"><a href="_note_track_8h.html#a9786c3ef2b94eedc6fe66b64a5681f74">SonifyEndNoteBackground</a></div><div class="ttdeci">#define SonifyEndNoteBackground()</div><div class="ttdef"><b>Definition:</b> <a href="_note_track_8h_source.html#l00226">NoteTrack.h:226</a></div></div>
<div class="ttc" id="class_theme_base_html_a935ffd1bb1fcdd5b7c0ff7ef507c60b7"><div class="ttname"><a href="class_theme_base.html#a935ffd1bb1fcdd5b7c0ff7ef507c60b7">ThemeBase::SetPenColour</a></div><div class="ttdeci">void SetPenColour(wxPen &amp;Pen, int iIndex)</div><div class="ttdef"><b>Definition:</b> <a href="_theme_8cpp_source.html#l01021">Theme.cpp:1021</a></div></div>
<div class="ttc" id="allegro_8h_html_a45c52ae87418a599d8196abd30aea3bd"><div class="ttname"><a href="allegro_8h.html#a45c52ae87418a599d8196abd30aea3bd">Alg_attribute</a></div><div class="ttdeci">const char * Alg_attribute</div><div class="ttdef"><b>Definition:</b> <a href="allegro_8h_source.html#l00070">allegro.h:70</a></div></div>
<div class="ttc" id="class_envelope_html_a4463f20563902ef78367735ea25440f4"><div class="ttname"><a href="class_envelope.html#a4463f20563902ef78367735ea25440f4">Envelope::DrawPoints</a></div><div class="ttdeci">void DrawPoints(wxDC &amp;dc, const wxRect &amp;r, const ZoomInfo &amp;zoomInfo, bool dB, double dBRange, float zoomMin, float zoomMax) const </div><div class="ttdoc">TODO: This should probably move to track artist. </div><div class="ttdef"><b>Definition:</b> <a href="src_2_envelope_8cpp_source.html#l00187">Envelope.cpp:187</a></div></div>
<div class="ttc" id="lib_2expat_8h_html_a4a30a13b813682e68c5b689b45c65971"><div class="ttname"><a href="lib_2expat_8h.html#a4a30a13b813682e68c5b689b45c65971">value</a></div><div class="ttdeci">const XML_Char int const XML_Char * value</div><div class="ttdef"><b>Definition:</b> <a href="lib_2expat_8h_source.html#l00331">expat.h:331</a></div></div>
<div class="ttc" id="class_spec_cache_html_ae2c827b1ffd882effd31281fe1d67fc0"><div class="ttname"><a href="class_spec_cache.html#ae2c827b1ffd882effd31281fe1d67fc0">SpecCache::where</a></div><div class="ttdeci">std::vector&lt; sampleCount &gt; where</div><div class="ttdef"><b>Definition:</b> <a href="_wave_clip_8h_source.html#l00119">WaveClip.h:119</a></div></div>
<div class="ttc" id="class_track_artist_html_aecb43569c2de2e9e2cae4584ffd80a5f"><div class="ttname"><a href="class_track_artist.html#aecb43569c2de2e9e2cae4584ffd80a5f">TrackArtist::DrawTracks</a></div><div class="ttdeci">void DrawTracks(TrackList *tracks, Track *start, wxDC &amp;dc, wxRegion &amp;reg, wxRect &amp;rect, wxRect &amp;clip, const SelectedRegion &amp;selectedRegion, const ZoomInfo &amp;zoomInfo, bool drawEnvelope, bool bigPoints, bool drawSliders)</div><div class="ttdef"><b>Definition:</b> <a href="_track_artist_8cpp_source.html#l00319">TrackArtist.cpp:319</a></div></div>
<div class="ttc" id="class_note_track_html"><div class="ttname"><a href="class_note_track.html">NoteTrack</a></div><div class="ttdoc">A Track that is used for Midi notes. (Somewhat old code). </div></div>
<div class="ttc" id="conv2dtest_8m_html_a4b223b47b1bd746a69ed8ac37c4b16db"><div class="ttname"><a href="conv2dtest_8m.html#a4b223b47b1bd746a69ed8ac37c4b16db">it</a></div><div class="ttdeci">program to test real fast conv let user select file then open it[fname, pname]</div><div class="ttdef"><b>Definition:</b> <a href="conv2dtest_8m_source.html#l00004">conv2dtest.m:4</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
